{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","js/app.js","js/app_modules/actions/errors.js","js/app_modules/actions/input-duplicator.js","js/app_modules/actions/jumps.js","js/app_modules/actions/parse/index.js","js/app_modules/actions/parse/methods/getBranchInputsHTML.js","js/app_modules/actions/parse/methods/getGroupInputsHTML.js","js/app_modules/actions/parse/methods/initFormbuilder.js","js/app_modules/actions/parse/methods/renderChildForms.js","js/app_modules/actions/parse/methods/renderInputs.js","js/app_modules/actions/parse/methods/renderProject.js","js/app_modules/actions/possible-answers-pager.js","js/app_modules/actions/possible-answers.js","js/app_modules/actions/save/index.js","js/app_modules/actions/save/module.doCleaningBeforeSaving.js","js/app_modules/actions/save/module.saveAdvancedProperties.js","js/app_modules/actions/save/module.saveAllInputProperties.js","js/app_modules/actions/save/module.saveJumps.js","js/app_modules/actions/save/module.savePossibleAnswers.js","js/app_modules/actions/save/module.saveProperties.js","js/app_modules/actions/save/module.saveUniqueness.js","js/app_modules/actions/undo.js","js/app_modules/actions/validation.js","js/app_modules/config/consts.js","js/app_modules/config/extend-natives.js","js/app_modules/config/formbuilder.js","js/app_modules/config/init.js","js/app_modules/config/messages.js","js/app_modules/config/toast.js","js/app_modules/factory/form-factory.js","js/app_modules/factory/input-factory.js","js/app_modules/factory/input-multiple-answers-prototype.js","js/app_modules/factory/input-properties.js","js/app_modules/factory/input-prototype.js","js/app_modules/helpers/import-form-validation.js","js/app_modules/helpers/ui.js","js/app_modules/helpers/utils.js","js/app_modules/inputs/audio.js","js/app_modules/inputs/barcode.js","js/app_modules/inputs/branch.js","js/app_modules/inputs/checkbox.js","js/app_modules/inputs/date.js","js/app_modules/inputs/dropdown.js","js/app_modules/inputs/group.js","js/app_modules/inputs/integer.js","js/app_modules/inputs/location.js","js/app_modules/inputs/phone.js","js/app_modules/inputs/photo.js","js/app_modules/inputs/radio.js","js/app_modules/inputs/readme.js","js/app_modules/inputs/search.js","js/app_modules/inputs/text.js","js/app_modules/inputs/textarea.js","js/app_modules/inputs/time.js","js/app_modules/inputs/video.js","js/app_modules/loaders/load-child-form-containers.js","js/app_modules/loaders/load-components.js","js/app_modules/loaders/load-containers.js","js/app_modules/loaders/load-input-properties-views.js","js/app_modules/loaders/load-partials.js","js/app_modules/loaders/load-project.js","js/app_modules/template/index.js","js/app_modules/template/methods/createBasicPropertiesHTML.js","js/app_modules/template/methods/createInputPropertiesHTML.js","js/app_modules/template/methods/createInputToolHTML.js","js/app_modules/template/methods/getAdvancedTabBtnHTML.js","js/app_modules/template/methods/getInputPropertiesPanelHTML.js","js/app_modules/template/methods/getJumpTabBtnHTML.js","js/app_modules/template/methods/getJumpsListHTML.js","js/app_modules/template/methods/getPossibleAnswersHTML.js","js/app_modules/template/methods/getPossibleAnswersList.js","js/app_modules/template/methods/getPossibleAnswersPage.js","js/app_modules/template/methods/getUniquenessHTML.js","js/app_modules/template/methods/prepareAdvancedInputPropertiesHTML.js","js/app_modules/template/methods/replaceCommonAdvancedProperties.js","js/app_modules/ui-handlers/branch-sortable.js","js/app_modules/ui-handlers/draggable.js","js/app_modules/ui-handlers/event-handler-callbacks/confirm-import-possible-answers-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/delete-all-questions-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/delete-form-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/export-form-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/form-tab-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/import-form-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-group-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-nested-group-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-advanced-tab-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-change-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-focus-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-keyup-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-title-checkbox-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/modal-form-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/modal-regex-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/print-as-pdf-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/save-project-click-callback.js","js/app_modules/ui-handlers/group-sortable.js","js/app_modules/ui-handlers/possible-answers-sortable.js","js/app_modules/ui-handlers/sortable.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACv5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1fA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"formbuilder.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n//modules are required using absolute paths in browserify: https://goo.gl/UkccGz\nvar init = require('config/init');\nvar extend_natives = require('config/extend-natives');\nvar load_components = require('loaders/load-components');\nvar load_project = require('loaders/load-project');\n\n//load project first\n$.when(\n    load_project()\n).then(function () {\n    //load partial views for index.html, extend natives, then init app\n    $.when(\n        load_components(),\n        extend_natives())\n       .then(init);\n});\n\n/*\n Set middle and right panel to the same height of the inputs-collection panel\n Maybe there is a pure css solution (flexbox), but middle column needs to be scrollable though when I add inputs\n For the time being this will do\n */\n//var inputs_collection_height = $('.inputs-tools').height();\n//$('.main .panel-body').height(inputs_collection_height);\n\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\n\n\nvar errors = {\n\n    //hide all properties errors for the current selected input\n    hidePropertiesErrors: function (the_properties_panel) {\n\n        var properties_panel = the_properties_panel;\n\n        //remove inline errors\n        properties_panel.find('div.input-properties__form__question').removeClass('has-error has-feedback');\n        properties_panel.find('div.input-properties__form__question > i').addClass('hidden');\n        properties_panel.find('div.input-properties__form__question span.input-properties__form__error').text('');\n\n        //remove visual errors from tabs\n        properties_panel.find('.input-properties__tabs .nav-tabs i').addClass('invisible');\n        properties_panel.find('.input-properties__tabs .nav-tabs i').parent().removeClass('validation-error');\n    },\n\n    hidePossibleAnswersErrors: function (the_input) {\n\n        //todo this function is called 3 times whne validating on keyup, look inot it when there is time\n        var input = the_input;\n        var possible_answer_list = input.dom.properties_panel.find('.input-properties__form__possible-answers__list');\n\n        $(possible_answer_list).each(function (index, possible_answer) {\n\n            //highlight wrong input and show error message\n            $(possible_answer).find('.input-properties__form__possible-answers__list__possible_answer_item')\n                .removeClass('has-error has-feedback');\n\n            $(possible_answer).find('.input-properties__form__error')\n                .addClass('hidden')\n                .text('');//set error description\n\n        });\n        //remove visual errors from tabs (if the input is valid, there might be some cuncurrency conditions)\n        if (input.dom.is_valid) {\n            input.dom.properties_panel.find('.input-properties__tabs .nav-tabs i').addClass('invisible');\n            input.dom.properties_panel.find('.input-properties__tabs .nav-tabs i').parent().removeClass('validation-error');\n        }\n    },\n\n    hideTabButtonsErrors: function () {\n        //todo maybe this is not needed\n    },\n\n    hideAdvancedPropertiesErrors: function (input, the_properties) {\n\n        var i;\n        var properties = the_properties;\n        var iLength = properties.length;\n        var wrapper = formbuilder.dom\n            .input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__advanced-properties');\n\n\n        for (i = 0; i < iLength; i++) {\n            wrapper\n                .find('div.input-properties__form__advanced-properties__' + properties[i])\n                .removeClass('has-error has-feedback');\n\n            wrapper\n                .find('div.input-properties__form__advanced-properties__' + properties[i] + ' i')\n                .addClass('hidden');\n\n            wrapper\n                .find('div.input-properties__form__advanced-properties__' + properties[i] + ' span.input-properties__form__error')\n                .addClass('hidden')\n                .text('');\n        }\n    },\n\n    //hide inline errors from jumps (red ouline and error message)\n    hideJumpsErrors: function (the_jumps_list) {\n\n        var jump_list = the_jumps_list;\n        var jump_properties = ['when', 'answer', 'goto'];\n\n        $(jump_list).each(function (index, jump) {\n            $(jump_properties).each(function (index, prop) {\n                $(jump)\n                    .find('.input-properties__form__jumps__logic--' + prop)\n                    .removeClass('has-error')\n                    .find('.input-properties__form__error')\n                    .addClass('hidden')\n                    .text('');\n            });\n        });\n    },\n\n    showQuestionTextErrors: function (the_properties_panel, the_error_message) {\n\n        var properties_panel = the_properties_panel;\n        var error = the_error_message;\n\n        //highlight wrong input and show error message\n        properties_panel.find('div.input-properties__form__question')\n            .addClass('has-error has-feedback');\n        properties_panel.find('div.input-properties__form__question i')\n            .removeClass('hidden')\n            .hide()\n            .fadeIn(consts.ANIMATION_FAST);\n        properties_panel.find('div.input-properties__form__question span.input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)//set error description\n            .hide()\n            .fadeIn(consts.ANIMATION_FAST);\n\n        //show '!' on affected tab, in this case the basic properties tab (first)\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .removeClass('invisible')\n            .fadeIn(consts.ANIMATION_FAST);\n\n        //set properties tab text to red\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .parent()\n            .addClass('validation-error');\n\n\n    },\n\n    showFormNameErrors: function (the_modal, the_error_message) {\n\n        var modal = the_modal;\n        var error = the_error_message;\n\n        modal.find('.modal-body .input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)//set error description\n            .hide()\n            .fadeIn(300);\n    },\n\n    hideFormNameErrors: function (the_modal) {\n\n        var modal = the_modal;\n        modal.find('.modal-body .input-properties__form__error')\n            .addClass('hidden')\n            .text('');\n    },\n\n    showPossibleAnswerErrors: function (the_possible_answer, the_error_message) {\n\n        var possible_answer = the_possible_answer;\n        var properties_panel = possible_answer.parents().eq(9);\n        var error = the_error_message;\n\n        //highlight wrong input and show error message\n        possible_answer.find('.input-properties__form__possible-answers__list__possible_answer_item')\n            .addClass('has-error has-feedback');\n\n        possible_answer.find('.input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)//set error description\n            .hide()\n            .fadeIn(300);\n\n\n        //show '!' on affected tab, in this case the basic properties tab (first)\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .removeClass('invisible')\n            .hide()\n            .fadeIn(300);\n\n        //set properties tab text to red\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .parent()\n            .addClass('validation-error');\n\n    },\n\n    showSingleAdvancedPropertyError: function (the_wrapper, the_property, the_error) {\n\n        var prop = the_property;\n        var error = the_error;\n        var wrapper = the_wrapper;\n\n        wrapper\n            .find('div.input-properties__form__advanced-properties__' + prop).addClass('has-error has-feedback');\n\n        wrapper\n            .find('div.input-properties__form__advanced-properties__' + prop + ' i')\n            .removeClass('hidden')\n            .hide()\n            .fadeIn(300);\n\n        wrapper\n            .find('div.input-properties__form__advanced-properties__' + prop + ' span.input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)\n            .hide()\n            .fadeIn(300);\n\n        //show '!' on affected tab, in this case the advanced properties tab\n        wrapper.parent().parent().find('.nav-tabs').find('i.advanced-error')\n            .removeClass('invisible')\n            .hide()\n            .fadeIn(300);\n\n        //set properties tab text to red\n        wrapper.parent().parent().find('.nav-tabs').find('i.advanced-error')\n            .parent()\n            .addClass('validation-error');\n    },\n\n    showSingleJumpErrors: function (the_jump_item_wrapper, the_properties) {\n\n        var jump_properties = the_properties;\n        var wrapper = the_jump_item_wrapper;\n        var ui = require('helpers/ui');\n\n        //jump condition was not selected\n        if (jump_properties.when === undefined) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--when')\n                .addClass('has-error')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_CONDITION_NOT_SELECTED);\n        }\n\n        //jump answer not selected\n        if (jump_properties.answer_ref === undefined) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--answer')\n                .addClass('has-error ')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_ANSWER_NOT_SELECTED);\n        }\n\n        //jump destination not selected\n        if (jump_properties.to === undefined) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--goto')\n                .addClass('has-error ')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_DESTINATION_NOT_SELECTED);\n        }\n\n        //jump destination not valid (after dragging)\n        if (!jump_properties.has_valid_destination) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--goto')\n                .addClass('has-error')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_DESTINATION_NOT_SELECTED);\n        }\n\n        console.log(wrapper.parents().eq(5));\n\n        ui.input_properties_panel.showJumpTabError(wrapper);\n    },\n\n    showBranchInputsErrors: function (the_properties_panel, the_error_message) {\n\n        var properties_panel = the_properties_panel;\n        var error = the_error_message;\n        var branch_input_ref = formbuilder.branch.current_input_ref;\n        var ui = require('helpers/ui');\n\n\n        //show error message\n        properties_panel.find('.input-properties__form__error--branch-error')\n            .removeClass('invisible')\n            .text(error);\n        //.hide()\n        //  .fadeIn(300);\n\n        //toggle icon to warning\n        ui.inputs_collection.showInputInvalidIcon(branch_input_ref);\n    },\n\n    showGroupInputsErrors: function (the_properties_panel, the_error_message) {\n\n        var properties_panel = the_properties_panel;\n        var error = the_error_message;\n        var branch_input_ref = formbuilder.branch.current_input_ref;\n        var ui = require('helpers/ui');\n\n\n        //show error message\n        properties_panel.find('.input-properties__form__error--group-error')\n            .removeClass('invisible')\n            .text(error);\n        // .hide()\n        //.fadeIn(300);\n\n        //toggle icon to warning\n        ui.inputs_collection.showInputInvalidIcon(branch_input_ref);\n    },\n\n    hideBranchInputsErrors: function (the_properties_panel) {\n        //show error message\n        the_properties_panel.find('.input-properties__form__error--branch-error')\n            .addClass('invisible')\n            .text('&nbsp;');\n    },\n\n    hideGroupInputsErrors: function (the_properties_panel) {\n        //show error message\n        the_properties_panel.find('.input-properties__form__error--group-error')\n            .addClass('invisible')\n            .text('&nbsp;');\n    }\n};\n\nmodule.exports = errors;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar template = require('template');\nvar input_factory = require('factory/input-factory');\n\nvar copy = {\n\n    pushInput: function (input) {\n        var branch_inputs;\n        var group_inputs;\n\n        //remove jumps (they would be invalid when copied, so not worthy)\n        input.jumps = [];\n\n        //also, do not copy the title, set it as false (as we might go over the 3 title limits)\n        input.is_title = false;\n        //add input to collection as the last one\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            var branch_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n            var nested_group_index = utils.getBranchInputCurrentIndexByRef(branch_index, formbuilder.group.active_group_ref);\n\n            //push nested group input\n            formbuilder.project_definition.data.project\n                .forms[formbuilder.current_form_index]\n                .inputs[branch_index]\n                .branch[nested_group_index]\n                .group.push(input);\n        }\n        else {\n\n            if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n                //push top level input\n                formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs.push(input);\n            }\n\n            if (formbuilder.is_editing_branch) {\n                branch_inputs = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref).branch;\n                //push branch input\n                branch_inputs.push(input);\n            }\n\n            if (formbuilder.is_editing_group) {\n                group_inputs = utils.getInputObjectByRef(formbuilder.group.active_group_ref).group;\n                //push group input\n                group_inputs.push(input);\n            }\n        }\n    },\n\n    appendInputToDom: function (input) {\n        var self = this;\n        var input_html = self.createInputHTML(input);\n        var active_branch_sortable;\n        var active_group_sortable;\n\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            //console.log('active group ref = ' + formbuilder.group.active_group_ref);\n            //console.log('active branch ref = ' + formbuilder.branch.active_branch_ref);\n\n            //todo\n            //get active group sortable\n            active_group_sortable = formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]')\n                .find('.group-sortable');\n\n            //append markup to group sortable\n            active_group_sortable.append(input_html.collection);\n        }\n        else {\n            if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n                //append to top level sortable\n                formbuilder.dom.inputs_collection_sortable.append(input_html.collection);\n            }\n\n            if (formbuilder.is_editing_branch) {\n\n                //get active branch sortable\n                active_branch_sortable = formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + formbuilder.branch.active_branch_ref + '\"]')\n                    .find('.branch-sortable');\n\n                //append markup to bracnh sortable\n                active_branch_sortable.append(input_html.collection);\n            }\n\n            if (formbuilder.is_editing_group) {\n\n                //get active group sortable\n                active_group_sortable = formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]')\n                    .find('.group-sortable');\n\n                //append markup to group sortable\n                active_group_sortable.append(input_html.collection);\n            }\n        }\n\n        //append panels\n        formbuilder.dom.input_properties_forms_wrapper.append(input_html.panels);\n    },\n\n    createInputHTML: function (input) {\n\n        var parse = require('actions/parse');\n        var input_factory = require('factory/input-factory');\n        var form_index = formbuilder.current_form_index;\n        var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n        //create html element for input collection (middle column)\n        var input_collection_html = input_factory.createInputToolHTML(input);\n        var properties_panel_html;\n        var input_properties_panel_html = '';\n\n\n        //if it is a branch, loop all the branch inputs (there must be at least a branch input)\n        if (input.type === consts.BRANCH_TYPE) {\n            //todo check the secons arg of getBranchInputsHTML, I had to pass `inputs.length - 1`\n            var branch_inputs_html = parse.getBranchInputsHTML(input, inputs.length - 1);\n            input_collection_html = input_collection_html.replace('{{branch-content}}', branch_inputs_html.collection);\n            //todo check where the string replacement happens\n            input_properties_panel_html += branch_inputs_html.panels;\n        }\n\n        //if it is a group, loop all the group inputs (there must be at least a group input)\n        if (input.type === consts.GROUP_TYPE) {\n\n            var branch_index = null;\n            var group_inputs_html = '';\n\n            //is this a nested group (inside a branch)\n            if (formbuilder.is_editing_branch) {\n                console.log('This is a nested group in a branch')\n                branch_index = utils.getInputCurrentIndexByRef(formbuilder.branch.active_branch_ref);\n                var form_index = formbuilder.current_form_index;\n                var branch_inputs = formbuilder.project_definition.data.project.forms[form_index].inputs[branch_index].branch;\n\n                //we insert the new nested group as the last question in the current branch\n                var group_inputs_html = parse.getGroupInputsHTML(input, branch_index, branch_inputs.length - 1);\n            }\n            else {\n                group_inputs_html = parse.getGroupInputsHTML(input, inputs.length - 1, branch_index);\n            }\n            input_collection_html = input_collection_html.replace('{{group-content}}', group_inputs_html.collection);\n            //todo check where the string replacement happens\n            input_properties_panel_html += group_inputs_html.panels;\n        }\n\n        //create properties panel for current input\n        properties_panel_html = template.getInputPropertiesPanelHTML(input);\n\n        /* Add the group or branch inputs panels markup (if any)\n         The panels are not attached in the right order in the dom but it does not matter,\n         as only one is shown at a time\n         */\n        input_properties_panel_html += properties_panel_html;\n\n        return {\n            collection: input_collection_html,\n            panels: input_properties_panel_html\n        };\n    },\n\n    createPossibleAnswersCopy: function (possible_answers) {\n\n        var possible_answers_copy = [];\n\n        $.each(possible_answers, function (index, possible_answer) {\n            possible_answers_copy[index] = {};\n            possible_answers_copy[index].answer = possible_answer.answer;\n            possible_answers_copy[index].answer_ref = utils.generateUniqID();\n        });\n\n        return possible_answers_copy;\n    },\n\n    createInputCopy: function (input) {\n\n        var input_factory = require('factory/input-factory');\n        var self = this;\n        var input_copied_ref = utils.generateInputCopyRef();\n        var input_copied = input_factory.createInput(input.type, input_copied_ref);\n        var ref_map = [];\n\n        //set input copy properties to original input properties\n        // (only the one saved in the project definition, leave the others intact,\n        // and DO NOT copy the ref!)\n        for (var property in input_copied) {\n            if (input.hasOwnProperty(property) && property !== 'ref') {\n\n                /* Important: branch/group is an array, so perform deep copy\n                 * using JSON.parse(JSON.stringify(obj));\n                 *\n                 * This is because array.slice does not perform a deep copy on anything nested, just on a plain array\n                 * and $.extend(true, [], oldArray) was not working\n                 * */\n                switch (property) {\n                    case consts.BRANCH_TYPE:\n                        input_copied.branch = window.CircularJSON.parse(window.CircularJSON.stringify(input.branch));\n                        // Copy the prototype per each branch input (not done by CircularJSON)\n                        input_copied.branch.forEach(function (copiedBranchInput, copiedIndex) {\n                            input.branch.forEach(function (sourceBranchInput, sourceIndex) {\n                                if (sourceIndex === copiedIndex) {\n                                    Object.setPrototypeOf(copiedBranchInput, Object.getPrototypeOf(sourceBranchInput));\n                                }\n                            });\n                        });\n                        break;\n                    case consts.GROUP_TYPE:\n                        //copy object\n                        input_copied.group = window.CircularJSON.parse(window.CircularJSON.stringify(input.group));\n                        // Copy the prototype per each group input (not done by CircularJSON)\n                        input_copied.group.forEach(function (copiedGroupInput, copiedIndex) {\n                            input.group.forEach(function (sourceGroupInput, sourceIndex) {\n                                if (sourceIndex === copiedIndex) {\n                                    Object.setPrototypeOf(copiedGroupInput, Object.getPrototypeOf(sourceGroupInput));\n                                }\n                            });\n                        });\n                        break;\n                    default:\n                        input_copied[property] = input[property];\n\n                }\n            }\n        }\n\n        //branch\n        ref_map = self.createBranchCopy(input_copied.ref, input_copied.branch, input);\n\n        //group:\n        self.overrideGroupCopyRefs(input_copied.ref, input_copied.group, input);\n\n        //override possible answers \"answer_ref\" on copied top level input (on multiple answers type only)\n        if ($.inArray(input_copied.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n            input_copied.possible_answers = self.createPossibleAnswersCopy(input_copied.possible_answers);\n\n            //todo check what the default property is set to, whether null or empty string\n            if (!(input.default === '' || input.default === null)) {\n                //there is a default value to remap!\n                input_copied.default = self.getDefaultValueFromInputCopy(input, input_copied);\n            }\n        }\n\n        //clear jumps for top level input (when not a branch!)\n        if (input_copied.type === consts.BRANCH_TYPE) {\n            //update jumps for all the branch inputs\n            self.updateBranchJumps(input_copied.branch, ref_map);\n        }\n        else {\n            input_copied.jumps = [];\n        }\n\n        //copy prototype\n        Object.setPrototypeOf(input_copied, Object.getPrototypeOf(input));\n\n        return input_copied;\n    },\n\n    updateBranchJumps: function (branch, ref_map) {\n        //to store the new jumps\n        var updated_jumps;\n        var self = this;\n\n        $(branch).each(function (branch_index, branch_input) {\n\n            updated_jumps = [];\n\n            if (branch_input.jumps.length > 0) {\n\n                $(branch_input.jumps).each(function (ji, jump) {\n\n                    if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        //update the jump references\n                        updated_jumps.push({\n                            when: jump.when,\n                            to: self.getJumpToValueFromRefMap(ref_map, jump.to),\n                            answer_ref: ref_map[branch_index].answer_refs[jump.answer_ref]\n                        });\n                    }\n                    else {\n                        //update the jump references\n                        updated_jumps.push({\n                            when: jump.when,\n                            to: self.getJumpToValueFromRefMap(ref_map, jump.to),\n                            answer_ref: null\n                        });\n                    }\n                });\n            }\n            //replace jumps with updated ones\n            branch_input.jumps = updated_jumps;\n        });\n    },\n\n    overrideGroupCopyRefs: function (copiedInputRef, copiedGroup, originalInput) {\n\n        $(copiedGroup).each(function (copiedGroupInputIndex, copiedGroupInput) {\n\n            var group_answer_ref_map = {};\n\n            copiedGroupInput.ref = utils.generateNestedGroupInputRef(copiedInputRef);\n\n            //override any \"answer_ref\"\n            if ($.inArray(copiedGroupInput.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n\n                var group_input_possible_answers_copy = [];\n\n                $.each(copiedGroupInput.possible_answers, function (index, possible_answer) {\n\n                    var new_answer_ref = utils.generateUniqID();\n\n                    group_input_possible_answers_copy[index] = {};\n                    group_input_possible_answers_copy[index].answer = possible_answer.answer;\n                    group_input_possible_answers_copy[index].answer_ref = new_answer_ref;\n\n                    group_answer_ref_map[possible_answer.answer_ref] = new_answer_ref;\n                });\n\n                //override possible answers for this group input\n                copiedGroupInput.possible_answers = group_input_possible_answers_copy;\n\n                //remap default value to new answer_ref\n                if (!(copiedGroupInput.default === '' || copiedGroupInput.default === null)) {\n                    //there is a default value to remap!\n                    if ($.inArray(copiedGroupInput.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        copiedGroupInput.default = group_answer_ref_map[originalInput.group[copiedGroupInputIndex].default];\n                    }\n                    else {\n                        //do nothing\n                    }\n                }\n            }\n        });\n    },\n\n    createBranchCopy: function (ref, branch, input) {\n\n        var branch_copy = [];\n        var branch_input_possible_answers_copy;\n        var ref_map = [];\n        var branch_input_jumps_copy;\n        var answer_ref_map;\n        var new_answer_refs;\n        var nested_group_copy = [];\n        var nested_group_input_possible_answers_copy;\n\n        $(branch).each(function (branch_index, branch_input) {\n\n            branch_copy[branch_index] = branch_input;\n            branch_copy[branch_index].ref = utils.generateBranchGroupInputRef(ref);\n\n            ref_map[branch_index] = {\n                jumps: branch_input.jumps,\n                answer_refs: {}\n            };\n\n            //map old - new input ref\n            ref_map[branch_index].old_ref = input.branch[branch_index].ref;\n            ref_map[branch_index].new_ref = branch_copy[branch_index].ref;\n\n            //override any \"answer_ref\" and update jumps\n            //todo all the jumps, there is the jump always as well!!!!!\n            if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n\n                branch_input_possible_answers_copy = [];\n                branch_input_jumps_copy = [];\n                answer_ref_map = {};\n\n                $.each(branch_input.possible_answers, function (index, possible_answer) {\n\n                    //build a map to update jumps references\n                    var new_answer_ref = utils.generateUniqID();\n                    answer_ref_map[possible_answer.answer_ref] = new_answer_ref;\n\n                    //override\n                    branch_input_possible_answers_copy[index] = {};\n                    branch_input_possible_answers_copy[index].answer = possible_answer.answer;\n                    branch_input_possible_answers_copy[index].answer_ref = new_answer_ref\n                });\n\n                //override possible answers for this branch input\n                branch_input.possible_answers = branch_input_possible_answers_copy;\n\n                new_answer_refs = answer_ref_map;\n            }\n            else {\n                new_answer_refs = null;\n            }\n\n            //add answer_refs map to jumps map\n            ref_map[branch_index].answer_refs = new_answer_refs;\n\n            //remap default value to new answer_ref\n            if (!(branch_input.default === '' || branch_input.default === null)) {\n                //there is a default value to remap!\n                if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                    branch_input.default = new_answer_refs[branch_input.default];\n                }\n            }\n\n            //a group within a branch:\n\n            $(branch_input.group).each(function (nested_group_input_index, nested_group_input) {\n\n                var group_input_answer_ref_map = {};\n\n                nested_group_copy[nested_group_input_index] = nested_group_input;\n                nested_group_copy[nested_group_input_index].ref = utils.generateBranchGroupInputRef(branch[branch_index].ref);\n\n                if ($.inArray(nested_group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n\n                    nested_group_input_possible_answers_copy = [];\n\n                    $.each(nested_group_input.possible_answers, function (index, possible_answer) {\n\n                        var new_answer_ref = utils.generateUniqID();\n\n                        //override\n                        nested_group_input_possible_answers_copy[index] = {};\n                        nested_group_input_possible_answers_copy[index].answer = possible_answer.answer;\n                        nested_group_input_possible_answers_copy[index].answer_ref = new_answer_ref;\n\n                        group_input_answer_ref_map[possible_answer.answer_ref] = new_answer_ref;\n                    });\n\n                    //override possible answers for this branch input\n                    nested_group_input.possible_answers = nested_group_input_possible_answers_copy;\n\n                    //remap default value to new answer_ref\n                    if (!(nested_group_input.default === '' || nested_group_input.default === null)) {\n                        //there is a default value to remap!\n                        if ($.inArray(nested_group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                            nested_group_input.default = group_input_answer_ref_map[branch_input.group[nested_group_input_index].default];\n                        }\n                    }\n                }\n            });\n        });\n\n        return ref_map;\n    },\n\n    getDefaultValueFromInputCopy: function (original, copy) {\n\n        var original_default_answer_ref_index = -1;\n\n        $(original.possible_answers).each(function (index, possible_answer) {\n            if (possible_answer.answer_ref === original.default) {\n                original_default_answer_ref_index = index;\n            }\n        });\n\n        return copy.possible_answers[original_default_answer_ref_index].answer_ref;\n\n    },\n\n    getJumpToValueFromRefMap: function (ref_map, to) {\n\n        var jump_to = null;\n\n        //if to id \"END\", just return it\n        if (to === consts.JUMP_TO_END_OF_FORM_REF) {\n            jump_to = consts.JUMP_TO_END_OF_FORM_REF;\n        }\n        else {\n            //otherwise return the new ref\n            $(ref_map).each(function (index, map) {\n                if (map.old_ref === to) {\n                    jump_to = map.new_ref;\n                    return false;\n                }\n            });\n        }\n\n        return jump_to\n    },\n\n    deepCloneWithPrototypeMap: function (obj) {\n\n        var self = this;\n\n        if (obj === null || typeof obj !== 'object') {\n            return obj;\n        }\n\n        // Create a new instance of the same prototype\n        var copy = Object.create(Object.getPrototypeOf(obj));\n\n        // Copy properties\n        for (var key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                var value = obj[key];\n                copy[key] = (typeof value === 'object') ? self.deepCloneWithPrototypeMap(value) : value;\n            }\n        }\n\n        return copy;\n    }\n};\n\nmodule.exports = copy;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar jumps = {\n\n    addJump: function (the_input) {\n\n        var input = the_input;\n        var jumps_list_wrapper = formbuilder.dom.input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__jumps .input-properties__form__jumps__list');\n        var html = '';\n        var jump_index = input.jumps.length;\n\n        //if the number of jumps is already equal to the number of possible answers, do not add jump\n        //Do this check only for multiple answers inputs, as single answer inputs do have zero possible_answers at all times.\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) > -1) {\n            if (input.jumps.length >= input.possible_answers.length) {\n                return;\n            }\n        }\n\n        //if jumps, remove 'no jumps set' item\n        jumps_list_wrapper.parent().find('.input-properties__form__jumps__no-jumps-message').addClass('hidden');\n\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) === -1) {\n            //append a jump with condition disabled and set to 'always' jump\n            //we do this because on EC5 when the question is an open answer, a jump will always jump no matter the answer given\n            // jumps_list_wrapper.append();\n\n            html += formbuilder.dom.partials.jump_list_item_always_jump;\n        }\n        else {\n            //jumps get full functionality with multiple answers input types\n            html += formbuilder.dom.partials.jump_list_item;\n        }\n\n        html = html.replace(/{{input-ref-logic-when}}/g, jump_index + '-' + input.ref + '-logic-when');\n        html = html.replace(/{{input-ref-logic-answer}}/g, jump_index + '-' + input.ref + '-logic-answer');\n        html = html.replace(/{{input-ref-logic-goto}}/g, jump_index + '-' + input.ref + '-logic-goto');\n\n        jumps_list_wrapper.append(html);\n\n        //add empty jump to input\n        input.jumps.push({});\n\n        //show jump icon in input tool\n        //todo\n        formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"]');\n        formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"] .input-inner');\n        formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"] .input-inner .jump-state').removeClass('invisible');\n\n    },\n\n    removeJump: function (the_current_input, the_remove_btn) {\n\n        var input = the_current_input;\n        var jump_item = the_remove_btn.parent();\n        var jump_list = jump_item.parent();\n        // jump index starts from 1, as index 0 is 'no jumps yet' placeholder, wrapped in a <li> tag\n        var jump_index = jump_item.index();\n\n        //remove selected from dom\n        jump_item.remove();\n\n        //remove from memory\n        input.jumps.splice((jump_index - 1), 1);\n\n        //if no jumps, show message\n        if (jump_list.find('li').length === 0) {\n            //if no jumps yet, remove 'no jumps set' item\n            jump_list.parent().find('.input-properties__form__jumps__no-jumps-message').removeClass('hidden');\n\n            //hide jumps icon from input tool\n            //todo\n            formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"] .input-inner .jump-state').addClass('invisible');\n        }\n    },\n\n    listJumpPossibleAnswers: function (the_select, the_input) {\n\n        var focused_select = the_select;\n        var input = the_input;\n        var html = '';\n\n        //trigger a save in case the user typed in a possibile answer and switched directly to the jump tab\n        input.savePossibleAnswers();\n\n        focused_select.empty();\n        $(input.possible_answers).each(function (index, possible_answer) {\n            html += '<option value=\"';\n            html += possible_answer.answer_ref + '\">';\n            html += possible_answer.answer.trunc(50);\n            html += '</option>';\n        });\n        focused_select.append(html);\n    },\n\n    //list jump consitions (is, is not etc...)\n    listJumpConditions: function (the_select) {\n\n        var focused_select = the_select;\n        var possible_conditions = consts.JUMP_CONDITIONS;\n        var html = '';\n\n        focused_select.empty();\n        $(possible_conditions).each(function (i) {\n\n            html += '<option value=\"';\n            html += this.key + '\">';\n            html += this.text;\n            html += '</option>';\n        });\n        focused_select.append(html);\n    },\n\n    //dynamically show a list of possible destination for a jump\n    listJumpDestinations: function (the_select, the_jump_destinations) {\n\n        var focused_select = the_select;\n        var jump_destinations = the_jump_destinations;\n\n        /*\n         jumps can go only forward, possible jumps destinations are index of current input +1,\n         as it not possible to jump to an adjacent input\n         */\n        focused_select.empty();\n        $(jump_destinations).each(function (index, destination) {\n\n            var question;\n            var purifiedReadme = '';\n\n            if (destination.question === '') {\n                if (destination.type === consts.BRANCH_TYPE) {\n                    question = messages.error.NO_BRANCH_HEADER_YET;\n                }\n                else {\n                    question = messages.error.NO_QUESTION_TEXT_YET;\n                }\n            }\n            else {\n                if (destination.type === consts.README_TYPE) {\n                    //strip all tags for preview within select\n                    purifiedReadme = utils.decodeHtml(destination.question);\n                    purifiedReadme = utils.stripTags(purifiedReadme);\n                    question = purifiedReadme.trunc(50);\n                }\n                else {\n                    question = destination.question.trunc(50);\n                }\n            }\n            focused_select.append('<option value=\"' + destination.ref + '\">' + question + ' </option>');\n        });\n    },\n\n    ////if any jump, refresh the jumps selected destination label as it might have changed\n    refreshInputJumpsDom: function (input, inputs) {\n\n        var selected_destinations = formbuilder.dom.input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__jumps__logic--goto select option:selected');\n        var purifiedReadme = '';\n\n        var available_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n        //loop each jump\n        $(input.jumps).each(function (jumpIndex, jump) {\n\n            //find the destination \"question\" and update the text shown in the dropdown \"go to\"\n            $(available_destinations).each(function (destinationIndex, destination) {\n\n                if (jump.to === destination.ref) {\n                    if (destination.type === consts.README_TYPE) {\n                        //strip all tags for preview within select\n                        purifiedReadme = utils.decodeHtml(destination.question);\n                        purifiedReadme = utils.stripTags(purifiedReadme);\n                        $(selected_destinations[jumpIndex]).text(purifiedReadme.trunc(50));\n                    }\n                    else {\n                        $(selected_destinations[jumpIndex]).text(destination.question);\n                    }\n                    return false;\n                }\n            });\n        });\n    }\n};\n\nmodule.exports = jumps;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar Input = require('factory/input-prototype');\nvar form_factory = require('factory/form-factory');\nvar template = require('template');\nvar validation = require('actions/validation');\nvar methods = {\n    getBranchInputsHTML: require('actions/parse/methods/getBranchInputsHTML'),\n    getGroupInputsHTML: require('actions/parse/methods/getGroupInputsHTML'),\n    renderInputs: require('actions/parse/methods/renderInputs'),\n    renderProject: require('actions/parse/methods/renderProject'),\n    renderChildForms: require('actions/parse/methods/renderChildForms'),\n    initFormbuilder: require('actions/parse/methods/initFormbuilder')\n};\n\nvar parse = {\n\n    action: '',\n\n    renderInputs: function (the_inputs) {\n        return methods.renderInputs(the_inputs);\n    },\n\n    getBranchInputsHTML: function (the_input, the_index) {\n        return methods.getBranchInputsHTML(the_input, the_index);\n    },\n    //branch index is set when it is a nested group only\n    getGroupInputsHTML: function (the_input, the_index, the_branch_index) {\n        return methods.getGroupInputsHTML(the_input, the_index, the_branch_index);\n    },\n\n    renderProject: function (project_definition, action) {\n        return methods.renderProject(project_definition, action);\n    },\n\n    initFormbuilder: function () {\n        return methods.initFormbuilder();\n    },\n\n    //render children forms recursively\n    renderChildForm: function (the_child_forms) {\n        return methods.renderChildForms(the_child_forms);\n    }\n};\n\nmodule.exports = parse;\n\n","'use strict';\nvar ui = require('helpers/ui');\nvar formbuilder = require('config/formbuilder');\nvar template = require('template');\nvar consts = require('config/consts');\n\nvar getBranchInputsHTML = function (the_input, the_index) {\n\n    var input_factory = require('factory/input-factory');\n    var self = this;\n    var input = the_input;\n    var index = the_index;\n    var branch_properties;\n    var html;\n    var branch_sortable_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.BRANCH_TYPE);\n    var branch_input_collection_html = '';\n    var branch_properties_panel_html = '';\n    var properties_panel_html = '';\n\n    formbuilder.current_input_ref = input.ref;\n\n    //if no branch inputs, show \"no branch inputs message\"\n\n    $.each(input.branch, function (branch_index, branch_input) {\n\n        //create html branch element for input collection (middle column)\n        html = input_factory.createInputToolHTML(branch_input);\n        branch_input_collection_html += html;\n\n        //copy input properties from stored branch input\n        branch_properties = JSON.parse(JSON.stringify(branch_input));\n\n        //generate new branch input with attached prototype\n        branch_input = input_factory.createInput(branch_properties.type, branch_properties.ref);\n\n        //set branch input properties to stored properties (only the one saved in the project definition, leave the others intact)\n        for (var property in branch_input) {\n            if (branch_properties.hasOwnProperty(property)) {\n                branch_input[property] = branch_properties[property];\n            }\n        }\n        //set branch input as valid, as by default it is generated as invalid\n        branch_input.dom.is_valid = true;\n\n        //override 'global' branch input obj literal with newly created\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[index].branch[branch_index] = branch_input;\n\n        //if it is a group, loop all the nesyed group inputs (there must be at least a group input)\n        if (branch_input.type === consts.GROUP_TYPE) {\n\n            formbuilder.is_editing_group = true;\n\n            //pass in branch_index as this is a nested group\n            var nested_group_inputs_html = self.getGroupInputsHTML(branch_input, index, branch_index);\n            branch_input_collection_html = branch_input_collection_html.replace('{{group-content}}', nested_group_inputs_html.collection);\n            branch_properties_panel_html += nested_group_inputs_html.panels;\n\n            formbuilder.is_editing_group = false;\n        }\n\n        //per each branch input with possible answers keep track of pagination\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(branch_input.type) > -1) {\n            //we have possible answers\n            formbuilder.possible_answers_pagination[branch_input.ref] = {};\n            formbuilder.possible_answers_pagination[branch_input.ref].page = 1;\n        }\n\n        //get properties panel for branch input\n        properties_panel_html = template.getInputPropertiesPanelHTML(branch_input);\n        branch_properties_panel_html += properties_panel_html;\n\n    });\n\n    branch_sortable_html = branch_sortable_html.replace('{{branch-inputs}}', branch_input_collection_html);\n\n    return {\n        collection: branch_sortable_html,\n        panels: branch_properties_panel_html\n    };\n};\n\nmodule.exports = getBranchInputsHTML;\n","'use strict';\nvar ui = require('helpers/ui');\nvar formbuilder = require('config/formbuilder');\nvar template = require('template');\nvar consts = require('config/consts');\n\nvar getGroupInputsHTML = function (the_input, the_index, the_branch_index) {\n\n    var input_factory = require('factory/input-factory');\n    var input = the_input;\n    var index = the_index;\n    var branch_index = the_branch_index;\n    var group_properties;\n    var html;\n    var group_sortable_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.GROUP_TYPE);\n    var group_input_collection_html = '';\n    var properties_panel_html = '';\n    var group_properties_panel_html = '';\n\n    formbuilder.current_input_ref = input.ref;\n\n    $.each(input.group, function (group_index, group_input) {\n\n        //create html group element for input collection (middle column)\n        html = input_factory.createInputToolHTML(group_input);\n        group_input_collection_html += html;\n\n        //copy input properties from stored group input\n        group_properties = JSON.parse(JSON.stringify(group_input));\n\n        //generate new group input with attached prototype\n        group_input = input_factory.createInput(group_properties.type, group_properties.ref);\n\n        //set group input properties to stored properties (only the one saved in the project definition, leave the others intact)\n        for (var property in group_input) {\n            if (group_properties.hasOwnProperty(property)) {\n                group_input[property] = group_properties[property];\n            }\n        }\n\n        //set group input as valid, as by default it is generated as invalid\n        group_input.dom.is_valid = true;\n\n        //override 'global' group input obj literal with newly created\n        if (branch_index === null) {\n            //this is a first level group\n            formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[index].group[group_index] = group_input;\n        }\n        else {\n            //this is a nested group\n            formbuilder.project_definition.data.project\n                .forms[formbuilder.current_form_index]\n                .inputs[index]\n                .branch[the_branch_index]\n                .group[group_index] = group_input;\n        }\n\n        //per each group input with possible answers keep track of pagination\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(group_input.type) > -1) {\n            //we have possible answers\n            formbuilder.possible_answers_pagination[group_input.ref] = {};\n            formbuilder.possible_answers_pagination[group_input.ref].page = 1;\n        }\n\n        properties_panel_html = template.getInputPropertiesPanelHTML(group_input);\n        group_properties_panel_html += properties_panel_html;\n    });\n\n    group_sortable_html = group_sortable_html.replace('{{group-inputs}}', group_input_collection_html);\n\n    return {\n        collection: group_sortable_html,\n        panels: group_properties_panel_html\n    };\n};\n\nmodule.exports = getGroupInputsHTML;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar form_factory = require('factory/form-factory');\nvar Input = require('factory/input-prototype');\nvar template = require('template');\nvar validation = require('actions/validation');\nvar input_collection_branch_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback');\n\nvar initFormbuilder = function () {\n\n    var self = this;\n    var project;\n    var forms;\n    var state;\n    // var project_definition;\n    var active_branch;\n    var active_branch_input;\n    var active_nested_group;\n\n\n    //drop any reference to input ref, as we start with no input selected\n    formbuilder.current_input_ref = undefined;\n    formbuilder.is_editing_branch = false;\n    formbuilder.is_editing_group = false;\n\n    //re-enable branch input tool in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch').show();\n    //re-enable group input tool in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-group').show();\n\n    if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n        ui.input_tools.hideSearchInput();\n    }\n    else {\n        ui.input_tools.showSearchInput();\n    }\n\n    //disable save project button, as there is no point saving a project with no changes\n    //it will be re-enable as soon the user make a change\n    formbuilder.dom.save_project_btn.off('click');\n\n    //when undoing\n    if (formbuilder.render_action === consts.RENDER_ACTION_UNDO) {\n\n        //get current project definition as we have all the methods attached to inputs (it is the previous state just rendered on screen)\n        //project_definition = formbuilder.project_definition;\n        state = formbuilder.previous_state;\n        project = formbuilder.project_definition.data.project;\n        forms = project.forms.slice();\n\n        //let's set all inputs as disabled to start with\n        formbuilder.current_input_ref = undefined;\n\n        //run validation on each form\n        $(forms).each(function (index, form) {\n\n            //set form dom references (for the validation and dom changes)\n            form_factory.updateFormbuilderDomReferences(form.ref);\n\n            //set formbuilder stet for validation\n            formbuilder.current_form_index = index;\n            formbuilder.current_form_ref = form.ref;\n\n            //todo check this for branches, groups and nested groups\n            $(form.inputs).each(function (index, input) {\n\n                //check if we have an active input after undoing\n                if (input.ref === state.active_input_ref) {\n                    formbuilder.current_input_ref = state.active_input_ref;\n                }\n\n                if (!input.dom.is_valid) {\n                    //run a validation after the dom is created looping all the inputs which are set as false, and set dom accordingly\n                    validation.performValidation(input, false);\n                }\n            });\n\n            if (validation.areFormInputsValid(index)) {\n                //set valid icon on form\n                ui.forms_tabs.showFormValidIcon(index);\n            }\n            else {\n                //set invalid icon on form\n                ui.forms_tabs.showFormInvalidIcon(index);\n            }\n        });\n\n        //set formbuilder interface to previous state\n        formbuilder.current_form_index = state.active_form_index;\n        formbuilder.current_form_ref = state.active_form_ref;\n        form_factory.updateFormbuilderDomReferences(formbuilder.current_form_ref);\n        formbuilder.is_editing_branch = state.was_editing_branch;\n        formbuilder.is_editing_group = state.was_editing_group;\n\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //todo re-enable the nested group that was being edited\n\n\n            console.log(formbuilder);\n\n            active_branch = utils.getInputObjectByRef(state.active_branch_ref);\n            active_nested_group = utils.getNestedGroupObjectByRef(active_branch, state.active_group_ref);\n            active_branch.enterBranchSortable();\n\n            formbuilder.current_input_ref = state.active_branch_ref;//the branch that was active when undoing\n            formbuilder.branch.current_input_ref = state.active_group_ref;//the nested group that was active when undoing\n            formbuilder.group.active_group_ref = state.active_group_ref;//the nested group that was active when undoing\n\n            active_nested_group.enterGroupSortable(true);\n\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //re-enable the branch that was being edited\n                active_branch = utils.getInputObjectByRef(state.active_branch_ref);\n                active_branch.enterBranchSortable();\n\n                //set the active branch input if there was one selected\n                if (state.active_branch_input_ref) {\n                    //trigger a synthetic click on the branch sortable (dom)\n                    //active_branch_input = utils.getBranchInputObjectByRef(state.active_branch_input_ref);\n                    $('.input[data-input-ref=\"' + state.active_branch_input_ref + '\"]').trigger('mousedown');\n                }\n\n                //switch to previously active properties tab\n                formbuilder.dom.input_properties_forms_wrapper\n                    .find('.nav-tabs .nav-tabs__tab-btn-item a[href=\"' + state.active_properties_tab + '\"]').tab('show');\n            }\n\n            if (formbuilder.is_editing_group) {\n                //re-enable the branch that was being edited\n                var active_group = utils.getInputObjectByRef(state.active_group_ref);\n                active_group.enterGroupSortable();\n\n                if (state.active_group_input_ref) {\n                    //trigger a synthetic click on the branch sortable (dom)\n                    //active_branch_input = utils.getBranchInputObjectByRef(state.active_branch_input_ref);\n                    $('.input[data-input-ref=\"' + state.active_group_input_ref + '\"]').trigger('mousedown');\n                }\n\n                //switch to previously active properties tab\n                formbuilder.dom.input_properties_forms_wrapper\n                    .find('.nav-tabs .nav-tabs__tab-btn-item a[href=\"' + state.active_properties_tab + '\"]').tab('show');\n\n            }\n        }\n\n        //if the user was editing main forms, rebind events\n        if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n\n            /* do this as we might have had an active branch when clicking undo ***************/\n            //enable form tab buttons\n            ui.forms_tabs.toggleFormTabsButtons({ enable: true });\n            //set draggable to work with main sortable\n            formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.sortable');\n            /**********************************************************************************/\n\n            form_factory.unbindFormPanelsEvents();\n            form_factory.updateFormbuilderDomReferences(formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].ref);\n            form_factory.bindFormPanelsEvents();\n\n            //switch to previously active form\n            formbuilder.dom.forms_tabs.find('a[data-form-index=' + state.active_form_index + ']').tab('show');\n\n            //activate previous input from dom collection (middle column), if one was active in the previous state\n            if (formbuilder.current_input_ref) {\n                formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + formbuilder.current_input_ref + '\"]').addClass('active');\n\n                //show active input properties panel\n                formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + formbuilder.current_input_ref + '\"]').removeClass('hidden');\n\n                //switch to previously active properties tab\n                formbuilder.dom.input_properties_forms_wrapper\n                    .find('.nav-tabs .nav-tabs__tab-btn-item a[href=\"' + state.active_properties_tab + '\"]').tab('show');\n\n                //hide message no input was selected\n                formbuilder.dom\n                    .input_properties_forms_wrapper\n                    .find('.input-properties__no-input-selected')\n                    .hide();\n            }\n        }\n        self.deferred.resolve();\n    }\n\n    if (formbuilder.render_action === consts.RENDER_ACTION_DO) {\n        //we are rendering an existing project, so switch dom references to top level form which is shown by default\n        formbuilder.current_form_index = 0;\n        formbuilder.current_form_ref = formbuilder.project_definition.data.project.forms[0].ref;\n        //form_factory.unbindFormPanelsEvents();\n        form_factory.updateFormbuilderDomReferences(formbuilder.project_definition.data.project.forms[0].ref);\n\n        //hide add child form button if the form total is MAX_NUMBER_OF_NESTED_CHILD_FORMS\n        if (formbuilder.project_definition.data.project.forms.length === consts.MAX_NUMBER_OF_NESTED_CHILD_FORMS) {\n            formbuilder.dom.forms_tabs.find('.main__tabs_add-form').parent().hide();\n        }\n\n        self.deferred.resolve();\n    }\n};\n\nmodule.exports = initFormbuilder;\n\n\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar Input = require('factory/input-prototype');\nvar form_factory = require('factory/form-factory');\nvar template = require('template');\n\nvar renderChildForms = function (the_child_forms) {\n\n    var child_forms = the_child_forms;\n    var child_form = child_forms.shift();\n    var child_inputs;\n    var self = this;\n\n    formbuilder.current_form_index++;\n\n    //render child form\n    $.when(form_factory.createChildForm(child_form.name, child_form.ref, formbuilder.current_form_index, false)).then(function () {\n\n        //append inputs and their properties panels\n        child_inputs = self.renderInputs(child_form.inputs);\n        //replace object literal inputs with newly generated ones via factory (i.e. using new) so they get the prototype\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs = child_inputs.slice();\n\n        //remove no questions message\n        formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').addClass('hidden');\n\n        //hide properties panel buttons as no input is selected\n        formbuilder.dom.input_properties_buttons.fadeOut();\n\n        //render next child form recursively\n        if (child_forms.length > 0) {\n            self.renderChildForms(child_forms);\n        }\n        else {\n            self.initFormbuilder();\n        }\n    });\n\n};\n\nmodule.exports = renderChildForms;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar template = require('template');\n\nvar renderInputs = function (the_inputs) {\n\n    var self = this;\n    var inputs = the_inputs;\n    var html;\n    var properties;\n    var properties_panel_html;\n    var generated_inputs = [];\n    var input_collection_html = '';\n    var input_properties_panel_html = '';\n\n\n    $.each(inputs, function (index, input) {\n\n        var input_factory = require('factory/input-factory');\n\n        ///**\n        // * Loop all jumps to remove any \"has_valid_destination\" property\n        // * this was caused by a bug so a few projects have it.\n        // * Instead of hacking the db, we sanitise that here\n        // * so the next time they save the project is ok\n        // */\n        //$(input.jumps).each(function(jumpIndex, jump){\n        //    delete jump.has_valid_destination;\n        //});\n\n        //create html element for input collection (middle column)\n        html = input_factory.createInputToolHTML(input);\n        input_collection_html += html;\n\n        //copy input properties from stored input\n        properties = JSON.parse(JSON.stringify(input));\n\n        //generate new input with attached prototype\n        input = input_factory.createInput(properties.type, properties.ref);\n\n        //on load (when loading an existing project)\n        if (formbuilder.render_action === consts.RENDER_ACTION_DO) {\n            console.log('render on load');\n            //set input as valid, as it is generated as invalid by default\n            input.dom.is_valid = true;\n        }\n\n        //set input properties to stored input properties (only the one saved in the project definition, leave the others intact)\n        for (var property in input) {\n            if (properties.hasOwnProperty(property)) {\n                input[property] = properties[property];\n            }\n        }\n\n        //override 'global' input obj literal with newly created\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[index] = input;\n\n        //if it is a branch, loop all the branch inputs (there must be at least a branch input)\n        if (input.type === consts.BRANCH_TYPE) {\n\n            //set edit branch to true when rendering from a saved project,\n            //because we are re-using functions that expects this flag to be true\n            formbuilder.is_editing_branch = true;\n            formbuilder.branch.active_branch_header = input.question;\n            formbuilder.branch.active_branch_ref = input.ref;\n\n            var branch_inputs_html = self.getBranchInputsHTML(input, index);\n            input_collection_html = input_collection_html.replace('{{branch-content}}', branch_inputs_html.collection);\n            input_properties_panel_html += branch_inputs_html.panels;\n\n            //reset edit branch flag\n            formbuilder.is_editing_branch = false;\n            formbuilder.branch.active_branch_ref = null;\n            formbuilder.branch.active_branch_ref = null;\n        }\n\n        //if it is a group, loop all the group inputs (there must be at least a group input)\n        if (input.type === consts.GROUP_TYPE) {\n\n            formbuilder.is_editing_group = true;\n            //todo should I set active group header and active group ref?\n            //todo maybe because I do nit have jumps in groups?\n\n            var group_inputs_html = self.getGroupInputsHTML(input, index, null);\n            input_collection_html = input_collection_html.replace('{{group-content}}', group_inputs_html.collection);\n            input_properties_panel_html += group_inputs_html.panels;\n\n            formbuilder.is_editing_group = false;\n        }\n\n        //per each input with possible answers keep track of pagination\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) > -1) {\n            //we have possible answers\n            formbuilder.possible_answers_pagination[input.ref] = {};\n            formbuilder.possible_answers_pagination[input.ref].page = 1;\n        }\n        //create properties panel for current input\n        properties_panel_html = template.getInputPropertiesPanelHTML(input);\n        input_properties_panel_html += properties_panel_html;\n\n        //hide panels as by default no inputs are selected\n        formbuilder.dom.input_properties.find('.panel-body form').hide();\n\n        //save newly generated input\n        generated_inputs.push(input);\n    });\n\n    formbuilder.dom.inputs_collection_sortable.append(input_collection_html);\n    formbuilder.dom.input_properties_forms_wrapper.append(input_properties_panel_html);\n\n    return generated_inputs;\n};\n\nmodule.exports = renderInputs;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar form_factory = require('factory/form-factory');\nvar Input = require('factory/input-prototype');\nvar template = require('template');\nvar validation = require('actions/validation');\n\nvar renderProject = function (project_definition) {\n\n    var self = this;\n    var forms = project_definition.data.project.forms.slice();//need a deep copy\n    var inputs;\n\n    self.deferred = new $.Deferred();\n\n    //if undoing, reset formbuilder on top parent form\n    if (formbuilder.render_action === consts.RENDER_ACTION_UNDO) {\n        console.log('resetting references to top parent form');\n        form_factory.updateFormbuilderDomReferences(forms[0].ref);\n    }\n\n    //render top parent form by default as the formbuilder loads.\n    formbuilder.current_form_index = 0;\n    inputs = self.renderInputs(forms[0].inputs);\n\n    //remove no questions message (if any inputs)\n    if (inputs.length > 0) {\n        formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').addClass('hidden');\n    }\n\n    //show no title warning (if no title set for the first form and we have inputs)\n    if (utils.getTitleCount(inputs) === 0 && inputs.length > 0) {\n        ui.inputs_collection.toggleTitleWarning(0, false);\n    }\n\n    //toggle form icon to a green chck if the top parent form is valid\n    if (validation.areFormInputsValid(0)) {\n        ui.forms_tabs.showFormValidIcon(0);\n\n        //enable download form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        //enable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n\n    //if no inputs, disable download form button\n    if (inputs.length === 0) {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').addClass('disabled');\n\n        //disable print as pdf\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').addClass('disabled');\n    }\n    else {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        //enable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n\n    //replace object literal inputs with newly generated ones via factory (i.e. using new) so they get the prototype\n    formbuilder.project_definition.data.project.forms[0].inputs = inputs.slice();\n\n    //remove first form as it is already rendered\n    forms.shift();\n\n    //render child forms recursively (if any)\n    if (forms.length > 0) {\n        self.renderChildForms(forms);\n    }\n    else {\n        self.initFormbuilder();\n    }\n\n    return self.deferred.promise();\n};\n\nmodule.exports = renderProject;\n","/* global $, toastr, Papa*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar toast = require('config/toast');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar getPossibleAnswerPage = require('template/methods/getPossibleAnswersPage');\n\nvar possible_answers_pager = {\n\n    init: function (input) {\n\n        var self = this;\n        var pager = formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.possible-answers__list_pager');\n        var page = formbuilder.possible_answers_pagination[input.ref].page;\n        var total = Math.ceil(input.possible_answers.length / consts.LIMITS.possible_answers_per_page);\n\n        pager.removeClass('hidden');\n        pager.find('.possible-answers__list_pager__current')\n            .html(page);\n        pager.find('.possible-answers__list_pager__total')\n            .html(total);\n\n        //attach handlers to pagination buttons\n        var prev_btn = pager.find('.possible-answers__list_pager__prev');\n        var next_btn = pager.find('.possible-answers__list_pager__next');\n\n        //when the pager is shown, set min-height on parent container\n        formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__possible-answers__list')\n            .parent().css('min-height', '325px');\n\n        var was_clicked = false;\n        next_btn.off().on('click', function () {\n\n            console.log('next button clicked');\n            var next_page;\n\n            //validate answers currently in the dom\n            //if any error, warn user instead of changing page\n            //so the user has the chance to fix them\n            if (!self.areValidPossibleAnswersInDOM(input)) {\n                //show error\n                toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n                return false;\n            }\n\n            if (!was_clicked) {\n                was_clicked = true;\n\n                //save possible answers currently on the dom\n                input.savePossibleAnswers();\n\n                if (formbuilder.possible_answers_pagination[input.ref].page < total) {\n                    //show next possible answers page in dom\n                    next_page = formbuilder.possible_answers_pagination[input.ref].page + 1;\n                    formbuilder.possible_answers_pagination[input.ref].page = next_page;\n\n                    getPossibleAnswerPage(input, next_page);\n\n                    //update dom with current page\n                    pager.find('.possible-answers__list_pager__current')\n                        .html(next_page);\n\n                    //restore button functionality\n                    window.setTimeout(function () {\n                        was_clicked = false;\n                    }, consts.ANIMATION_SLOW)\n                }\n                else {\n                    was_clicked = false;\n                }\n            }\n        });\n\n        prev_btn.off().on('click', function () {\n            console.log('prev button clicked');\n            //show next possible answers page in dom\n            var prev_page;\n\n            if (!self.areValidPossibleAnswersInDOM(input)) {\n                //show error\n                toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n                return false;\n            }\n\n            if (!was_clicked) {\n                was_clicked = true;\n\n                //save possible answers currently on the dom\n                input.savePossibleAnswers();\n\n                if (formbuilder.possible_answers_pagination[input.ref].page > 1) {\n                    prev_page = formbuilder.possible_answers_pagination[input.ref].page - 1;\n                    formbuilder.possible_answers_pagination[input.ref].page = prev_page;\n\n                    getPossibleAnswerPage(input, prev_page);\n\n                    //update dom with current page\n                    pager.find('.possible-answers__list_pager__current')\n                        .html(prev_page);\n\n                    //restore button functionality\n                    window.setTimeout(function () {\n                        was_clicked = false\n                    }, consts.ANIMATION_SLOW);\n                }\n            }\n            else {\n                was_clicked = false;\n            }\n        });\n    },\n\n    //hide pager and restore possible answers container height\n    tearDown: function (input) {\n\n        var pager = formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.possible-answers__list_pager');\n\n        //restore height\n        formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__possible-answers__list')\n            .parent().css('min-height', 'auto');\n\n        pager.addClass('hidden');\n\n        formbuilder.possible_answers_pagination[input.ref].page = 1;\n    },\n\n    areValidPossibleAnswersInDOM: function (input) {\n        var are_possible_answers_valid = true;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n        var possible_answers = properties_panel.find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li');\n\n        possible_answers.each(function (index, possible_answer) {\n\n            var current_input = $(possible_answer).find('div input');\n            var answer = current_input.val();\n\n            // //strip html tags (angle brackets)\n            // answer = answer.replace(/[<>]/ig, '');\n\n            //sanitise < and > replacing by unicode\n            answer = answer.replaceAll('>', '\\ufe65');\n            answer = answer.replaceAll('<', '\\ufe64');\n\n            if (answer === '') {\n                are_possible_answers_valid = false;\n                return false;\n            }\n\n        });\n\n        return are_possible_answers_valid;\n    },\n\n    recalculatePagination: function (input) {\n\n        //get current page and total of possibe answers\n        var page = formbuilder.possible_answers_pagination[input.ref].page;\n        var total = Math.ceil(input.possible_answers.length / consts.LIMITS.possible_answers_per_page);\n\n        var pager = formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.possible-answers__list_pager');\n\n        pager.find('.possible-answers__list_pager__current')\n            .html(page);\n        pager.find('.possible-answers__list_pager__total')\n            .html(total);\n\n        //hide pager if not needed\n        if (input.possible_answers.length <= consts.LIMITS.possible_answers_per_page) {\n            pager.addClass('hidden');\n        }\n    },\n\n    recalculatePossibleAnswersDOM: function (input) {\n\n        var self = this;\n        var possible_answers_list = input.dom.properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n        var possible_answers = possible_answers_list.find('li');\n        var lookup_index;\n        var possible_answer_to_append;\n        var list_item;\n        var prev_page;\n        var current_page = formbuilder.possible_answers_pagination[input.ref].page;\n\n        /*add one answer to the bottom to fill the page (if any)\n        here we are checking the possible answers currently on the dom\n        this is the case where the user remove the 100th answer from the dom and we have more answers\n        to show\n        * */\n        if (possible_answers.length === (consts.LIMITS.possible_answers_per_page - 1)) {\n\n            if (input.possible_answers.length > possible_answers.length) {\n\n                //append answer to the bottom of current page\n                list_item = formbuilder.dom.partials.possible_answer_list_item;\n                list_item = list_item.replace('{{answer}}', possible_answer_to_append.answer);\n                list_item = list_item.replace('{{answer-ref}}', possible_answer_to_append.answer_ref);\n\n                list_item = formbuilder.dom.partials.possible_answer_list_item;\n                list_item = list_item.replace('{{answer}}', possible_answer_to_append.answer);\n                list_item = list_item.replace('{{answer-ref}}', possible_answer_to_append.answer_ref);\n\n                //append to dom\n                possible_answers_list.append(list_item);\n\n                //update pagination\n                self.recalculatePagination(input);\n            }\n        }\n\n        /*\n        if the possible answers in the dom is 0, it means the user removed all the answers\n        from the dom, therefore we have to\n        * */\n        if (possible_answers.length === 0) {\n\n            //go to previous page\n            formbuilder.possible_answers_pagination[input.ref].page--;\n            prev_page = formbuilder.possible_answers_pagination[input.ref].page;\n            getPossibleAnswerPage(input, prev_page);\n\n            //update pagination buttons\n            self.recalculatePagination(input);\n        }\n    }\n};\n\nmodule.exports = possible_answers_pager;\n","/* global $, toastr, Papa*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar validation = require('actions/validation');\nvar import_form_validation = require('helpers/import-form-validation');\nvar messages = require('config/messages');\nvar toast = require('config/toast');\nvar confirm_import_callback = require('ui-handlers/event-handler-callbacks/confirm-import-possible-answers-callback');\nvar getPossibleAnswerPage = require('template/methods/getPossibleAnswersPage');\nvar possible_answers_pager = require('actions/possible-answers-pager');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar getPossibleAnswersList = require('template/methods/getPossibleAnswersList');\nvar undo = require('actions/undo');\n\nvar possible_answers = {\n\n    addPossibleAnswer: function (the_input) {\n\n        var input = the_input;\n        var possible_answers_list;\n        var answer_ref;\n        var list_item = formbuilder.dom.partials.possible_answer_list_item;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n        var possible_answers;\n        var areAllPOssibleAnswersValidinDom = true;\n\n        possible_answers_list = properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n        //Validate answers currently in dom\n        possible_answers = possible_answers_list.find('li div input');\n        possible_answers.each(function (index, possible_answer) {\n            if (!validation.isPossibleAnswerValid($(possible_answer).val()).is_valid) {\n                areAllPOssibleAnswersValidinDom = false;\n                return false;\n            }\n        });\n\n        //warn user if there is any error to fix, and exit\n        if (!areAllPOssibleAnswersValidinDom) {\n            toast.showError(messages.error.POSSIBLE_ANSWER_EMPTY);\n            return;\n        }\n\n        //when there is more than 1 possible answers, enable all remove buttons\n        possible_answers_list.find('li div span button').prop('disabled', false);\n\n        //prepare dom for possible answer list item\n        //generate uniqid here and append it to the dom to be used later\n        answer_ref = utils.generateUniqID();\n\n        list_item = list_item.replace('{{answer}}', consts.POSSIBILE_ANSWER_PLACEHOLDER);\n        list_item = list_item.replace('{{answer-ref}}', answer_ref);\n\n        //load html snippet based on input type\n\n        //do we have pagination?\n        if (input.possible_answers.length >= consts.LIMITS.possible_answers_per_page) {\n\n            //ok, so go to last possible answers page\n            //todo check user is not there already\n            var last_page = Math.ceil((input.possible_answers.length + 1) / (consts.LIMITS.possible_answers_per_page));\n\n            //save answers currently in the dom\n            input.savePossibleAnswers();\n\n            //update global flag to keep track of pagination\n            formbuilder.possible_answers_pagination[input.ref].page = last_page;\n            getPossibleAnswerPage(input, last_page);\n\n            //Get updated list\n            possible_answers = properties_panel\n                .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li');\n\n            //Append answer to current list if there is any room,\n            //otherwise create new page\n            if (possible_answers.length > (consts.LIMITS.possible_answers_per_page - 1)) {\n                //go to a brand new page\n                getPossibleAnswerPage(input, (last_page + 1));\n                possible_answers = properties_panel\n                    .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li ');\n            }\n\n            possible_answers_list.append(list_item).fadeIn(consts.ANIMATION_FAST);\n\n            //save the new answer (both dom and input object)\n            input.possible_answers.push({\n                answer: consts.POSSIBILE_ANSWER_PLACEHOLDER,\n                answer_ref: answer_ref\n            });\n            input.savePossibleAnswers();\n\n            //show pager\n            possible_answers_pager.init(input);\n\n            //update pagination\n            possible_answers_pager.recalculatePagination(input);\n        }\n        else {\n            possible_answers_list.append(list_item).fadeIn(consts.ANIMATION_FAST);\n            input.savePossibleAnswers();\n        }\n\n        //if max number of allowed possible answers reached, disable \"Add answer\" button\n        switch (input.type) {\n            case consts.SEARCH_SINGLE_TYPE:\n            case consts.SEARCH_MULTIPLE_TYPE:\n                //up to 1000\n                if\n                    (input.possible_answers.length >= consts.LIMITS.possible_answers_max_search) {\n                    ui.input_properties_panel.toggleAddAnswerBtn(true);\n                }\n                break;\n            case consts.CHECKBOX_TYPE:\n            case consts.RADIO_TYPE:\n            case consts.DROPDOWN_TYPE:\n                //up to 300\n\n                if\n                    (input.possible_answers.length >= consts.LIMITS.possible_answers_max) {\n                    ui.input_properties_panel.toggleAddAnswerBtn(true);\n                }\n                break;\n            default:\n            //do nothing\n        }\n    },\n\n    removePossibleAnswer: function (the_input, the_answer_index_dom) {\n\n        var input = the_input;\n        var answer_index_dom = the_answer_index_dom;\n        var possible_answers_list;\n        var possible_answers;\n        var current_page = formbuilder.possible_answers_pagination[input.ref].page;\n\n        input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n        possible_answers_list = input.dom.properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n        possible_answers = possible_answers_list.find('li');\n\n        /* check if the possible answer has got a jump attached\n         if so, the jump will be dropped so ask the user to confirm action\n         */\n        //todo check if the jump is just dropped\n\n        //do not do anything if there is only 1 possible answer\n        if (input.possible_answers.length === 1) {\n            return;\n        }\n\n        //if 'possible_answers' length is 2, after removing the element disable the one left, so we have at least 1 possible answer\n        possible_answers.eq(answer_index_dom).fadeOut(200, function () {\n\n            //get possible answer index offset based on what page we are showing in the DOM\n            var offset = (current_page - 1) * consts.LIMITS.possible_answers_per_page;\n\n            //remove from dom\n            $(this).remove();\n\n            //remove answer from project definition\n            input.possible_answers.splice(offset + answer_index_dom, 1);\n\n            if (input.possible_answers.length === 1) {\n                possible_answers_list.find('li div span button').prop('disabled', true);\n            }\n\n            //if max number of allowed possible answers reached, disable \"Add answer\" button\n            switch (input.type) {\n                case consts.SEARCH_SINGLE_TYPE:\n                case consts.SEARCH_MULTIPLE_TYPE:\n                    //up to 1000\n                    if\n                        (input.possible_answers.length < consts.LIMITS.possible_answers_max_search) {\n                        ui.input_properties_panel.toggleAddAnswerBtn(false);\n                    }\n                    //update possible answers in dom (when needed)\n                    possible_answers_pager.recalculatePossibleAnswersDOM(input);\n                    break;\n                case consts.CHECKBOX_TYPE:\n                case consts.RADIO_TYPE:\n                case consts.DROPDOWN_TYPE:\n                    //up to 300\n                    if\n                        (input.possible_answers.length < consts.LIMITS.possible_answers_max) {\n                        ui.input_properties_panel.toggleAddAnswerBtn(false);\n                    }\n                    //update possible answers in dom (when needed)\n                    possible_answers_pager.recalculatePossibleAnswersDOM(input);\n\n                    input.updatePossibleInitialAnswers();\n                    break;\n                default:\n                //do nothing\n            }\n\n            //todo check what this does here, when removing an answer?\n            // input.savePossibleAnswers();\n\n        });\n    },\n\n    updateJumpPossibleAnswers: function (the_input, the_jump_panel) {\n\n        var input = the_input;\n        var jump_panel = the_jump_panel;\n        var i;\n        var iLength = input.possible_answers.length;\n\n        //find answer <select>(s)\n        var selects_to_target = jump_panel\n            .find('.input-properties__form__jumps__list .input-properties__form__jumps__list-item .input-properties__form__jumps__logic--answer select');\n\n        selects_to_target.each(function (index) {\n\n            var target = $(this);\n            var selected_option = target.find('option:selected');\n            var current_selected_answer_id = window.parseInt(selected_option.val(), 10);\n\n            //get the updated answer text from \"possible answers\"\n            for (i = 0; i < iLength; i++) {\n                if (current_selected_answer_id === input.possible_answers[i].answer_id) {\n                    selected_option.text(current_selected_answer_id + ' - ' + input.possible_answers[i].answer);\n                }\n\n            }\n            console.log($(this).attr('id'));\n            console.log($(this).find('option:selected').val());\n        });\n    },\n\n    //get selected possible answer and save it in the input object as the default answer\n    updatePossibleInitialAnswers: function (the_input) {\n        var input = the_input;\n        var possible_initial_answers_list;\n        var selected_answer;\n\n        input.dom.advanced_properties_wrapper = formbuilder\n            .dom\n            .input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__advanced-properties');\n\n        possible_initial_answers_list = input.dom.advanced_properties_wrapper.find('div.panel-body div.input-properties__form__advanced-properties__default select');\n\n        selected_answer = possible_initial_answers_list.find('option:selected');\n\n        input.default = selected_answer.val();\n\n    },\n\n    listPossibleInitialAnswers: function (the_input) {\n\n        var input = the_input;\n        var possible_answers;\n        var possible_initial_answers_list;\n        var value;\n        var answer_ref;\n        var selected = '';\n\n        input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n        possible_answers = input.dom\n            .properties_panel\n            .find('.input-properties__form__possible-answers .panel-body ul.input-properties__form__possible-answers__list li');\n\n\n        console.log(possible_answers);\n\n\n        input.dom.advanced_properties_wrapper = formbuilder\n            .dom\n            .input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__advanced-properties');\n\n        possible_initial_answers_list = input.dom.advanced_properties_wrapper.find('div.panel-body div.input-properties__form__advanced-properties__default select');\n\n        //empty list and re-append items todo maybe too expensive, find a better way\n        possible_initial_answers_list.empty();\n\n        //append 'none' selection, using index 0 as nothing has been selected\n        possible_initial_answers_list.append('<option value=\"\">None</option>');\n\n        input.possible_answers.forEach(function (possible_answer) {\n\n            var answer_ref = possible_answer.answer_ref;\n            var answer = possible_answer.answer\n\n            //pre select previously saved option\n            selected = (answer_ref === input.default) ? 'selected' : '';\n\n            possible_initial_answers_list.append('<option value=\"' + answer_ref + '\" ' + selected + ' >' + answer + '</option>');\n        });\n    },\n\n    exportPossibleAnswersCSV: function () {\n\n        var input;\n        var answers = [];\n        var filename;\n\n        input = utils.getActiveInput();\n\n        //abort if no possible answers\n        if (input.possible_answers.length === 0) {\n            return false;\n        }\n\n        //abort if possible answers are invalid\n        if (!import_form_validation.arePossibleAnswersValid(input.possible_answers, input.type)) {\n            return false;\n        }\n\n        //filename gets very long if we use the input ref...so we do not\n        filename = input.question.trunc(20) + '__possible_answers.csv';\n\n        $(input.possible_answers).each(function (index, possible_answer) {\n            answers[index] = [possible_answer.answer];\n        });\n\n        // Specifying fields and data explicitly\n        var csv = Papa.unparse({\n            fields: [input.question],\n            data: answers\n        }, {\n            quotes: false,\n            quoteChar: '',\n            delimiter: ',',\n            header: true,\n            newline: '\\r\\n'\n        });\n\n        return {\n            data: csv,\n            filename: filename\n        };\n    },\n\n    importCSVFile: function (files) {\n\n        var file = files[0];\n        var file_parts;\n        var file_ext;\n        var getPossibleAnswersHTML = require('template/methods/getPossibleAnswersHTML');\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        formbuilder.isOpeningFileBrowser = false;\n\n        //if the user cancels the action\n        if (!file) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.CSV_FILE_INVALID);\n            return;\n        }\n\n        file_parts = file.name.split('.');\n        file_ext = file_parts[file_parts.length - 1];\n\n        //it must be csv\n        if (file_ext !== consts.CSV_FILE_EXTENSION) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.CSV_FILE_INVALID);\n            return;\n        }\n        //file is valid, let's parse it\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n\n            var content = e.target.result;\n            var json = Papa.parse(content, { header: true, delimiter: ',' });\n            var headers = json.meta.fields;\n            var undo = require('actions/undo');//it is here otherwise it breaks when compiling...go figure??\n            var modal = $('#csv-import-possible_answers');\n\n            if (json.data.length === 0) {\n                //empty csv file, show error\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.CSV_FILE_INVALID);\n                return;\n            }\n\n            //todo show modal asking which colums and whether to replace or not the existing possible answers\n            modal.modal();\n\n            modal.off().on('shown.bs.modal', function () {\n\n                var column_picker = $('#csv-import-possible_answers').find('.possible-answers-column-picker');\n                var column_items = '';\n                var selectedHeaderIndex = null;\n                var params;\n                var userWantstoReplaceAnswers;\n                var doesFirstRowContainsHeaders;\n                var possible_answers_max = consts.LIMITS.possible_answers_max;\n                var input = utils.getActiveInput();\n\n                if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n                    possible_answers_max = consts.LIMITS.possible_answers_max_search;\n                }\n\n                //reset column picker\n                column_picker.find('.btn').html('Pick column' + ' <span class=\"caret\"></span>');\n                column_picker.find('.btn').val('');\n\n                //reset other controls\n                modal.find('.possible_answers__first-row-headers input').prop('checked', true);\n\n                modal.find('.possible_answers__append-or-replace input#replace').prop('checked', true);\n\n                //disable import button\n                modal.find('.possible_answers-perform-import').attr('disabled', true);\n\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n\n                //show list of headers so the user can select which column to use\n                //generate list items\n                $(headers).each(function (headerIndex, header) {\n                    column_items += '<li>';\n                    column_items += '<a href=\"#\">' + header.trunc(25) + '</a>';\n                    column_items += '</li>';\n                });\n\n                //append items\n                column_picker.find('.dropdown-menu').empty().append(column_items);\n\n                //show selected colun in dropdown picker\n                column_picker.find('.dropdown-menu li').off().on('click', function () {\n                    $(this).parents('.possible-answers-column-picker').find('.btn').html($(this).text() + ' <span class=\"caret\"></span>');\n                    $(this).parents('.possible-answers-column-picker').find('.btn').val($(this).data('value'));\n\n                    selectedHeaderIndex = $(this).index();\n\n                    //enable import button\n                    modal.find('.possible_answers-perform-import').attr('disabled', false);\n                });\n\n\n                $('.possible_answers-perform-import').off().on('click', function () {\n\n                    //show overlay and cursor\n                    formbuilder.dom.overlay.fadeIn(0);\n\n                    //get parameters from modal\n                    userWantstoReplaceAnswers = modal.find('.possible_answers__append-or-replace').find('#replace').is(':checked');\n                    doesFirstRowContainsHeaders = modal.find('.possible_answers__first-row-headers').find('.checkbox input').is(':checked');\n\n                    //add callback to handle the import\n                    params = {\n                        userWantstoReplaceAnswers: userWantstoReplaceAnswers,\n                        doesFirstRowContainsHeaders: doesFirstRowContainsHeaders,\n                        input: input,\n                        importedJson: json,\n                        selectedHeaderIndex: selectedHeaderIndex\n                    };\n\n                    if (confirm_import_callback(params)) {\n\n                        modal.modal('hide');\n\n                        //if max number of allowed possible answers reached, disable \"Add answer\" button\n                        ui.input_properties_panel\n                            .toggleAddAnswerBtn(input.possible_answers.length >= possible_answers_max);\n\n                        //recalculate pagination\n                        possible_answers_pager.recalculatePagination(input);\n\n                        //enable save project button if all inputs are valid\n                        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n                            //enable save project button (if disabled)\n                            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                            formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n                        }\n\n                        //hide overlay\n                        window.setTimeout(function () {\n                            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n\n                            //show toast confirm\n                            toast.showSuccess(messages.success.POSSIBLE_ANSWERS_IMPORTED);\n\n                            //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n                            undo.pushState(false);\n\n                        }, consts.ANIMATION_SUPER_SLOW);\n                    }\n                    else {\n                        window.setTimeout(function () {\n                            //hide overlay\n                            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                            //show error/warning\n                            toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n                        }, consts.ANIMATION_SUPER_SLOW);\n                    }\n                });\n            });\n\n            //add events to hide the modal manually (was nt working, go figure)\n            modal.find('button[data-dismiss=\"modal\"]').one('click', function () {\n                modal.modal('hide');\n            });\n        };\n\n        reader.readAsText(file);\n    },\n\n    orderPossibleAnswers: function (order_type) {\n        //get current input object\n        var input = utils.getActiveInput();\n        var possible_answers = input.possible_answers;\n\n        formbuilder.possible_answers_pagination[input.ref].page = 1;\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        switch (order_type) {\n            //order A - Z for UTF-8 languages\n            case consts.POSSIBLE_ANSWERS_ORDER.AZ:\n                possible_answers = possible_answers.sort(function (a, b) {\n                    return a.answer.localeCompare(b.answer, undefined, {\n                        ignorePunctuation: true,\n                        numeric: true\n                    });\n                });\n                break;\n            //order Z - A for UTF-8 languages\n            case consts.POSSIBLE_ANSWERS_ORDER.ZA:\n                possible_answers = possible_answers.sort(function (a, b) {\n                    return b.answer.localeCompare(a.answer, undefined, {\n                        ignorePunctuation: true,\n                        numeric: true\n                    });\n                });\n                break;\n            case consts.POSSIBLE_ANSWERS_ORDER.SHUFFLE:\n                possible_answers = utils.shuffleArray(possible_answers);\n                break;\n        }\n\n        var ordered_list_html = getPossibleAnswersList(possible_answers);\n        var possible_answers_list;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n        possible_answers_list = properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n        //remove current answers from dom and append ordered ones\n        possible_answers_list\n            .empty()\n            .hide()\n            .append(ordered_list_html)\n            .fadeIn(consts.ANIMATION_FAST);\n\n        //recalculate pagination\n        possible_answers_pager.recalculatePagination(input);\n\n        //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n        undo.pushState(false);\n\n        //enable save project button as user made a change\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n        //hide overlay\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        }, consts.ANIMATION_SUPER_SLOW);\n\n    },\n\n    deleteAllAnswers: function () {\n\n        var input;\n        var answer_ref = utils.generateUniqID();\n        var undo = require('actions/undo');//it is here otherwise it breaks when compiling...go figure??\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        //get current input object\n        input = utils.getActiveInput();\n\n        var possible_answers_list;\n        var list_item = formbuilder.dom.partials.possible_answer_list_item;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n        possible_answers_list = properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n        list_item = list_item.replace('{{answer}}', consts.POSSIBILE_ANSWER_PLACEHOLDER);\n        list_item = list_item.replace('{{answer-ref}}', answer_ref);\n        list_item = list_item.replace('{{disabled}}', consts.DISABLED_STATE);\n\n\n        //load html snippet based on input type\n        possible_answers_list.empty().hide().append(list_item).fadeIn(consts.ANIMATION_FAST);\n\n        //reset array of possible answers to 1 single default element\n        input.possible_answers = [{\n            answer_ref: utils.generateUniqID(),\n            answer: consts.POSSIBILE_ANSWER_PLACEHOLDER\n        }];\n\n        //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n        undo.pushState(false);\n\n        //enable save project button (if disabled)\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n        //enable add answer button\n        ui.input_properties_panel.toggleAddAnswerBtn(false);\n\n        //reset pagination\n        possible_answers_pager.tearDown(input);\n\n        //hide overlay\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        }, consts.ANIMATION_SUPER_SLOW);\n    }\n};\n\nmodule.exports = possible_answers;\n","/* global $*/\n'use strict';\nvar saveAllInputProperties = require('actions/save/module.saveAllInputProperties');\nvar saveProperties = require('actions/save/module.saveProperties');\nvar savePossibleAnswers = require('actions/save/module.savePossibleAnswers');\nvar saveAdvancedProperties = require('actions/save/module.saveAdvancedProperties');\nvar saveJumps = require('actions/save/module.saveJumps');\nvar saveUniqueness = require('actions/save/module.saveUniqueness');\nvar doCleaningBeforeSaving = require('actions/save/module.doCleaningBeforeSaving');\n\nvar save = {\n\n    saveUniqueness: function (the_input) {\n        return saveUniqueness(the_input);\n    },\n    saveAllInputProperties: function (the_input) {\n        return saveAllInputProperties(the_input);\n    },\n    saveProperties: function (the_input) {\n        return saveProperties(the_input);\n    },\n    savePossibleAnswers: function (the_input) {\n        return savePossibleAnswers(the_input);\n    },\n    saveAdvancedProperties: function (the_input) {\n        return saveAdvancedProperties(the_input);\n    },\n    saveJumps: function (the_input) {\n        return saveJumps(the_input);\n    },\n    doCleaningBeforeSaving: function (the_forms) {\n        return doCleaningBeforeSaving(the_forms);\n    }\n};\n\nmodule.exports = save;\n","/* global $*/\n'use strict';\nvar utils = require('helpers/utils');\n\n\nvar doCleaningBeforeSaving = function (forms) {\n\n    var invalid_jumps_question = '';\n    var all_jumps_valid = true;\n\n    $(forms).each(function (index, form) {\n        $(form.inputs).each(function (inputIndex, input) {\n\n            //remove Word Unicode chars from question (if any)\n            form.inputs[inputIndex].question = utils.replaceWordChars(input.question);\n\n            //get valid jump destinations\n            var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, form.inputs, false);\n\n            //extra validation for jumps, check if the destination still exists and it is valid\n            $(input.jumps).each(function (jumpIndex, jump) {\n                //does the jump \"to\" property reference a valid destination input?\n                ////test: screw up the jump.to\n                // jump.to = 'sfdgg';\n\n                if (!jump_destinations[jump.to]) {\n                    //invalid destination found\n                    invalid_jumps_question = input.question;\n                    all_jumps_valid = false;\n                }\n\n                //remove any leftover extra property from jump (if any)\n                //hack to avoid huge refactoring and testing ;)\n                input.jumps[jumpIndex] = {\n                    to: jump.to,\n                    when: jump.when,\n                    answer_ref: jump.answer_ref\n                };\n            });\n\n            $(input.branch).each(function (branchInputIndex, branch_input) {\n                delete branch_input.dom;\n\n                //remove Word Unicode chars from question (if any)\n                input.branch[branchInputIndex].question = utils.replaceWordChars(branch_input.question);\n\n                //todo validate branch jumps\n                jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n                //extra validation for jumps, check if the destination still exists and it is valid\n                $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                    //does the jump \"to\" property reference a valid destination input?\n                    ////test: screw up the jump.to\n                    // branchJump.to = 'sfdgg';\n\n                    if (!jump_destinations[branchJump.to]) {\n                        //invalid destination found\n                        invalid_jumps_question = ' (branch) ' + branch_input.question;\n                        all_jumps_valid = false;\n                    }\n\n                    //remove any leftover extra property from jump (if any)\n                    //hack to avoid huge refactoring and testing ;)\n                    branch_input.jumps[branchJumpIndex] = {\n                        to: branchJump.to,\n                        when: branchJump.when,\n                        answer_ref: branchJump.answer_ref\n                    };\n                });\n\n                $(branch_input.group).each(function (index, group_input) {\n\n                    //remove Word Unicode chars from question (if any)\n                    branch_input.group[index].question = utils.replaceWordChars(group_input.question);\n\n                    delete group_input.dom;\n                });\n            });\n            $(input.group).each(function (index, group_input) {\n\n                //remove Word Unicode chars from question (if any)\n                input.group[index].question = utils.replaceWordChars(group_input.question);\n\n                delete group_input.dom;\n            });\n            console.log(' delete input.dom; called *******');\n            delete input.dom;\n        });\n    });\n\n    return {\n        invalid_jumps_question: invalid_jumps_question,\n        all_jumps_valid: all_jumps_valid\n    };\n};\n\nmodule.exports = doCleaningBeforeSaving;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\n\nvar saveAdvancedProperties = function (input) {\n\n    var save = require('actions/save');\n    var initial_answer_validation;\n\n    input.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //clear all advanced properties errors from dom\n    input.hideAdvancedPropertiesErrors();\n\n\n    //set properties but skip if it is a readme\n    if (input.type !== consts.README_TYPE) {\n        //set default\n        input.default = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val();\n        input.default = input.default === '' ? null : input.default;\n\n        //strip html tags and reset input to sanitised value\n        if (input.default) {\n            input.default = input.default.replace(/(<([^>]+)>)/ig, '');\n            input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(input.default);\n        }\n\n        //set regex\n        input.regex = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val();\n        input.regex = input.regex === '' ? null : input.regex;\n\n        //strip html tags and reset input to sanitised value\n        if (input.regex) {\n            input.regex = input.regex.replace(/(<([^>]+)>)/ig, '');\n            input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(input.regex);\n        }\n\n        //set verification flag\n        input.verify = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').is(':checked');\n\n        /* get uniqueness flag */\n        save.saveUniqueness(input);\n\n    }\n\n    /****************************************************/\n\n    //validate initial answer\n    initial_answer_validation = input.isInitialAnswerValid();\n    if (!initial_answer_validation.is_valid) {\n        input.dom.is_valid = false;\n        //highlight wrong input\n        input.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, initial_answer_validation.error.message);\n    }\n};\n\nmodule.exports = saveAdvancedProperties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\n\nvar saveAllInputProperties = function (the_input) {\n\n    var input = the_input;\n    var ui = require('helpers/ui');\n    var utils = require('helpers/utils');\n    var validation = require('actions/validation');\n    var active_branch;\n    var active_group;\n    var branch_inputs_validation;\n    var group_inputs_validation;\n    var nested_group_owner_branch_validation;\n\n    //save basic properties\n    input.saveProperties();\n\n    //if the selected input is a multiple choice input, save possible answers\n    if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n        //todo we are testing performance\n        input.savePossibleAnswers();\n    }\n    //save advanced properties (not for media or branch or group types)\n    if (consts.MEDIA_ANSWER_TYPES.indexOf(input.type) === -1 && input.type !== consts.BRANCH_TYPE && input.type !== consts.GROUP_TYPE) {\n        input.saveAdvancedProperties();\n    }\n\n    //save jumps\n    // if (input.type !== consts.GROUP_TYPE) {\n    if (input.jumps.length > 0) {\n        input.saveJumps();\n    }\n\n    //save branch inputs if the branch input owner is valid (header is not empty)\n    if (input.type === consts.BRANCH_TYPE && input.dom.is_valid) {\n\n        //set header preview\n        ui.inputs_collection.showInputQuestionPreview(input.ref, input.question.trunc(50));\n\n        //branch inputs are already attached to the branch property, just validate them\n        //todo check this as I should do something if there is a valid/invalid one?\n        input.validateBranchInputs();\n    }\n\n    //save branch inputs if the branch input owner is valid (header is not empty)\n    if (input.type === consts.GROUP_TYPE && input.dom.is_valid) {\n\n        //set header preview\n        ui.inputs_collection.showInputQuestionPreview(input.ref, input.question.trunc(50));\n\n        //branch inputs are already attached to the branch property, just validate them\n        input.validateGroupInputs();\n    }\n\n    //if we are editing a nested group\n    if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n        // if we are editing a nested group, and all the nested group inputs are valid,\n        // set the nested group input owner as valid and toggle valid icon for the owner group input\n        active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n        active_group = utils.getNestedGroupObjectByRef(active_branch, formbuilder.group.active_group_ref);\n        group_inputs_validation = validation.validateGroupInputs(active_group);\n\n        if (group_inputs_validation.is_valid) {\n            active_group.dom.is_valid = true;\n            ui.inputs_collection.showInputValidIcon(active_group.ref);\n\n            //if the nested group is valid, is the owner branch valid then?\n            nested_group_owner_branch_validation = active_branch.validateBranchInputs();\n\n            //todo do i need to do something here  based on the above result?\n\n        }\n        else {\n            ui.inputs_collection.showInputInvalidIcon(active_group.ref);\n            active_group.dom.is_valid = false;\n        }\n    }\n    else {\n\n\n        // if we are editing a branch, and all the active branch inputs are valid,\n        // set the branch input owner as valid and toggle valid icon for the owner branch input\n        if (formbuilder.is_editing_branch) {\n\n            //get current active branch and validate\n            active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            branch_inputs_validation = validation.validateBranchInputs(active_branch);\n\n            if (branch_inputs_validation.is_valid) {\n\n                ui.inputs_collection.showInputValidIcon(active_branch.ref);\n                active_branch.dom.is_valid = true;\n            }\n            else {\n                ui.inputs_collection.showInputInvalidIcon(active_branch.ref);\n                active_branch.dom.is_valid = false;\n            }\n        }\n\n        // if we are editing a group, and all the active group inputs are valid,\n        // set the group input owner as valid and toggle valid icon for the owner branch input\n        if (formbuilder.is_editing_group) {\n\n            //get current active group and validate\n            active_group = utils.getInputObjectByRef(formbuilder.group.active_group_ref);\n            group_inputs_validation = validation.validateGroupInputs(active_group);\n\n            if (group_inputs_validation.is_valid) {\n\n                active_group.dom.is_valid = true;\n                ui.inputs_collection.showInputValidIcon(active_group.ref);\n            }\n            else {\n                ui.inputs_collection.showInputInvalidIcon(active_group.ref);\n                active_group.dom.is_valid = false;\n            }\n        }\n    }\n};\n\nmodule.exports = saveAllInputProperties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar saveJumps = function (input) {\n\n    var ui = require('helpers/ui');\n    var undo = require('actions/undo');\n    var jumps_list_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]')\n        .find('.input-properties__form__jumps .input-properties__form__jumps__list');\n\n    var jumps = jumps_list_wrapper.find('li');\n    var jump_properties = {\n        are_valid: null,\n        when: null,\n        to: null,\n        answer_ref: null,\n        type: null\n    };\n\n    input.hideJumpsErrors(jumps);\n\n    //reset all jumps\n    input.jumps = [];\n    jumps.each(function (i) {\n            jump_properties.has_valid_destination = true;\n            jump_properties.type = input.type;\n\n            //get jump properties\n            jump_properties.when = $(this).find('.input-properties__form__jumps__logic--when select option:selected').val();\n            jump_properties.to = $(this).find('.input-properties__form__jumps__logic--goto select option:selected').val();\n            jump_properties.answer_ref = $(this).find('.input-properties__form__jumps__logic--answer select option:selected').val();\n\n            //validate jump properties\n            jump_properties.are_valid = input.isJumpValid(jump_properties);\n\n            if (!jump_properties.are_valid) {\n\n                //show errors\n                input.showSingleJumpErrors($(this), jump_properties);\n\n                //set input as invalid\n                input.dom.is_valid = false;\n            }\n\n            //save jump anyway, as it is flag as invalid and it will keep the project invalid until it is either removed or set properly\n            input.jumps[i] = {\n                to: jump_properties.to,\n                //this will be always 'ALL' for this type of input\n                when: jump_properties.when,\n                //this will be null for single answer options. val() is set to answer_ref of possible answer otherwise\n                answer_ref: jump_properties.answer_ref || null\n            };\n        }\n    );\n    undo.pushState();\n};\n\nmodule.exports = saveJumps;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\n\nvar savePossibleAnswers;\nsavePossibleAnswers = function (the_input) {\n\n    var input = the_input;\n    var answer;\n    var answer_ref;\n    var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n    var possible_answers = properties_panel.find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li');\n    var is_possible_aswer_valid;\n    var answer_refs = [];\n\n    var current_page = formbuilder.possible_answers_pagination[input.ref].page;\n    var from_index = (current_page - 1) * consts.LIMITS.possible_answers_per_page;\n\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    //reset validation dom feedback (hide all errors from dom)\n    input.hidePossibleAnswersErrors(possible_answers);\n\n    /*\n     Possible answers are grabbed from the dom, so we just update the text with whatever is set\n     */\n    possible_answers.each(function (index, possible_answer) {\n\n        var current_input = $(possible_answer).find('div input');\n\n        answer = current_input.val();\n\n        //strip html tags (angle brackets)\n        //answer = answer.replace(/[<>]/ig, '');\n\n        //sanitise < and > replacing by unicode\n        answer = answer.replaceAll('>', '\\ufe65');\n        answer = answer.replaceAll('<', '\\ufe64');\n\n        //reflect changes in dom\n        current_input.attr('value', answer);\n        current_input.val(answer);\n\n        answer_ref = current_input.attr('data-answer-ref');\n        if (!answer_refs.includes(answer_ref)) {\n            answer_refs.push(answer_ref);\n        } else {\n            //duplicated answer_ref, show error\n            input.dom.is_valid = false;\n            //highlight wrong answer and show error message\n            input.showPossibleAnswerErrors($(possible_answer), messages.error.POSSIBLE_ANSWER_DUPLICATED_IDENTIFIER);\n            return false;\n        }\n\n        //add element to the correct position in the array\n        //based on pagination\n        input.possible_answers[from_index + index] = {\n            answer: answer,\n            answer_ref: answer_ref\n        };\n\n        is_possible_aswer_valid = input.isPossibleAnswerValid(answer);\n\n        //validate each possible answer and show embedded errors if any\n        if (!is_possible_aswer_valid.is_valid) {\n            // warn user question text is wrong\n            input.dom.is_valid = false;\n\n            //highlight wrong answer and show error message\n            input.showPossibleAnswerErrors($(possible_answer), is_possible_aswer_valid.error.message);\n        }\n    });\n};\n\nmodule.exports = savePossibleAnswers;\n\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar saveProperties = function (the_input) {\n\n    var question_text_validation;\n    var input = the_input;\n\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n    input.dom.is_valid = true;\n\n    //reset validation dom feedback (hide all errors from dom)\n    input.hidePropertiesErrors();\n\n    //set question text (readme is the only one with a textarea in the markup)\n    if (input.type === consts.README_TYPE) {\n\n        input.question = input.dom.properties_panel.find('div.input-properties__form__question textarea').val().trim();\n\n        //remove double white spaces, tabs and new lines and &nbsp;\n        input.question = input.question.replace(/\\s\\s+/g, ' ').replace(/&nbsp;/g, '');\n\n        //convert html tags to html entities\n        input.question = utils.encodeHtml(input.question)\n    }\n    else {\n        input.question = input.dom.properties_panel.find('div.input-properties__form__question input').val();\n\n        //sanitise < and > replacing by unicode\n        input.question = input.question.replaceAll('>', '\\ufe65');\n        input.question = input.question.replaceAll('<', '\\ufe64');\n        input.dom.properties_panel.find('div.input-properties__form__question input').val(input.question);\n\n        //set required flag\n        input.is_required = input.dom.properties_panel.find('div.input-properties__form__required-flag input').is(':checked');\n\n        //set title flag\n        input.is_title = input.dom.properties_panel.find('div.input-properties__form__title-flag input').is(':checked');\n    }\n\n    //validate question text\n    question_text_validation = input.isQuestionTextValid();\n\n    if (!question_text_validation.is_valid) {\n        // warn user question text is wrong\n        input.dom.is_valid = false;\n        input.dom.error = question_text_validation.error.message;\n\n        //highlight wrong input and show error message\n        input.showPropertiesErrors(question_text_validation.error.message);\n\n    }\n};\n\nmodule.exports = saveProperties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar saveUniqueness = function (input) {\n\n    /* get uniqueness flag */\n    var uniqueness = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input:checked');\n    //top parent form\n    if (formbuilder.current_form_index === 0) {\n        //this is the top level form, get single checkbox state\n        input.uniqueness = (uniqueness.length > 0) ? consts.UNIQUESS_FORM : consts.UNIQUESS_NONE;\n    }\n    else {\n        //do we have some checkboxes selected?\n        if (uniqueness.length > 0) {\n            //child form can have either hierarchy or form uniqueness\n            input.uniqueness = uniqueness.hasClass('uniqueness-hierarchy') ? consts.UNIQUESS_HIERARCHY : consts.UNIQUESS_FORM;\n        }\n        else {\n            input.uniqueness = consts.UNIQUESS_NONE;\n        }\n    }\n\n};\n\nmodule.exports = saveUniqueness;\n","/* global Flatted*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar parse = require('actions/parse');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar form_factory = require('factory/form-factory');\nvar utils = require('helpers/utils');\nvar push_state_timeout;\n\nvar undo = {\n\n    execute: function () {\n\n        //set render action flag so we know we do not have to push a state when we undo (since we are re-using the same functions)\n        formbuilder.render_action = consts.RENDER_ACTION_UNDO;\n\n        //show overlay and cursor, on complete execute undo\n        formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST, function () {\n\n            //if there is only 1 element in state, that is the starting state and it cannot be undone\n            if (formbuilder.state.length > 1) {\n                formbuilder.state.pop();\n            }\n\n            formbuilder.previous_state = window.CircularJSON.parse(window.CircularJSON.stringify(formbuilder.state[formbuilder.state.length - 1]));\n\n            //remove all child tab-panel\n            formbuilder.dom.forms_tabs_content.find('.main__tabs-content-tabpanel').not(':first').remove();\n\n            //remove all inputs from top level form\n            formbuilder.dom.forms_tabs_content.find('.inputs-collection .sortable .input').remove();\n\n            //remove all properties panels for top level form\n            formbuilder.dom.forms_tabs_content.find('.main__tabs-content-tabpanel .input-properties .input-properties__form').remove();\n\n            //remove forms tabs buttons (not the first one)\n            formbuilder.dom.forms_tabs.find('.main__tabs__form-btn').not(':first').remove();\n\n            //render previous state\n            formbuilder.project_definition = formbuilder.previous_state.project_definition;//todo test for side effect of this assignment\n\n            $.when(parse.renderProject(formbuilder.project_definition)).then(function () {\n\n                //always switch tabs to form of index 0\n                //todo\n\n                //hide overlay with a bit of delay\n                window.setTimeout(function () {\n                    formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST, function () {\n                    });\n                }, consts.ANIMATION_SLOW);\n\n                //disable undo button if we do not have any more state\n                if (formbuilder.state.length === 1) {\n                    ui.navbar.toggleUndoBtn(consts.BTN_DISABLED);\n                }\n\n                //reset state to register new  user actions\n                formbuilder.render_action = consts.RENDER_ACTION_DO;\n\n                //clear possible answers sortable enabled array!\n                //to bind the sortable events again\n                //it might bind it twice for some elements, but the undo action is not common\n                //so it is acceptable in terms of memory usage\n                formbuilder.possible_answers.enabled_sortable = [];\n            });\n        });\n    },\n\n    pushState: function (with_throttle) {\n\n        var state = {};\n\n        //push a state only when we are NOT undoing ;)\n        if (formbuilder.render_action === consts.RENDER_ACTION_UNDO) {\n            return;\n        }\n\n        function _doPushState() {\n            //console.log('called pushState');\n            //push state\n            if (formbuilder.state.length >= consts.LIMITS.max_states) {\n                formbuilder.state.shift();\n            }\n\n            state.project_definition = Flatted.parse(Flatted.stringify(formbuilder.project_definition));\n            // state.project_definition = formbuilder.project_definition;\n            state.active_input_ref = formbuilder.current_input_ref;\n            state.active_form_index = formbuilder.current_form_index;\n            state.active_form_ref = formbuilder.current_form_ref;\n\n            state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + state.active_input_ref + '\"]')\n                .find('.nav-tabs .active a').attr('href');\n\n            if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n                //todo save reference to the nested group that was being edited\n\n                //save the branch that was being edited\n                state.active_branch_ref = formbuilder.branch.active_branch_ref;\n\n                //save the group that was being edited\n                state.active_group_ref = formbuilder.group.active_group_ref;\n\n                //override input ref reference to get the nested group input that was being edited\n                state.active_input_ref = formbuilder.group.current_input_ref;\n                state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                    .find('form[data-input-ref=\"' + state.active_input_ref + '\"]')\n                    .find('.nav-tabs .active a').attr('href');\n            }\n            else {\n                if (formbuilder.is_editing_branch) {\n                    //save the branch that was being edited\n                    state.active_branch_ref = formbuilder.branch.active_branch_ref;\n\n                    //save the active branch input (if any)\n                    if (formbuilder.branch.current_input_ref) {\n                        state.active_branch_input_ref = formbuilder.branch.current_input_ref;\n                    }\n\n                    //save branch input active tab if any\n                    state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                        .find('form[data-input-ref=\"' + state.active_branch_input_ref + '\"]')\n                        .find('.nav-tabs .active a').attr('href');\n                }\n\n                if (formbuilder.is_editing_group) {\n                    //save the group that was being edited\n                    state.active_group_ref = formbuilder.group.active_group_ref;\n\n                    //save the active branch input (if any)\n                    if (formbuilder.group.current_input_ref) {\n                        state.active_group_input_ref = formbuilder.group.current_input_ref;\n                    }\n\n                    //save branch input active tab if any\n                    state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                        .find('form[data-input-ref=\"' + state.active_group_input_ref + '\"]')\n                        .find('.nav-tabs .active a').attr('href');\n                }\n            }\n\n            state.was_editing_branch = formbuilder.is_editing_branch;\n            state.was_editing_group = formbuilder.is_editing_group;\n\n            formbuilder.state.push(state);\n\n            console.log('current formbuilder state');\n            console.log(formbuilder.state);\n        }\n\n        //enable undo button the first tije a state is pushed\n        if (formbuilder.state.length === 1) {\n            ui.navbar.toggleUndoBtn(consts.BTN_ENABLED);\n        }\n\n        if (with_throttle) {\n            // Throttle requests\n            clearTimeout(push_state_timeout);\n            push_state_timeout = window.setTimeout(_doPushState, 500);\n        }\n        else {\n            _doPushState();\n        }\n    }\n};\n\nmodule.exports = undo;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar utils = require('helpers/utils');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar import_form_validation = require('helpers/import-form-validation');\nvar toast = require('config/toast');\n\nvar validation = {\n\n    isFormNameValid: function (the_name, is_adding_new_form) {\n\n        var forms = formbuilder.project_definition.data.project.forms;\n        var str = the_name.trim();\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.QUESTION_PROPERTY\n            }\n        };\n        //reject an empty string\n        if (str === '') {\n            validate.is_valid = false;\n            validate.error.message = messages.error.FORM_NAME_EMPTY;\n        }\n        else {\n            //reject if not alphanumeric\n            if (!consts.FORM_NAME_REGEX.test(str)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.FORM_NAME_INVALID;\n            }\n            else {\n\n                if (is_adding_new_form) {\n                    //check if the form name already exists (case insensitive)\n                    $(forms).each(function (index, form) {\n                        if (form.name.toLowerCase() === str.toLowerCase()) {\n                            validate.is_valid = false;\n                            validate.error.message = messages.error.FORM_NAME_EXIST;\n                        }\n                    });\n                }\n            }\n        }\n\n        return validate;\n    },\n\n    //check for empty string and the presence of either '|' or '_skipp3d_' which are reserved words/chars\n    isQuestionTextValid: function (input) {\n\n        var question = input.question;\n        var str = question.trim();\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.QUESTION_PROPERTY\n            }\n        };\n        if (str === '') {\n            validate.is_valid = false;\n            validate.error.message = messages.error.QUESTION_TEXT_EMPTY;\n        }\n        //readme text too long?\n        if (input.type === consts.README_TYPE) {\n            //convert any html entities to tags\n            str = utils.decodeHtml(str);\n            //strip tags\n            str = str.replace(/(<([^>]+)>)/ig, '');\n            //check REAL length\n            if (str.trim().length > consts.LIMITS.readme_length) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.QUESTION_LENGTH_LIMIT_EXCEEDED;\n            }\n        }\n\n        //other questions text too long\n        if (input.type !== consts.README_TYPE && str.length > consts.LIMITS.question_length) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.QUESTION_LENGTH_LIMIT_EXCEEDED;\n        }\n\n        return validate;\n    },\n\n    isPossibleAnswerValid: function (the_possible_answer) {\n\n        var str = the_possible_answer.trim();\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.QUESTION_PROPERTY\n            }\n        };\n\n        if (str === '') {\n            validate.is_valid = false;\n            validate.error.message = messages.error.POSSIBLE_ANSWER_EMPTY;\n        }\n        return validate;\n    },\n\n    //check if this is valid against the input type or the regex\n    isInitialAnswerValid: function (the_type, the_default, the_regex) {\n\n        var str = the_default || '';\n        var regex = the_regex;\n        var type = the_type;\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.DEFAULT_PROPERTY\n            }\n        };\n\n        str = str.trim();\n\n        //does the initial answer pass the regex?\n        if (regex && str) {\n            if (!str.match(regex)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.INITIAL_ANSWER_NOT_MATCHING_REGEX;\n            }\n        }\n\n        if (type === consts.PHONE_TYPE) {\n            //is the initial answer a valid phone number format?\n            //todo this is hairy, too many options\n            //validate.is_valid = false;\n            //validate.error.message = messages.error.INITIAL_ANSWER_NOT_PHONE_NUMBER;\n        }\n\n\n        return validate;\n    },\n    //convert value to a float and check if it is an integer\n    isValueInt: function (n) {\n        n = parseFloat(n);\n        return Number(n) === n && n % 1 === 0;\n    },\n    //convert value to a float and check if it is a decimal or\n    isValueFloat: function (n) {\n        n = parseFloat(n);\n        return n === Number(n) && n % 1 !== 0;\n    },\n\n    //is this right? todo double check this and maybe refactor integer/decimal validation in integer.js\n    isMinMaxValueValid: function (type, value) {\n\n        var minmax_value = value;\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.MAX_VALUE_PROPERTY\n            }\n        };\n\n        if (type === consts.INTEGER_TYPE && minmax_value !== '') {\n            //min must be an integer, not a float\n            if (!this.isValueInt(minmax_value)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.VALUE_MUST_BE_INTEGER;\n            }\n        }\n        return validate;\n    },\n\n    isJumpValid: function (the_jump, the_input) {\n\n        var jump = the_jump;\n        var input = the_input;\n        var is_valid = true;\n        var inputs;\n        var jump_destinations;\n\n        //if editing a branch, get jumps destinations within the active branch\n        if (formbuilder.is_editing_branch) {\n            inputs = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref).branch;\n        }\n        else {\n            inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        }\n\n        jump_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(jump.type) !== -1) {\n            //multiple answers validation\n            if (jump.to === undefined || jump.when === undefined) {\n                is_valid = false;\n            }\n\n            //answer_ref in needed when IS ans IS NOT only\n            if (jump.answer_ref === undefined) {\n                if (jump.when === 'IS' || jump.when === 'IS_NOT') {\n                    is_valid = false;\n                }\n            }\n        }\n        else {\n            //single answer validation (it will always jump, so check if destination is set)\n            if (jump.to === undefined) {\n                is_valid = false;\n            }\n        }\n\n        //check the destination is valid (the user might have dragged the input around)\n        if (is_valid) {\n\n            var refs = jump_destinations.map(function (destination) {\n                return destination.ref;\n            });\n\n\n            if (refs.indexOf(jump.to) === -1) {\n                is_valid = false;\n                jump.has_valid_destination = false;\n            }\n            else {\n                //remove jump.has_valid_destination just in case it was there from a previous error\n                //this happens because I am mutating the object! shame on me, too much work refactoring ;)\n                delete jump.has_valid_destination;\n            }\n        }\n        return is_valid;\n    },\n\n    //todo I do not think this is used anymore\n    isPossibleAnswerlinkedToJump: function (the_possible_answer, the_jumps) {\n\n        var possible_answer = the_possible_answer;\n        var jumps = the_jumps;\n        var i;\n        var iLength = jumps.length;\n        var has_linked_jump = false;\n\n        for (i = 0; i < iLength; i++) {\n            if (jumps[i].answer_id === possible_answer.answer_id) {\n                has_linked_jump = true;\n                break;\n            }\n        }\n        return has_linked_jump;\n    },\n\n    //perform validation on an input and optionally show toast notification\n    performValidation: function (the_input, show_toast) {\n\n        var input = the_input;\n        var message;\n        var ui = require('helpers/ui');\n        var utils = require('helpers/utils');\n        var undo = require('actions/undo');\n        var question;\n        var copy_btn_state = input.dom.is_valid ? consts.BTN_ENABLED : consts.BTN_DISABLED;\n        /***************************************\n         Save will implicitly run the validation!\n         */\n        save.saveAllInputProperties(input);\n        /*************************************/\n\n        //show visual feedback if the properties are valid\n        if (input.dom.is_valid) {\n\n            //update the just saved input showing a preview of the question text (limit to 50 chars)\n            //strip html tags from readme type if any\n            if (input.type === consts.README_TYPE) {\n\n                //start with deconding the html\n                question = utils.decodeHtml(input.question);\n                //remove '<' and '>' from decoded string (as html entities)\n                //tags already parsed (<b>, <i>, <u>) should go through\n                //todo test this well\n                var purifiedHtml = utils.replaceAllOccurrences(question, '&lt;', '\\ufe64');\n                purifiedHtml = utils.replaceAllOccurrences(purifiedHtml, '&gt;', '\\ufe65');\n\n                //remove link protocol\n                purifiedHtml = utils.replaceAllOccurrences(purifiedHtml, 'http://', '');\n                purifiedHtml = utils.replaceAllOccurrences(purifiedHtml, 'https://', '');\n\n                //remove not allowed tags\n                purifiedHtml = utils.stripTags(purifiedHtml, consts.README_ALLOWED_TAGS);\n\n                //save purified question\n                input.question = utils.encodeHtml(purifiedHtml);\n\n                //remove ALL tags for preview only\n                question = purifiedHtml.replace(/(<([^>]+)>)/ig, ' ');\n                //wrap in double quotes to escape html in the preview so <br> do not get rendered\n                ui.inputs_collection.showInputQuestionPreview(input.ref, '\"' + question.trunc(consts.LIMITS.question_preview_length) + '\"');\n            }\n            else {\n                ui.inputs_collection.showInputQuestionPreview(input.ref, input.question.trunc(consts.LIMITS.question_preview_length));\n            }\n\n            //replace warning icon with green check\n            ui.inputs_collection.showInputValidIcon(input.ref);\n\n            //show question preview on input properties panel\n            //strip html tags from readme type if any\n            if (input.type === consts.README_TYPE) {\n                question = utils.decodeHtml(input.question);\n                question = question.replace(/(<([^>]+)>)/ig, ' ');\n                //wrap in double quotes to escape html rendering in preview\n                ui.input_properties_panel.showInputQuestionPreview('\"' + question.trunc(20) + \"\");\n            }\n            else {\n                ui.input_properties_panel.showInputQuestionPreview(input.question.trunc(20));\n            }\n\n            if (show_toast) {\n                toast.showSuccess(messages.success.INPUT_VALID);\n            }\n            //enable save project button if all inputs are valid\n            if (this.areAllInputsValid(formbuilder.project_definition)) {\n                //console.log('** all good **');\n                //enable save project button\n                ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n                //replace warning icon with green check on current form tab\n                ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n                //enable download form button on current form\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__export-form').removeClass('disabled');\n\n                //enable prnt as pdf button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n            }\n            else {\n\n                //check if inputs are all valid for current form only\n                if (this.areFormInputsValid(formbuilder.current_form_index)) {\n                    //replace warning icon with green check on current form tab\n                    ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n                    //enable download form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__export-form').removeClass('disabled');\n\n                    //enable print as pdf form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n                }\n                else {\n                    //disable download form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__export-form').addClass('disabled');\n\n                    //disable print as pdf form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__print-as-pdf').addClass('disabled');\n                }\n            }\n        } else {\n            if (input.question) {\n                message = input.dom.error ? input.dom.error : input.question;\n            }\n            else {\n                switch (input.type) {\n                    case consts.BRANCH_TYPE:\n                        message = messages.error.NO_BRANCH_HEADER_YET;\n                        break;\n                    case consts.GROUP_TYPE:\n                        message = messages.error.NO_GROUP_HEADER_YET;\n                        break;\n                    default:\n                        message = messages.error.NO_QUESTION_TEXT_YET;\n                        break;\n                }\n            }\n\n            //update question preview\n            ui.inputs_collection.showInputInvalidIcon(input.ref);\n            ui.inputs_collection.showInputQuestionPreview(input.ref, message);\n            ui.input_properties_panel.showInputQuestionPreview(message);\n\n            if (show_toast) {\n                toast.showError(messages.error.INPUT_NOT_VALID, 2000);\n            }\n\n            //disable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n            formbuilder.dom.save_project_btn.off('click');\n\n            //show warning icon on current form tab\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable download form button on current form\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').addClass('disabled');\n            //disable print as pdf button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').addClass('disabled');\n        }\n\n        //toggle copy button (valid, enable button else disable)\n        ui.input_properties_panel.toggleCopyInputButton(input.ref, copy_btn_state);\n    },\n\n    areAllInputsValid: function (project_definition) {\n        var are_all_valid = true;\n        var forms = project_definition.data.project.forms;\n\n        loop1:\n        for (var index = 0; index < forms.length; index++) {\n\n            //do not accept forms with no inputs\n            if (forms[index].inputs.length === 0) {\n                are_all_valid = false;\n                break;\n            }\n\n            for (var input_index = 0; input_index < forms[index].inputs.length; input_index++) {\n\n                if (!forms[index].inputs[input_index].dom.is_valid) {\n                    are_all_valid = false;\n                    break loop1;\n                }\n            }\n        }\n        return are_all_valid;\n    },\n\n    areFormInputsValid: function (form_index) {\n\n        var are_valid = true;\n        var form = formbuilder.project_definition.data.project.forms[form_index];\n\n        //do not accept forms with no inputs\n        if (form.inputs.length === 0) {\n            are_valid = false;\n        }\n\n        //loop all inputs to see if they are all valid\n        $(form.inputs).each(function (index, input) {\n            if (!input.dom.is_valid) {\n                are_valid = false;\n                return false;\n            }\n        });\n\n        return are_valid;\n    },\n\n    // a branch is valid when the branch header is not empty and there is at least a valid branch question\n    // also, all the branch questions need to pass validation to make a branch valid\n    validateBranchInputs: function (the_branch_owner) {\n\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.DEFAULT_PROPERTY\n            }\n        };\n\n        var branch_owner = the_branch_owner;\n\n        if (branch_owner.branch.length === 0) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.NO_BRANCH_INPUTS_FOUND;\n        }\n        else {\n            //check if ALL the branch inputs are valid and return as soon as the first invalid is found\n            $(branch_owner.branch).each(function (index, input) {\n                // console.log('** input dom is_valid for branches');\n                // console.log(input.dom.is_valid);\n                if (!input.dom.is_valid) {\n                    validate.is_valid = false;\n                    validate.error.message = messages.error.INVALID_BRANCH_INPUTS;\n                    return false;\n                }\n            });\n        }\n        return validate;\n    },\n\n    // a group is valid when the group header is not empty and there is at least a valid group question\n    // also, all the group questions need to pass validation to make a group valid\n    validateGroupInputs: function (the_group_input) {\n\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.DEFAULT_PROPERTY\n            }\n        };\n\n        var group_input = the_group_input;\n\n        if (group_input.group.length === 0) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.NO_GROUP_INPUTS_FOUND;\n        }\n        else {\n            //check if ALL the group inputs are valid and return as soon as the first invalid is found\n            $(group_input.group).each(function (index, input) {\n                if (!input.dom.is_valid) {\n                    validate.is_valid = false;\n                    validate.error.message = messages.error.INVALID_GROUP_INPUTS;\n                    return false;\n                }\n            });\n        }\n        return validate;\n    },\n\n    validateJumpsAfterSorting: function (inputs) {\n\n        var self = this;\n        var ui = require('helpers/ui');\n        var inputs_to_validate = inputs;\n        var jumps_list_wrapper_dom;\n        var jumps_dom;\n        var jump_dom;\n\n        //validate previous inputs based and current one\n        for (var index = 0; index < inputs_to_validate.length; index++) {\n\n            var input = inputs_to_validate[index];\n            var are_jumps_valid = true;\n\n            //hide all errors for a jump in the dom\n            jumps_list_wrapper_dom = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]')\n                .find('.input-properties__form__jumps .input-properties__form__jumps__list');\n\n            jumps_dom = jumps_list_wrapper_dom.find('li');\n\n            //hide all the jumps error\n            input.hideJumpsErrors(jumps_dom);\n\n            for (var jump_index = 0; jump_index < input.jumps.length; jump_index++) {\n\n                var jump = input.jumps[jump_index];\n\n                // Assume the index of the <li> in the list is the same of the index in the jumps object\n                jump_dom = jumps_dom.eq(jump_index);\n\n                //todo if any error, highlight the wrong destination in the markup\n                if (!self.isJumpValid(jump, input)) {\n\n                    //show errors\n                    input.showSingleJumpErrors(jump_dom, jump);\n\n                    //keep track the jumps now are invalid\n                    are_jumps_valid = false;\n\n                    //set input in the dom as invalid, and also the form if it is the only invalid one\n                    ui.inputs_collection.showInputInvalidIcon(input.ref);\n                }\n                else {\n                    //todo what if I have multiple jumps with errors?\n                    ui.input_properties_panel.hideJumpTabError(jump_dom);\n                }\n            }\n\n            //Is the input valid aside from the jumps? That would mean all the jumps were ok, but there might be other errors\n            //we just need to check the object properties, as they do not change when sorting\n            input.dom.is_valid = self.isInputObjectValid(input) && are_jumps_valid;\n\n            //set input validation icon accordingly\n            if (input.dom.is_valid) {\n                ui.inputs_collection.showInputValidIcon(input.ref);\n            }\n            else {\n                ui.inputs_collection.showInputInvalidIcon(input.ref);\n            }\n        }\n\n\n        //check if the form is now valid\n        if (self.areFormInputsValid(formbuilder.current_form_index)) {\n            ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n            //enable download form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').removeClass('disabled');\n\n            //enable print as pdf form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n        }\n        else {\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable form download button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').addClass('disabled');\n\n            //disable print as pdf download button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').addClass('disabled');\n        }\n\n        //check if all inputs are now valid to enable save project button\n        if (self.areAllInputsValid(formbuilder.project_definition)) {\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        }\n        else {\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n        }\n    },\n\n    isInputObjectValid: function (input) {\n\n        var self = this;\n        var is_valid = true;\n\n        //check question text ***********************************************************\n        if (!self.isQuestionTextValid(input).is_valid) {\n            is_valid = false;\n        }\n        //*******************************************************************************\n\n        //test min and max for integer **************************************************\n        if (input.type === consts.INTEGER_TYPE) {\n\n            //is min a int?\n            if (input.min !== '') {\n                if (!self.isValueInt(input.min)) {\n                    is_valid = false;\n                }\n            }\n\n            //is max a int?\n            if (input.max !== '') {\n                if (!self.isValueInt(input.max)) {\n                    is_valid = false;\n                }\n            }\n\n            //If both are set, are they valid?\n            if (is_valid && (input.min !== '' && input.max !== '')) {\n                if (parseFloat(input.min) > parseFloat(input.max)) {\n                    is_valid = false;\n                }\n            }\n\n            //if the default answer is set, is it valid?\n            if (input.default !== '') {\n                if (!self.isValueInt(input.default)) {\n                    is_valid = false;\n                }\n                else {\n                    //default answer is a valid int, is it within range?\n                    if (input.min !== '' && parseInt(input.default, 0) < input.min) {\n                        is_valid = false;\n                    }\n                    if (input.min !== '' && parseInt(input.default, 0) > input.max) {\n                        is_valid = false;\n                    }\n                }\n            }\n        }\n        //*******************************************************************************\n\n        //test min and max for decimal (float) ******************************************\n        if (input.type === consts.DECIMAL_TYPE) {\n            //is min a float or an integer?\n            if (input.min !== '') {\n                if (!(self.isValueFloat(input.min) || self.isValueInt(input.min))) {\n                    is_valid = false;\n                }\n            }\n\n            //is max a float or integer?\n            if (input.max !== '') {\n                if (!(self.isValueFloat(input.max) || self.isValueInt(input.max))) {\n                    is_valid = false;\n                }\n            }\n\n            //If both are set, are they valid?\n            if (is_valid && (input.min !== '' && input.max !== '')) {\n                if (parseFloat(input.min) > parseFloat(input.max)) {\n                    is_valid = false;\n                }\n            }\n\n            //if the default answer is set, is it valid?\n            if (input.default !== '') {\n                if (!(self.isValueFloat(input.default) || self.isValueInt(input.default))) {\n                    is_valid = false;\n                }\n                else {\n                    //default answer is a valid number, is it within range?\n                    if (input.min !== '' && parseFloat(input.default) < input.min) {\n                        is_valid = false;\n                    }\n                    if (input.min !== '' && parseFloat(input.default) > input.max) {\n                        is_valid = false;\n                    }\n                }\n            }\n        }\n        //*******************************************************************************\n\n        //check possible answers for multiple answer types ******************************\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type !== -1)) {\n            $(input.possible_answers).each(function (index, possible_answer) {\n                if (!self.isPossibleAnswerValid(possible_answer.answer).is_valid) {\n                    is_valid = false;\n                }\n            });\n        }\n        //*******************************************************************************\n\n        //group type but empty? *********************************************************\n        if (input.type === consts.GROUP_TYPE && input.group.length === 0) {\n            is_valid = false;\n        }\n        //*******************************************************************************\n\n        //branch type but empty? ********************************************************\n        if (input.type === consts.BRANCH_TYPE && input.branch.length === 0) {\n            is_valid = false;\n        }\n        //*******************************************************************************\n\n        return is_valid;\n    }\n    ,\n\n    validateBeforeSaving: function (form_ref, inputs) {\n\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null\n            }\n        };\n        var invalid_question = '';\n        var are_inputs_valid = true;\n        var are_branch_inputs_valid = true;\n        $(inputs).each(function (index, input) {\n            if (!import_form_validation.isValidInput(form_ref, input, false, false)) {\n                console.log(JSON.stringify(input));\n                invalid_question = input.question.trunc(50);\n                are_inputs_valid = false;\n                return false;//exit loop only\n            }\n        });\n        var questions_total;\n\n        if (!are_inputs_valid) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: invalid_question\n                }\n            };\n            return validate;\n        }\n\n        //check total number of questions/branches\n        questions_total = utils.getInputsTotal(inputs);\n        if (questions_total > consts.INPUTS_MAX_ALLOWED) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_QUESTIONS_FOR_CURRENT_FORM + questions_total + ', limit is ' + consts.INPUTS_MAX_ALLOWED + '!'\n                }\n            };\n            return validate;\n        }\n\n        //check total number of titles (main form)\n        if (utils.isMaxTitleLimitExceeded(inputs)) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_TITLES\n                }\n            };\n            return validate;\n        }\n        //check total number of titles (branches)\n        $(inputs).each(function (index, input) {\n            if (utils.isMaxTitleLimitExceeded(input.branch)) {\n                are_branch_inputs_valid = false;\n                return false;\n            }\n        });\n\n        if (!are_branch_inputs_valid) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_TITLES + ' (branch)'\n                }\n            };\n            return validate;\n        }\n\n        //check jumps destinations\n        if (!import_form_validation.areJumpsDestinationsValid(inputs)) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.JUMPS_INVALID\n                }\n            };\n            return validate;\n        }\n\n        //check total number of search inputs\n        if (utils.getSearchInputsTotal() > consts.LIMITS.search_inputs_max) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_SEARCH_QUESTIONS\n                }\n            };\n            return validate;\n        }\n\n        return validate;\n    }\n}\n    ;\n\nmodule.exports = validation;\n\n","/*\n set of constants and values to use across the application\n we use `consts` as const is a reserved word and `constant` is a window global object\n */\n'use strict';\n\nconsole.log(window.location.href);\n\nvar consts = {\n\n    PROJECT_URL: '',\n    PROJECT_LOGO_URL: '',\n    BACK_URL: '',\n    API_DEVELOPMENT_GET_PATH: '../project/',\n    API_DEVELOPMENT_POST_PATH: '../postdump/',\n    API_DEVELOPMENT_PROJECT: 'project.json',\n\n    API_PRODUCTION_PATH: 'api/internal/formbuilder/',\n    API_MEDIA_PATH: 'api/internal/media/',\n    API_PROJECT_LOGO_QUERY_STRING: '?type=photo&name=logo.jpg&format=project_mobile_logo',\n    API_DEVELOPMENT_SERVER: 'http://localhost/~mmenegazzo/epicollect5-server/public',//to be changed accordingly\n    FORMBUIlDER_ROOT_FOLDER: 'epicollect5-formbuilder',\n\n    PROJECT_NAME_MAX_LENGHT: 100,\n    FORM_NAME_MAX_LENGHT: 50,\n    INPUTS_MAX_ALLOWED: 300,\n    TAB_FORM_NAME_MAX_DISPLAY_LENGHT: 22,\n    INPUTS_COLLECTION_FORM_NAME_MAX_DISPLAY_LENGHT: 22,\n    INPUTS_COLLECTION_BRANCH_NAME_MAX_DISPLAY_LENGHT: 25,\n    INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT: 25,\n    MAX_NUMBER_OF_NESTED_CHILD_FORMS: 5,\n    ANIMATION_FAST: 100,//milliseconds\n    ANIMATION_NORMAL: 150,\n    ANIMATION_SLOW: 500,\n    ANIMATION_SUPER_SLOW: 1000,\n\n    FORM_NAME_REGEX: /^[\\w\\-\\s]+$/, //allow only alphanumeric chars and '-', '_'\n    FORM_HIERARCHY_TYPE: 'hierarchy',\n    FORM_TYPE: 'form',\n\n    UNIQUESS_NONE: 'none',\n    UNIQUESS_FORM: 'form',\n    UNIQUESS_HIERARCHY: 'hierarchy',\n\n    //app ids namespace\n    NAMESPACE_PREFIX: 'ec5_',\n\n    //input types icons\n    TEXT_TYPE_ICON: 'fa-text-width', //\n    TEXTAREA_TYPE_ICON: 'fa-sticky-note-o',\n    NUMERIC_TYPE_ICON: 'fa-hashtag',\n    INTEGER_TYPE_ICON: 'fa-hashtag',\n    DECIMAL_TYPE_ICON: 'fa-hashtag',\n    DATE_TYPE_ICON: 'fa-calendar',\n    TIME_TYPE_ICON: 'fa-clock-o',\n    RADIO_TYPE_ICON: 'fa-dot-circle-o',\n    README_TYPE_ICON: 'fa-file-text-o',\n    CHECKBOX_TYPE_ICON: 'fa-check-square-o',\n    DROPDOWN_TYPE_ICON: 'fa-caret-square-o-down',\n    BARCODE_TYPE_ICON: 'fa-barcode',\n    LOCATION_TYPE_ICON: 'fa-map-marker',\n    AUDIO_TYPE_ICON: 'fa-microphone',\n    VIDEO_TYPE_ICON: 'fa-video-camera',\n    PHOTO_TYPE_ICON: 'fa-camera-retro',\n    PHONE_TYPE_ICON: 'fa-phone',\n    BRANCH_TYPE_ICON: 'fa-clone',\n    GROUP_TYPE_ICON: 'fa-align-justify',\n    SEARCH_SINGLE_TYPE_ICON: 'fa-search',\n    SEARCH_MULTIPLE_TYPE_ICON: 'fa-search',\n\n    //input types\n    TEXT_TYPE: 'text', //\n    TEXTAREA_TYPE: 'textarea',\n    INTEGER_TYPE: 'integer',\n    DECIMAL_TYPE: 'decimal',\n    DATE_TYPE: 'date',\n    TIME_TYPE: 'time',\n    RADIO_TYPE: 'radio',\n    CHECKBOX_TYPE: 'checkbox',\n    DROPDOWN_TYPE: 'dropdown',\n    BARCODE_TYPE: 'barcode',\n    LOCATION_TYPE: 'location',\n    AUDIO_TYPE: 'audio',\n    VIDEO_TYPE: 'video',\n    PHOTO_TYPE: 'photo',\n    BRANCH_TYPE: 'branch',\n    GROUP_TYPE: 'group',\n    README_TYPE: 'readme',\n    PHONE_TYPE: 'phone',\n    SEARCH_SINGLE_TYPE: 'searchsingle',\n    SEARCH_MULTIPLE_TYPE: 'searchmultiple',\n\n    //date formats\n    DATE_FORMAT_1: 'dd/MM/YYYY',\n    DATE_FORMAT_2: 'MM/dd/YYYY',\n    DATE_FORMAT_3: 'YYYY/MM/dd',\n    DATE_FORMAT_4: 'MM/YYYY',\n    DATE_FORMAT_5: 'dd/MM',\n\n    //time formats\n    TIME_FORMAT_1: 'HH:mm:ss',\n    TIME_FORMAT_2: 'hh:mm:ss',\n    TIME_FORMAT_3: 'HH:mm',\n    TIME_FORMAT_4: 'hh:mm',\n    TIME_FORMAT_5: 'mm:ss',\n\n    //reserverd words/chars\n    //RESERVED_WORD_SKIPP3D: '_skipp3d_',\n    //PATH_SEPARATOR_MOBILE_CLIENT: '|',\n\n    //input properties names\n    DEFAULT_PROPERTY: 'default',\n    QUESTION_PROPERTY: 'question',\n    MIN_VALUE_PROPERTY: 'min',\n    MAX_VALUE_PROPERTY: 'max',\n\n    //button labels\n    SHOW_JUMPS: 'Show jumps',\n    HIDE_JUMPS: 'Hide jumps',\n    JUMP_TO_END_OF_FORM_REF: 'END',\n    JUMP_TO_END_OF_FORM_LABEL: 'End of form',\n\n    //possible answers\n    POSSIBILE_ANSWERS_CUSTOM_ID: 'pa_custom_id',\n    POSSIBILE_ANSWER_PLACEHOLDER: 'I am a placeholder answer',\n    USE_ANSWER_AS_TITLE: 'Use answer as title',\n    MAX_TITLE_LIMIT_REACHED: 'Limit of 3 titles reached',\n\n    //paths\n    VIEWS_PATH: 'views/',\n\n    //buttons status\n    BTN_ENABLED: 'btn-enabled',\n    BTN_DISABLED: 'btn-disabled',\n\n    ENABLED_STATE: 'enabled',\n    DISABLED_STATE: 'disabled',\n\n    //action\n    RENDER_ACTION_UNDO: 'undo',\n    RENDER_ACTION_DO: 'do',\n    RENDER_ACTION_VALIDATE: 'validate',\n\n    //form export/import\n    FORM_FILE_ACCEPTED_TYPE: 'application/json',\n    FORM_FILE_EXTENSION: 'json',\n\n    //possible answers csv import/export\n    CSV_FILE_ACCEPTED_TYPES: ['text/csv', 'application/vnd.ms-excel'], //MIME types\n    CSV_FILE_EXTENSION: 'csv'\n};\n\n//multiple answers types\nconsts.MULTIPLE_ANSWER_TYPES = [\n    consts.RADIO_TYPE,\n    consts.CHECKBOX_TYPE,\n    consts.DROPDOWN_TYPE,\n    consts.SEARCH_MULTIPLE_TYPE,\n    consts.SEARCH_SINGLE_TYPE\n];\n\n\nconsts.SINGLE_ANSWER_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.DATE_TYPE,\n    consts.TIME_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.README_TYPE,\n    consts.PHONE_TYPE\n];\n\n//these types do not have the required/uniqueness option\nconsts.MEDIA_ANSWER_TYPES = [\n    consts.AUDIO_TYPE,\n    consts.PHOTO_TYPE,\n    consts.VIDEO_TYPE,\n    consts.LOCATION_TYPE\n];\n\n//types that have the verify option\nconsts.VERIFY_ALLOWED_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.PHONE_TYPE\n];\n\n//types that have the uniquess option\nconsts.UNIQUENESS_ALLOWED_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.DATE_TYPE,\n    consts.TIME_TYPE,\n    consts.INTEGER_TYPE,//numeric\n    consts.DECIMAL_TYPE,//numeric\n    consts.BARCODE_TYPE,\n    consts.PHONE_TYPE\n];\n\n//these types DO have the required option\nconsts.REQUIRED_ALLOWED_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.DATE_TYPE,\n    consts.TIME_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.PHONE_TYPE,\n    consts.RADIO_TYPE,\n    consts.CHECKBOX_TYPE,\n    consts.DROPDOWN_TYPE,\n    consts.SEARCH_MULTIPLE_TYPE,\n    consts.SEARCH_SINGLE_TYPE\n];\n\n\n//jump conditions\nconsts.JUMP_CONDITIONS = [\n    { key: 'NO_ANSWER_GIVEN', text: 'no answer given' },\n    { key: 'IS', text: 'answer is' },\n    { key: 'IS_NOT', text: 'answer is NOT' },\n    { key: 'ALL', text: 'always' }\n];\n\nconsts.LIMITS = {\n    question_length: 255,\n    readme_length: 1000,\n    default_answer_length: 255,\n    regex_length: 50,\n    min_value_length: 50,\n    max_value_length: 50,\n    possible_answers_max: 300,\n    possible_answers_max_search: 1000,\n    titles_max: 3,\n    max_states: 10,\n    possible_answer_ref_length: 13,\n    possible_answer_max_length: 150,\n    possible_answers_per_page: 100,\n    search_inputs_max: 5,\n    question_preview_length: 80\n};\n\nconsts.SUMMERNOTE_OPTIONS = {\n    placeholder: 'Type here...',\n    toolbar: [\n        // [groupName, [list of button]]\n        ['style', ['bold', 'italic', 'underline']]\n    ]\n};\n\nconsts.REGEX = {\n    only_letters: '^[a-zA-Z]*$',\n    only_digits: '^[0-9]+$',\n    limit_length_20: '^.{1,20}$',\n    possible_answer_ref: '^[a-zA-Z0-9]{13}$',\n    input_ref: '^[a-zA-Z0-9-_]{60}$'\n};\n\nconsts.README_ALLOWED_TAGS = [\n    '<br>',\n    '<p>',\n    '<b>',\n    '<strong>',\n    '<i>',\n    '<em>',\n    '<u>'\n];\n\nconsts.POSSIBLE_ANSWERS_ORDER = {\n    AZ: 'az',\n    ZA: 'za',\n    SHUFFLE: 'shuffle'\n};\n\nmodule.exports = consts;\n","'use strict';\n\nvar extend_natives = function () {\n\n    //from http://www.redips.net/javascript/array-move/\n    //move an element within same array and shift other elements\n    Array.prototype.move = function (from, to) {\n        // local variables\n        var i, tmp;\n        // cast input parameters to integers\n        from = parseInt(from, 10);\n        to = parseInt(to, 10);\n        // if positions are different and inside array\n        if (from !== to && from >= 0 && from <= this.length && to >= 0 && to <= this.length) {\n            // save element 'from'\n            tmp = this[from];\n            // move element down and shift other elements up\n            if (from < to) {\n                for (i = from; i < to; i++) {\n                    this[i] = this[i + 1];\n                }\n            }\n            // move element up and shift other elements down\n            else {\n                for (i = from; i > to; i--) {\n                    this[i] = this[i - 1];\n                }\n            }\n            // put element 'from' to destination\n            this[to] = tmp;\n        }\n    };\n\n    String.prototype.trunc = function (n) {\n        return this.substr(0, n - 1) + (this.length >= n ? '...' : '');\n    };\n\n    if (!String.prototype.startsWith) {\n        String.prototype.startsWith = function (str) {\n            return !this.indexOf(str);\n        };\n    }\n\n    //indexOf polyfill\n    // Production steps of ECMA-262, Edition 5, 15.4.4.14\n// Reference: http://es5.github.io/#x15.4.4.14\n    if (!Array.prototype.indexOf) {\n        Array.prototype.indexOf = function (searchElement, fromIndex) {\n\n            var k;\n\n            // 1. Let O be the result of calling ToObject passing\n            //    the this value as the argument.\n            if (this === null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            var O = Object(this);\n\n            // 2. Let lenValue be the result of calling the Get\n            //    internal method of O with the argument \"length\".\n            // 3. Let len be ToUint32(lenValue).\n            var len = O.length >>> 0;\n\n            // 4. If len is 0, return -1.\n            if (len === 0) {\n                return -1;\n            }\n\n            // 5. If argument fromIndex was passed let n be\n            //    ToInteger(fromIndex); else let n be 0.\n            var n = +fromIndex || 0;\n\n            if (Math.abs(n) === Infinity) {\n                n = 0;\n            }\n\n            // 6. If n >= len, return -1.\n            if (n >= len) {\n                return -1;\n            }\n\n            // 7. If n >= 0, then Let k be n.\n            // 8. Else, n<0, Let k be len - abs(n).\n            //    If k is less than 0, then let k be 0.\n            k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n            // 9. Repeat, while k < len\n            while (k < len) {\n                // a. Let Pk be ToString(k).\n                //   This is implicit for LHS operands of the in operator\n                // b. Let kPresent be the result of calling the\n                //    HasProperty internal method of O with argument Pk.\n                //   This step can be combined with c\n                // c. If kPresent is true, then\n                //    i.  Let elementK be the result of calling the Get\n                //        internal method of O with the argument ToString(k).\n                //   ii.  Let same be the result of applying the\n                //        Strict Equality Comparison Algorithm to\n                //        searchElement and elementK.\n                //  iii.  If same is true, return k.\n                if (k in O && O[k] === searchElement) {\n                    return k;\n                }\n                k++;\n            }\n            return -1;\n        };\n    }\n};\n\nmodule.exports = extend_natives;\n\n","/* global $*/\n'use strict';\n\nvar formbuilder = {\n    current_form_ref: '',\n    current_form_index: '',\n    current_input_ref: '',\n    is_sorting: false,\n    from_index: 0,\n    to_index: 0,\n    possible_answers: {\n        enabled_sortable: [],\n        from_index: 0,\n        to_index: 0\n    },\n    state: [],\n    dom: {\n        input_properties: '',\n        input_properties_forms_wrapper: '',\n        input_properties_buttons: '',\n        input_properties_no_input_selected: '',\n        inputs_collection: '',\n        inputs_collection_sortable: '',\n        partials: {},\n        input_properties_views: {}\n    },\n    branch: {},\n    project_definition: {},//this gets loaded dynamically\n\n    setup: function (ref, partials, views) {\n\n        //set refs for current form (always top parent, on load)\n        formbuilder.current_form_ref = ref;\n        formbuilder.current_form_index = 0;\n        formbuilder.possible_answers_pagination = {};\n\n        /* cache static dom selectors to speed up dynamic queries\n         and also for consistent and quick access throughout the code as\n         we are abstracting the dom access away a little bit\n\n         to get the dom element, we concatenate find() calls, as it is faster\n         http://jsperf.com/find-chaining/2\n         */\n        formbuilder.dom = {\n            overlay: $('.wait-overlay'),\n            loader: $('.loader'),\n            navbar: $('.navbar'),\n            forms_tabs: $('.main .main__tabs'),\n            forms_tabs_content: $('.main .main__tabs-content'),\n            save_project_btn: $('.main__tabs-btns .btn-group .main__tabs__save-project-btn'),\n            undo_btn: $('.main__tabs-btns .btn-group .main__tabs__undo-btn'),\n            main_container: $('.container-fluid'),\n            input_properties: $('#' + ref + '-input-properties.input-properties'),\n            input_properties_forms_wrapper: $('#' + ref + '-input-properties.input-properties > .panel > .panel-body.input_properties__forms_wrapper'),\n            input_properties_buttons: $('#' + ref + '-input-properties .input-properties__buttons'),\n            input_properties_no_input_selected: $('.input-properties__no-input-selected'),\n            inputs_collection: $('#' + ref + '-inputs-collection.inputs-collection'),\n            inputs_collection_sortable: $('#' + ref + '-inputs-collection.inputs-collection .panel .panel-body'),\n            inputs_tools_draggable: $('ul#inputs-tools-list li div.input')\n        };\n\n        if ($.isEmptyObject(formbuilder.dom.partials) && partials) {\n            formbuilder.dom.partials = partials;\n        }\n\n        if ($.isEmptyObject(formbuilder.dom.input_properties_views) && views) {\n            formbuilder.dom.input_properties_views = views;\n        }\n\n        formbuilder.isOpeningFileBrowser = false;\n\n        console.log('formbuilder object ready');\n    }\n};\n\n\nmodule.exports = formbuilder;\n","/* global toastr, $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar draggable = require('ui-handlers/draggable');\nvar sortable = require('ui-handlers/sortable');\nvar input_properties_click_callback = require('ui-handlers/event-handler-callbacks/input-properties-click-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\nvar input_properties_focus_callback = require('ui-handlers/event-handler-callbacks/input-properties-focus-callback');\nvar input_properties_change_callback = require('ui-handlers/event-handler-callbacks/input-properties-change-callback');\nvar input_properties_title_checkbox_callback = require('ui-handlers/event-handler-callbacks/input-properties-title-checkbox-callback');\nvar form_tab_click_callback = require('ui-handlers/event-handler-callbacks/form-tab-click-callback');\nvar modal_edit_form_name_callback = require('ui-handlers/event-handler-callbacks/modal-form-callback');\nvar export_form_click_callback = require('ui-handlers/event-handler-callbacks/export-form-click-callback');\n\nvar print_as_pdf_click_callback = require('ui-handlers/event-handler-callbacks/print-as-pdf-click-callback');\n\nvar import_form_click_callback = require('ui-handlers/event-handler-callbacks/import-form-click-callback');\n\nvar delete_all_questions_callback = require('ui-handlers/event-handler-callbacks/delete-all-questions-click-callback');\n\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar modal_regex_callback = require('ui-handlers/event-handler-callbacks/modal-regex-callback');\nvar input_properties_advanced_tab_callback = require('ui-handlers/event-handler-callbacks/input-properties-advanced-tab-click-callback');\n\n\nvar messages = require('config/messages');\nvar parse = require('actions/parse');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar undo = require('actions/undo');\n\nvar init = function () {\n\n    var project_name = formbuilder.project_definition.data.project.name;\n    var first_form_name = formbuilder.project_definition.data.project.forms[0].name;\n\n    //config toast notification options\n    window.toastr.options = {\n        closeButton: true,\n        // progressBar: true,\n        positionClass: 'toast-top-center',\n        showDuration: '200',\n        hideDuration: '300',\n        timeOut: '2000'\n    };\n\n    //on Safari 9, JSON.stringify() causes a bug, so we override it with a MDN polyfill\n    if (utils.isSafari) {\n        window.CircularJSON = utils.JSONPolyfill;\n    }\n\n    //set back button\n    $('.navbar-back-button').on('click', function () {\n        utils.goBack();\n    });\n\n    //set undo button\n    $('.main__tabs__undo-btn').off().on('click', function () {\n        undo.execute();\n    });\n\n    //todo disable text selection if it causes problems with drag and drop\n\n    //make text not selectable for sortable\n    formbuilder.dom.inputs_collection.disableSelection();\n\n    /*********************************************************/\n    /******* attach UI dom events and event handlers *********/\n\n    draggable();\n\n    //init inputs collection as a sortable (it is also droppable by default)\n    sortable();\n\n    //handle click action on input properties panel in the right sidebar (use event delegation)\n    formbuilder.dom.input_properties.off().on('click', 'button.btn, .possible_answer-more-action', input_properties_click_callback);\n\n    //handle click on the advanced tab button\n    formbuilder.dom.input_properties.on('click', '.advanced-tab', input_properties_advanced_tab_callback);\n\n    //attach delegate event to mousedown so we cover both clicks and click hold + drag\n    formbuilder.dom.inputs_collection_sortable.on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n\n    //triggered when users focus on a select of the input properties panel\n    formbuilder.dom.input_properties.on('focus', 'select', input_properties_focus_callback);\n\n    //triggered when users change selected option in the input properties panel\n    formbuilder.dom.input_properties.on('change', 'select', input_properties_change_callback);\n\n    //triggered when users check/unckeck title in the input properties panel\n    formbuilder.dom.input_properties.on('change', '.input-properties__form__title-flag input', input_properties_title_checkbox_callback);\n\n    //triggered when user navigates form hierarchy using the forms tabs\n    formbuilder.dom.forms_tabs.on('click', 'a[data-toggle=\"tab\"]', form_tab_click_callback);\n\n    //triggered when user navigates form hierarchy using the forms tabsx\n    formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n    //triggered when user wants to export a form\n    formbuilder.dom.inputs_collection.on('click', '.inputs-collection__export-form', function (e) {\n\n        //avoid any action if option in dropdown is disabled\n        if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n            return false\n        }\n\n        export_form_click_callback();\n    });\n\n    //triggered when user wants to export a form\n    formbuilder.dom.inputs_collection.on('click', '.inputs-collection__print-as-pdf', function (e) {\n\n        //avoid any action if option in dropdown is disabled\n        if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n            return false\n        }\n\n        print_as_pdf_click_callback();\n    });\n\n    //triggered when the user wants to import a form\n    formbuilder.dom.inputs_collection.find('.inputs-collection__form-import input').off('change').on('change', function () {\n        import_form_click_callback(this.files);\n        $(this).val(null);\n    });\n\n    //triggered when the user wants to remove all questions at once\n    formbuilder.dom.inputs_collection.on('click', '.inputs-collection__delete-all-questions', function (e) {\n        delete_all_questions_callback();\n    });\n\n    //validate question text/ group or branch header, possible answer text on keyup\n    formbuilder.dom.input_properties\n        .off('keyup')\n        .on('keyup', '.input-properties__form__question input, .input-properties__form__possible-answers__list__possible_answer_item input', input_properties_keyup_callback);\n\n    //blur links after closing modals\n    $(document).on('hidden.bs.modal', function (e) {\n        $('a').blur();\n    });\n\n    //show project name in navbar\n    formbuilder.dom.navbar.find('.navbar-project-name span').text(project_name);\n\n    //show project logo in sidebar\n    //'var logo_url = https://test.epicollect.net/api/internal/json/media/ants-project?type=photo&name=logo.jpg&format=project_mobile_logo'\n    console.log(consts.PROJECT_URL);\n    console.log(window.location.href);\n\n    //for live server only\n    // if (window.location.href.indexOf('localhost/') === -1 && window.location.href.indexOf('epicollect5-formbuilder/') === -1) {\n    utils.setProjectLogoUrl();\n    formbuilder.dom.navbar.find('.navbar-project-name img').attr('src', consts.PROJECT_LOGO_URL);\n    // }\n    //else {\n    //  formbuilder.dom.navbar.find('.navbar-project-name img').remove();\n    // }\n\n    //show name of first form in navbar and inputs collection container\n\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(first_form_name.trunc(consts.INPUTS_COLLECTION_FORM_NAME_MAX_DISPLAY_LENGHT));\n    formbuilder.dom.input_properties.find('.question-preview').text('');\n\n    //set form name in form tab\n    ui.forms_tabs.setFirstFormTabName(first_form_name);\n\n    //hide properties panel buttons as no input is selected\n    formbuilder.dom.input_properties_buttons.fadeOut();\n\n    /*********************************************************/\n\n    //init help popovers and tooltips\n    $('[data-toggle=\"popover\"]').popover();\n    $('[data-toggle=\"tooltip\"]').tooltip();\n\n    //edit form name modal handler\n    $('.main__modal--edit-form-name').on('show.bs.modal', modal_edit_form_name_callback);\n\n    //regex modal handler\n    $('#info-regex').on('show.bs.modal', modal_regex_callback);\n\n    //render project from project definition json\n    formbuilder.render_action = consts.RENDER_ACTION_DO;\n    $.when(parse.renderProject(formbuilder.project_definition)).then(function () {\n\n        //set initial state, now after render all the inputs have the 'dom' property\n        var state = {\n            project_definition: JSON.parse(JSON.stringify(formbuilder.project_definition)),\n            active_input_ref: null,\n            active_form_index: 0,\n            active_form_ref: formbuilder.project_definition.data.project.forms[0].ref\n        };\n\n        //set state as the starting state pushing a deep copy\n        formbuilder.state.push(state);\n\n        //hide loader and show formbuilder containers\n        formbuilder.dom.loader.fadeOut(consts.ANIMATION_FAST);\n        formbuilder.dom.navbar.removeClass('hidden').hide().fadeIn(consts.ANIMATION_FAST);\n        formbuilder.dom.main_container.removeClass('hidden').hide().fadeIn(consts.ANIMATION_FAST);\n    });\n\n    $(window).on('beforeunload', function () {\n        return 'Are you sure you want to leave?';\n    });\n\n    /**\n * String.prototype.replaceAll() polyfill\n * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/\n * @author Chris Ferdinandi\n * @license MIT\n */\n    if (!String.prototype.replaceAll) {\n        String.prototype.replaceAll = function (str, newStr) {\n            // If a regex pattern\n            if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {\n                return this.replace(str, newStr);\n            }\n            // If a string\n            return this.replace(new RegExp(str, 'g'), newStr);\n        };\n    }\n};\n\nmodule.exports = init;\n\n","'use strict';\n\nvar consts = require('config/consts');\n\nvar messages = {\n\n    labels: {\n        EDITING_FORM: 'Form > ',\n        EDITING_BRANCH: 'Branch > ',\n        EDITING_GROUP: 'Group > ',\n        EDITING_NESTED_GROUP: ' Group: ',\n        EXIT_EDITING: 'Back',\n        ADD_BRANCH_INPUTS_HERE: 'Add branch questions here',\n        ADD_GROUP_INPUTS_HERE: 'Add group questions here'\n    },\n    success: {\n        INPUT_VALID: 'Question valid!',\n        FORM_IMPORTED: 'Form import succeeded!',\n        POSSIBLE_ANSWERS_IMPORTED: 'Possible answers import succeeded!',\n        PROJECT_SAVED: 'Project saved!',\n        JUMP_DELETED: 'Jump deleted!',//this should be a warning\n        INPUT_COPIED: 'Question copied!'\n    },\n    error: {\n        FORM_CANNOT_BE_DELETED: 'Form cannot be deleted',\n        FORM_NAME_EMPTY: 'Form name cannot be empty',\n        FORM_NAME_INVALID: 'Form name is invalid',\n        FORM_FILE_INVALID: 'Form file is invalid',\n        FORM_IS_INVALID: 'Form is invalid',\n        FORM_NAME_EXIST: 'Form name exists',\n        INPUT_NOT_VALID: 'Question NOT valid!',\n        INPUT_NOT_SELECTED: 'No question selected',\n        POSSILE_ANSWERS_CUSTOM_ID_CANNOT_SWITCH_BACK: 'Cannot switch back to basic mode',\n        QUESTION_TEXT_EMPTY: 'This field cannot be empty',\n        POSSIBLE_ANSWER_EMPTY: 'Answer text cannot be empty',\n        POSSIBLE_ANSWER_DUPLICATED_IDENTIFIER: 'Duplicated identifier, please remove',\n        VALUE_MUST_BE_INTEGER: 'Value must be an integer',\n        MIN_MUST_BE_SMALLER_THAN_MAX: 'Min value must be smaller than Max',\n        INITIAL_ANSWER_OUT_OF_RANGE: 'Value is out of range',\n        INITIAL_ANSWER_NOT_MATCHING_REGEX: 'Value does not match regex',\n        INITIAL_ANSWER_NOT_PHONE_NUMBER: 'Value is not a phone number',\n        NO_QUESTION_TEXT_YET: 'No question text yet',\n        NO_BRANCH_HEADER_YET: 'No branch header yet',\n        NO_GROUP_HEADER_YET: 'No group header yet',\n        NO_BRANCH_INPUTS_FOUND: 'No branch questions found',\n        NO_GROUP_INPUTS_FOUND: 'No group questions found',\n        INVALID_BRANCH_INPUTS: 'There are invalid branch questions',\n        INVALID_GROUP_INPUTS: 'There are invalid group questions',\n        JUMP_CONDITION_NOT_SELECTED: 'You must choose a condition',\n        JUMP_ANSWER_NOT_SELECTED: 'You must choose an answer',\n        JUMP_DESTINATION_NOT_SELECTED: 'You must choose a valid destination',\n        JUMP_DESTINATION_INVALID: 'Invalid destination',\n        PROJECT_NOT_SAVED: 'Project error!',\n        JUMP_INVALID: 'Invalid jump on question:',\n        JUMPS_INVALID: 'Some jumps are invalid',\n        POSSIBLE_ANSWERS_INVALID: 'Some possible answers are invalid',\n        CSV_FILE_INVALID: 'CSV file is invalid!',\n        BROWSER_NOT_SUPPORTED: 'Browser not supported',\n        MAX_QUESTIONS_LIMIT_REACHED: 'Questions limit reached for this form!',\n        TOO_MANY_SEARCH_QUESTIONS: 'Too many search questions, only ' + consts.LIMITS.search_inputs_max + '  per project are allowed!',\n        TOO_MANY_TITLES: 'Too many titles',\n        TOO_MANY_QUESTIONS_FOR_CURRENT_FORM: 'Too many questions for this form: ',\n        QUESTION_LENGTH_LIMIT_EXCEEDED: 'Characters limit exceeded'\n    },\n    warning: {\n        POSSIBILE_ANSWER_HAS_LINKED_JUMP: 'There is a jump linked to this answer, please remove it first!',\n        INPUT_DELETED: 'Question deleted!',\n        FORM_DELETED: 'Form deleted!',\n        SEARCH_INPUTS_LIMIT_REACHED: 'Search questions limit reached!'\n    }\n};\n\nmodule.exports = messages;\n","'use strict';\nvar options = {\n    closeButton: true,\n    positionClass: 'toast-top-center',\n    preventDuplicates: true,\n    onclick: null,\n    showDuration: 500,\n    hideDuration: 500,\n    extendedTimeOut: 0,\n    showMethod: 'fadeIn',\n    hideMethod: 'fadeOut'\n};\n\nvar toast = {\n    showSuccess: function (message) {\n        options.timeOut = 2000;\n        window.toastr.options = options;\n        window.toastr.success(message);\n    },\n\n    showError: function (message, timeout) {\n        options.timeOut = timeout || 0;\n        window.toastr.options = options;\n        window.toastr.error(message);\n    },\n\n    showWarning: function (message, timeout) {\n        options.timeOut = timeout || 0;\n        window.toastr.options = options;\n        window.toastr.warning(message);\n    },\n\n    clear: function () {\n        window.toastr.clear();\n    }\n};\n\nmodule.exports = toast;\n\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar input_properties_click_callback = require('ui-handlers/event-handler-callbacks/input-properties-click-callback');\nvar input_properties_focus_callback = require('ui-handlers/event-handler-callbacks/input-properties-focus-callback');\nvar delete_form_click_callback = require('ui-handlers/event-handler-callbacks/delete-form-click-callback');\nvar export_form_click_callback = require('ui-handlers/event-handler-callbacks/export-form-click-callback');\nvar print_as_pdf_click_callback = require('ui-handlers/event-handler-callbacks/print-as-pdf-click-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar input_properties_title_checkbox_callback = require('ui-handlers/event-handler-callbacks/input-properties-title-checkbox-callback');\nvar delete_all_questions_callback = require('ui-handlers/event-handler-callbacks/delete-all-questions-click-callback');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar validation = require('actions/validation');\nvar form;\nvar forms;\n\nvar form_factory = {\n\n    createTabButton: function () {\n\n        //create new tab button, append after latest form tab button\n        var form_tab_button_html = ui.forms_tabs.getFormTabButtonHTML(form);\n        var form_tab_buttons = formbuilder.dom.forms_tabs.find('li.main__tabs__form-btn');\n        form_tab_buttons.eq(form_tab_buttons.length - 1).after(form_tab_button_html);\n    },\n\n    createChildForm: function (the_form_name, the_form_ref, the_form_index, is_creating_new_child_form) {\n\n        var self = this;\n        var deferred = new $.Deferred();\n        form = {};\n        form.name = the_form_name;\n        form.slug = utils.slugify(the_form_name);\n        form.ref = the_form_ref;\n        form.type = consts.FORM_HIERARCHY_TYPE;\n        formbuilder.current_form_index = the_form_index;\n        formbuilder.current_form_ref = form.ref;\n        forms = formbuilder.project_definition.data.project.forms;\n\n        self.createTabButton();\n\n        if (is_creating_new_child_form) {\n            form.inputs = [];\n            formbuilder.project_definition.data.project.forms[the_form_index] = form;\n        }\n        else {\n            //set the form tab button to a valid green check as a parsed from must be valid\n            ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n        }\n\n        //create new tab content\n        $.when(ui.forms_tabs.getFormTabContentHTML(form)).then(function (html) {\n\n            formbuilder.dom.forms_tabs_content.append(html);\n\n            //update formbuilder dom references to point to the new form markup\n            self.updateFormbuilderDomReferences(form.ref);\n\n            //show name of form in tab and inputs collection container, truncating form name (>10) for UI purposes\n            formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n            formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(form.name.trunc(consts.INPUTS_COLLECTION_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)));\n\n            //show empty input question preview\n            ui.input_properties_panel.showInputQuestionPreview('');\n\n            //enable delete form button as the new form will be the last child\n            // (it is possible to delete from the last child up to the first child up to the top form which cannot be deleted)\n            formbuilder.dom.inputs_collection.find('.inputs-collection__buttons .inputs-collection__buttons--remove-form').prop('disabled', false);\n\n            //switch to newly created form/tab when creating a child form only, not when rendering an existing project for editing\n            if (is_creating_new_child_form) {\n\n                formbuilder.dom.forms_tabs.find('li a[href=\"#' + form.ref + '-tabpanel\"]').tab('show');\n\n                //bind event handlers\n                self.bindFormPanelsEvents();\n            }\n\n            deferred.resolve();\n        });\n\n        return deferred.promise();\n    },\n\n    removeForm: function (previous_form_ref, form_ref, form_tab) {\n\n        //delete form from project definition (it is always the last one)\n        formbuilder.project_definition.data.project.forms.pop();\n\n        //remove form markup from dom (a single tabpanel, which has got both the input collection and the inputs properties)\n        formbuilder.dom.forms_tabs_content.find('#' + form_ref + '-tabpanel').remove();\n\n        //remove tab\n        form_tab.remove();\n\n        //set form state to previous\n        formbuilder.current_form_index--;\n\n        //set ref to previous form\n        formbuilder.current_form_ref = previous_form_ref;\n        form_ref = previous_form_ref;\n\n        //update formbuilder dom references to point to the selected form markup\n        form_factory.updateFormbuilderDomReferences(form_ref);\n\n        //enable delete form button for previous form as it becomes the last (aside from fist form)\n        if (formbuilder.current_form_index !== 0) {\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__buttons .inputs-collection__buttons--remove-form')\n                .prop('disabled', false);\n        }\n\n        //show add form button if total is less than max number of forms\n        if (formbuilder.project_definition.data.project.forms.length < consts.MAX_NUMBER_OF_NESTED_CHILD_FORMS) {\n            formbuilder.dom.forms_tabs.find('.main__tabs_add-form').parent().show();\n        }\n\n        //resize form tabs\n        ui.forms_tabs.resizeFormTabs();\n\n\n        //enable save project button if all inputs are valid\n        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n            //console.log('** all good **');\n            //enable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n            formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n        }\n    },\n\n    updateFormbuilderDomReferences: function (the_form_ref) {\n\n        var form_ref = the_form_ref;\n\n        //update formbuilder dom references to point to the currently active form markup\n        formbuilder.dom.input_properties = $('#' + form_ref + '-input-properties.input-properties');\n        formbuilder.dom.input_properties_forms_wrapper = $('#' + form_ref + '-input-properties.input-properties > .panel > .panel-body.input_properties__forms_wrapper');\n        formbuilder.dom.input_properties_buttons = $('#' + form_ref + '-input-properties .input-properties__buttons');\n\n        //todo check this\n        formbuilder.dom.input_properties_no_input_selected = $('.input-properties__no-input-selected');\n\n        formbuilder.dom.inputs_collection = $('#' + form_ref + '-inputs-collection.inputs-collection');\n        formbuilder.dom.inputs_collection_sortable = $('#' + form_ref + '-inputs-collection.inputs-collection .panel .panel-body');\n\n    },\n\n    bindFormPanelsEvents: function () {\n\n        var sortable = require('ui-handlers/sortable');\n        var import_form_click_callback = require('ui-handlers/event-handler-callbacks/import-form-click-callback');\n\n        sortable();\n\n        //attach delegate event to mousedown so we cover both clicks and click hold + drag\n        formbuilder.dom.inputs_collection_sortable.on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n\n        //handle click action on input properties panel in the right sidebar (use event delegation)\n        //todo test this if it is unbinding other events\n        formbuilder.dom.input_properties.off('click').on('click', 'button.btn, .possible_answer-more-action', input_properties_click_callback);\n        //triggered when users focus on a select of the input properties panel\n        formbuilder.dom.input_properties.on('focus', 'select', input_properties_focus_callback);\n\n        //triggered when user wants to delete a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__buttons--remove-form').off('click').on('click', delete_form_click_callback);\n        //formbuilder.dom.inputs_collection.on('click', '.inputs-collection__buttons--remove-form', delete_form_click_callback);\n\n        //triggered when user wants to export a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__export-form').off('click').on('click', function (e) {\n\n            //avoid any action if option in dropdown is disabled\n            if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n                return false\n            }\n\n            export_form_click_callback();\n        });\n\n        //triggered when the user wants to remove all questions at once\n        formbuilder.dom.inputs_collection.on('click', '.inputs-collection__delete-all-questions', function (e) {\n            delete_all_questions_callback();\n        });\n\n        //triggered when user wants to export a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__print-as-pdf').off('click').on('click', function (e) {\n\n            //avoid any action if option in dropdown is disabled\n            if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n                return false\n            }\n            print_as_pdf_click_callback();\n        });\n\n        //triggered when the user wants to import a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__form-import input').off('change').on('change', function () {\n            import_form_click_callback(this.files);\n            $(this).val(null);\n\n        });\n\n        //validate question text/ group or branch header on keyup\n        formbuilder.dom.input_properties.on('keyup', '.input-properties__form__question input', input_properties_keyup_callback);\n\n        //triggered when users check/unckeck title in the input properties panel\n        formbuilder.dom.input_properties.on('change', '.input-properties__form__title-flag input', input_properties_title_checkbox_callback);\n    },\n\n    unbindFormPanelsEvents: function () {\n\n        formbuilder.dom.input_properties.off();\n        formbuilder.dom.inputs_collection.off();\n\n        //destroy sortable only if it is set already (see http://goo.gl/riN4Yk)\n        if (formbuilder.dom.inputs_collection_sortable.data('ui-sortable')) {\n            formbuilder.dom.inputs_collection_sortable.sortable('destroy');//Remove the plugin functionality\n        }\n        formbuilder.dom.inputs_collection_sortable.off();\n    }\n};\n\nmodule.exports = form_factory;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar AudioInput = require('inputs/audio');\nvar BarcodeInput = require('inputs/barcode');\nvar BranchInput = require('inputs/branch');\nvar CheckboxInput = require('inputs/checkbox');\nvar DateInput = require('inputs/date');\nvar DropdownInput = require('inputs/dropdown');\nvar LocationInput = require('inputs/location');\nvar NumericInput = require('inputs/integer');\nvar PhotoInput = require('inputs/photo');\nvar PhoneInput = require('inputs/phone');\nvar RadioInput = require('inputs/radio');\nvar TextInput = require('inputs/text');\nvar TextareaInput = require('inputs/textarea');\nvar ReadmeInput = require('inputs/readme');\nvar TimeInput = require('inputs/time');\nvar VideoInput = require('inputs/video');\nvar GroupInput = require('inputs/group');\nvar SearchInput = require('inputs/search');\nvar formbuilder = require('config/formbuilder');\nvar possible_answers = require('actions/possible-answers');\nvar jumps = require('actions/jumps');\nvar template = require('template');\n\n/**\n * Define an interface for creating an object, but let subclasses decide which class to instantiate.\n * Factory Method lets a class defer instantiation to subclasses.\n */\nvar input_factory = {\n\n    //set default input as type text\n    type: TextInput,\n\n    //create input based on type, set also index unique to each input\n    createInput: function (the_type, the_input_ref) {\n        var type = the_type;\n        var input_ref = the_input_ref;\n\n        switch (type) {\n            case consts.AUDIO_TYPE:\n                this.type = AudioInput;\n                break;\n            case consts.BARCODE_TYPE:\n                this.type = BarcodeInput;\n                break;\n            case consts.BRANCH_TYPE:\n                this.type = BranchInput;\n                break;\n            case consts.CHECKBOX_TYPE:\n                this.type = CheckboxInput;\n                break;\n            case consts.DATE_TYPE:\n                this.type = DateInput;\n                break;\n            case consts.DROPDOWN_TYPE:\n                this.type = DropdownInput;\n                break;\n            case consts.GROUP_TYPE:\n                this.type = GroupInput;\n                break;\n            case consts.LOCATION_TYPE:\n                this.type = LocationInput;\n                break;\n            case consts.INTEGER_TYPE:\n                this.type = NumericInput;\n                break;\n            case consts.DECIMAL_TYPE:\n                this.type = NumericInput;\n                break;\n            case consts.PHONE_TYPE:\n                this.type = PhoneInput;\n                break;\n            case consts.PHOTO_TYPE:\n                this.type = PhotoInput;\n                break;\n            case consts.RADIO_TYPE:\n                this.type = RadioInput;\n                break;\n            case consts.TEXT_TYPE:\n                this.type = TextInput;\n                break;\n            case consts.TEXTAREA_TYPE:\n\n                this.type = TextareaInput;\n                break;\n            case consts.README_TYPE:\n                this.type = ReadmeInput;\n                break;\n            case consts.TIME_TYPE:\n                this.type = TimeInput;\n                break;\n            case consts.VIDEO_TYPE:\n                this.type = VideoInput;\n                break;\n            case consts.SEARCH_SINGLE_TYPE:\n                this.type = SearchInput;\n                break;\n            case consts.SEARCH_MULTIPLE_TYPE:\n                this.type = SearchInput;\n                break;\n        }\n\n        return new this.type(input_ref);\n    },\n\n    //remove input from dom and memory\n    removeInput: function (the_ref) {\n\n        var undo = require('actions/undo');\n        var input_ref = the_ref;\n        var input_index = utils.getInputCurrentIndexByRef(input_ref);\n        var input = utils.getInputObjectByRef(input_ref);\n\n        //remove element from global array in memory\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs.splice(input_index, 1);\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no input is selected, show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //show action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //remove track of this input\n        formbuilder.current_input_ref = undefined;\n        if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    //remove branch input from dom and memory\n    removeBranchInput: function (the_owner_input_ref, the_branch_input_ref) {\n\n        var owner_input_ref = the_owner_input_ref;\n        var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n        var branch_input_ref = the_branch_input_ref;\n        var branch_input_index = utils.getBranchInputCurrentIndexByRef(owner_input_index, branch_input_ref);\n        var form_index = formbuilder.current_form_index;\n        var branch_inputs = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].branch;\n\n        //remove element from global object in memory (and store the removed element for later use)\n        var branch_input = branch_inputs.splice(branch_input_index, 1)[0];\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + branch_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + branch_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no branch input is selected, so show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //hide action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //if branch is empty, show message\n        if (branch_inputs.length === 0) {\n            formbuilder.dom.inputs_collection_sortable.find('.active-branch').find('.input-properties__no-branch-questions-message').show();\n\n            //show invalid icon in active branch\n            ui.inputs_collection.showInputInvalidIcon(formbuilder.branch.active_branch_ref);\n\n            //set the form as invalid\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        }\n\n        //remove track of this input\n        formbuilder.branch.current_input_ref = undefined;\n\n        if (branch_input.type === consts.SEARCH_SINGLE_TYPE || branch_input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            //update search inputs total\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    //remove branch input from dom and memory\n    removeGroupInput: function (the_owner_input_ref, the_group_input_ref) {\n\n        var owner_input_ref = the_owner_input_ref;\n        var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n        var group_input_ref = the_group_input_ref;\n        var group_input_index = utils.getGroupInputCurrentIndexByRef(owner_input_index, group_input_ref);\n        var form_index = formbuilder.current_form_index;\n        var group_inputs = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].group;\n\n        //remove element from global object in memory (and store the removed element for later use)\n        var group_input = group_inputs.splice(group_input_index, 1)[0];\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + group_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + group_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no group input is selected, so show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //hide action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //if group is empty, show message\n        if (group_inputs.length === 0) {\n            formbuilder.dom.inputs_collection_sortable.find('.active-group').find('.input-properties__no-group-questions-message').show();\n\n            //show invalid icon in active branch\n            ui.inputs_collection.showInputInvalidIcon(formbuilder.group.active_group_ref);\n\n            //set the form as invalid\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        }\n\n        //remove track of this input\n        formbuilder.group.current_input_ref = undefined;\n\n        if (group_input.type === consts.SEARCH_SINGLE_TYPE || group_input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    removeNestedGroupInput: function (the_owner_input_branch_ref, the_nested_group_ref) {\n\n        var nested_group_ref = the_nested_group_ref;\n        var form_index = formbuilder.current_form_index;\n        var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n        var owner_branch_index = utils.getBranchInputCurrentIndexByRef(owner_input_index, formbuilder.branch.current_input_ref);\n        var nested_group_index = utils.getNestedGroupInputCurrentIndexByRef(owner_branch, nested_group_ref);\n        var nested_group_inputs = formbuilder.project_definition.data.project\n            .forms[form_index]\n            .inputs[owner_input_index]\n            .branch[owner_branch_index]\n            .group;\n\n        //remove element from global object in memory (and store the removed element for later use)\n        var nested_group_input = nested_group_inputs.splice(nested_group_index, 1)[0];\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + nested_group_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + nested_group_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no group input is selected, so show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //hide action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //if group is empty, show message\n        if (nested_group_inputs.length === 0) {\n            formbuilder.dom.inputs_collection_sortable.find('.active-group').find('.input-properties__no-group-questions-message').show();\n\n            //show invalid icon in active branch\n            ui.inputs_collection.showInputInvalidIcon(formbuilder.group.active_group_ref);\n\n            //set the form as invalid\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        }\n\n        //remove track of this input\n        formbuilder.group.current_input_ref = undefined;\n\n        if (nested_group_input.type === consts.SEARCH_SINGLE_TYPE || nested_group_input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    //todo this is a bit of code duplication, to be refactored\n    showGroupInputPropertiesDom: function (the_group_input_index) {\n\n        var form_index = formbuilder.current_form_index;\n        var owner_input_ref = formbuilder.current_input_ref;\n        var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n        var group_input_index = the_group_input_index;\n        var group_input = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].group[group_input_index];\n        var input_properties_forms_wrapper = formbuilder.dom.input_properties_forms_wrapper;\n        var view = formbuilder.dom.input_properties_views[group_input.type];\n\n        input_properties_forms_wrapper.append(view).hide().fadeIn(consts.ANIMATION_FAST);\n\n        //init properties panel\n        //todo\n        //helpers.initInputPropertiesPanel(input_properties_forms_wrapper, group_input, formbuilder.dom.partials);\n    },\n\n    //todo this is a bit of code duplication, to be refactored\n    showNestedGroupInputPropertiesDom: function (the_nested_group_input_index) {\n\n\n        console.log(formbuilder.project_definition.data.project.forms);\n\n        var form_index = formbuilder.current_form_index;\n        var branch_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var group_index = utils.getBranchInputCurrentIndexByRef(branch_index, formbuilder.group.active_group_ref);\n        var nested_group_index = the_nested_group_input_index;\n        var nested_group_input = formbuilder.project_definition.data.project\n            .forms[form_index]\n            .inputs[branch_index]\n            .branch[group_index]\n            .group[nested_group_index];\n\n        var input_properties_forms_wrapper = formbuilder.dom.input_properties_forms_wrapper;\n        var view = formbuilder.dom.input_properties_views[nested_group_input.type];\n\n        input_properties_forms_wrapper.append(view).hide().fadeIn(consts.ANIMATION_FAST);\n\n    },\n\n    createInputToolHTML: function (input) {\n        return template.createInputToolHTML(input);\n    },\n\n    createPropertiesHTML: function (input) {\n        return template.createPropertiesHTML(input);\n    },\n    getAdvancedTabBtnHTML: function (ref, is_active) {\n        return template.getAdvancedTabBtnHTML(ref, is_active);\n    },\n    getJumpTabBtnHTML: function (ref, is_active) {\n        return template.getJumpTabBtnHTML(ref, is_active);\n    }\n};\n\nmodule.exports = input_factory;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar template = require('template');\n\nvar InputMultipleAnswers = function () {\n};\n\nInputMultipleAnswers.prototype.prepareAdvancedInputProperties = function (view) {\n    return template.prepareAdvancedInputProperties(view, this);\n};\n\nInputMultipleAnswers.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    this.dom.advanced_properties_wrapper\n        .find('div.panel-body div.input-properties__form__advanced-properties__default select option[value=\"' + this.default + '\"]').prop('selected', true);\n\n    //set 'input_ref' on 'uniqueness' option\n    //  ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n\n};\n\nInputMultipleAnswers.prototype.saveAdvancedProperties = function () {\n\n    var self = this;\n\n    self.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n    //set default\n    this.default = this.dom.advanced_properties_wrapper\n        .find('div.panel-body div.input-properties__form__advanced-properties__default select option:selected')\n        .val();\n\n    if (this.default === 'None') {\n        this.default = null;\n    }\n\n    //for SEARCH type, save if the search allow a single answer or multiple answers\n    if (self.type === consts.SEARCH_SINGLE_TYPE || self.type === consts.SEARCH_MULTIPLE_TYPE) {\n\n        //set single or multiple search type\n        self.type = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__search input:checked').val();\n    }\n\n};\n\nInputMultipleAnswers.prototype.hidePropertiesErrors = function () {\n    errors.hidePropertiesErrors(this.dom.properties_panel);\n    errors.hidePossibleAnswersErrors(this);\n};\n\nInputMultipleAnswers.prototype.addPossibleAnswer = function () {\n    possible_answers.addPossibleAnswer(this);\n};\n\nInputMultipleAnswers.prototype.removePossibleAnswer = function (the_answer_index) {\n    possible_answers.removePossibleAnswer(this, the_answer_index);\n};\n\n\nInputMultipleAnswers.prototype.savePossibleAnswers = function () {\n    save.savePossibleAnswers(this);\n};\nInputMultipleAnswers.prototype.showPossibleAnswerErrors = function (the_possible_answer, the_error_message) {\n    errors.showPossibleAnswerErrors(the_possible_answer, the_error_message);\n};\nInputMultipleAnswers.prototype.hidePossibleAnswersErrors = function (the_possible_answers) {\n    errors.hidePossibleAnswersErrors(this, the_possible_answers);\n};\nInputMultipleAnswers.prototype.isPossibleAnswerValid = function (the_answer) {\n    //validate possible answer\n    return validation.isPossibleAnswerValid(the_answer);\n};\n\n/*\n update the selected possible answers for the jumps, in case the possible answers got changed by the user\n this is to refresh the dom when the user change a possible answer text and then switches to the jumps panel:\n if an old option was selected, we reflect that change on the dom\n */\nInputMultipleAnswers.prototype.updateJumpPossibleAnswers = function (the_jump_panel) {\n    possible_answers.updateJumpPossibleAnswers(this, the_jump_panel);\n};\n\nInputMultipleAnswers.prototype.updatePossibleInitialAnswers = function () {\n    possible_answers.updatePossibleInitialAnswers(this);\n};\n\nInputMultipleAnswers.prototype.listPossibleInitialAnswers = function () {\n    possible_answers.listPossibleInitialAnswers(this);\n};\n\nInputMultipleAnswers.prototype.addJump = function () {\n\n    var self = this;\n\n    //set \"Add Jump\" button reference (so it is available when playing with jumps)\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    $.when(jumps.addJump(self, true)).then(function () {\n\n        //disable add jump button if total of jumps is equal to total of possible answers\n        if (self.jumps.length === self.possible_answers.length) {\n            self.dom.add_jump_button.attr('disabled', true);\n        }\n    });\n};\n\n//override the existing method, as we need an extra check for these types of input\nInputMultipleAnswers.prototype.removeJump = function (the_remove_btn) {\n\n    var self = this;\n\n    //set \"Add Jump\" button reference (so it is available when playing with jumps)\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    jumps.removeJump(self, the_remove_btn);\n\n    //enable button if we removed last jump\n    if (self.jumps.length === 0) {\n        //enable add jump button\n        self.dom.add_jump_button.attr('disabled', false);\n    }\n    else {\n        //enable button if we can add jumps\n        if (self.jumps.length < self.possible_answers.length) {\n            self.dom.add_jump_button.attr('disabled', false);\n        }\n    }\n};\n\nmodule.exports = InputMultipleAnswers;\n","'use strict';\n\n//input base properties\nvar inputs_properties = {\n\n    //top level, to be exported when saving project\n   // index: null,\n    ref: null,\n    type: '',\n    question: '',\n    is_title: false,\n    is_required: false,\n    uniqueness: 'none',\n    regex: null,\n    default: null,\n    verify: false,\n    max: null,\n    min: null,\n    datetime_format: null,\n    set_to_current_datetime: false,\n    possible_answers: [],\n    jumps: [],\n    branch: [],\n    group: []\n\n    /**************************************************************************************************************/\n    //this property is not declared here anymore as with jquery the dom is cached and stays the same per each object,\n    //so I will add them later after the object is instantiated\n    ///* DOM properties*/\n    //dom: {\n    //    is_valid: false, //false by default as we sdo not have a question text after drag and drop\n    //    advanced_properties_wrapper: null,\n    //    add_jump_button: null,\n    //    properties_panel:null\n    //}\n    /**************************************************************************************************************/\n};\n\nmodule.exports = inputs_properties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar template = require('template');\n\n\nvar Input = function () {\n};\n\nInput.prototype.prepareAdvancedInputProperties = function () {\n    //override in specific input type\n};\n\nInput.prototype.isQuestionTextValid = function () {\n    //validate question text\n    return validation.isQuestionTextValid(this);\n};\n\nInput.prototype.hideQuestionErrors = function () {\n    this.hidePropertiesErrors();\n};\nInput.prototype.showQuestionErrors = function (the_error_message) {\n    this.showPropertiesErrors(the_error_message);\n};\n\nInput.prototype.isInitialAnswerValid = function () {\n    //validate initial answer\n    return validation.isInitialAnswerValid(this.type, this.default, this.regex);\n};\n\nInput.prototype.isJumpValid = function (the_jump_properties) {\n    //validate initial answer\n    return validation.isJumpValid(the_jump_properties, this);\n};\n\nInput.prototype.saveProperties = function () {\n    save.saveProperties(this);\n};\n\nInput.prototype.saveAdvancedProperties = function () {\n    save.saveAdvancedProperties(this);\n};\n\nInput.prototype.saveJumps = function () {\n    save.saveJumps(this);\n};\n\nInput.prototype.showPropertiesErrors = function (the_error_message) {\n    errors.showQuestionTextErrors(this.dom.properties_panel, the_error_message);\n};\n\nInput.prototype.hidePropertiesErrors = function () {\n    errors.hidePropertiesErrors(this.dom.properties_panel);\n};\n\nInput.prototype.showAdvancedPropertiesErrors = function (the_invalid_property, the_error_message) {\n    errors.showSingleAdvancedPropertyError(this.dom.advanced_properties_wrapper, the_invalid_property, the_error_message);\n};\n\nInput.prototype.hideAdvancedPropertiesErrors = function () {\n    //override in specific input type\n};\n\nInput.prototype.addJump = function () {\n\n    var self = this;\n\n    //set \"Add Jump\" button reference (so it is available when playing with jumps)\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    $.when(jumps.addJump(this)).then(function () {\n        //disable add jump button as this input type only allows to set a single jump\n        self.dom.add_jump_button.attr('disabled', true);\n    });\n};\n\nInput.prototype.removeJump = function (the_remove_btn) {\n\n    var self = this;\n\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    jumps.removeJump(this, the_remove_btn);\n\n    if (this.jumps.length === 0) {\n        //enable add jump button\n        this.dom.add_jump_button.attr('disabled', false);\n    }\n};\n\nInput.prototype.showSingleJumpErrors = function (the_jump_item, the_jump_properties) {\n    errors.showSingleJumpErrors(the_jump_item, the_jump_properties);\n};\nInput.prototype.hideJumpsErrors = function (the_jumps_list) {\n    errors.hideJumpsErrors(the_jumps_list);\n};\n\nmodule.exports = Input;\n","'use strict';\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar valid_date_formats = [\n    consts.DATE_FORMAT_1,\n    consts.DATE_FORMAT_2,\n    consts.DATE_FORMAT_3,\n    consts.DATE_FORMAT_4,\n    consts.DATE_FORMAT_5\n];\n\nvar valid_time_formats = [\n    consts.TIME_FORMAT_1,\n    consts.TIME_FORMAT_2,\n    consts.TIME_FORMAT_3,\n    consts.TIME_FORMAT_4,\n    consts.TIME_FORMAT_5\n];\n\nvar import_form_validation = {\n\n    hasValidFormStructure: function (form) {\n\n        var validFormStructure = {\n            data: {\n                id: '',\n                type: 'form',\n                form: {\n                    ref: '',\n                    name: '',\n                    slug: '',\n                    type: 'hierarchy',\n                    inputs: []\n                }\n            }\n        };\n\n        //compare a valid object against the imported form object if they have the same keys\n        if (!utils.hasSameProps(validFormStructure, form)) {\n            return false;\n        }\n\n        //data type must be form\n        if (form.data.type !== 'form') {\n            return false;\n        }\n\n        //form type must be hierarchy\n        if (form.data.form.type !== 'hierarchy') {\n            return false;\n        }\n\n        //ref, name, slug and inputs props are not considered here\n        return true;\n    },\n\n    areJumpsValid: function (input) {\n\n        var jumps = input.jumps;\n        var are_valid = true;\n        var possible_answers = input.possible_answers;\n        var validJumpStructure = {\n            to: '',\n            when: '',\n            answer_ref: ''\n        };\n\n        var answer_ref_regex = new RegExp(consts.REGEX.possible_answer_ref);\n\n        if (!$.isArray(jumps)) {\n            are_valid = false;\n        }\n        else {\n            $(jumps).each(function (index, jump) {\n\n                var answer_ref_found = false;\n\n                //validate structure\n                if (!utils.hasSameProps(validJumpStructure, jump)) {\n                    are_valid = false;\n                    return false;\n                }\n\n                //if answer_ref is in invalid format, bail out (can be null, we catch that later)\n                if (jump.answer_ref) {\n                    if (!answer_ref_regex.test(jump.answer_ref)) {\n                        are_valid = false;\n                        return false;\n                    }\n                }\n\n                //validate jumps properties values\n                if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n                    // multiple choice input\n                    //jump \"to\" value must be an existing \"forward\" input_ref\n                    //todo need next inputs\n\n                    //jump \"to\" must exist in possible answers (it is the answer_ref)\n                    // only if \"when\" is not either ALL or NO_ANSWER_GIVEN\n                    if (!(jump.when === 'ALL' || jump.when === 'NO_ANSWER_GIVEN')) {\n                        $(possible_answers).each(function (index, possible_answer) {\n                            if (jump.answer_ref === possible_answer.answer_ref) {\n                                answer_ref_found = true;\n                            }\n                        });\n\n                        if (!answer_ref_found) {\n                            are_valid = false;\n                            return false;\n                        }\n                    }\n                }\n                else {\n                    //single question, jump \"when\" must be set to ALL\n                    if (jump.when !== 'ALL') {\n                        are_valid = false;\n                        return false;\n                    }\n                }\n\n                // If we have an empty 'to' - error\n                // If we have an empty 'when' - error\n                // If we have an empty 'answer_ref' and 'when' is not 'ALL' or 'NO_ANSWER_GIVEN' - error\n                if (!jump.to || !jump.when ||\n                    (!jump.answer_ref && !(jump.when === 'ALL' || jump.when === 'NO_ANSWER_GIVEN'))\n                ) {\n                    are_valid = false;\n                    return false;\n                }\n\n                //validate \"when\" prop, must be one of the jump conditions\n                var isValidWhenProperty = false;\n                $(consts.JUMP_CONDITIONS).each(function (index, condition) {\n                    if (condition.key === jump.when) {\n                        isValidWhenProperty = true;\n                        return false;\n                    }\n                });\n                if (!isValidWhenProperty) {\n                    are_valid = false;\n                    return false;\n                }\n\n            });\n        }\n\n        return are_valid;\n    },\n\n    areJumpsDestinationsValid: function (inputs) {\n\n        var all_jumps_valid = true;\n\n        $(inputs).each(function (inputIndex, input) {\n\n            //get valid jump destinations\n            var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, inputs, false);\n\n            //extra validation for jumps, check if the destination still exists and it is valid\n            $(input.jumps).each(function (jumpIndex, jump) {\n                //does the jump \"to\" property reference a valid destination input?\n                if (!jump_destinations[jump.to]) {\n                    //invalid destination found\n                    all_jumps_valid = false;\n                }\n            });\n\n            //validate branch jumps\n            $(input.branch).each(function (branchInputIndex, branch_input) {\n\n                jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n                //extra validation for jumps, check if the destination still exists and it is valid\n                $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                    //does the jump \"to\" property reference a valid destination input?\n                    if (!jump_destinations[branchJump.to]) {\n                        //invalid destination found\n                        all_jumps_valid = false;\n                    }\n                });\n            });\n        });\n\n        return all_jumps_valid;\n    },\n\n    arePossibleAnswersValid: function (possible_answers, input_type) {\n\n        var answer_ref_regex = new RegExp(consts.REGEX.possible_answer_ref);\n        var answer_refs = [];\n        var validPossibleAnswerStructure = {\n            answer: '',\n            answer_ref: ''//this must be unique\n        };\n\n        if (!$.isArray(possible_answers)) {\n            return false;\n        }\n        else {\n            //check possible answer total is within limits\n            if (possible_answers.length > consts.LIMITS.possible_answers_max) {\n                //is this a search type?\n                if (input_type === consts.SEARCH_MULTIPLE_TYPE || input_type === consts.SEARCH_SINGLE_TYPE) {\n                    //limit is higher for search type\n                    if (possible_answers.length > consts.LIMITS.possible_answers_max_search) {\n                        return false;\n                    }\n                }\n                else {\n                    return false;\n                }\n\n            }\n\n            //at least 1 possible answer\n            if (possible_answers.length === 0) {\n                return false;\n            }\n\n            //check possible answer structure\n            var are_possible_answer_valid = true;\n            $(possible_answers).each(function (key, possible_answer) {\n\n                answer_refs.push(possible_answer.answer_ref);\n\n                if (typeof possible_answer.answer_ref !== 'string' || typeof possible_answer.answer !== 'string') {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //check answer_ref length\n                if (possible_answer.answer_ref.length !== consts.LIMITS.possible_answer_ref_length) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //check answer_ref to be hex characters\n                if (!answer_ref_regex.test(possible_answer.answer_ref)) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //check answer max length\n                if (possible_answer.answer.length === 0 || possible_answer.answer.length > consts.LIMITS.possible_answer_max_length) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //possible_answer cannot be empty\n                if (possible_answer.answer === '') {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //strip html tags from possible answers answer prop\n                possible_answer.answer = possible_answer.answer.replace(/(<([^>]+)>)/ig, ' ');\n\n                if (!utils.hasSameProps(validPossibleAnswerStructure, possible_answer)) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                ////check for answer_ref uniqueness\n                ////note: this has bad performance with big arrays\n                //var hasDuplicateAnswerRef = answer_refs.some(function (ref, index) {\n                //    return answer_refs.indexOf(ref) !== index;\n                //});\n                var seen = {}; // Create an object to keep track of encountered answer_refs\n                var hasDuplicateAnswerRef = possible_answers.some(function (possible_answer) {\n                    if (seen[possible_answer.answer_ref]) {\n                        return true; // If it's already in 'seen', we have a duplicate\n                    } else {\n                        seen[possible_answer.answer_ref] = true; // Mark it as seen\n                        return false;\n                    }\n                });\n\n                if (hasDuplicateAnswerRef) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n            });\n\n            if (!are_possible_answer_valid) {\n                return false;\n            }\n        }\n\n        return true;\n    },\n\n    isValidInput: function (form_ref, input, is_branch, is_group) {\n\n        var self = this;\n        var valid = true;\n        var input_ref_regex = new RegExp(consts.REGEX.input_ref);\n        var readme = '';\n\n        var validInputStructure = {\n            ref: '',\n            type: '',\n            question: '',\n            is_title: true,\n            is_required: false,\n            uniqueness: '',\n            regex: null,\n            default: null,\n            verify: false,\n            max: null,\n            min: null,\n            datetime_format: null,\n            set_to_current_datetime: false,\n            possible_answers: [],\n            jumps: [],\n            branch: [],\n            group: []\n        };\n\n        var accepted_types = [\n            consts.TEXT_TYPE,\n            consts.TEXTAREA_TYPE,\n            consts.INTEGER_TYPE,\n            consts.DECIMAL_TYPE,\n            consts.DATE_TYPE,\n            consts.TIME_TYPE,\n            consts.RADIO_TYPE,\n            consts.CHECKBOX_TYPE,\n            consts.DROPDOWN_TYPE,\n            consts.BARCODE_TYPE,\n            consts.LOCATION_TYPE,\n            consts.AUDIO_TYPE,\n            consts.VIDEO_TYPE,\n            consts.PHOTO_TYPE,\n            consts.BRANCH_TYPE,\n            consts.GROUP_TYPE,\n            consts.README_TYPE,\n            consts.PHONE_TYPE,\n            consts.SEARCH_SINGLE_TYPE,\n            consts.SEARCH_MULTIPLE_TYPE\n        ];\n\n        /**\n         * Validate input structure\n         */\n\n        if (!utils.hasSameProps(validInputStructure, input)) {\n            //it means the input structure is invalid\n            return false;\n        }\n\n        /**\n         * Validate ref\n         */\n        if (input.ref && typeof input.ref !== 'boolean') {\n            if (!input.ref.startsWith(form_ref)) {\n                return false;\n            }\n            //check ref structure\n            if (!input_ref_regex.test(input.ref)) {\n                return false;\n            }\n\n            // must have 3 components\n            if (input.ref.split('_').length !== 3) {\n                return false;\n            }\n        }\n        else {\n            return false;\n        }\n\n        //validate ref against regex\n        //(todo)\n\n        /**\n         * Validate type\n         */\n        if ($.inArray(input.type, accepted_types) < 0 || typeof input.type !== 'string') {\n            return false;\n        }\n\n        /**\n         * Validate question\n         */\n        if (input.type === consts.README_TYPE) {\n            //readme type is up to 1000 chars, html is allowed (server catches was it is not)\n            if (typeof input.question !== 'string' || input.question === '') {\n                return false;\n            }\n\n            //first convert html entities to tags\n            readme = utils.decodeHtml(input.question);\n            //then remove all tags\n            readme = readme.replace(/(<([^>]+)>)/ig, ' ');\n\n            //now check the lenght of the remaining pure text ;)\n            if (readme.length > consts.LIMITS.readme_length) {\n                return false;\n            }\n        }\n        else {\n            //any other question\n            if (input.question.length > consts.LIMITS.question_length || typeof input.question !== 'string' || input.question === '') {\n                return false;\n            }\n            else {\n                input.question = input.question.replace(/(<([^>]+)>)/ig, ' ');\n            }\n        }\n\n\n        /**\n         * Validate is_title\n         */\n\n        if (typeof input.is_title !== 'boolean') {\n            return false;\n        }\n\n        /**\n         *  Validate is_required\n         */\n        if (typeof input.is_required !== 'boolean') {\n            return false;\n        }\n        else {\n            //check if we can have required set to true\n            if ($.inArray(input.type, consts.REQUIRED_ALLOWED_TYPES) < 0 && input.is_required === true) {\n                return false;\n            }\n        }\n\n        /**\n         * Validate uniqueness\n         */\n        if ($.inArray(input.type, consts.UNIQUENESS_ALLOWED_TYPES) < 0) {\n            //uniquess must be \"none\"\n            if (input.uniqueness !== consts.UNIQUESS_NONE) {\n                return false;\n            }\n        }\n        else {\n            if (is_branch) {\n                if (!(input.uniqueness === consts.UNIQUESS_NONE || input.uniqueness == consts.UNIQUESS_FORM)) {\n                    return false;\n                }\n            }\n            else {\n                if (!(input.uniqueness === consts.UNIQUESS_NONE || input.uniqueness === consts.UNIQUESS_FORM || input.uniqueness == consts.UNIQUESS_HIERARCHY)) {\n                    return false;\n                }\n            }\n        }\n\n        /**\n         * Validate regex (can be null)\n         */\n        if (input.regex !== null && input.regex !== '') {\n            if (input.regex.length > consts.LIMITS.regex_length || typeof input.regex !== 'string') {\n                return false;\n            }\n        }\n        else {\n            //check if a regex is allowed for this input type?\n            //todo\n\n        }\n\n        /**\n         * Validate default answer\n         */\n        if (input.default !== null && input.default !== '') {\n            if (input.default.length > consts.LIMITS.default_answer_length || typeof input.default !== 'string') {\n                return false;\n            }\n\n            //multiple answers type?\n            if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n                //check that the default answer (if set) is one of the possible answers\n                var found = false;\n                $(input.possible_answers).each(function (key, possible_answer) {\n                    if (possible_answer.answer_ref === input.default) {\n                        found = true;\n                        return false;//exit the loop\n                    }\n                });\n\n                if (!found) {\n                    return false;\n                }\n            }\n            else {\n                //valid default answer, strip html tags\n                input.default = input.default.replace(/(<([^>]+)>)/ig, ' ');\n            }\n        }\n\n        /**\n         * Validate verify\n         */\n        if (typeof input.verify !== 'boolean') {\n            return false;\n        }\n\n\n        /**\n         * validate max and min (for numeric types)\n         */\n        if (input.type === consts.INTEGER_TYPE || input.type === consts.DECIMAL_TYPE) {\n            //check min, if it is set must be numeric. can be null\n            if (input.min) {\n\n                if (input.type === consts.INTEGER_TYPE && !utils.isInteger(parseInt(input.min))) {\n                    return false;\n                }\n\n                if (input.type === consts.DECIMAL_TYPE && !$.isNumeric(input.min)) {\n                    return false;\n                }\n\n                if (input.min.toString().length > consts.LIMITS.min_value_length) {\n                    return false;\n                }\n\n            }\n\n            //check min, if it is set must be numeric. can be null\n            if (input.max) {\n\n                //bail if not integer for integer type\n                if (input.type === consts.INTEGER_TYPE && !utils.isInteger(parseInt(input.max))) {\n                    return false;\n                }\n\n                //bail if not numeric for decimal type\n                if (input.type === consts.DECIMAL_TYPE && !$.isNumeric(input.max)) {\n                    return false;\n                }\n\n                if (input.max.toString().length > consts.LIMITS.max_value_length) {\n                    return false;\n                }\n            }\n\n            //if they are both set, check min < max\n            if (input.min && input.max) {\n\n                if (input.type === consts.INTEGER_TYPE) {\n                    if (parseInt(input.min, 10) >= parseInt(input.max, 10)) {\n                        return false;\n                    }\n                }\n\n                if (input.type === consts.DECIMAL_TYPE) {\n                    if (parseFloat(input.min, 10) >= parseFloat(input.max, 10)) {\n                        return false;\n                    }\n                }\n            }\n        }\n\n        /**\n         * Validate date format\n         */\n\n        //date\n        if (input.type === consts.DATE_TYPE) {\n            if (input.datetime_format) {\n                if ($.inArray(input.datetime_format, valid_date_formats) < 0) {\n                    //format not allowed\n                    return false;\n                }\n            }\n        }\n\n        //time\n        if (input.type === consts.TIME_TYPE) {\n            if (input.datetime_format) {\n                if ($.inArray(input.datetime_format, valid_time_formats) < 0) {\n                    //format not allowed\n                    return false;\n                }\n            }\n        }\n\n        /**\n         * Validate set_to_current_datetime\n         */\n        if (input.set_to_current_datetime) {\n            if (typeof input.set_to_current_datetime !== 'boolean') {\n                return false;\n            }\n\n            //it can be true only for date and time input types\n            if (input.set_to_current_datetime === true) {\n                if (!(input.type === consts.DATE_TYPE || input.type === consts.TIME_TYPE)) {\n                    return false;\n                }\n            }\n        }\n\n        /**\n         * Validate possible answers\n         */\n        if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n            if (!self.arePossibleAnswersValid(input.possible_answers, input.type)) {\n                return false;\n            }\n        }\n\n        if (!is_branch && !is_group) {\n            /**\n             * Validate jumps\n             */\n            if (!self.areJumpsValid(input)) {\n                return false;\n            }\n\n\n            //top level input, validate branch and group recursively\n\n            //branch\n            if ($.isArray(input.branch)) {\n                $(input.branch).each(function (index, branch_input) {\n                    self.isValidInput(form_ref, branch_input, true, false);\n                });\n            }\n            else {\n                return false;\n            }\n\n            //group\n            if ($.isArray(input.group)) {\n                $(input.group).each(function (index, group_input) {\n                    self.isValidInput(form_ref, group_input, false, true);\n                });\n            }\n            else {\n                return false;\n            }\n\n        }\n        else {\n\n            if (is_branch) {\n                //branch in branch is not allowed\n                if (input.branch.length > 0) {\n                    return false;\n                }\n\n                /**\n                 * Validate jumps\n                 */\n                if (!self.areJumpsValid(input.branch)) {\n                    return false;\n                }\n            }\n\n            if (is_group) {\n                //group in group is not allowed\n                if (input.group.length > 0) {\n                    return false;\n                }\n\n                //jumps in group are not allowed\n                if (input.jumps.length > 0) {\n                    return false;\n                }\n            }\n        }\n        return valid;\n    }\n\n};\n\n\nmodule.exports = import_form_validation;\n","'use strict';\n\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\nvar consts = require('config/consts');\nvar jumps = require('actions/jumps');\nvar utils = require('helpers/utils');\nvar load_child_form_containers = require('loaders/load-child-form-containers');\n\nvar ui = {\n\n    navbar: {\n\n        toggleUndoBtn: function (status) {\n\n            if (status === consts.BTN_DISABLED) {\n                //toggle button\n                formbuilder.dom.undo_btn\n                    .attr('disabled', true);\n            }\n\n            if (status === consts.BTN_ENABLED) {\n                //toggle button\n                formbuilder.dom.undo_btn\n                    .attr('disabled', false);\n            }\n        },\n\n        toggleSaveProjectBtn: function (status) {\n\n            if (status === consts.BTN_DISABLED) {\n                //toggle button\n                formbuilder.dom.save_project_btn\n                    .attr('disabled', true);\n\n            }\n\n            if (status === consts.BTN_ENABLED) {\n                //toggle button\n                formbuilder.dom.save_project_btn\n                    .attr('disabled', false);\n            }\n\n            //toggle icon\n            if (status === consts.BTN_ENABLED) {\n                formbuilder\n                    .dom.save_project_btn\n                    .find('.project-state')\n                    .removeClass('fa-warning')\n                    .addClass('fa-check');\n            }\n            else {\n                formbuilder\n                    .dom.save_project_btn\n                    .find('.project-state')\n                    .addClass('fa-warning')\n                    .removeClass('fa-check');\n            }\n        }\n    },\n    forms_tabs: {\n\n        injectRefIntoFormTab: function (ref) {\n\n            var tab_button = $('.main .main__tabs li').first();\n            var tab_panel = $('.main .main__tabs-content .main__tabs-content-tabpanel').first();\n\n            //inject ref of the first form to the fist tab/tab content, as it is shown by default\n            tab_button.find('a').attr('href', '#' + ref + '-tabpanel');\n            tab_panel.first().attr('id', ref + '-tabpanel');\n            tab_panel.find('.inputs-collection').attr('id', ref + '-inputs-collection');\n            tab_panel.find('.input-properties').attr('id', ref + '-input-properties');\n\n        },\n\n        toggleFormTabsButtons: function (option) {\n\n            if (option.enable) {\n                //enable form tab buttons\n                formbuilder.dom.forms_tabs.find('li')\n                    .not('.main__tabs-btns')\n                    .each(function (index, item) {\n                        $(item).removeClass('disabled disabled-tab');\n                    });\n            }\n            else {\n                //disable form tab buttons\n                formbuilder.dom.forms_tabs.find('li')\n                    .not('.main__tabs-btns')\n                    .each(function (index, item) {\n                        $(item).addClass('disabled disabled-tab');\n                    });\n            }\n        },\n\n        setFirstFormTabName: function (the_form_name) {\n\n            var forms = formbuilder.project_definition.data.project.forms;\n\n            formbuilder.dom.forms_tabs\n                .find('.active a[data-form-index=\"0\"]')\n                .text(the_form_name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)))\n                .append('&nbsp;<i class=\"form-state fa fa-exclamation-triangle\"></i>');\n        },\n\n\n        //if the form is valid show a green check on its tab button\n        showFormValidIcon: function (the_form_index) {\n            formbuilder.dom.forms_tabs\n                .find('li a[data-form-index=' + the_form_index + '] i.form-state')\n                .removeClass('fa-exclamation-triangle').addClass('fa-check');\n        },\n\n        //if the form is NOT valid show a warning icon on its tab button\n        showFormInvalidIcon: function (the_form_index) {\n            formbuilder.dom.forms_tabs\n                .find('li a[data-form-index=' + the_form_index + '] i.form-state')\n                .removeClass('fa-check').addClass('fa-exclamation-triangle');\n        },\n\n        //return the markup for a form tab button, showing form name\n        getFormTabButtonHTML: function (form) {\n\n            var html = '';\n            var form_index = formbuilder.current_form_index;\n            var forms = formbuilder.project_definition.data.project.forms;\n\n            html += '<li role=\"presentation\" class=\"main__tabs__form-btn\">';\n            html += '<a href=\"#' + form.ref + '-tabpanel\" role=\"tab\" data-toggle=\"tab\" data-form-index=\"' + form_index + '\">';\n            html += form.name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2));\n            html += '&nbsp;<i class=\"form-state fa fa-exclamation-triangle\"></i>';\n            html += '</a>';\n            html += '</li>';\n\n            return html;\n        },\n\n        //get markup for a form tab content (input collection + input properties)\n        getFormTabContentHTML: function (form) {\n\n            var html = '';\n\n            var deferred = new $.Deferred();\n\n            $.when(load_child_form_containers()).then(function (views) {\n\n                html += '<div role=\"tabpanel\" class=\"main__tabs-content-tabpanel tab-pane fade in active\" id=\"' + form.ref + '-tabpanel\">';\n                html += '<div id=\"' + form.ref + '-inputs-collection\" class=\"inputs-collection col-md-6\">';\n                html += views.inputs_collection;\n                html += '</div>';\n                html += '<div id=\"' + form.ref + '-input-properties\" class=\"input-properties col-md-6\">';\n                html += views.inputs_properties;\n                html += '</div>';\n                html += '</div>';\n\n                deferred.resolve(html);\n            });\n\n            return deferred.promise();\n        },\n\n        resizeFormTabs: function () {\n\n            var forms = formbuilder.project_definition.data.project.forms;\n\n\n            formbuilder.dom.forms_tabs\n                .find('li:lt(' + forms.length + ')').each(function (index, form_btn) {\n\n                    var state = $(form_btn).find('a i').hasClass('fa-check');\n                    var btn = $(form_btn).find('a');\n                    var valid_icon_html = '&nbsp;<i class=\"form-state fa fa-check\"></i>';\n                    var invalid_icon_html = '&nbsp;<i class=\"form-state fa fa-exclamation-triangle\"></i>';\n\n                    btn.text(forms[index].name\n                        .trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)));\n                    btn.append(state ? valid_icon_html : invalid_icon_html);\n                });\n        }\n    },\n    inputs_collection: {\n\n        //show/hide the title not set warning message\n        toggleTitleWarning: function (count, is_branch) {\n\n            //find warning for either the active form or the active branch\n            var element_to_find = is_branch ? '.active-branch .no-branch-title-set' : '.no-form-title-set';\n\n            if (count === 0) {\n                //show\n                formbuilder.dom.inputs_collection_sortable.find(element_to_find).removeClass('hidden').animate({\n                    opacity: 1,\n                    height: 37\n                }, consts.ANIMATION_FAST);\n            }\n            else {\n                //hide\n                formbuilder.dom.inputs_collection_sortable.find(element_to_find).animate({\n                    opacity: 0,\n                    height: 0\n                }, consts.ANIMATION_FAST, function () {\n                    $(this).addClass('hidden');\n                });\n            }\n        },\n\n        getInputStateIconsHTML: function () {\n\n            var html = '';\n            html += '<i class=\"question-state fa fa-exclamation-triangle fa-2x fa-fw pull-right\"></i>';\n            html += '<i class=\"jump-state fa fa-arrow-circle-o-down fa-2x fa-fw pull-right invisible\"></i>';\n\n            return html;\n        },\n\n        showInputValidIcon: function (the_ref) {\n            formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + the_ref + '\"] i.question-state')\n                .first()\n                .removeClass('fa-exclamation-triangle').addClass('fa-check');\n        },\n\n        showInputInvalidIcon: function (the_ref) {\n            formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + the_ref + '\"] i.question-state')\n                .first()\n                .removeClass('fa-check').addClass('fa-exclamation-triangle');\n        },\n\n        showInputQuestionPreview: function (the_ref, the_question) {\n            formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + the_ref + '\"] > .input-inner > .question-preview')\n                .text(the_question.trunc(50));\n        },\n        toggleFormActionButtons: function (the_state) {\n            var buttons = formbuilder.dom.inputs_collection\n                .find('.inputs-collection__buttons')\n                .find('.btn');\n\n            if (the_state) {\n                buttons.attr('disabled', false).show();\n            }\n            else {\n                buttons.attr('disabled', true).hide();\n            }\n        },\n        getEmptyCollectionSortableHTML: function (type) {\n\n            var html = '';\n\n            html += '<div class=\"' + type + '-sortable hidden\">';\n            //no title set warning (only for branch type)\n            if (type === consts.BRANCH_TYPE) {\n                html += '<div class=\"warning-well no-branch-title-set hidden\">No title set for this branch yet ';\n                html += '<i class=\"fa fa-question-circle fa-2x fa-fw\" data-toggle=\"modal\" data-target=\"#info-title\">';\n                html += '</i>';\n                html += '</div>';\n            }\n            //no inputs yet message\n            html += '<span class=\"input-properties__no-' + type + '-questions-message\" style=\"display: none;\">';\n            html += type === consts.BRANCH_TYPE ? messages.labels.ADD_BRANCH_INPUTS_HERE : messages.labels.ADD_GROUP_INPUTS_HERE;\n            html += '</span>';\n            html += '{{' + type + '-inputs}}';\n            html += '</div>';\n\n            return html;\n        }\n    },\n    input_tools: {\n\n        enable: function () {\n            $('ul#inputs-tools-list li div.input')\n                .draggable('enable')\n                .removeClass('dragging-disabled');\n        },\n        disable: function () {\n            //disable draggable\n            $('ul#inputs-tools-list li div.input')\n                .draggable('disable')\n                .addClass('dragging-disabled');\n\n            //show toast max number of input hit\n            //todo\n        },\n        hideSearchInput: function () {\n            formbuilder.dom.inputs_tools_draggable.filter('.input-search').hide();\n        },\n        showSearchInput: function () {\n            formbuilder.dom.inputs_tools_draggable.filter('.input-search').show();\n        }\n    },\n    input_properties_panel: {\n\n        toggleAddAnswerBtn: function (is_disabled) {\n\n            var input = utils.getActiveInput();\n            var properties_panel = formbuilder.dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]');\n\n            properties_panel\n                .find('.input-properties__form__possible-answers__add-answer')\n                .attr('disabled', is_disabled);\n\n        },\n\n        setUniquenessProperty: function (the_form_index, the_input) {\n\n            var form_index = the_form_index;\n            var input = the_input;\n\n            if (form_index === 0) {\n                input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input')\n                    .prop('checked', input.uniquess !== consts.UNIQUESS_NONE);\n            }\n            else {\n                switch (input.uniqueness) {\n\n                    case consts.UNIQUESS_FORM:\n                        input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input.uniqueness-form')\n                            .prop('checked', true);\n                        break;\n                    case consts.UNIQUESS_HIERARCHY:\n                        input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input.uniqueness-hierarchy')\n                            .prop('checked', true);\n                        break;\n                }\n            }\n        },\n\n        showInputQuestionPreview: function (question) {\n\n            formbuilder.dom.input_properties\n                .find('.panel .panel-heading .input-properties__header .question-preview')\n                .text(question);\n        },\n\n        toggleJumpTab: function (the_ref, the_state) {\n\n            var jump_tab = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + the_ref + '\"]')\n                .find('.input-properties__tabs')\n                .find('.nav-tabs')\n                .children()\n                .eq(2);\n\n            //true enable, false disable\n            if (the_state) {\n                jump_tab.removeClass('disabled disabled-tab');\n            }\n            else {\n                jump_tab.addClass('disabled disabled-tab');\n            }\n        },\n\n        showJumpTabError: function (jump_dom_object) {\n\n            //show '!' on affected tab, in this case the jump properties tab (third)\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .removeClass('invisible')\n                .hide()\n                .fadeIn(300);\n\n            //set jump properties tab text to red\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .parent()\n                .addClass('validation-error');\n\n        },\n\n        hideJumpTabError: function (jump_dom_object) {\n\n            //show '!' on affected tab, in this case the jump properties tab (third)\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .addClass('invisible');\n\n\n            //set jump properties tab text to red\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .parent()\n                .removeClass('validation-error');\n\n        },\n\n        toggleTitleCheckbox: function (state, ref) {\n\n            var title_control = formbuilder.dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + ref + '\"]')\n                .find('.input-properties__form__title-flag');\n\n            switch (state) {\n                case consts.DISABLED_STATE:\n                    title_control.find('label').addClass('disabled-checkbox');\n                    title_control.find('input').attr('disabled', true).addClass('disabled-checkbox');\n                    title_control.find('span.title-label').text(consts.MAX_TITLE_LIMIT_REACHED);\n                    break;\n                case consts.ENABLED_STATE:\n                    title_control.find('label').removeClass('disabled-checkbox');\n                    title_control.find('input').attr('disabled', false).removeClass('disabled-checkbox');\n                    title_control.find('span.title-label').text(consts.USE_ANSWER_AS_TITLE);\n                    break;\n            }\n        },\n        toggleCopyInputButton: function (ref, state) {\n\n            var copy_btn = formbuilder.dom\n                .input_properties\n                .find('.input-properties__buttons--copy-input');\n\n            switch (state) {\n                case consts.BTN_DISABLED:\n                    copy_btn.attr('disabled', true);\n                    break;\n                case consts.BTN_ENABLED:\n                    copy_btn.attr('disabled', false);\n                    break;\n            }\n        }\n    },\n    group: {\n\n        toggleEditGroupButton: function (the_ref, the_state) {\n            formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + the_ref + '\"]')\n                .find('.input-properties__form__basic-properties')\n                .find('.input-properties__form__edit-group').attr('disabled', !the_state);\n        },\n\n        hideGroupInputsErrors: function (the_properties_panel) {\n            //show error message\n            the_properties_panel.find('.input-properties__form__error--group-error')\n                .addClass('hidden')\n                .text('&nbsp;');\n        }\n\n    },\n    branch: {\n\n        toggleEditBranchButton: function (the_ref, the_state) {\n            formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + the_ref + '\"]')\n                .find('.input-properties__form__basic-properties')\n                .find('.input-properties__form__edit-branch').attr('disabled', !the_state);\n        },\n\n        hideBranchInputsErrors: function (the_properties_panel) {\n            //show error message\n            the_properties_panel.find('.input-properties__form__error--branch-error')\n                .addClass('hidden')\n                .text('&nbsp;');\n        },\n        showBranchInputPropertiesDom: function (the_branch_input_index) {\n\n            var form_index = formbuilder.current_form_index;\n            var owner_input_ref = formbuilder.current_input_ref;\n            var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n            var branch_input_index = the_branch_input_index;\n            var branch_input = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].branch[branch_input_index];\n            var input_properties_forms_wrapper = formbuilder.dom.input_properties_forms_wrapper;\n            var view = formbuilder.dom.input_properties_views[branch_input.type];\n\n\n            //todo update view template with ref and stuff\n            //init properties panel\n            // helpers.initInputPropertiesPanel(input_properties_forms_wrapper, branch_input, formbuilder.dom.partials);\n\n\n            input_properties_forms_wrapper.append(view).hide().fadeIn(consts.ANIMATION_FAST);\n\n\n            ////todo move this in mousedown?\n            ////for group nested in a branch, enable keyup to check for validation of header text\n            //if (branch_input.type === consts.GROUP_TYPE) {\n            //    formbuilder.dom.input_properties.off('keyup').on('keyup', 'input', input_properties_keyup_callback);\n            //}\n            //else {\n            //    formbuilder.dom.input_properties.off('keyup');\n            //}\n        }\n    }\n};\n\nmodule.exports = ui;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar utils = {\n\n    //from MDN\n    JSONPolyfill: {\n        parse: function (sJSON) {\n            return eval('(' + sJSON + ')');\n        },\n        stringify: (function () {\n            var toString = Object.prototype.toString;\n            var isArray = Array.isArray || function (a) {\n                return toString.call(a) === '[object Array]';\n            };\n            var escMap = {\n                '\"': '\\\\\"',\n                '\\\\': '\\\\\\\\',\n                '\\b': '\\\\b',\n                '\\f': '\\\\f',\n                '\\n': '\\\\n',\n                '\\r': '\\\\r',\n                '\\t': '\\\\t'\n            };\n            var escFunc = function (m) {\n                return escMap[m] || '\\\\u' + (m.charCodeAt(0) + 0x10000).toString(16).substr(1);\n            };\n            var escRE = /[\\\\\"\\u0000-\\u001F\\u2028\\u2029]/g;\n            return function stringify(value) {\n                if (value == null) {\n                    return 'null';\n                } else if (typeof value === 'number') {\n                    return isFinite(value) ? value.toString() : 'null';\n                } else if (typeof value === 'boolean') {\n                    return value.toString();\n                } else if (typeof value === 'object') {\n                    if (typeof value.toJSON === 'function') {\n                        return stringify(value.toJSON());\n                    } else if (isArray(value)) {\n                        var res = '[';\n                        for (var i = 0; i < value.length; i++)\n                            res += (i ? ', ' : '') + stringify(value[i]);\n                        return res + ']';\n                    } else if (toString.call(value) === '[object Object]') {\n                        var tmp = [];\n                        for (var k in value) {\n                            if (value.hasOwnProperty(k))\n                                tmp.push(stringify(k) + ': ' + stringify(value[k]));\n                        }\n                        return '{' + tmp.join(', ') + '}';\n                    }\n                }\n                return '\"' + value.toString().replace(escRE, escFunc) + '\"';\n            };\n        })()\n    },\n    //https://goo.gl/x4jcS\n    isSafari: Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0 || (function (p) {\n        return p.toString() === '[object SafariRemoteNotification]';\n    })(!window.safari || safari.pushNotification),\n\n    getContainersPath: function () {\n        return consts.VIEWS_PATH + 'containers/';\n    },\n\n    getPropertiesPath: function () {\n        return consts.VIEWS_PATH + 'properties/';\n    },\n\n    getPartialsPath: function () {\n        return consts.VIEWS_PATH + 'partials/';\n    },\n\n    //go back to project details page (when inside Epicollect5 Laravel)\n    goBack: function () {\n\n        var href = window.location.href;\n        //both http and https\n        var protocol = window.location.protocol;\n        var parts = href.replace(protocol + '//', '').split('/');\n        var last = parts.pop();\n        var back_href = parts.join('/');\n\n        //standalone mode for testing from localhost?\n        if (last.indexOf('formbuilder') !== -1) {\n            window.location.replace(protocol + '//' + back_href);\n        }\n        else {\n            return false;\n        }\n    },\n\n    //project_ref is defined on the server, and it is unique server wise\n    setProjectURL: function () {\n\n        var domain;\n        var path;\n        var slug;\n        var href = window.location.href;\n        var protocol = window.location.protocol;\n        var parts = href.replace(protocol + '//', '').split('/');\n        var subpath;\n\n        console.log('parts[0]', parts[0]);\n\n        //standalone mode for testing from localhost?\n        if (parts[0].indexOf('localhost') !== -1 || parts[0].indexOf('ngrok')) {\n\n            //is standalone formbuilder?\n            if (parts.indexOf('epicollect5-formbuilder') !== -1) {\n                buildLocalPath();//testing locally, copying the json into project.json\n            }\n            else {\n                //it is a local installation of Laravel\n                buildLaravelPath();\n            }\n        }\n        else {\n            //laravel server\n            buildLaravelPath();\n            console.log(consts.PROJECT_URL);\n        }\n\n        function buildLaravelPath() {\n\n            slug = parts[parts.length - 2];\n            parts.splice(parts.length - 3, 3);\n            domain = protocol + '//' + parts.join('/') + '/';\n\n            path = consts.API_PRODUCTION_PATH;\n            consts.PROJECT_URL = domain + path + slug;\n\n            //do this for Laravel integration\n            //remove domain (first element)\n            parts.shift();\n            if (parts.length > 0) {\n                subpath = parts.join('/');\n                consts.VIEWS_PATH = '/' + subpath + '/' + consts.VIEWS_PATH;\n            }\n            else {\n                consts.VIEWS_PATH = '/' + consts.VIEWS_PATH;\n            }\n        }\n\n        function buildLocalPath() {\n            consts.PROJECT_URL = consts.API_DEVELOPMENT_GET_PATH + consts.API_DEVELOPMENT_PROJECT;\n        }\n    },\n\n    setProjectLogoUrl: function () {\n        console.log('href =>' + window.location.href);\n        var domain;\n        var path;\n        var slug;\n        var href = window.location.href;\n        var protocol = window.location.protocol;\n        var parts = href.replace(protocol + '//', '').split('/');\n\n        slug = parts[parts.length - 2];\n        parts.splice(parts.length - 3, 3);\n        domain = window.location.protocol + '//' + parts.join('/') + '/';\n\n        path = consts.API_MEDIA_PATH;\n        consts.PROJECT_LOGO_URL = domain + path + slug + consts.API_PROJECT_LOGO_QUERY_STRING;\n\n\n        console.log(consts.PROJECT_LOGO_URL);\n    },\n\n    //we generate the refs appending a uniqid per each level\n    //form - input - branch_input - group_input\n    generateFormRef: function () {\n        return formbuilder.project_definition.data.project.ref + '_' + this.generateUniqID();\n    },\n\n    //input ref consists of form_ref + input_ref\n    generateInputRef: function (form_ref) {\n        return form_ref + '_' + this.generateUniqID();\n    },\n\n    generateInputCopyRef: function () {\n\n        var ref;\n        //top level input?\n        if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n            ref = utils.generateInputRef(formbuilder.current_form_ref);\n        }\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //generate nested group input ref (passing active branch input ref)\n            ref = utils.generateBranchGroupInputRef(formbuilder.branch.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //generated branch input ref\n                ref = utils.generateBranchGroupInputRef(formbuilder.branch.active_branch_ref);\n            }\n            if (formbuilder.is_editing_group) {\n                //generate group ref\n                ref = utils.generateBranchGroupInputRef(formbuilder.group.active_group_ref);\n            }\n        }\n        return ref;\n    },\n\n    //for branch and groups, we append the unique ID to the input (nesting a level more)\n    //a nested group will be 2 levels nested\n    generateBranchGroupInputRef: function (input_ref) {\n        return input_ref + '_' + this.generateUniqID();\n    },\n    generateNestedGroupInputRef: function (group_ref) {\n        return group_ref + '_' + this.generateUniqID();\n    },\n    //generate PHP type uniqid to be appended to form, inputs, branch and groups\n    generateUniqID: function (prefix, more_entropy) {\n        if (typeof prefix === 'undefined') {\n            prefix = '';\n        }\n\n        var retId;\n        var formatSeed = function (seed, reqWidth) {\n            seed = parseInt(seed, 10)\n                .toString(16); // to hex str\n            if (reqWidth < seed.length) {\n                // so long we split\n                return seed.slice(seed.length - reqWidth);\n            }\n            if (reqWidth > seed.length) {\n                // so short we pad\n                return Array(1 + (reqWidth - seed.length))\n                    .join('0') + seed;\n            }\n            return seed;\n        };\n\n        // BEGIN REDUNDANT\n        if (!this.php_js) {\n            this.php_js = {};\n        }\n        // END REDUNDANT\n        if (!this.php_js.uniqidSeed) {\n            // init seed with big random int\n            this.php_js.uniqidSeed = Math.floor(Math.random() * 0x75bcd15);\n        }\n        this.php_js.uniqidSeed++;\n\n        // start with prefix, add current milliseconds hex string\n        retId = prefix;\n        retId += formatSeed(parseInt(new Date()\n            .getTime() / 1000, 10), 8);\n        // add seed hex string\n        retId += formatSeed(this.php_js.uniqidSeed, 5);\n        if (more_entropy) {\n            // for more entropy we add a float lower to 10\n            retId += (Math.random() * 10)\n                .toFixed(8)\n                .toString();\n        }\n\n        return retId;\n    },\n\n    //find duplicates in array\n    hasDuplicates: function (array) {\n        var valuesSoFar = [];\n        for (var i = 0; i < array.length; ++i) {\n            var value = array[i];\n            if (valuesSoFar.indexOf(value) !== -1) {\n                return true;\n            }\n            valuesSoFar.push(value);\n        }\n        return false;\n    },\n\n    getInputCurrentIndexByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var i;\n        var iLength = inputs.length;\n\n        for (i = 0; i < iLength; i++) {\n            if (inputs[i].ref === the_ref) {\n                return i;\n            }\n        }\n    },\n\n    getBranchInputCurrentIndexByRef: function (the_owner_input_index, the_branch_input_ref) {\n\n        var branch_inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[the_owner_input_index].branch;\n        var found = -1;\n\n        $(branch_inputs).each(function (index, branch_input) {\n            if (branch_input.ref === the_branch_input_ref) {\n                found = index;\n                return false;\n            }\n        });\n        return found;\n    },\n\n    getGroupInputCurrentIndexByRef: function (the_owner_input_index, the_group_input_ref) {\n\n        var group_inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[the_owner_input_index].group;\n        var found = -1;\n\n        $(group_inputs).each(function (index, branch_input) {\n            if (branch_input.ref === the_group_input_ref) {\n                found = index;\n                return false;\n            }\n        });\n        return found;\n    },\n\n    getInputObjectByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var i;\n        var iLength = inputs.length;\n\n        if (the_ref === undefined) {\n            return false;\n        }\n\n        for (i = 0; i < iLength; i++) {\n            if (inputs[i].ref === the_ref) {\n                return inputs[i];\n            }\n        }\n    },\n\n    getBranchInputObjectByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        /** imp:\n         * After a branch input is copied when editing a branch, we check the formbuilder current ref\n         * If the formbuilder.current_input_ref is not referencing the branch\n         * buth the inner branch input we reset it to reference the active branch\n         */\n        //HACK: \n        if (owner_input_index === undefined) {\n            owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.branch.active_branch_ref);\n            formbuilder.current_input_ref = formbuilder.branch.active_branch_ref\n        }\n        //end HACK:\n        var branch_inputs = inputs[owner_input_index].branch;\n        var found;\n\n        if (the_ref !== undefined) {\n            $(branch_inputs).each(function (index, input) {\n                if (input.ref === the_ref) {\n                    found = input;\n                    return false;\n                }\n            });\n        }\n\n        return found;\n    },\n\n    getNestedGroupInputObjectByRef: function (the_owner_branch, the_current_nested_group_input_ref) {\n\n        var ref = the_current_nested_group_input_ref;\n        var owner_branch = the_owner_branch;\n        var owner_group_ref = formbuilder.group.active_group_ref;\n\n        var found;\n\n        $(owner_branch.branch).each(function (index, branch_input) {\n\n            //get the nested group\n            if (branch_input.ref === owner_group_ref) {\n\n                //for each nested group inputs, look for the one we are looking for\n                $(branch_input.group).each(function (index, nested_group_input) {\n\n                    if (nested_group_input.ref === ref) {\n                        found = nested_group_input;\n                        return false;\n                    }\n                });\n\n                if (found) {\n                    return false;\n                }\n            }\n        });\n        return found;\n    },\n\n    getNestedGroupInputCurrentIndexByRef: function (the_owner_branch, the_current_nested_group_input_ref) {\n\n        var ref = the_current_nested_group_input_ref;\n        var owner_branch = the_owner_branch;\n        var owner_group_ref = formbuilder.group.active_group_ref;\n\n        var found;\n\n        $(owner_branch.branch).each(function (index, branch_input) {\n\n            //get the nested group\n            if (branch_input.ref === owner_group_ref) {\n\n                //for each nested group inputs, look for the one we are looking for\n                $(branch_input.group).each(function (group_index, nested_group_input) {\n\n                    if (nested_group_input.ref === ref) {\n                        found = group_index;\n                        return false;\n                    }\n                });\n\n                if (found) {\n                    return false;\n                }\n            }\n        });\n        return found;\n    },\n\n    getGroupInputObjectByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var group_inputs = inputs[owner_input_index].group;\n        var found;\n\n        if (the_ref !== undefined) {\n\n            $(group_inputs).each(function (index, input) {\n                if (input.ref === the_ref) {\n                    found = input;\n                    return false;\n                }\n            });\n        }\n\n        return found;\n    },\n\n    getNestedGroupObjectByRef: function (owner_branch, nested_group_ref) {\n\n        var found;\n\n        $(owner_branch.branch).each(function (index, branch_input) {\n\n            //get the nested group\n            if (branch_input.ref === nested_group_ref) {\n                found = branch_input;\n                return false;\n            }\n        });\n\n        return found;\n    },\n\n    //passing in a branch input ref, removing the last `_uniqid` we have the input ref that branch belong to\n    getBranchOwnerInputRef: function (the_branch_input_ref) {\n\n        var parts = the_branch_input_ref.split('_');\n\n        parts.pop();\n\n        return parts.join('_');\n    },\n\n    //passing in a group input ref, removing the last `_uniqid` we have the input ref that group belong to\n    getGroupOwnerInputRef: function (the_group_input_ref) {\n\n        var parts = the_group_input_ref.split('_');\n\n        parts.pop();\n\n        return parts.join('_');\n    },\n\n    getInputToolIcon: function (the_type) {\n\n        var icon;\n\n        switch (the_type) {\n            case consts.AUDIO_TYPE:\n                icon = consts.AUDIO_TYPE_ICON;\n                break;\n            case consts.BARCODE_TYPE:\n                icon = consts.BARCODE_TYPE_ICON;\n                break;\n            case consts.BRANCH_TYPE:\n                icon = consts.BRANCH_TYPE_ICON;\n                break;\n            case consts.CHECKBOX_TYPE:\n                icon = consts.CHECKBOX_TYPE_ICON;\n                break;\n            case consts.DATE_TYPE:\n                icon = consts.DATE_TYPE_ICON;\n                break;\n            case consts.DROPDOWN_TYPE:\n                icon = consts.DROPDOWN_TYPE_ICON;\n                break;\n            case consts.GROUP_TYPE:\n                icon = consts.GROUP_TYPE_ICON;\n                break;\n            case consts.LOCATION_TYPE:\n                icon = consts.LOCATION_TYPE_ICON;\n                break;\n            case consts.INTEGER_TYPE:\n                icon = consts.NUMERIC_TYPE_ICON;\n                break;\n            case consts.DECIMAL_TYPE:\n                icon = consts.NUMERIC_TYPE_ICON;\n                break;\n            case consts.PHONE_TYPE:\n                icon = consts.PHONE_TYPE_ICON;\n                break;\n            case consts.PHOTO_TYPE:\n                icon = consts.PHOTO_TYPE_ICON;\n                break;\n            case consts.RADIO_TYPE:\n                icon = consts.RADIO_TYPE_ICON;\n                break;\n            case consts.README_TYPE:\n                icon = consts.README_TYPE_ICON;\n                break;\n            case consts.TEXT_TYPE:\n                icon = consts.TEXT_TYPE_ICON;\n                break;\n            case consts.TEXTAREA_TYPE:\n                icon = consts.TEXTAREA_TYPE_ICON;\n                break;\n            case consts.TIME_TYPE:\n                icon = consts.TIME_TYPE_ICON;\n                break;\n            case consts.VIDEO_TYPE:\n                icon = consts.VIDEO_TYPE_ICON;\n                break;\n            case consts.SEARCH_SINGLE_TYPE:\n                icon = consts.SEARCH_SINGLE_TYPE_ICON;\n                break;\n            case consts.SEARCH_MULTIPLE_TYPE:\n                icon = consts.SEARCH_MULTIPLE_TYPE_ICON;\n                break;\n        }\n        return icon;\n    },\n\n    slugify: function (text) {\n\n        var trimmed = $.trim(text);\n        var $slug = trimmed.replace(/[^a-z0-9-]/gi, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');\n        return $slug.toLowerCase();\n    },\n\n    //get total inputs downo to al levels: counting also nested branch inputs and group inputs\n    getInputsTotal: function (inputs) {\n\n        var total = 0;\n\n        total += inputs.length;\n\n        $(inputs).each(function (index, input) {\n            if (input.type === consts.GROUP_TYPE) {\n                total += input.group.length;\n            }\n            if (input.type === consts.BRANCH_TYPE) {\n                total += input.branch.length;\n\n                //todo count nested group inputs!\n                //todo\n            }\n        });\n        return total;\n    },\n    //get total inputs down to all levels: counting also nested branch inputs and group inputs\n    getSearchInputsTotal: function () {\n\n        var total = 0;\n        var forms = formbuilder.project_definition.data.project.forms;\n\n        $(forms).each(function (formIndex, form) {\n\n            $(form.inputs).each(function (inputIndex, input) {\n                //count all search input types\n                if (input.type === consts.SEARCH_MULTIPLE_TYPE || input.type === consts.SEARCH_SINGLE_TYPE) {\n                    total++;\n                }\n\n                if (input.type === consts.GROUP_TYPE) {\n                    //count all search input types of a group\n                    $(input.group).each(function (groupIndex, groupInput) {\n                        if (groupInput.type === consts.SEARCH_MULTIPLE_TYPE || groupInput.type === consts.SEARCH_SINGLE_TYPE) {\n                            total++;\n                        }\n                    });\n                }\n\n                if (input.type === consts.BRANCH_TYPE) {\n                    //count all search input types of a branch\n                    $(input.branch).each(function (branchIndex, branchInput) {\n                        if (branchInput.type === consts.SEARCH_MULTIPLE_TYPE || branchInput.type === consts.SEARCH_SINGLE_TYPE) {\n                            total++;\n                        }\n                        //nested group?\n                        if (branchInput.type === consts.GROUP_TYPE) {\n                            $(branchInput.group).each(function (groupIndex, groupInput) {\n                                if (groupInput.type === consts.SEARCH_MULTIPLE_TYPE || groupInput.type === consts.SEARCH_SINGLE_TYPE) {\n                                    total++;\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n        });\n\n        return total;\n    },\n    //jump destinations: cannot jump on the next one, but always next + 1\n    getJumpAvailableDestinations: function (input, inputs) {\n\n        var current_input_index;\n        var owner_input_index;\n        var destinations = [];\n        var available_inputs;\n\n        if (formbuilder.is_editing_branch) {\n            owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.branch.active_branch_ref);\n            current_input_index = utils.getBranchInputCurrentIndexByRef(owner_input_index, input.ref);\n        }\n        else {\n            current_input_index = utils.getInputCurrentIndexByRef(input.ref);\n        }\n\n        available_inputs = inputs.slice(current_input_index + 2);\n\n        $(available_inputs).each(function (index, input) {\n            destinations.push({\n                ref: input.ref,\n                question: input.question,\n                type: input.type\n            });\n        });\n\n        //add \"End of form\" as an available destination\n        destinations.push({\n            ref: consts.JUMP_TO_END_OF_FORM_REF,\n            question: consts.JUMP_TO_END_OF_FORM_LABEL,\n            type: null\n        });\n\n\n        return destinations;\n    },\n\n    //jump destinations object: for quicker look ups, this is for extra validation on \"save\"\n    getJumpAvailableDestinationsAsKeys: function (current_input_index, input, inputs) {\n\n        var destinations = {};\n        var available_inputs;\n\n        available_inputs = inputs.slice(current_input_index + 2);\n\n        //fill with available inputs refs as keys\n        $(available_inputs).each(function (index, input) {\n            destinations[input.ref] = 1;\n        });\n        //add \"End of form\" as an available destination\n        destinations[consts.JUMP_TO_END_OF_FORM_REF] = 1;\n\n        return destinations;\n    },\n\n    //return true when the value is less or equal to max title\n    isMaxTitleLimitReached: function (inputs) {\n        return this.getTitleCount(inputs) >= consts.LIMITS.titles_max;\n    },\n    //return true when the value exceeds max title\n    isMaxTitleLimitExceeded: function (inputs) {\n        return this.getTitleCount(inputs) > consts.LIMITS.titles_max;\n    },\n\n    getTitleCount: function (inputs) {\n\n        var count = 0;\n\n        $(inputs).each(function (index, input) {\n            if (input.is_title) {\n                count++;\n            }\n            //loop all group inputs as they count towards the limit\n            if (input.type === consts.GROUP_TYPE) {\n                $(input.group).each(function (index, group_input) {\n                    if (group_input.is_title) {\n                        count++;\n                    }\n                });\n            }\n        });\n        return count;\n    },\n    //from http://goo.gl/D7FxG0\n    //  //convert html tags to html entities\n    encodeHtml: function (str) {\n        return str.replace(/[&<>\"']/g, function ($0) {\n            /* jshint ignore:start */\n            // jscs:disable\n            return \"&\" + {\n                \"&\": \"amp\",\n                \"<\": \"lt\",\n                \">\": \"gt\",\n                '\"': \"quot\",\n                \"'\": \"#39\"\n            }[$0] + \";\";\n            /* jshint ignore:end */\n            // jscs:enable\n        });\n    },\n\n    //from http://goo.gl/htCroU\n    decodeHtml: function (html) {\n        var txt = document.createElement('textarea');\n        txt.innerHTML = html;\n        return txt.value;\n    },\n\n    getPossibleAnswerLabel: function (input) {\n        var label = '';\n        $(input.possible_answers).each(function (answer_index, answer) {\n            if (answer.answer_ref === input.default) {\n                label = answer.answer;\n            }\n        });\n        return label;\n    },\n    /**\n     * @param validSource: the valid obj structure\n     * @param wannaBe: the obj structure to validate\n     * @param strict: whether the type must be the same\n     * @returns {boolean}\n     * Compare properties of objects (only keys: wannaBe must have the same keys, in any order. Values don't matter, they are check separately)\n     * we do check for the same nested properties when an object {} but arrays must be arrays []\n     */\n    hasSameProps: function (validSource, wannaBe, strict) {\n\n        var self = this;\n\n        //false when wannabe property is an array but validSource is not\n        if (typeof validSource === 'object' && Array.isArray(wannaBe)) {\n            return false;\n        }\n\n        //check for wannaBe overlapping props\n        if (!Object.keys(wannaBe).every(function (key) {\n            return validSource.hasOwnProperty(key);\n        })) {\n            // console.log('wannaBe has extra keys')\n            return false;\n        }\n\n        //check every key for being same\n        return Object.keys(validSource).every(function (key) {\n            //if object\n            if (typeof validSource[key] === 'object' && typeof wannaBe[key] === 'object' && validSource[key] !== null && wannaBe[key] !== null) {\n\n                //check array is array\n                if (Array.isArray(validSource[key])) {\n                    //console.log('must be array key: ' + key);\n                    return Array.isArray(wannaBe[key]);\n                } else {\n                    //recursively check nested object\n                    return self.hasSameProps(validSource[key], wannaBe[key]);\n                }\n\n            } else {\n                //check every key is present in the wanna be object\n                if (wannaBe[key] === undefined) {\n                    // console.log('wannaBe does not have key:' + key)\n                    return false;\n                }\n\n                //check the type of value is the same (not the actual value, which can be different)\n                if (strict) {\n                    if (typeof validSource[key] !== typeof wannaBe[key]) {\n                        //console.log('wannaBe type is wrong for key: ' + key)\n                        return false;\n                    }\n                }\n\n                return true;\n            }\n        });\n    },\n    //from MDN https://goo.gl/vOhzta\n    isInteger: function (value) {\n        return typeof value === 'number' &&\n            isFinite(value) &&\n            Math.floor(value) === value;\n    },\n\n    getActiveInput: function () {\n\n        var self = this;\n        var input;\n        var current_branch;\n        var current_input_ref = formbuilder.current_input_ref;\n\n        //get current input object based on editing state:\n\n        //nested group?\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get nested group input\n            current_branch = self.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = self.getNestedGroupInputObjectByRef(current_branch, formbuilder.group.current_input_ref);\n        }\n\n        //branch input\n        if (formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n            //get branch input\n            input = self.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        }\n\n        //group input?\n        if (!formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get group input\n            input = self.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n\n        //top level input?\n        if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n            //get input\n            input = self.getInputObjectByRef(current_input_ref);\n        }\n\n        return input;\n    },\n    /// Replaces commonly-used Windows 1252 encoded chars that do not exist in ASCII or ISO-8859-1 with ISO-8859-1 cognates.\n    replaceWordChars: function (text) {\n        var s = text;\n        // smart single quotes and apostrophe\n        s = s.replace(/[\\u2018\\u2019\\u201A]/g, \"\\'\");\n        // smart double quotes\n        s = s.replace(/[\\u201C\\u201D\\u201E]/g, '\\\"');\n        // ellipsis\n        s = s.replace(/\\u2026/g, '...');\n        // dashes\n        s = s.replace(/[\\u2013\\u2014]/g, '-');\n        // circumflex\n        s = s.replace(/\\u02C6/g, '^');\n        // open angle bracket\n        s = s.replace(/\\u2039/g, ' ');\n        // close angle bracket\n        s = s.replace(/\\u203A/g, ' ');\n        // spaces\n        s = s.replace(/[\\u02DC\\u00A0]/g, ' ');\n\n        //remove invalid chars\n        s = s.replace(/\\uFFFD/g, ' ');\n\n        return s;\n    },\n\n    getCurrentlySelectedInput: function () {\n\n        var self = this;\n        var input = self.getInputObjectByRef(formbuilder.current_input_ref);\n        var owner_branch;\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get nested group input\n            owner_branch = self.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = self.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //get selected branch input\n                input = self.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n            }\n\n            if (formbuilder.is_editing_group) {\n                //get selected group input\n                input = self.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n            }\n        }\n\n        return input;\n    },\n    //http://locutus.io/php/strings/strip_tags/\n    stripTags: function (input, allowed) {\n        allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n        var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n        var commentsAndPhpTags = /<!--[\\s\\S]*?-->|<\\?(?:php)?[\\s\\S]*?\\?>/gi;\n        return input.replace(commentsAndPhpTags, '').replace(tags, function ($0, $1) {\n            return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : ''\n        })\n    },\n    //replace all occurences of 'needle' in string\n    replaceAllOccurrences: function (string, needle, replacement) {\n        return string.replace(new RegExp(needle, 'g'), replacement);\n    },\n\n    /**\n     * Randomize array element order in-place.\n     * Using Durstenfeld shuffle algorithm.\n     */\n    shuffleArray: function (array) {\n        for (var i = array.length - 1; i > 0; i--) {\n            var j = Math.floor(Math.random() * (i + 1));\n            var temp = array[i];\n            array[i] = array[j];\n            array[j] = temp;\n        }\n        return array;\n    }\n};\n\nmodule.exports = utils;\n","'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar formbuilder = require('config/formbuilder');\n\nvar AudioInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.AUDIO_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nAudioInput.prototype = Object.create(Input.prototype);\n\nmodule.exports = AudioInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar BarcodeInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n   // this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.BARCODE_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nBarcodeInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nBarcodeInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\nBarcodeInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = BarcodeInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar messages = require('config/messages');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar branch_sortable = require('ui-handlers/branch-sortable');\nvar input_collection_branch_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\n\nvar BranchInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.BRANCH_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nBranchInput.prototype = Object.create(Input.prototype);\n\nBranchInput.prototype.isHeaderTextValid = function () {\n    return this.isQuestionTextValid();\n};\n\n\n//toggle edit branch button\nBranchInput.prototype.toggleEditButton = function (the_state) {\n    ui.branch.toggleEditBranchButton(this.ref, the_state);\n};\n\nBranchInput.prototype.enterBranchSortable = function () {\n\n    var self = this;\n    var undo = require('actions/undo');\n    var active_branch = formbuilder.dom.inputs_collection_sortable\n        .find('div.input[data-input-ref=\"' + self.ref + '\"]');\n    var active_branch_inner = active_branch.find(' > .input-inner');\n    var branch_holder_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.BRANCH_TYPE);\n    var branch_inputs = utils.getInputObjectByRef(self.ref).branch;\n    var exit_btn_html = '';\n    exit_btn_html += '<button class=\"btn btn-sm btn-default exit-branch-editing\">';\n    exit_btn_html += '<i class=\"fa fa-2x fa-fw fa-chevron-left \"></i>';\n    exit_btn_html += messages.labels.EXIT_EDITING;\n    exit_btn_html += '</button>';\n\n    //reset branch object, as we cache properties of the current enabled branch only\n    formbuilder.branch = {};\n\n    //set draggable to work with enabled branch only\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.branch-sortable');\n\n    //set useful flags\n    formbuilder.is_editing_branch = true;\n    formbuilder.branch.active_branch_ref = self.ref;\n    formbuilder.branch.active_branch_header = self.question;\n\n    active_branch.off().on('mousedown', 'div.input', input_collection_branch_sortable_mousedown_callback);\n\n    // if it is a brand new branch, append sortable markup and show help message\n    if (active_branch.find('.branch-sortable').length === 0) {\n        branch_holder_html = branch_holder_html.replace('{{branch-inputs}}', '');\n        active_branch.append(branch_holder_html);\n        active_branch.find('.input-properties__no-branch-questions-message').show();\n    }\n    else {\n        if (formbuilder.render_action === consts.RENDER_ACTION_UNDO && active_branch.find('.branch-sortable > div').length === 0) {\n            active_branch.find('.input-properties__no-group-questions-message').show();\n        }\n    }\n\n    //enable branch sortable\n    active_branch.find('.branch-sortable').sortable(branch_sortable).disableSelection().removeClass('hidden');\n\n    //remove any previously selected branch input\n    active_branch.find('.branch-sortable').find('.input.active').removeClass('active');\n\n    //show exit editing button\n    active_branch.addClass('active-branch').removeClass('active');\n\n    //remove first two elements\n    active_branch_inner.find('.fa-clone').remove();\n    active_branch_inner.find('> .question-preview').remove();\n\n    //append exit button\n    active_branch_inner.prepend(exit_btn_html);\n\n    //disable form tab buttons\n    ui.forms_tabs.toggleFormTabsButtons({enable: false});\n\n    //prepare ui for editing branch\n    self.showEditBranchUI();\n\n    active_branch\n        .find('.exit-branch-editing')\n        .one('click', function () {\n            self.exitBranchSortable();\n        });\n\n    /*\n     change binding when editing a branch, as we want to incercept only a mousedown to the exit button on the active branch input\n     */\n    //destroy sortable only if it is set already (see http://goo.gl/riN4Yk)\n    if (formbuilder.dom.inputs_collection_sortable.data('ui-sortable')) {\n        formbuilder.dom.inputs_collection_sortable.sortable('destroy');//Remove the plugin functionality\n    }\n\n    formbuilder.dom.inputs_collection_sortable.off('mousedown').on('mousedown', '.fa-chevron-left', input_collection_sortable_mousedown_callback);\n\n    //hide form title warning regardless (passing 1)=> this is for the form which owns the branch\n    ui.inputs_collection.toggleTitleWarning(1, false);\n\n    //show/hide warning for the branch\n    ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(branch_inputs), true);\n\n    //push state to enable undoing the action (adding/dragging input)\n    undo.pushState();\n};\n\nBranchInput.prototype.exitBranchSortable = function () {\n\n    var self = this;\n    var sortable = require('ui-handlers/sortable');\n    var current_form_name = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].name;\n    var active_branch = formbuilder.dom.inputs_collection_sortable.find('.input.active-branch');\n    var active_branch_input_sortable = active_branch.find('.branch-sortable');\n    var active_branch_inner = active_branch.find(' > .input-inner');\n    var active_branch_input;\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n\n    if (formbuilder.branch.current_input_ref) {\n        active_branch_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        //validate last active group input and update dom accordingly\n        validation.performValidation(active_branch_input, false);\n    }\n\n    active_branch.removeClass('active-branch').addClass('active');\n\n\n    //remove exit button\n    active_branch_inner.find('.exit-branch-editing').remove();\n\n    //restore question in input collection\n    active_branch_inner.prepend('<span class=\"question-preview\">' + self.question + '</span>');\n    active_branch_inner.prepend('<i class=\"fa fa-2x fa-fw fa-clone\"></i>');\n\n    formbuilder.dom.inputs_collection_sortable.find('.input').not('.active').slideDown(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(current_form_name.trunc(consts.INPUTS_COLLECTION_BRANCH_NAME_MAX_DISPLAY_LENGHT));\n\n    //show form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(true);\n\n    //enable jumps tab\n    ui.input_properties_panel.toggleJumpTab(self.ref, true);\n\n    self.toggleEditButton(true);\n\n    //set draggable to work with main sortable\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.sortable');\n\n    active_branch_input_sortable.addClass('hidden');\n\n    /*\n     restore parent binding after exiting branch editing\n     */\n    formbuilder.dom.inputs_collection_sortable.off('mousedown').on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n\n\n    //re-bind sortable plugin\n    sortable();\n\n    self.validateBranchInputs();\n\n    //todo: hide current input and show branch\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').hide();\n\n    //hide previously selected branch input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.branch.current_input_ref + '\"]').hide();\n\n    //show branch input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.branch.active_branch_ref + '\"]').fadeIn(consts.ANIMATION_FAST);\n\n    //enable branch input tools in left sidebar, as we cannot have a branch withing a branch\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch').show();\n\n    formbuilder.is_editing_branch = false;\n    formbuilder.branch.current_input_ref = undefined;\n\n    //enable form tab buttons\n    ui.forms_tabs.toggleFormTabsButtons({enable: true});\n\n    //show action buttons for owner input\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n    //show title warning if no title set\n    //todo is this needed?\n    ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(inputs), false);\n};\n\n\nBranchInput.prototype.showEditBranchUI = function () {\n\n    var self = this;\n\n    //hide first level inputs from the input collection\n    formbuilder.dom.inputs_collection_sortable.find(' > .input').not('.active-branch').slideUp(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_BRANCH);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(self.question.trunc(consts.INPUTS_COLLECTION_BRANCH_NAME_MAX_DISPLAY_LENGHT));\n\n    //disable form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(false);\n\n    //disable jumps tab //todo is this needed?\n    ui.input_properties_panel.toggleJumpTab(self.ref, false);\n\n    //hide owner branch input panel and show 'no branch inputs selected' by default\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]').hide();\n\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').show();\n\n    //hide input properties panel action buttons until a branch input gets selected\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n\n    //disable branch input tools in left sidebar, as we cannot have a branch withing a branch\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch').hide();\n\n};\n\nBranchInput.prototype.validateBranchInputs = function () {\n\n    var self = this;\n    var branch_inputs_validation = validation.validateBranchInputs(self);\n\n    self.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + self.ref + '\"]');\n\n    if (!branch_inputs_validation.is_valid) {\n        //highlight wrong input and show error message\n        errors.showBranchInputsErrors(self.dom.properties_panel, branch_inputs_validation.error.message);\n        //set element as invalid\n        self.dom.is_valid = false;\n    }\n    else {\n        //set element as valid\n        self.dom.is_valid = true;\n        errors.hideBranchInputsErrors(self.dom.properties_panel);\n    }\n};\n\nmodule.exports = BranchInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('../config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar CheckboxInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.CHECKBOX_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //pagination defaults\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n};\n\n//extend prototype from basic input object and multiple answer object\nCheckboxInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\nmodule.exports = CheckboxInput;\n","'use strict';\nvar consts = require('../config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar formbuilder = require('../config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar DateInput = function (the_input_ref) {\n\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.DATE_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nDateInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nDateInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set default to current datetime?\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current input').prop('checked', this.set_to_current_datetime);\n\n    //set datetime format\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__dateformat input[name=\"dateformatRadio\"][value=\"' + this.datetime_format + '\"]')\n        .prop('checked', true);\n\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\n\nDateInput.prototype.saveAdvancedProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set default to current datetime?\n    this.set_to_current_datetime = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current input')\n        .is(':checked');\n\n    //set datetime format\n    this.datetime_format = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__dateformat input[name=\"dateformatRadio\"]:checked')\n        .val();\n\n    //save uniqueness\n    save.saveUniqueness(this);\n};\n\nmodule.exports = DateInput;\n","/* global $*/\n'use strict';\nvar consts = require('../config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('../config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar DropdownInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.DROPDOWN_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //pagination defaults\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n};\n\n//extend prototype from basic input object and multiple answer object\nDropdownInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\n\nmodule.exports = DropdownInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar messages = require('config/messages');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar group_sortable = require('ui-handlers/group-sortable');\nvar input_collection_branch_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback');\nvar input_collection_group_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-group-sortable-mousedown-callback');\nvar input_collection_nested_group_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-nested-group-sortable-mousedown-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\n\nvar GroupInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.GROUP_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nGroupInput.prototype = Object.create(Input.prototype);\n\nGroupInput.prototype.isHeaderTextValid = function () {\n    return this.isQuestionTextValid();\n};\n\n//toggle edit branch button\nGroupInput.prototype.toggleEditButton = function (the_state) {\n    ui.group.toggleEditGroupButton(this.ref, the_state);\n};\n\nGroupInput.prototype.enterGroupSortable = function (is_nested) {\n\n    var self = this;\n    var undo = require('actions/undo');\n    var active_group = formbuilder.dom.inputs_collection_sortable\n        .find('div.input[data-input-ref=\"' + self.ref + '\"]');\n    var active_group_inner = active_group.find(' > .input-inner');\n    var group_holder_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.GROUP_TYPE);\n    var exit_btn_html = '';\n    var exit_button_class = is_nested ? 'exit-nested-group-editing' : 'exit-group-editing';\n    exit_btn_html += '<button class=\"btn btn-sm btn-default ' + exit_button_class + '\">';\n    exit_btn_html += '<i class=\"fa fa-2x fa-fw fa-chevron-left \"></i>';\n    exit_btn_html += messages.labels.EXIT_EDITING;\n    exit_btn_html += '</button>';\n\n\n    //disable jumps tab when editing a group\n    $('.jump-tab').addClass('disabled disabled-tab');\n\n    //reset group object, as we cache properties of the current enabled group only\n    formbuilder.group = {};\n\n    //set draggable to work with enabled group only\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.group-sortable');\n\n    //set useful flags\n    formbuilder.is_editing_group = true;\n    formbuilder.group.active_group_ref = self.ref;\n\n    if (is_nested) {\n        active_group.off().on('mousedown', 'div.input', input_collection_nested_group_sortable_mousedown_callback);\n    } else {\n        active_group.off().on('mousedown', 'div.input', input_collection_group_sortable_mousedown_callback);\n    }\n\n    //if it is a brand new group, append sortable markup\n    if (active_group.find('.group-sortable').length === 0) {\n        group_holder_html = group_holder_html.replace('{{group-inputs}}', '');\n        active_group.append(group_holder_html);\n        active_group.find('.input-properties__no-group-questions-message').show();\n    }\n    else {\n        if (formbuilder.render_action === consts.RENDER_ACTION_UNDO && active_group.find('.group-sortable > div').length === 0) {\n            active_group.find('.input-properties__no-group-questions-message').show();\n        }\n    }\n\n    //enable group sortable\n    active_group.find('.group-sortable').sortable(group_sortable).disableSelection().removeClass('hidden');\n\n    //remove any previously selected group input\n    active_group.find('.group-sortable').find('.input.active').removeClass('active');\n\n    //show exit editing button\n    active_group.addClass('active-group').removeClass('active');\n\n    //remove first two elements\n    active_group_inner.find('.fa-align-justify').remove();\n    active_group_inner.find('> .question-preview').remove();\n\n    //append exit button\n    active_group_inner.prepend(exit_btn_html);\n\n    //disable form tab buttons\n    ui.forms_tabs.toggleFormTabsButtons({\n        enable: false\n    });\n\n    //prepare ui for editing group\n    if (is_nested) {\n        self.showEditNestedGroupUI();\n    } else {\n        self.showEditGroupUI();\n    }\n\n    active_group\n        .find('.' + exit_button_class)\n        .one('click', function () {\n            if (is_nested) {\n                self.exitNestedGroupSortable();\n            } else {\n                self.exitGroupSortable();\n            }\n        });\n\n    /*\n     change binding when editing a group, as we want to incercept only a mousedown to the exit button on the active group input\n     */\n    //destroy top parent sortable\n    console.log('group.js calls destroy');\n\n    /******** NEEDED BUG *********/\n    /* The call to 'destroy' will trigger an error the first time, but if it does not (catching the error or using the commented 'if else' statement)\n     *  when exiting the group the parent sortable will not work anymore, whether is a top level sortable or a branch sortable.\n     *  todo look into it\n     *\n     * */\n    if (formbuilder.render_action === consts.RENDER_ACTION_DO) {\n        try {\n            formbuilder.dom.inputs_collection_sortable.sortable('destroy');\n        }\n        catch (error) {\n            console.log('Sortable destroy error thrown and caught (THIS IS NEEDED!)')\n        }\n    }\n    /******** END NEEDED BUG *********/\n\n    // formbuilder.dom.inputs_collection_sortable.find('.active-branch.hidden-active-branch .branch-sortable').sortable('destroy');\n    if (is_nested) {\n        //disable mousedown\n        formbuilder.dom.inputs_collection_sortable\n            .find('.active-branch.hidden-active-branch .branch-sortable')\n            .off('mousedown')\n            .on('mousedown', '.fa-chevron-left', input_collection_branch_sortable_mousedown_callback);\n    } else {\n        formbuilder.dom.inputs_collection_sortable.on('mousedown', '.fa-chevron-left', input_collection_sortable_mousedown_callback);\n    }\n\n    undo.pushState();\n};\n\nGroupInput.prototype.exitNestedGroupSortable = function () {\n\n    //exit nested group sortable\n    console.log('exiting nested group, goes up to branch');\n\n    var self = this;\n    var branch_sortable = require('ui-handlers/branch-sortable');\n    var active_branch = formbuilder.dom.inputs_collection_sortable.find('.active-branch');\n    var current_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n    var current_branch_name = current_branch.question;\n    var active_group = formbuilder.dom.inputs_collection_sortable.find('.input.active-group');\n    var active_group_input_sortable = active_group.find('.group-sortable');\n    var active_group_inner = active_group.find(' > .input-inner');\n    var active_nested_group_input;\n\n    if (formbuilder.group.current_input_ref) {\n        active_nested_group_input = utils.getNestedGroupInputObjectByRef(current_branch, formbuilder.group.current_input_ref);\n        //validate last active group input and update dom accordingly (if an input was selected)\n        validation.performValidation(active_nested_group_input, false, formbuilder.project_definition);\n    }\n\n    //enable owner branch sortable\n    active_branch.find('.branch-sortable').sortable(branch_sortable).disableSelection();\n\n    active_group.removeClass('active-group').addClass('active');\n\n    //remove exit button\n    active_group_inner.find('.exit-nested-group-editing').remove();\n\n    //restore question in input collection\n    active_group_inner.prepend('<span class=\"question-preview\">' + self.question + '</span>');\n    active_group_inner.prepend('<i class=\"fa fa-2x fa-fw fa-align-justify\"></i>');\n\n    //show owner branch\n    active_branch\n        .removeClass('hidden-active-branch')\n        .find(' > .input-inner > i')\n        .fadeIn(consts.ANIMATION_FAST);\n\n    active_branch.find(' > .input-inner > .exit-branch-editing').fadeIn(consts.ANIMATION_FAST);\n\n    //show inactive branch inputs\n    formbuilder.dom.inputs_collection_sortable\n        .find('.active-branch')\n        .find('.branch-sortable')\n        .find(' > .input')\n        .not('.active-group')\n        .slideDown(consts.ANIMATION_NORMAL);\n\n    //update middle colum panel header showing owner branch question\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_BRANCH);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(current_branch_name.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    self.toggleEditButton(true);\n\n    //set draggable to work with the active branch sortable\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.branch-sortable');\n\n    //hide nested group sortable\n    active_group_input_sortable.addClass('hidden');\n\n    /*\n     restore parent binding after exiting group editing\n     */\n    formbuilder.dom.inputs_collection_sortable\n        .find('.active-branch')\n        .off()\n        .on('mousedown', 'div.input', input_collection_branch_sortable_mousedown_callback);\n\n    formbuilder.dom.inputs_collection_sortable.find('.active-branch > .branch-sortable').sortable(branch_sortable);\n\n    //if both header and groups are valid, show green check on active group input\n    if (self.dom.is_valid) {\n        //replace warning icon with green check\n        ui.inputs_collection.showInputValidIcon(self.ref);\n    } else {\n        //replace warning icon with green check\n        ui.inputs_collection.showInputInvalidIcon(self.ref);\n    }\n\n    //show a preview of the nested group header (limit to 20 chars)\n    formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(self.question.trunc(20));\n\n    //hide no inputs selected (just in case no input was selected in the nested group)\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').hide();\n\n    //hide any input previously selected\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.current_input_ref + '\"]').hide();\n\n    //show nested group input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]').fadeIn(consts.ANIMATION_FAST);\n\n    //enable group input tools in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-group').show();\n\n    formbuilder.is_editing_group = false;\n    formbuilder.group.current_input_ref = undefined;\n\n    //enable jumps tab when exit editing a group\n    $('.jump-tab').removeClass('disabled disabled-tab');\n\n    //show action buttons for owner input\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n};\n\nGroupInput.prototype.exitGroupSortable = function () {\n\n    var self = this;\n    var active_group_input;\n    var sortable = require('ui-handlers/sortable');\n    var current_form_name = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].name;\n    var active_group = formbuilder.dom.inputs_collection_sortable.find('.input.active-group');\n    var active_group_input_sortable = active_group.find('.group-sortable');\n    var active_group_inner = active_group.find(' > .input-inner');\n\n    if (formbuilder.group.current_input_ref) {\n        active_group_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        //validate last active group input and update dom accordingly\n        validation.performValidation(active_group_input, false, formbuilder.project_definition);\n    }\n\n    active_group.removeClass('active-group').addClass('active');\n\n    //remove exit button\n    active_group_inner.find('.exit-group-editing').remove();\n\n    //restore question in input collection\n    active_group_inner.prepend('<span class=\"question-preview\">' + self.question + '</span>');\n    active_group_inner.prepend('<i class=\"fa fa-2x fa-fw fa-align-justify\"></i>');\n\n    formbuilder.dom.inputs_collection_sortable.find('.input').not('.active').slideDown(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(current_form_name.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    //show form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(true);\n\n    //enable jumps tab\n    ui.input_properties_panel.toggleJumpTab(self.ref, true);\n\n    self.toggleEditButton(true);\n\n    //set draggable to work with main sortable\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.sortable');\n\n    active_group_input_sortable.addClass('hidden');\n\n    /*\n     restore parent binding and sortable after exiting group editing\n     */\n    formbuilder.dom.inputs_collection_sortable.off('mousedown').on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n    sortable();\n\n    //if both header and groups are valid, show green check on active group input\n    if (self.dom.is_valid) {\n        //update the just saved input showing a preview of the question text (limit to 50 chars)\n        ui.inputs_collection.showInputQuestionPreview(self.ref, self.question.trunc(50));\n        //replace warning icon with green check\n        ui.inputs_collection.showInputValidIcon(self.ref);\n    } else {\n        //replace warning icon with green check\n        ui.inputs_collection.showInputInvalidIcon(self.ref);\n    }\n\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').hide();\n\n    //hide any input previously selected\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.current_input_ref + '\"]').hide();\n\n    //show branch input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]').fadeIn(consts.ANIMATION_FAST);\n\n    //enable branch & group input tools in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch, .input-group').show();\n\n    formbuilder.is_editing_group = false;\n    formbuilder.group.current_input_ref = undefined;\n\n    //enable jumps tab when exit editing a group\n    $('.jump-tab').removeClass('disabled disabled-tab');\n\n    //show title flag\n    $('.input-properties__form__title-flag').removeClass('hidden');\n\n    //enable form tabs buttons\n    ui.forms_tabs.toggleFormTabsButtons({\n        enable: true\n    });\n\n    //show action buttons for owner input\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n};\n\nGroupInput.prototype.showEditGroupUI = function () {\n\n    var self = this;\n\n    //hide first level inputs from the input collection\n    formbuilder.dom.inputs_collection_sortable.find(' > .input').not('.active-group').slideUp(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_GROUP);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(self.question.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    //disable form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(false);\n\n    //disable jumps tab //todo is this needed?\n    ui.input_properties_panel.toggleJumpTab(self.ref, false);\n\n    //hide owner group input panel and show 'no group inputs selected' by default\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]').hide();\n\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').show();\n\n    //hide input properties panel action buttons until a group input gets selected\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n    ////hide branch & group input tools in left sidebar, as we cannot have a branch or a group withing a group\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch, .input-group').hide();\n\n};\n\nGroupInput.prototype.showEditNestedGroupUI = function () {\n\n    var self = this;\n    var active_branch = formbuilder.dom.inputs_collection_sortable.find('.active-branch');\n\n    //render UI for a nested group, as we cannot just hide the main parent since it is a branch sortable\n    //hide inactive branch inputs from the input collection\n    active_branch\n        .find('.branch-sortable')\n        .find(' > .input')\n        .not('.active-group')\n        .slideUp(consts.ANIMATION_NORMAL);\n\n    //hide owner branch ant its inactive inputs (without using display:none as that will hide the nested group as well :/)\n    active_branch\n        .addClass('hidden-active-branch')\n        .find(' > .input-inner > i')\n        .hide();\n\n    active_branch.find('.exit-branch-editing').hide();\n\n    //remove all events from active branch as we are only interested in the mousedown event of the group sortable\n    active_branch.off();\n\n    //update panel header, as it a nested group show full breadcrumbs\n    formbuilder.dom.inputs_collection\n        .find('.inputs-collection__header__edit-state')\n        .text(messages.labels.EDITING_BRANCH + messages.labels.EDITING_NESTED_GROUP);\n\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(self.question.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    //hide owner group input panel and show 'no group inputs selected' by default\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]').hide();\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').show();\n\n    //hide input properties panel action buttons until a group input gets selected\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n    ////disable branch & group input tools in left sidebar, as we cannot have a branch or a group withing a group\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch, .input-group').hide();\n};\n\nGroupInput.prototype.validateGroupInputs = function () {\n\n    var self = this;\n    var group_inputs_validation = validation.validateGroupInputs(self);\n    if (!group_inputs_validation.is_valid) {\n        //highlight wrong input and show error message\n        errors.showGroupInputsErrors(self.dom.properties_panel, group_inputs_validation.error.message);\n        //set element as invalid\n        self.dom.is_valid = false;\n    } else {\n        //set element as valid\n        self.dom.is_valid = true;\n        errors.hideGroupInputsErrors(self.dom.properties_panel);\n    }\n};\n\nmodule.exports = GroupInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar messages = require('config/messages');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar template = require ('template');\n\nvar NumericInput = function (the_input_ref) {\n\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.INTEGER_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nNumericInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\n//validate initial answer\nNumericInput.prototype.isInitialAnswerValid = function () {\n\n    var validate = validation.isInitialAnswerValid(this.type,this.default, this.regex);\n\n    if (validate.is_valid) {\n        //validate for integer type\n        if (this.type === consts.INTEGER_TYPE && this.default !== '') {\n            //initial answer must be an integer, not a float\n            if (!validation.isValueInt(this.default)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.VALUE_MUST_BE_INTEGER;\n            }\n        }\n    }\n    return validate;\n};\n\nNumericInput.prototype.isMinValueValid = function () {\n    //validate min value\n    return validation.isMinMaxValueValid(this.type, this.min);\n};\n\nNumericInput.prototype.isMaxValueValid = function () {\n    //validate max value\n    return validation.isMinMaxValueValid(this.type, this.max);\n};\n\nNumericInput.prototype.saveAdvancedProperties = function () {\n\n    var initial_answer_validation;\n    var min_value_validation;\n    var max_value_validation;\n    var uniqueness;\n\n    this.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //clear all advanced properties errors from dom\n    this.hideAdvancedPropertiesErrors();\n\n    //set integer or decimal numeric type\n    this.type = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__numeric input:checked').val();\n\n    //set default (initial answer)\n    this.default = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val();\n\n    //strip html tags\n    this.default = this.default.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n\n    //set min value\n    this.min = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__min input').val();\n    this.min = this.min.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__min input').val(this.min);\n\n    //set max value\n    this.max = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__max input').val();\n    this.max = this.max.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__max input').val(this.max);\n\n    //set regex\n    this.regex = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val();\n    this.regex = this.regex.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set verify flag\n    this.verify = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').is(':checked');\n\n    //validate initial answer (based also on min max and numeric type)\n    initial_answer_validation = this.isInitialAnswerValid();\n    if (!initial_answer_validation.is_valid) {\n        //warn user initial answer is not valid\n        this.dom.is_valid = false;\n        //highlight wrong input\n        this.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, initial_answer_validation.error.message);\n    }\n\n    //validate min value\n    min_value_validation = this.isMinValueValid();\n    if (!min_value_validation.is_valid) {\n        //warn user min value is not valid\n        this.dom.is_valid = false;\n        //highlight wrong input\n        this.showAdvancedPropertiesErrors(consts.MIN_VALUE_PROPERTY, min_value_validation.error.message);\n    }\n\n    //validate max value\n    max_value_validation = this.isMaxValueValid();\n    if (!max_value_validation.is_valid) {\n        //warn user min value is not valid\n        this.dom.is_valid = false;\n        //highlight wrong input\n        this.showAdvancedPropertiesErrors(consts.MAX_VALUE_PROPERTY, max_value_validation.error.message);\n    }\n\n    //all advanced properties are valid, validate combinations across properties\n    //min (if set) needs to be smaller than max (if set)\n    if (min_value_validation.is_valid && max_value_validation.is_valid && this.min !== '' && this.max !== '') {\n\n        if (parseFloat(this.min) >= parseFloat(this.max)) {\n            //warn user min value is not valid\n            this.dom.is_valid = false;\n            //highlight wrong input\n            this.showAdvancedPropertiesErrors(consts.MIN_VALUE_PROPERTY, messages.error.MIN_MUST_BE_SMALLER_THAN_MAX);\n        }\n    }\n\n    //intial answer (if set) should be within the range set by min/max properties\n    if (initial_answer_validation.is_valid && this.default !== '') {\n\n        if (min_value_validation.is_valid && this.min !== '') {\n            if (parseFloat(this.default) < parseFloat(this.min)) {\n                //warn user min value is not valid\n                this.dom.is_valid = false;\n                //highlight wrong input\n                this.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, messages.error.INITIAL_ANSWER_OUT_OF_RANGE);\n            }\n        }\n\n        if (max_value_validation.is_valid && this.max !== '') {\n            if (parseFloat(this.default) > parseFloat(this.max)) {\n                //warn user min value is not valid\n                this.dom.is_valid = false;\n                //highlight wrong input\n                this.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, messages.error.INITIAL_ANSWER_OUT_OF_RANGE);\n            }\n        }\n    }\n\n    //save uniqueness\n    save.saveUniqueness(this);\n};\n\nNumericInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY,\n        consts.MIN_VALUE_PROPERTY,\n        consts.MAX_VALUE_PROPERTY\n    ];\n\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = NumericInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\n\nvar LocationInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n   // this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.LOCATION_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nLocationInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n//LocationInput.prototype.prepareAdvancedInputProperties = function () {\n//};\n//\n//LocationInput.prototype.hideAdvancedPropertiesErrors = function () {\n//    //do nothing\n//};\n\nmodule.exports = LocationInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar PhoneInput = function (the_input_ref) {\n\n    //extend basic input (using a clone, not a reference) wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    this.ref = the_input_ref;\n    this.type = consts.PHONE_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live')*/\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nPhoneInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nPhoneInput.prototype.setAdvancedInputProperties = function () {\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\n\nPhoneInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = PhoneInput;\n","/* global $*/\n'use strict';\nvar consts = require('../config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('../config/formbuilder');\n\nvar PhotoInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.PHOTO_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nPhotoInput.prototype = Object.create(Input.prototype);\n/*\n Overrides\n */\n//PhotoInput.prototype.prepareAdvancedInputProperties = function () {\n//};\n\n//PhotoInput.prototype.hideAdvancedPropertiesErrors = function () {\n//    //do nothing\n//};\n\nmodule.exports = PhotoInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar RadioInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.RADIO_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //pagination defaults\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n\n};\n\n//extend prototype from basic input object and multiple answer object\nRadioInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\nmodule.exports = RadioInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar ReadmeInput = function (the_input_ref) {\n\n    //extend basic input (using a clone, not a reference) wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    this.ref = the_input_ref;\n    this.type = consts.README_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live')*/\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //override a few properties for validation purposes server side\n    this.is_title = false;\n    this.verify = false;\n    this.is_required = false;\n\n\n\n};\n\n//extend prototype from basic input object\nReadmeInput.prototype = Object.create(Input.prototype);\n\n\n/*\n Overrides\n */\n\n\nmodule.exports = ReadmeInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar SearchInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.SEARCH_SINGLE_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n\n};\n\n//extend prototype from basic input object and multiple answer object\nSearchInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\nmodule.exports = SearchInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar TextInput = function (the_input_ref) {\n\n    //extend basic input (using a clone, not a reference) wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    this.ref = the_input_ref;\n    this.type = consts.TEXT_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live')*/\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nTextInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nTextInput.prototype.setAdvancedInputProperties = function () {\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\n\nTextInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = TextInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar TextareaInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.TEXTAREA_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nTextareaInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nTextareaInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\nTextareaInput.prototype.hideAdvancedPropertiesErrors = function () {\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = TextareaInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar TimeInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.TIME_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nTimeInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\n\nTimeInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n\n    //set default to current datetime?\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current label input').prop('checked', this.set_to_current_datetime);\n\n    //set datetime format\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__timeformat input[name=\"timeformatRadio\"][value=\"' + this.datetime_format + '\"]')\n        .prop('checked', true);\n\n    //set 'uniqueness' option\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n\n};\n\nTimeInput.prototype.saveAdvancedProperties = function () {\n\n    var form_index = formbuilder.current_form_index;\n    var uniqueness;\n\n    this.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set default to current datetime?\n    this.set_to_current_datetime = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current input')\n        .is(':checked');\n\n    //set datetime format\n    this.datetime_format = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__timeformat input[name=\"timeformatRadio\"]:checked')\n        .val();\n\n    //save uniqueness\n    save.saveUniqueness(this);\n};\n\nmodule.exports = TimeInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar VideoInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.VIDEO_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nVideoInput.prototype = Object.create(Input.prototype);\n\nmodule.exports = VideoInput;\n","'use strict';\nvar consts = require('config/consts.js');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar load_child_form_containers = function () {\n\n    var deferred = new $.Deferred();\n    var views = {};\n    var path = utils.getContainersPath();\n    var version = consts.FORMBUILDER_VERSION;\n\n    $.when(\n        //inputs collection (sortable), holding all the inputs for a child form\n        $.get(path + 'inputs-collection.html?v=' + version, function (data) {\n            views.inputs_collection = data;\n        }),\n        //inputs properties, showing properties for selected input\n        $.get(path + 'inputs-properties.html?v=' + version, function (data) {\n            views.inputs_properties = data;\n        })\n    ).then(function () {\n        deferred.resolve(views);\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_child_form_containers;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar load_partials = require('loaders/load-partials');\nvar load_containers = require('loaders/load-containers');\nvar load_input_properties_views = require('loaders/load-input-properties-views');\nvar ui = require('helpers/ui');\n\n/********************************************\n Load html components\n *******************************************/\nvar load_components = function () {\n\n    var deferred = new $.Deferred();\n\n    //load main containers (inputs tools, inputs collection and inputs properties) (\"containers will be undefined\")\n    //load partials for input properties tabs (\"partials\")\n    //load views for input properties (\"views\")\n    $.when(load_containers(), load_partials(), load_input_properties_views()).then(function (containers, partials, views) {\n\n        //init with first form ref\n        var form_ref = formbuilder.project_definition.data.project.forms[0].ref;\n\n        //inject ref into first form in the dom\n        ui.forms_tabs.injectRefIntoFormTab(form_ref);\n\n        //setup formbuilder object\n        formbuilder.setup(form_ref, partials, views);\n\n\n        deferred.resolve();\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_components;\n","'use strict';\nvar consts = require('config/consts.js');\nvar utils = require('helpers/utils');\n\nvar get_containers = function () {\n\n    var deferred = new $.Deferred();\n    var path = utils.getContainersPath();\n    var version = consts.FORMBUILDER_VERSION;\n\n    //load container views for index.html (main entry point)\n    $.when(\n        //navbar\n        $.get(path + 'navbar.html?v=' + version, function (data) {\n            $('.navbar').html(data);\n        }),\n        //inputs tools list (source inputs to drag, draggable)\n        $.get(path + 'inputs-tools.html?v=' + version, function (data) {\n            $('.inputs-tools').html(data);\n        }),\n        //inputs collection (sortable), holding all the inputs for a form\n        $.get(path + 'inputs-collection.html?v=' + version, function (data) {\n            $('.inputs-collection').html(data);\n        }),\n        //inputs properties, showing properties for selected input\n        $.get(path + 'inputs-properties.html?v=' + version, function (data) {\n            $('.input-properties').html(data);\n        })\n    ).then(function () {\n        deferred.resolve();\n    });\n\n    return deferred.promise();\n};\n\nmodule.exports = get_containers;\n","'use strict';\nvar consts = require('config/consts.js');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\n\nvar load_input_properties_views = function () {\n\n    var views = {};\n    var deferred = new $.Deferred();\n    var path = utils.getPropertiesPath();\n    var version = consts.FORMBUILDER_VERSION;\n\n    $.when(\n        $.get(path + 'properties-audio.html?v=' + version, function (data) {\n            views.audio = data;\n        }),\n        $.get(path + 'properties-barcode.html?v=' + version, function (data) {\n            views.barcode = data;\n        }),\n        $.get(path + 'properties-branch.html?v=' + version, function (data) {\n            views.branch = data;\n        }),\n        $.get(path + 'properties-checkbox.html?v=' + version, function (data) {\n            views.checkbox = data;\n        }),\n        $.get(path + 'properties-date.html?v=' + version, function (data) {\n            views.date = data;\n        }),\n        $.get(path + 'properties-dropdown.html?v=' + version, function (data) {\n            views.dropdown = data;\n        }),\n        $.get(path + 'properties-group.html?v=' + version, function (data) {\n            views.group = data;\n        }),\n        $.get(path + 'properties-integer.html?v=' + version, function (data) {\n            views.integer = data;\n            views.decimal = data;\n        }),\n        $.get(path + 'properties-location.html?v=' + version, function (data) {\n            views.location = data;\n        }),\n        $.get(path + 'properties-photo.html?v=' + version, function (data) {\n            views.photo = data;\n        }),\n        $.get(path + 'properties-phone.html?v=' + version, function (data) {\n            views.phone = data;\n        }),\n        $.get(path + 'properties-radio.html?v=' + version, function (data) {\n            views.radio = data;\n        }),\n        $.get(path + 'properties-textarea.html?v=' + version, function (data) {\n            views.textarea = data;\n        }),\n        $.get(path + 'properties-readme.html?v=' + version, function (data) {\n            views.readme = data;\n        }),\n        $.get(path + 'properties-text.html?v=' + version, function (data) {\n            views.text = data;\n        }),\n        $.get(path + 'properties-time.html?v=' + version, function (data) {\n            views.time = data;\n        }),\n        $.get(path + 'properties-video.html?v=' + version, function (data) {\n            views.video = data;\n        }),\n        $.get(path + 'properties-searchsingle.html?v=' + version, function (data) {\n            views.searchsingle = data;\n        }),\n        $.get(path + 'properties-searchsingle.html?v=' + version, function (data) {\n            views.searchmultiple = data;\n        })\n    ).then(function () {\n        deferred.resolve(views);\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_input_properties_views;\n","'use strict';\nvar consts = require('config/consts.js');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar get_partials = function () {\n\n    var partials = {};\n    var deferred = new $.Deferred();\n    var path = utils.getPartialsPath();\n    var version = consts.FORMBUILDER_VERSION;\n\n    $.when(\n        $.get(path + 'nav-tabs.html?v=' + version, function (data) {\n            partials.navtabs = data;\n        }),\n        $.get(path + 'basic-properties.html?v=' + version, function (data) {\n            partials.basic_properties = data;\n        }),\n        $.get(path + 'uniqueness-form-checkbox.html?v=' + version, function (data) {\n            partials.uniqueness_form_checkbox = data;\n        }),\n        $.get(path + 'uniqueness-hierarchy-checkboxes.html?v=' + version, function (data) {\n            partials.uniqueness_hierarchy_checkboxes = data;\n        }),\n        $.get(path + 'uniqueness-branch-checkbox.html?v=' + version, function (data) {\n            partials.uniqueness_branch_checkbox = data;\n        }),\n        $.get(path + 'exit-branchgroup-editing.html?v=' + version, function (data) {\n            partials.exit_branchgroup_editing = data;\n        }),\n        $.get(path + 'basic-media-properties.html?v=' + version, function (data) {\n            partials.basic_media_properties = data;\n        }),\n        $.get(path + 'basic-branch-properties.html?v=' + version, function (data) {\n            partials.basic_branch_properties = data;\n        }),\n        $.get(path + 'basic-group-properties.html?v=' + version, function (data) {\n            partials.basic_group_properties = data;\n        }),\n        $.get(path + 'basic-readme-properties.html?v=' + version, function (data) {\n            partials.basic_readme_properties = data;\n        }),\n        $.get(path + 'possible-answers-wrapper.html?v=' + version, function (data) {\n            partials.possible_answers_wrapper = data;\n        }),\n        $.get(path + 'possible-answer-list-item.html?v=' + version, function (data) {\n            partials.possible_answer_list_item = data;\n        }),\n        $.get(path + 'jumps-wrapper.html?v=' + version, function (data) {\n            partials.jumps_wrapper = data;\n        }),\n        $.get(path + 'jump-list-item.html?v=' + version, function (data) {\n            partials.jump_list_item = data;\n        }),\n        $.get(path + 'jump-list-item-always-jump.html?v=' + version, function (data) {\n            partials.jump_list_item_always_jump = data;\n        }),\n        $.get(path + 'modal-form.html?v=' + version, function (data) {\n            partials.modal_edit_form_name = data;\n        }),\n        $.get(path + 'input-tool.html?v=' + version, function (data) {\n            partials.input_tool = data;\n        })\n    ).then(function () {\n        deferred.resolve(partials);\n    });\n    return deferred.promise();\n};\n\nmodule.exports = get_partials;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar load_project = function () {\n\n    //get version first, we need it for busting cache in inner ajax requests\n    console.log($('#formbuilder-version').data());\n    try {\n        consts.FORMBUILDER_VERSION = $('#formbuilder-version').data().version;\n    }\n    catch (error) {\n        console.log(error);\n        consts.FORMBUILDER_VERSION = Date.now();\n    }\n\n    var deferred = new $.Deferred();\n\n    utils.setProjectURL();\n\n    console.log(consts.PROJECT_URL + '?' + Date.now());\n\n    //load container views for index.html (main entry point)\n    $.when(\n        $.ajax({\n            url: consts.PROJECT_URL + '?' + Date.now(),\n            type: 'GET',\n            //contentType: 'application/vnd.api+json',\n            success: function (data) {\n                formbuilder.project_definition = data;\n                // formbuilder.project_definition = data\n            },\n            error: function (error) {\n                console.log(error);\n                formbuilder.project_definition = JSON.parse(pako.ungzip(window.atob(error.responseText), { 'to': 'string' }));\n            }\n        })\n    ).then(function () {\n        deferred.resolve();\n    }).fail(function () {\n        deferred.resolve();\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_project;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar methods = {};\n\nmethods.replaceCommonAdvancedProperties = require('template/methods/replaceCommonAdvancedProperties');\nmethods.createInputToolHTML = require('template/methods/createInputToolHTML');\nmethods.prepareAdvancedInputPropertiesHTML = require('template/methods/prepareAdvancedInputPropertiesHTML');\nmethods.getJumpTabBtnHTML = require('template/methods/getJumpTabBtnHTML');\nmethods.getAdvancedTabBtnHTML = require('template/methods/getAdvancedTabBtnHTML');\nmethods.createBasicPropertiesHTML = require('template/methods/createBasicPropertiesHTML');\nmethods.getUniquenessHTML = require('template/methods/getUniquenessHTML');\nmethods.getPossibleAnswersHTML = require('template/methods/getPossibleAnswersHTML');\nmethods.getInputPropertiesPanelHTML = require('template/methods/getInputPropertiesPanelHTML');\nmethods.createInputPropertiesHTML = require('template/methods/createInputPropertiesHTML');\nmethods.getJumpsListHTML = require('template/methods/getJumpsListHTML');\n\nvar template = {\n\n    replaceCommonAdvancedProperties: function (the_markup, the_input) {\n        return methods.replaceCommonAdvancedProperties(the_markup, the_input);\n    },\n    createInputToolHTML: function (input) {\n        return methods.createInputToolHTML(input);\n    },\n    prepareAdvancedInputPropertiesHTML: function (view, input) {\n        return methods.prepareAdvancedInputPropertiesHTML(view, input);\n    },\n    getAdvancedTabBtnHTML: function (ref, is_active) {\n        return methods.getAdvancedTabBtnHTML(ref, is_active);\n    },\n    getJumpTabBtnHTML: function (ref, is_active) {\n        return methods.getJumpTabBtnHTML(ref, is_active);\n    },\n    createBasicPropertiesHTML: function (input) {\n        return methods.createBasicPropertiesHTML(input);\n    },\n    getUniquenessHTML: function (input) {\n        return methods.getUniquenessHTML(input);\n    },\n    getPossibleAnswersHTML: function (input) {\n        return methods.getPossibleAnswersHTML(input);\n    },\n    getInputPropertiesPanelHTML: function (input) {\n        return methods.getInputPropertiesPanelHTML(input);\n    },\n    createInputPropertiesHTML: function (input, view) {\n        return methods.createInputPropertiesHTML(input, view);\n    },\n    getJumpsListHTML: function (input) {\n        return methods.getJumpsListHTML(input);\n    }\n};\n\nmodule.exports = template;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar createBasicPropertiesHTML = function (input) {\n\n    var html;\n    var partials = formbuilder.dom.partials;\n    var question = input.question;\n    var is_required_checked = (input.is_required) ? 'checked' : '';\n    var is_title_checked = (input.is_title) ? 'checked' : '';\n    var is_branch_edit_disabled = (input.question === '') ? 'disabled' : '';\n    var is_group_edit_disabled = (input.question === '') ? 'disabled' : '';\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var branch_inputs = [];\n\n    //when editing a branch, check the title limit against the inputs within a branch (even the group inputs)\n    if (formbuilder.is_editing_branch) {\n        branch_inputs = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref).branch;\n    }\n\n    //if the input is NOT media type, get basic properties\n    if (consts.SINGLE_ANSWER_TYPES.indexOf(input.type) !== -1 || consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n\n        //if input is a readme type, get readme property\n        if (input.type === consts.README_TYPE) {\n            html = partials.basic_readme_properties;\n        }\n        else {\n            html = partials.basic_properties;\n\n            html = html.replace('{{required-flag-checked}}', is_required_checked);\n            html = html.replace('{{title-flag-checked}}', is_title_checked);\n\n            //if 3 titles are already set, disable title checkbox and show proper message\n            //if we are editing a branch, check branch inputs for titles\n\n            if (formbuilder.is_editing_branch ? utils.isMaxTitleLimitReached(branch_inputs) : utils.isMaxTitleLimitReached(inputs)) {\n                if (!input.is_title) {\n                    html = html.replace('{{is-title-disabled}}', 'disabled');\n                    html = html.replace(/{{is-checkbox-disabled}}/g, 'disabled-checkbox');\n                    html = html.replace('{{checkbox-title-label}}', consts.MAX_TITLE_LIMIT_REACHED);\n                }\n                else {\n                    html = html.replace('{{is-title-disabled}}', '');\n                    html = html.replace(/{{is-checkbox-disabled}}/g, '');\n                    html = html.replace('{{checkbox-title-label}}', consts.USE_ANSWER_AS_TITLE);\n                }\n            }\n            else {\n                html = html.replace('{{is-title-disabled}}', '');\n                html = html.replace(/{{is-checkbox-disabled}}/g, '');\n                html = html.replace('{{checkbox-title-label}}', consts.USE_ANSWER_AS_TITLE);\n            }\n        }\n    }\n\n    //if input is a media type, get media properties\n    if (consts.MEDIA_ANSWER_TYPES.indexOf(input.type) !== -1) {\n        html = partials.basic_media_properties;\n    }\n\n    //is a branch? check the edit button status\n    if (input.type === consts.BRANCH_TYPE) {\n        html = partials.basic_branch_properties;\n        html = html.replace('{{branch-edit-disabled}}', is_branch_edit_disabled);\n    }\n\n    //is a group? check the edit button status\n    if (input.type === consts.GROUP_TYPE) {\n        html = partials.basic_group_properties;\n        html = html.replace('{{group-edit-disabled}}', is_group_edit_disabled);\n    }\n\n    html = html.replace(/{{input-ref-question}}/g, input.ref + '-question');\n    html = html.replace('{{basic-input-ref}}', 'basic-' + input.ref);\n    html = html.replace('{{input-question-value}}', question);\n\n    return html;\n};\n\nmodule.exports = createBasicPropertiesHTML;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar createInputPropertiesHTML = function (the_input, the_view) {\n\n    var self = this;\n    var html = the_view;\n    var input = the_input;\n    var partials = formbuilder.dom.partials;\n    var is_media_type = consts.MEDIA_ANSWER_TYPES.indexOf(input.type) !== -1;\n    var nav_tabs = partials.navtabs;\n    var advanced_tab_btn;\n    var jump_tab_button;\n    var properties;\n    var jumps_html;\n    var jump_list_html;\n\n    html = html.replace('{{input-ref}}', input.ref);\n    html = html.replace('{{advanced-input-ref}}', 'advanced-' + input.ref);\n\n    //get navtabs html\n    nav_tabs = nav_tabs.replace('{{#basic-input-ref}}', '#basic-' + input.ref);\n\n    //for media inputs, branch and groups, readme, get disabled 'Advanced tab' button\n    if (is_media_type || input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE || input.type === consts.README_TYPE) {\n        advanced_tab_btn = self.getAdvancedTabBtnHTML(input.ref, false);\n    }\n    else {\n        //get enable advanced tab button\n        advanced_tab_btn = self.getAdvancedTabBtnHTML(input.ref, true);\n    }\n\n    nav_tabs = nav_tabs.replace('{{advanced-tab-btn}}', advanced_tab_btn);\n\n    //for inputs NESTED within a group, disable jumps tab, as we cannot have jumps in groups\n    if (formbuilder.is_editing_group) {\n        jump_tab_button = self.getJumpTabBtnHTML(input.ref, false);\n    }\n    else {\n        jump_tab_button = self.getJumpTabBtnHTML(input.ref, true);\n    }\n\n    nav_tabs = nav_tabs.replace('{{jumps-tab-btn}}', jump_tab_button);\n\n    html = html.replace('{{nav-tabs}}', nav_tabs);\n\n    //get properties html\n    properties = self.createBasicPropertiesHTML(input);\n    html = html.replace('{{properties}}', properties);\n\n    //get jumps html\n    jumps_html = partials.jumps_wrapper;\n    jumps_html = jumps_html.replace('{{jumps-input-ref}}', 'jumps-' + input.ref);\n\n    //build jump list html\n    if (input.jumps.length > 0) {\n        //get list of jumps markup\n        jump_list_html = self.getJumpsListHTML(input);\n        jumps_html = jumps_html.replace('{{no-jumps_message-hidden}}', 'hidden');\n\n        jumps_html = jumps_html.replace('{{jumps-list}}', jump_list_html);\n\n        //if we reached the max number of jumps or this input does not allow multiple jumps, disable button\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) > -1) {\n            //multiple answer input, disable add jump if the maximum number of jumps for the input is reached\n            // or exceeded, the latter because we had a bug.\n            if (input.jumps.length >= input.possible_answers.length) {\n                jumps_html = jumps_html.replace('{{add-jump-btn-state}}', 'disabled');\n            }\n            else {\n                jumps_html = jumps_html.replace('{{add-jump-btn-state}}', '');\n            }\n        }\n        else {\n            //single answer input\n            jumps_html = jumps_html.replace('{{add-jump-btn-state}}', 'disabled');\n        }\n    }\n    else {\n        //no jumps list to render\n        jumps_html = jumps_html.replace('{{jumps-list}}', '');\n        jumps_html = jumps_html.replace('{{add-jump-btn-state}}', '');\n        jumps_html = jumps_html.replace('{{no-jumps_message-hidden}}', '');\n    }\n\n    html = html.replace('{{jumps}}', jumps_html);\n\n    //disable \"Add Jump\" button if the max number of jumps is reached\n    if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n        //multiple jumps allowed, check if limit met (number of jumps must be less or equal to possible answers)\n        if (input.jumps.length >= input.possible_answers.length) {\n            html = html.replace('{{add-jump-btn-state}}', 'disabled=\"disabled\"');\n        }\n        else {\n            html = html.replace('{{add-jump-btn-state}}', '');\n        }\n    }\n    else {\n        //single jump allowed, enable add jump button\n        html = html.replace('{{add-jump-btn-state}}', '');\n    }\n\n    //if multiple choice input type, append possible answer wrapper\n    if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n\n        html = html.replace('{{possible-answers}}', self.getPossibleAnswersHTML(input));\n    }\n    else {\n        html = html.replace('{{possible-answers}}', '');\n    }\n\n    //check if input allows uniqueness\n    if (consts.UNIQUENESS_ALLOWED_TYPES.indexOf(input.type) !== -1) {\n        html = html.replace('{{uniqueness}}', self.getUniquenessHTML(input));\n    }\n    return html;\n};\n\nmodule.exports = createInputPropertiesHTML;\n\n\n","'use strict';\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\n\nvar createInputToolHTML = function (input) {\n\n    var html = '';\n    var icon = utils.getInputToolIcon(input.type);\n    var is_input_branch = (input.type === consts.BRANCH_TYPE) ? 'input-branch' : '';\n    var is_input_group = (input.type === consts.GROUP_TYPE) ? 'input-group' : '';\n    var question = input.question === '' ? messages.error.NO_QUESTION_TEXT_YET : input.question;\n    var invisible_class = input.jumps.length > 0 ? '' : 'invisible';\n\n    //convert html entities to tags and strip html tags from readme type if any\n    if (input.type === consts.README_TYPE) {\n        question = utils.decodeHtml(input.question);\n        question = question.replace(/(<([^>]+)>)/ig, ' ');\n        //wrap in \"\" to avoid rendering of <br/>\n        question = '\"' + question + '\"';\n    }\n\n    html += '<div class=\"input ' + is_input_branch + is_input_group + ' ui-draggable ui-draggable-handle\" ';\n    html += 'data-type=\"' + input.type + '\" data-input-ref=\"' + input.ref + '\">';\n    html += '<div class=\"input-inner\">';\n    html += '<i class=\"fa fa-2x fa-fw ' + icon + '\"></i>';\n    html += '<span class=\"question-preview\">' + question.trunc(consts.LIMITS.question_preview_length) + '</span>';\n    html += '<i class=\"question-state fa fa-check fa-2x fa-fw pull-right\"></i>';\n    html += '<i class=\"jump-state fa fa-arrow-circle-o-down fa-2x fa-fw pull-right ' + invisible_class + '\"></i>';\n\n    if (input.type === consts.BRANCH_TYPE) {\n        html += '{{branch-content}}';\n    }\n    if (input.type === consts.GROUP_TYPE) {\n        html += '{{group-content}}';\n    }\n    html += '</div>';\n    html += '</div>';\n\n    return html;\n};\n\nmodule.exports = createInputToolHTML;\n","'use strict';\n\nvar getAdvancedTabBtnHTML = function (ref, is_active) {\n\n    var html = '';\n\n    if (is_active) {\n        html += '<li role=\"presentation\" class=\"nav-tabs__tab-btn-item advanced-tab\">';\n        html += '<a href=\"#advanced-' + ref + '\" role=\"tab\" data-toggle=\"tab\"> Advanced&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x invisible advanced-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    else {\n\n        html += '<li role=\"presentation\" class=\"disabled disabled-tab nav-tabs__tab-btn-item\">';\n        html += '<a href=\"#\" role=\"tab\" > Advanced&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x  invisible advanced-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    return html;\n};\n\nmodule.exports = getAdvancedTabBtnHTML;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar getInputPropertiesPanelHTML = function (the_input) {\n\n    //todo use the function here http://jsfiddle.net/jfriend00/DyCwk/\n    var self = this;\n    var input = the_input;\n    var is_media_type = consts.MEDIA_ANSWER_TYPES.indexOf(input.type) !== -1;\n    var html = formbuilder.dom.input_properties_views[input.type];\n\n    //get dynamic html for input properties panel\n    html = self.createInputPropertiesHTML(input, html);\n\n    //prepare advanced properties (NOT for branch or groups or media types)\n    if (input.type !== consts.BRANCH_TYPE || input.type !== consts.GROUP_TYPE || !is_media_type) {\n        //manipulate dom for advanced options, which are unique (most of the time) to the input type\n        html = self.prepareAdvancedInputPropertiesHTML(html, input);\n    }\n\n    return html;\n\n};\n\nmodule.exports = getInputPropertiesPanelHTML;\n","'use strict';\n\nvar getJumpTabBtnHTML = function (ref, is_active) {\n\n    var html = '';\n\n    if (is_active) {\n        html += '<li role=\"presentation\" class=\"jump-tab nav-tabs__tab-btn-item\">';\n        html += '<a href=\"#jumps-' + ref + '\" role=\"tab\" data-toggle=\"tab\" > Jumps (IF - ELSE)&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x invisible jumps-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    else {\n        html += '<li role=\"presentation\" class=\"jump-tab disabled disabled-tab nav-tabs__tab-btn-item\">';\n        html += '<a href=\"#\" class=\"nav-tabs__jump\" role=\"tab\" > Jumps (IF - ELSE)&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x invisible jumps-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    return html;\n};\n\nmodule.exports = getJumpTabBtnHTML;\n","/*jshint expr:true */\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nfunction _getSelectedJumpAnswerHTML(possible_answer) {\n    return '<option value=\"' + possible_answer.answer_ref + '\" selected=\"selected\">' + possible_answer.answer + '</option>';\n}\n\nfunction _getSelectedJumpConditionHTML(jump) {\n\n    var text = '';\n\n    $(consts.JUMP_CONDITIONS).each(function (index, condition) {\n        if (condition.key === jump.when) {\n            text = condition.text;\n            return false;\n        }\n    });\n    return '<option value=\"' + jump.when + '\" selected=\"selected\">' + text + '</option>';\n}\n\nfunction _getSelectedJumpDestinationHTML(destination_input) {\n    return '<option value=\"' + destination_input.ref + '\" selected=\"selected\">' + destination_input.question + '</option>';\n}\n\nvar getJumpsListHTML = function (input) {\n\n    var html = '';\n    var inputs = [];\n    var selected_condition_html;\n    var selected_possible_answer_html;\n\n    //get input list (hierarchy or branch)\n    var parts = input.ref.split('_');\n    if (parts.length > 3) {\n        //this is a branch ref\n        parts.pop();\n        inputs = utils.getInputObjectByRef(parts.join('_')).branch;\n    }\n    else {\n        inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    }\n    //jump destinations: cannot jump on the next one, but always next + 1\n    var jump_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n    $(input.jumps).each(function (index, jump) {\n\n        /****************************************************************************************************\n         * set `when option`\n         */\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) === -1) {\n            //append a jump with condition disabled and set to 'always' jump\n            //we do this because on EC5 when the question is an open answer, a jump will always jump no matter the answer given\n            html += formbuilder.dom.partials.jump_list_item_always_jump;\n        }\n        else {\n            //jumps get full functionality with multiple answers input types\n            html += formbuilder.dom.partials.jump_list_item;\n\n            selected_condition_html = _getSelectedJumpConditionHTML(jump);\n            html = html.replace('{{logic-when-saved-option}}', selected_condition_html);\n\n            /****************************************************************************************************\n             *  set selected `answer`\n             */\n            $(input.possible_answers).each(function (index, possible_answer) {\n                if (possible_answer.answer_ref === jump.answer_ref) {\n                    selected_possible_answer_html = _getSelectedJumpAnswerHTML(possible_answer);\n                }\n            });\n            html = html.replace('{{logic-answer-saved-option}}', selected_possible_answer_html);\n            /***************************************************************************************************/\n\n        }\n        /****************************************************************************************************\n         *  set selected `goto`\n         */\n        var selected_goto_html = '';\n        if (jump.to === 'END') {\n            selected_goto_html = _getSelectedJumpDestinationHTML({ ref: 'END', question: 'End of form' });\n        }\n        else {\n            $(jump_destinations).each(function (index, jump_destination) {\n                if (jump_destination.ref === jump.to) {\n                    selected_goto_html = _getSelectedJumpDestinationHTML(jump_destination);\n                    return false;\n                }\n            });\n        }\n\n        html = html.replace('{{logic-goto-saved-option}}', selected_goto_html);\n        /***************************************************************************************************/\n\n        html = html.replace(/{{input-ref-logic-when}}/g, index + '-' + input.ref + '-logic-when');\n        html = html.replace(/{{input-ref-logic-goto}}/g, index + '-' + input.ref + '-logic-goto');\n        html = html.replace(/{{input-ref-logic-answer}}/g, index + '-' + input.ref + '-logic-answer');\n\n    });\n\n\n    return html;\n};\n\nmodule.exports = getJumpsListHTML;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar getPossibleAnswersList = require('template/methods/getPossibleAnswersList');\n\n//generate list of possible answers and inject it into its wrapper, then return it\nvar getPossibleAnswersHTML = function (the_input) {\n\n    var input = the_input;\n    var wrapper = formbuilder.dom.partials.possible_answers_wrapper;\n    var list = getPossibleAnswersList(input.possible_answers);\n\n    wrapper = wrapper.replace('{{possible-answers-list}}', list);\n\n    //toggle \"add answers\" button\n    if (input.possible_answers.length >= consts.LIMITS.possible_answers_max) {\n        //is it a search type? limit is higher for search type\n        if(input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (input.possible_answers.length >= consts.LIMITS.possible_answers_max_search) {\n                wrapper = wrapper.replace('{{disabled}}', 'disabled');\n            }\n            else {\n                wrapper = wrapper.replace('{{disabled}}', '');\n            }\n        }\n        else {\n            wrapper = wrapper.replace('{{disabled}}', 'disabled');\n        }\n    }\n    else {\n        wrapper = wrapper.replace('{{disabled}}', '');\n    }\n\n    return wrapper;\n};\n\nmodule.exports = getPossibleAnswersHTML;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\n\n//generate list of possible answers and return html\nvar getPossibleAnswersList = function (possible_answers) {\n\n    var list = '';\n    var list_item = '';\n\n    //generate markup for first possible answers page\n    $(possible_answers).each(function (index, possible_answer) {\n\n        if (index === consts.LIMITS.possible_answers_per_page) {\n            return false;\n        }\n\n        list_item = formbuilder.dom.partials.possible_answer_list_item;\n        list_item = list_item.replace('{{answer-ref}}', possible_answer.answer_ref);\n        list_item = list_item.replace('{{answer}}', possible_answer.answer);\n\n        if (index === 0 && possible_answers.length === 1) {\n            list_item = list_item.replace('{{disabled}}', 'disabled');\n        }\n        else {\n            list_item = list_item.replace('{{disabled}}', '');\n        }\n        list += list_item;\n    });\n\n    return list;\n};\n\nmodule.exports = getPossibleAnswersList;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\n\n//generate list of possible answers and inject it into its wrapper, then return it\nvar getPossibleAnswersPage = function (the_input, the_page) {\n\n    var input = the_input;\n    var current_page = the_page;\n    var list_item = '';\n    var list = '';\n    var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n    var possible_answers_wrapper = properties_panel.find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n    var from_index = (current_page - 1) * consts.LIMITS.possible_answers_per_page;\n    var to_index = current_page * consts.LIMITS.possible_answers_per_page;\n\n    //remove possible aswers from dom\n    possible_answers_wrapper.find('li').remove();\n\n    //get next possible answers\n    var possible_answers =  input.possible_answers.slice(from_index, to_index);\n\n    $(possible_answers).each(function (index, possible_answer) {\n\n        //replace double quotes with html entities\n        possible_answer.answer = possible_answer.answer.replace(/\"/gi, '&quot;');\n\n        list_item = formbuilder.dom.partials.possible_answer_list_item;\n        list_item = list_item.replace('{{answer-ref}}', possible_answer.answer_ref);\n        list_item = list_item.replace('{{answer}}', possible_answer.answer);\n\n        if (index === 0 && input.possible_answers.length === 1) {\n            list_item = list_item.replace('{{disabled}}', 'disabled');\n        }\n        else {\n            list_item = list_item.replace('{{disabled}}', '');\n        }\n        list += list_item;\n\n        //if the possible answer is invalid, add error in the dom\n        if(possible_answer.answer === '') {\n            //todo\n\n        }\n    });\n\n    //append new page to dom\n    possible_answers_wrapper.hide().html(list).fadeIn(consts.ANIMATION_SLOW);\n};\n\nmodule.exports = getPossibleAnswersPage;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\n\nvar getUniquenessHTML = function (the_input) {\n\n    var html = '';\n    var input = the_input;\n    var form_index = formbuilder.current_form_index;\n    var current_form_name = formbuilder.project_definition.data.project.forms[form_index].name;\n    var partials = formbuilder.dom.partials;\n    var parent_form_name;\n    var is_uniqueness_form_checked;\n    var is_uniqueness_hierarchy_checked;\n\n    function getStandardUniquessMarkup(markup) {\n\n        markup = partials.uniqueness_hierarchy_checkboxes;\n        parent_form_name = formbuilder.project_definition.data.project.forms[form_index - 1].name;\n        markup = markup.replace(/{{parent-form-name}}/g, parent_form_name);\n        markup = markup.replace('{{input-ref-uniqueness-hierarchy}}', input.ref + '-uniqueness-hierarchy');\n\n        is_uniqueness_hierarchy_checked = (input.uniqueness === consts.UNIQUESS_HIERARCHY) ? 'checked' : '';\n        markup = markup.replace('{{input-ref-uniqueness-hierarchy-checked}}', is_uniqueness_hierarchy_checked);\n\n        return markup;\n    }\n\n    function getBranchUniquenessMarkup(markup) {\n        //branch uniquess is within for all the '{branch header}' entries for a branch question within a single entry ('form')\n        markup = partials.uniqueness_branch_checkbox;\n        markup = markup.replace('{{branch-header}}', formbuilder.branch.active_branch_header);\n\n        return markup;\n    }\n\n    //add uniqueness constraint based on form hierarchy\n    if (form_index > 0) {\n        //child forms, user cn select form or hierarchy uniqueness\n        if (formbuilder.is_editing_branch) {\n            //if (formbuilder.is_editing_group) {\n            //    //nested group gets standard uniqueness\n            //    html = getStandardUniquessMarkup(html);\n            //}\n            //  else {\n            //branches get its own uniqueness\n            html = getBranchUniquenessMarkup(html);\n            //  }\n        }\n        else {\n            //standard uniqueness\n            html = getStandardUniquessMarkup(html);\n        }\n    }\n\n    else {\n        //standard uniqueness, top parent form inputscan be set to form uniqueness only\n        if (!formbuilder.is_editing_branch) {\n            html = partials.uniqueness_form_checkbox;\n        }\n        else {\n            //branches get its own uniqueness\n            //if (formbuilder.is_editing_group) {\n            //    //group gets standard uniqueness\n            //    html = partials.uniqueness_form_checkbox;\n            //}\n            //else {\n            //branch uniquess is within for all the branches within a single entry ('form')\n            html = getBranchUniquenessMarkup(html);\n            // }\n        }\n    }\n\n    //common markup\n    html = html.replace('{{input-ref-uniqueness-form}}', input.ref + '-uniqueness-form');\n    is_uniqueness_form_checked = (input.uniqueness === consts.UNIQUESS_FORM) ? 'checked' : '';\n    html = html.replace('{{input-ref-uniqueness-form-checked}}', is_uniqueness_form_checked);\n    html = html.replace(/{{form-name}}/g, current_form_name);\n\n    return html;\n};\n\nmodule.exports = getUniquenessHTML;\n","'use strict';\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar prepareAdvancedInputPropertiesHTML = function (view, input) {\n\n    var html = view;\n    var ref = input.ref;\n    var type = input.type;\n    var datetime_format = {\n        is_checked_datetime_format_1: '',//set first format as default\n        is_checked_datetime_format_2: '',\n        is_checked_datetime_format_3: '',\n        is_checked_datetime_format_4: '',\n        is_checked_datetime_format_5: ''\n    };\n\n    var is_integer_checked;\n    var is_decimal_checked;\n    var is_search_single_checked;\n    var is_search_multiple_checked;\n\n    function _replaceDatetimeAdvancedProperties(type) {\n\n        var i;\n        var iLength = 6;\n\n        //if it is a new input, set datatime format to default\n        if (input.datetime_format === null) {\n            if (input.type === consts.TIME_TYPE) {\n                //for time questions, default to HH:mm to get best UI on device\n                input.datetime_format = consts[type.toUpperCase() + '_FORMAT_3'];\n            }\n            else {\n                input.datetime_format = consts[type.toUpperCase() + '_FORMAT_1'];\n            }\n        }\n\n        //set datetime format to the one saved\n        for (i = 1; i < iLength; i++) {\n            datetime_format['is_checked_datetime_format_' + i] = input.datetime_format === consts[type.toUpperCase() + '_FORMAT_' + i] ? 'checked' : '';\n            html = html.replace('{{is-checked-datetime-format-' + i + '}}', datetime_format['is_checked_datetime_format_' + i]);\n        }\n        html = html.replace('{{input-ref-default-to-current}}', ref + '-default-to-current');\n        html = html.replace('{{set-to-current-datetime}}', set_to_current_datetime);\n    }\n\n    function _replaceNumericAdvancedProperties(type) {\n\n        is_integer_checked = 'checked';\n        is_decimal_checked = '';\n\n        if (type === consts.DECIMAL_TYPE) {\n            is_integer_checked = '';\n            is_decimal_checked = 'checked';\n        }\n\n        html = html.replace('{{is-integer-checked}}', is_integer_checked);\n        html = html.replace('{{is-decimal-checked}}', is_decimal_checked);\n        html = html.replace('{{input-ref-min-value}}', input.min);\n        html = html.replace('{{input-ref-max-value}}', input.max);\n        html = html.replace(/{{input-ref-integer}}/g, ref + '-integer');\n        html = html.replace(/{{input-ref-decimal}}/g, ref + '-decimal');\n        html = html.replace(/{{input-ref-min}}/g, ref + '-min');\n        html = html.replace(/{{input-ref-max}}/g, ref + '-max');\n\n    }\n\n    function _replaceSearchAdvancedProperties(type) {\n\n        is_search_single_checked = 'checked';\n        is_search_multiple_checked = '';\n\n        if (type === consts.SEARCH_MULTIPLE_TYPE) {\n            is_search_single_checked = '';\n            is_search_multiple_checked = 'checked';\n        }\n\n        html = html.replace('{{is-searchsingle-checked}}', is_search_single_checked);\n        html = html.replace('{{is-searchmultiple-checked}}', is_search_multiple_checked);\n\n\n    }\n\n    function _getInitialAnswerHTML(input, the_html) {\n\n        var html = the_html;\n        var answer_label = '';\n\n        html = html.replace(/{{input-ref-default}}/g, input.ref + '-default');\n\n        if (input.default === '' || input.default === null) {\n            //no, set 'none'\n            html = html.replace(/{{selected}}/g, 'selected');\n            html = html.replace(/{{initial-answer}}/g, '');\n        }\n        else {\n\n            //get possible answer label\n            answer_label = utils.getPossibleAnswerLabel(input);\n\n            html = html.replace(/{{selected}}/g, '');\n            html = html.replace(/{{initial-answer}}/g, '<option value=\"' + input.default + '\"  selected >' + answer_label + '</option>');\n        }\n        return html;\n    }\n\n    var set_to_current_datetime = (input.set_to_current_datetime) ? 'checked' : '';\n\n    switch (type) {\n\n        case consts.DROPDOWN_TYPE:\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.RADIO_TYPE:\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.CHECKBOX_TYPE:\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.INTEGER_TYPE:\n            html = this.replaceCommonAdvancedProperties(html, input);\n            _replaceNumericAdvancedProperties(type);\n            break;\n        case consts.DECIMAL_TYPE:\n            html = this.replaceCommonAdvancedProperties(html, input);\n            _replaceNumericAdvancedProperties(type);\n            break;\n        case consts.DATE_TYPE:\n            _replaceDatetimeAdvancedProperties(consts.DATE_TYPE);\n            break;\n        case consts.TIME_TYPE:\n            _replaceDatetimeAdvancedProperties(consts.TIME_TYPE);\n            break;\n        case consts.SEARCH_SINGLE_TYPE:\n            _replaceSearchAdvancedProperties(consts.SEARCH_SINGLE_TYPE);\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.SEARCH_MULTIPLE_TYPE:\n            _replaceSearchAdvancedProperties(consts.SEARCH_MULTIPLE_TYPE);\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        default:\n            html = this.replaceCommonAdvancedProperties(html, input);\n\n    }\n    return html;\n};\n\nmodule.exports = prepareAdvancedInputPropertiesHTML;\n","'use strict';\n\nvar replaceCommonAdvancedProperties = function (the_markup, the_input) {\n\n    var html = the_markup;\n    var input = the_input;\n\n    var replacements = [\n        {\n            to_be_replaced: /{{input-ref-default}}/g,\n            with_this: input.ref + '-default'\n        },\n        {\n            to_be_replaced: /{{input-ref-regex}}/g,\n            with_this: input.ref + '-regex'\n        },\n        {\n            to_be_replaced: /{{input-ref-double-entry}}/g,\n            with_this: input.ref + '-double-entry'\n        },\n        {\n            to_be_replaced: '{{input-ref-default-value}}',\n            with_this: (input.default === null) ? '' : input.default\n        },\n        {\n            to_be_replaced: '{{input-ref-regex-value}}',\n            with_this: (input.regex === null) ? '' : input.regex\n        },\n        {\n            to_be_replaced: '{{input-ref-double-entry-checked}}',\n            with_this: input.verify ? 'checked' : ''\n        }\n    ];\n\n    //replace placeholder with values from input\n    $(replacements).each(function (index, replacement) {\n        html = html.replace(replacement.to_be_replaced, replacement.with_this);\n    });\n\n    return html;\n};\n\nmodule.exports = replaceCommonAdvancedProperties;\n\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar template = require('template');\nvar toast = require('config/toast');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nvar branch_sortable = function () {\n\n    var branch_input;\n\n    return {\n        cursor: 'move',\n        items: '.input',\n        revert: 100,\n        //axis: 'y',// it causes the placeholder to be always active\n        containment: 'parent',\n        tolerance: 'pointer',\n        // forcePlaceholderSize: true,\n        placeholder: 'input-collection-drop-placeholder',\n\n        //triggered when a new input is dropped over the sortable\n        receive: function (e, jquery_ui) {\n\n            var form_index = formbuilder.current_form_index;\n            var previous_branch_input_ref = formbuilder.branch.current_input_ref;\n            var current_element;\n            var branch_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).branch;\n            var branch_input_ref = utils.generateBranchGroupInputRef(formbuilder.current_input_ref);\n            var branch_input_index = branch_inputs.length;\n            var branch_input_type = jquery_ui.item.attr('data-type');\n            var input_factory = require('factory/input-factory');\n\n            //do not consider branch inputs within a branch\n            if (branch_input_type === consts.BRANCH_TYPE) {\n                return false;\n            }\n            else {\n\n                formbuilder.branch.current_input_ref = branch_input_ref;\n\n                //validate previous input (if any) to show embedded errors (in case the ser did not press validate button)\n                //todo is this an overkill?\n                if (previous_branch_input_ref) {\n                    validation.performValidation(utils.getBranchInputObjectByRef(previous_branch_input_ref), false);\n                }\n\n                //  console.log('branch sortable receive');\n\n                formbuilder.branch.collection_is_being_sorted = false;\n\n                //generate input object based on type and set index incrementally\n                branch_input = input_factory.createInput(branch_input_type, branch_input_ref);\n                //formbuilder.current_input_ref = input.ref;\n                //   console.log(branch_input);\n\n                //disable current active element\n                current_element = formbuilder.dom.inputs_collection_sortable.find('.active');\n                current_element.removeClass('active');\n\n                //add input to collection as the last one\n                branch_inputs.push(branch_input);\n                //console.log(branch_inputs);\n                //console.log(formbuilder.project_definition.data.project.forms[form_index].inputs);\n            }\n\n            //disable save project button as by default an input is invalid when it is created\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n            //set form tab as invalid, as the new input will be invalid by default\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        },\n        stop: function (e, jquery_ui) {\n\n            var undo = require('actions/undo');\n            var form_index = formbuilder.current_form_index;\n            var branch_input_ref = formbuilder.branch.current_input_ref;\n            var owner_input_ref = formbuilder.current_input_ref;\n            var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var branch_inputs = inputs[owner_input_index].branch;\n            var placeholder_text = messages.error.NO_QUESTION_TEXT_YET;\n            var input_type = jquery_ui.item.attr('data-type');\n            var active_branch;\n            var properties_panel_html;\n\n            //disable draggable if we hit the max amount of inputs allowed\n            if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n                ui.input_tools.disable();\n            }\n\n            //reject branch inputs here\n            if (input_type === consts.BRANCH_TYPE) {\n                jquery_ui.item.remove();\n\n                //if branch inputs length is zero, show help text placeholder\n                //todo\n            }\n            else {\n\n                //count search inputs\n                if (input_type === consts.SEARCH_SINGLE_TYPE && !formbuilder.branch.collection_is_being_sorted) {\n                    //if the limit is reached, hide search from input tools\n                    if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n                        ui.input_tools.hideSearchInput();\n                        console.log('search limit reached');\n\n                        //show warning to user\n                        toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n                    }\n                }\n\n                //    console.log('sortable stop');\n                jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n                //get the index where the input was dropped (skip when list is empty)\n                //nb the -2 is to remove the element which are no input (warning messages)\n                formbuilder.branch.to_index = jquery_ui.item.index() === 0 ? jquery_ui.item.index() : jquery_ui.item.index() - 2;\n\n                //hide message about no input selected, as dropped input gets focus\n                formbuilder.dom.input_properties_no_input_selected.hide();\n\n                /*\n                 if the user is dragging a new input over, it was added as the last element of the array\n                 otherwise the current input position is set in the start event\n                 */\n                if (!formbuilder.branch.collection_is_being_sorted) {\n\n                    //override 'from_index' as we are dropping a new element (min value for length is 1, as we add the input in the `receive` function)\n                    formbuilder.branch.from_index = branch_inputs.length - 1;\n\n                    //move inputs to keep the array sequence like the input sequence on screen\n                    branch_inputs.move(formbuilder.branch.from_index, formbuilder.branch.to_index);\n                    //console.log(branch_inputs);\n                    //console.log(branch_inputs.length);\n\n                    jquery_ui.item.addClass('active');\n                    jquery_ui.item.attr('data-input-ref', branch_input_ref);\n\n                    //append input id and a warning icon, as by default the question does not have any text\n                    jquery_ui.item.find('.input-inner').append(ui.inputs_collection.getInputStateIconsHTML());\n                    jquery_ui.item.find('span.question-preview').text(placeholder_text);\n\n                    //set owner branch as invalid as we are adding an invalid input\n                    active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n                    ui.inputs_collection.showInputInvalidIcon(active_branch.ref);\n\n                    //show input properties for the new dropped input\n                    formbuilder.dom.input_properties.find('.panel-body form').hide();\n                    formbuilder.dom.input_properties.find('.panel-title span').text(placeholder_text);\n\n                    //create properties panel in right sidebar for this input (common properties)\n                    properties_panel_html = template.getInputPropertiesPanelHTML(branch_input);\n\n                    //append input and show it as it gets selected by default\n                    formbuilder.dom.input_properties_forms_wrapper.hide();\n                    $(properties_panel_html).removeClass('hidden').appendTo(formbuilder.dom.input_properties_forms_wrapper);\n                    formbuilder.dom.input_properties_forms_wrapper.fadeIn(consts.ANIMATION_FAST);\n\n\n                    //show action buttons for input\n                    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n                    //for nested group, enable keyup to check for validation of header text\n                    //triggered when users type in the header input field for nested group\n                    //todo check this\n                    if (branch_input.type === consts.GROUP_TYPE) {\n                        //formbuilder.dom.input_properties.off('keyup').on('keyup', 'input', input_properties_keyup_callback);\n                    }\n                    else {\n                        //formbuilder.dom.input_properties.off('keyup');\n                    }\n\n                    //enable sortable on current input (only when first created)\n                    possibleAnswersSortable(branch_input);\n                }\n                else {\n\n                    //'from_index is set in start event of sortable'\n                    //move branch inputs to keep the array sequence like the input sequence on screen\n                    branch_inputs.move(formbuilder.branch.from_index, formbuilder.branch.to_index);\n                    //console.log(branch_inputs);\n\n                    //run the validation on all branch jumps, as we might have some invalid destinations after re-ordering\n                    //I am forced to do this against all the branch inputs\n                    validation.validateJumpsAfterSorting(branch_inputs);\n\n                    jquery_ui.item.addClass('active');\n                }\n            }\n\n            //todo test this thing\n            //add this state for undoing, so it is easier to rebind everything\n            formbuilder.render_action = consts.RENDER_ACTION_DO;\n            undo.pushState();\n\n            if (input_type === consts.README_TYPE) {\n                $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n            }\n\n            //if there is not any title set, show warning\n            ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(branch_inputs), true);\n\n        },\n        //this callback is triggered when the user start dragging an existing input from the      sortable\n        start: function (e, jquery_ui) {\n\n\n            console.log('sortable start');\n            //get current input position, as we need to move from here\n            //console.log('branch input index: ' + jquery_ui.item.index());\n\n            formbuilder.branch.collection_is_being_sorted = true;\n\n            //nb the -2 is to remove the element which are no input (warning messages)\n            formbuilder.branch.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index() - 2;\n\n            //de-activate all inputs in collection\n            formbuilder.dom.inputs_collection_sortable.removeClass('active');\n\n        },\n        scroll: true,\n        snap: false,\n        over: function (e, jquery_ui) {\n\n            var owner_input_ref = formbuilder.branch.active_branch_ref;\n            var owner_input = utils.getInputObjectByRef(owner_input_ref);\n\n            //hide help text if the list is empty and we are hovering with an input\n            if (owner_input.branch.length === 0) {\n                //remove input from dom collection (middle column)\n                formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + owner_input_ref + '\"]')\n                    .find('.input-properties__no-branch-questions-message')\n                    .hide();\n            }\n        }\n    };\n};\n\nmodule.exports = branch_sortable();\n","'use strict';\nvar formbuilder = require('../config/formbuilder');\nvar draggable = function () {\n\n    $('ul#inputs-tools-list li div.input').draggable({\n        connectToSortable: '.sortable',\n        //clone element keeping same width when dragging\n        //mind: `evt` is jquery generated, it cannot be called anything else!\n        helper: function (evt) {\n\n            var event = evt || window.event;\n\n            /*\n             clone always the input wrapper, checking which element the user is actually dragging\n             */\n            if ($(event.target).prop('tagName') === 'SPAN' || $(event.target).prop('tagName') === 'I') {\n                //dragging elements inside inner div\n                return $(event.target).parent().parent().clone().css({\n                    width: $(event.target).parent().width()\n\n                });\n\n            } else {\n                //dragging inner div\n                if ($(event.target).hasClass('input-inner')) {\n                    return $(event.target).parent().clone().css({\n                        width: $(event.target).width()\n                    });\n\n                }\n                else {\n                    //dragging outer div (input wrapper)\n                    return $(event.target).clone().css({\n                        width: $(event.target).width()\n                    });\n                }\n            }\n        },\n        snap: false,\n        //cursorAt: {left: '50%', top: '50%'}, get mouse x and y dinamically\n        //handle: 'i',\n        // cancel: 'i', //this stop the dragging over the icon, not good\n        //better stop propagation on mousedown like\n        // cursor: 'move', this keep the cursor 'move' after dropping, not good\n        revert: 'invalid',\n        revertDuration: 100,\n        zIndex: 9999,\n        appendTo: 'body',//append outside sortable to avoid flickering\n        stop: function () {\n            formbuilder.collection_is_being_sorted = false;\n\n\n        },\n        start: function (e, ui) {\n\n\n            if ($(e.target).prop('tagName') === 'SPAN' || $(e.target).prop('tagName') === 'I') {\n                $(this).width($(e.target).parent().width());\n            } else {\n                $(this).width($(e.target).width());\n            }\n            //keep track we are dragging from sidebar a new input to the input list\n            formbuilder.collection_is_being_sorted = false;\n        },\n        scroll: true\n    }).disableSelection();\n};\n\nmodule.exports = draggable;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\nvar possible_answers_pager = require('actions/possible-answers-pager');\nvar getPossibleAnswersList = require('template/methods/getPossibleAnswersList');\n\nvar callback = function (params) {\n\n    var selectedHeaderIndex = params.selectedHeaderIndex;\n    var input = params.input;\n    var importedJson = params.importedJson;\n    var list;\n    var properties_panel;\n    var possible_answers_list;\n    var headers = importedJson.meta.fields;\n    var userWantstoReplaceAnswers = params.userWantstoReplaceAnswers;\n    var doesFirstRowContainsHeaders = params.doesFirstRowContainsHeaders;\n    var possible_answers_max = consts.LIMITS.possible_answers_max;\n\n    if(input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n        possible_answers_max = consts.LIMITS.possible_answers_max_search;\n    }\n\n    //if no column is selected abort\n    if (selectedHeaderIndex === null) {\n        return false;\n    }\n\n    //replace or append?\n    if (userWantstoReplaceAnswers) {\n        //reset answers array\n        input.possible_answers = [];\n    }\n\n    //headers on first row or not?\n    if (!doesFirstRowContainsHeaders) {\n\n        var first_row = {};\n        first_row[importedJson.meta.fields[selectedHeaderIndex]] = importedJson.meta.fields[selectedHeaderIndex];\n        //csv file does not have any headers, prepend meta.fields (which is the headers)\n        importedJson.data.unshift(first_row);\n    }\n\n    //append imported possible answers based on selected column (up to max number allowed)\n    $(importedJson.data).each(function (index, item) {\n\n        var imported_answer = item[headers[selectedHeaderIndex]];\n\n        //import as many as we can\n        if (input.possible_answers.length < possible_answers_max && imported_answer !== undefined) {\n\n            //strip html tags\n            imported_answer = imported_answer.replace(/(<([^>]+)>)/ig, ' ');\n\n            //escape double quotes\n            imported_answer = imported_answer.replace(/\"/gi, '&quot;');\n\n            //filter out empty answers\n            if (imported_answer.trim() !== '') {\n\n                //truncate if too long\n                if (imported_answer.length > consts.LIMITS.possible_answer_max_length) {\n                    imported_answer = imported_answer.substring(0,consts.LIMITS.possible_answer_max_length);\n                }\n\n                //add to object\n                input.possible_answers.push({\n                    answer: imported_answer,\n                    answer_ref: utils.generateUniqID()\n                });\n            }\n        }\n        else {\n            //too many, exit\n            console.log('exit at ' + possible_answers_max);\n            return false;//just to exit loop\n        }\n    });\n\n    //get possible answers list markup\n    list = getPossibleAnswersList(input.possible_answers);\n\n    properties_panel = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    possible_answers_list = properties_panel\n        .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n    //empty current list and append new one to dom\n    possible_answers_list\n        .empty()\n        .hide()\n        .append(list)\n        .fadeIn(consts.ANIMATION_FAST);\n\n    //when there is more than 1 possible answers, enable all remove buttons\n    possible_answers_list.find('li div span button').prop('disabled', false);\n\n    //show pagination if needed, starting from page 1\n    if(input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n        formbuilder.possible_answers_pagination[input.ref].page = 1;\n        possible_answers_pager.init(input);\n    }\n    else {\n        //reset pagination\n        possible_answers_pager.tearDown(input);\n    }\n\n    return true;\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar toast = require('config/toast');\nvar utils = require('helpers/utils');\n\nvar callback = function (files) {\n\n    var undo = require('actions/undo');\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n\n\n    //show overlay and cursor\n    formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST);\n\n    //delete all inputs from dom\n    $(inputs).each(function (index, input) {\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties\n            .find('div.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable\n            .find('div.input[data-input-ref=\"' + input.ref + '\"]')\n            .fadeOut(consts.ANIMATION_FAST).remove();\n    });\n\n    //delete all question from project definition\n    formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs = [];\n\n    //after deletion no input is selected, show message and hide context buttons\n    formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n    //hide action button for input\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n    //remove track of any inputs\n    formbuilder.current_input_ref = undefined;\n\n    //re calculate search questions total\n    if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n        ui.input_tools.showSearchInput();\n    }\n\n    //remove title warning if any\n    ui.inputs_collection.toggleTitleWarning(1,false);\n\n    //set form as invalid\n    ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n    //disable save project button\n    ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n    //show import form button\n    formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').removeClass('hidden');\n\n    //handle the undo...can we go back?\n    ui.navbar.toggleUndoBtn(consts.BTN_ENABLED);\n\n    //hide overlay\n    window.setTimeout(function () {\n        formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n    }, 1000);\n\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\n\n\nvar callback = function (e) {\n\n    var undo = require('actions/undo');\n    var form_factory = require('factory/form-factory');\n    var form_ref = formbuilder.current_form_ref;\n    var form_tab = formbuilder.dom.forms_tabs.find('.active');\n    var previous_tab_trigger = form_tab.prev().find('a');\n    var previous_form_ref = previous_tab_trigger.attr('href');\n    var forms = formbuilder.project_definition.data.project.forms;\n\n    //if current form index === 0, do not delete as this is the first form\n    if(formbuilder.current_form_index === 0) {\n        //cannot delete top parent form\n        toastr.error(messages.error.FORM_CANNOT_BE_DELETED);\n        return;\n    }\n\n    //if the current form is not the last in the hierarchy, do not delete it\n    if(formbuilder.current_form_index !== (forms.length - 1)) {\n        //cannot delete top parent form\n        toastr.error(messages.error.FORM_CANNOT_BE_DELETED);\n        return;\n    }\n\n    previous_form_ref = previous_form_ref.substring(1, previous_form_ref.length - 9);\n    //after the form to be deleted is hidden, delete it and unbind the callback\n    previous_tab_trigger.on('shown.bs.tab', function (e) {\n\n        form_factory.removeForm(previous_form_ref, form_ref, form_tab);\n\n        //show toast\n        toastr.warning(messages.warning.FORM_DELETED);\n        undo.pushState();\n\n        previous_tab_trigger.off();\n\n        //run validation, the removed form night have been the only one with invalid inputs\n        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        }\n\n        //show search input if we deleted some search qestions\n        if (utils.getSearchInputsTotal() <= consts.LIMITS.search_inputs_max) {\n            ui.input_tools.showSearchInput();\n        }\n    });\n\n    //unbind current panel handlers before switching\n    form_factory.unbindFormPanelsEvents();\n\n    //update formbuilder dom references to point to the selected form markup\n    form_factory.updateFormbuilderDomReferences(previous_form_ref);\n\n    //bind events to active form\n    form_factory.bindFormPanelsEvents();\n\n    //switch to previous form\n    form_tab.prev().find('a').tab('show');\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar toast = require('config/toast');\n\nvar callback = function (e) {\n\n    var undo = require('actions/undo');\n    // var generate_search_type_project = require('helpers/generate-search-type-project');\n    //\n    // generate_search_type_project.doIt();\n    // return false;\n\n    var index = formbuilder.current_form_index;\n    var formToExport = {\n        data: {\n            id: '',\n            type: 'form',\n            form: {}\n        }\n    };\n    //create a deep copy of the project object properties\n    var project_definition_json = window.CircularJSON.parse(window.CircularJSON.stringify(formbuilder.project_definition));\n    var is_valid_form = true;\n    var project_slug = project_definition_json.data.project.slug;\n    var form = project_definition_json.data.project.forms[index];\n    var filename = project_slug + '__' + form.slug + '__form.json';\n\n    if (form.inputs.length === 0) {\n        toast.showError(messages.error.FORM_IS_INVALID);\n        return;\n    }\n\n    $(form.inputs).each(function (inputIndex, input) {\n\n        //get valid jump destinations\n        var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, form.inputs, false);\n\n        //extra validation for jumps, check if the destination still exists and it is valid\n        $(input.jumps).each(function (jumpIndex, jump) {\n            //does the jump \"to\" property reference a valid destination input?\n            if (!jump_destinations[jump.to]) {\n                //invalid destination found\n                is_valid_form = false;\n            }\n        });\n\n        $(input.branch).each(function (branchInputIndex, branch_input) {\n\n            if (!branch_input.dom.is_valid) {\n                is_valid_form = false;\n            }\n\n            delete branch_input.dom;\n\n            //todo validate branch jumps\n            jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n            //extra validation for jumps, check if the destination still exists and it is valid\n            $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                //does the jump \"to\" property reference a valid destination input?\n                if (!jump_destinations[branchJump.to]) {\n                    //invalid destination found\n                    is_valid_form = false;\n                }\n            });\n\n            $(branch_input.group).each(function (index, group_input) {\n\n                if (!group_input.dom.is_valid) {\n                    is_valid_form = false;\n                }\n                delete group_input.dom;\n            });\n        });\n        $(input.group).each(function (index, group_input) {\n            if (!group_input.dom.is_valid) {\n                is_valid_form = false;\n            }\n            delete group_input.dom;\n        });\n\n        if (!input.dom.is_valid) {\n            is_valid_form = false;\n        }\n        delete input.dom;\n    });\n\n    //wrap form in \"data {}\" accordin to json api\n    formToExport.data.id = form.ref;\n    formToExport.data.form = form;\n\n    if (is_valid_form) {\n        //do export\n\n        var file;\n\n        try {\n            file = new File([JSON.stringify(formToExport)], filename, { type: 'text/plain:charset=utf-8' });\n            saveAs(file);\n        }\n        catch (error) {\n            console.log(error);\n\n            //Microsoft browsers?\n            if (navigator.msSaveBlob) {\n                return navigator.msSaveBlob(new Blob([JSON.stringify(formToExport)], { type: 'text/plain:charset=utf-8' }), filename);\n            }\n            else {\n                //browser not supported yet\n                toast.showError(messages.error.BROWSER_NOT_SUPPORTED);\n            }\n        }\n\n    }\n    else {\n        toast.showError(messages.error.FORM_IS_INVALID);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar form_factory = require('factory/form-factory');\n\nvar callback = function (e) {\n\n    var target = $(this);\n    var href = target.attr('href');\n    var form_ref = target.attr('href').substring(1, href.length - 9);\n    var forms = formbuilder.project_definition.data.project.forms;\n    var inputs;\n    var is_last_child_form;\n    var active_input;\n\n\n    //ignore clicks on active tab\n    if (target.parent().hasClass('active')) {\n        return;\n    }\n\n    //validate active input (if any) before switching\n    if (formbuilder.current_input_ref) {\n        active_input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    }\n\n    //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n    if (active_input) {\n        validation.performValidation(active_input, false);\n    }\n\n    //unbind current panel handlers before switching\n    form_factory.unbindFormPanelsEvents();\n\n    //update formbuilder dom references to point to the selected form markup\n    form_factory.updateFormbuilderDomReferences(form_ref);\n\n    //bind events to active form\n    form_factory.bindFormPanelsEvents();\n\n    //get active input for the selected form (if any)\n    var active_input_ref = formbuilder.dom.inputs_collection_sortable.find('.active').attr('data-input-ref');\n\n    //switch form to selected one\n    formbuilder.current_form_index = parseInt(target.attr('data-form-index'), 10);\n    formbuilder.current_form_ref = forms[formbuilder.current_form_index].ref;\n\n    //remove any reference to selected input\n    //todo check this as we might need to run a validation before switching tab\n    formbuilder.current_input_ref = active_input_ref;\n\n    is_last_child_form = formbuilder.current_form_index === forms.length - 1;\n    //enable delete button if the active child form is the last child\n    if (is_last_child_form) {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__buttons--remove-form')\n            .attr('disabled', false);\n    }\n    else {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__buttons--remove-form')\n            .attr('disabled', true);\n    }\n\n    inputs = forms[formbuilder.current_form_index].inputs;\n\n    //if the new active form does not have a title set, show warning\n    //show no title warning (if no title set for the first form)\n    if (utils.getTitleCount(inputs) === 0 && inputs.length > 0) {\n        ui.inputs_collection.toggleTitleWarning(0, false);\n    }\n\n    //if no inputs, disable download form button\n    if (inputs.length === 0) {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').addClass('disabled');\n\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').addClass('disabled');\n    }\n    else {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n\n    //toggle form icon to a green chck if the top parent form is valid\n    if (validation.areFormInputsValid(formbuilder.current_form_index)) {\n        ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n        //enable download form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        //enable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n    else {\n        //disable download form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').addClass('disabled');\n\n        //disable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').addClass('disabled');\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar toast = require('config/toast');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar parser = {\n    getBranchInputsHTML: require('actions/parse/methods/getBranchInputsHTML'),\n    getGroupInputsHTML: require('actions/parse/methods/getGroupInputsHTML'),\n    renderInputs: require('actions/parse/methods/renderInputs'),\n    renderProject: require('actions/parse/methods/renderProject'),\n    renderChildForms: require('actions/parse/methods/renderChildForms'),\n    initFormbuilder: require('actions/parse/methods/initFormbuilder')\n};\n\nvar import_form_validation = require('helpers/import-form-validation');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\n\nvar callback = function (files) {\n\n    var undo = require('actions/undo');\n    var file = files[0];\n    var file_parts;\n    var file_ext;\n\n    //show overlay and cursor\n    formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST);\n\n    //if the user cancels the action\n    if (!file) {\n        //hide overlay\n        formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        toastr.error(messages.error.FORM_FILE_INVALID);\n        return;\n    }\n\n    file_parts = file.name.split('.');\n    file_ext = file_parts[file_parts.length - 1];\n\n    console.log(file);\n\n    //it must be json\n    if (file_ext !== consts.FORM_FILE_EXTENSION) {\n        //hide overlay\n        formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        toastr.error(messages.error.FORM_FILE_INVALID);\n        return;\n    }\n\n    //todo skip MIME type validation on the front end as it is a mess\n    //json format according to epicollect5 api\n    //if (file.type !== consts.FORM_FILE_ACCEPTED_TYPE) {\n    //hide overlay\n    //     formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n    //     toastr.error(messages.error.FORM_FILE_INVALID);\n    //     return;\n    // }\n\n    var reader = new FileReader();\n\n    reader.onload = function (e) {\n\n        var json_text = e.target.result;\n        var form;\n        var current_form_ref;\n        var imported_form_ref;\n        var regex;\n        var inputs;\n        try {\n            form = JSON.parse(json_text);\n        }\n        catch (error) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            //it means the json is in invalid format\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n\n\n        //validate form structure\n        if (!import_form_validation.hasValidFormStructure(form)) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            //it means the structure is invalid\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n\n        //grab inputs\n        inputs = form.data.form.inputs;\n\n        //are there any inputs?\n        if (inputs.length === 0) {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n\n        //is inputs array?\n        if (!$.isArray(inputs)) {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n        else {\n            var are_valid_inputs = true;\n            $(inputs).each(function (index, input) {\n                if (!import_form_validation.isValidInput(form.data.form.ref, input, false, false)) {\n                    console.log(input);\n                    console.log(JSON.stringify(input));\n                    are_valid_inputs = false;\n                    return false;\n                }\n            });\n\n            if (!are_valid_inputs) {\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n\n            //check total number of questions/branches\n            if (utils.getInputsTotal(inputs) > consts.INPUTS_MAX_ALLOWED) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n\n            //check total number of titles (main form)\n            if (utils.isMaxTitleLimitExceeded(inputs)) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n            //check total number of titles (branches)\n            var are_branch_inputs_valid = true;\n            $(inputs).each(function (index, input) {\n                if (utils.isMaxTitleLimitExceeded(input.branch)) {\n                    are_branch_inputs_valid = false;\n                    return false;\n                }\n            });\n\n            if (!are_branch_inputs_valid) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n\n            //check jumps destinations\n            if (!import_form_validation.areJumpsDestinationsValid(inputs)) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n        }\n\n        //we need to use the current form ref\n        current_form_ref = formbuilder.current_form_ref;\n        imported_form_ref = form.data.form.ref;\n        regex = new RegExp(imported_form_ref, 'g');\n\n        //replace imported form ref with current form ref(all occurrrences)\n        json_text = json_text.replace(regex, current_form_ref);\n        form = JSON.parse(json_text);\n\n        // temporarly setup inputs with the current_form_ref in formbuilder global object (so it can pass jump destinations validation when parsing, and also to render jumps properly in the dom)\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index]\n            .inputs = form.data.form.inputs.slice();\n\n        //parse the form and add the markup then.\n        var renderedInputs = parser.renderInputs(form.data.form.inputs);\n\n        //remove no questions message (if any inputs)\n        if (renderedInputs.length > 0) {\n            formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').addClass('hidden');\n        }\n\n        //show no title warning (if no title set for the first form)\n        if (utils.getTitleCount(renderedInputs) === 0) {\n            ui.inputs_collection.toggleTitleWarning(0, false);\n        }\n\n        //toggle form icon to a green check if the top parent form is valid\n        if (validation.areFormInputsValid(formbuilder.current_form_index)) {\n            ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n            //enable download form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').removeClass('disabled');\n\n            //enable print as pdf form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n        }\n\n        //replace object literal inputs with newly generated ones via factory (i.e. using new) so they get the prototype\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs = renderedInputs.slice();//by value\n\n\n        //enable save project button if all inputs are valid\n        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n\n            //enable save project button (if disabled)\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n\n            //reset some flags\n            formbuilder.current_input_ref = null; //no input is selected\n\n            formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n        }\n\n        //if there are too many search inputs, hide the search input tool in the sidebar\n        if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n            ui.input_tools.hideSearchInput();\n\n            //also show warning\n            //show warning to user\n            toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n        }\n\n        window.setTimeout(function () {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_SLOW);\n            //show success toast\n            toastr.success(messages.success.FORM_IMPORTED);\n            //push state for undo\n            undo.pushState();\n        }, consts.ANIMATION_SLOW);\n    };\n\n    reader.readAsText(file);\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\nvar possible_answers_pager = require('actions/possible-answers-pager');\n\n\nvar callback = function (e) {\n\n    console.log('called branch-sortable-mousedown');\n\n\n    var self = $(this);\n    console.log('formbuilder current input ref ->', JSON.stringify(formbuilder.current_input_ref));\n    console.log('formbuilder active branch ref ->', JSON.stringify(formbuilder.branch.active_branch_ref));\n\n    var ref = self.attr('data-input-ref');\n    var branch_input = utils.getBranchInputObjectByRef(ref);\n    var previous_branch_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n    var branch_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).branch;\n    var question;\n\n    //branch_input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + ref + '\"]');\n\n    /*\n     if both the editing branch flag and the editing group flag are set, we are exiting a nested group\n     */\n    if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n        //we are in nested group edit mode, exit is the only action we need to intercept\n        if (self.hasClass('fa-chevron-left')) {\n\n            //get active nested group we are exiting from\n            var input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n            //exit nested group editing\n            input.exitNestedGroupSortable();\n        }\n        else {\n            return false;\n        }\n    }\n    else {\n\n        //deactivate all inputs in active branch sortable collection\n        formbuilder.dom.inputs_collection_sortable.find('.active-branch .branch-sortable').find('.active').removeClass('active');\n        //activate new clicked element\n        self.addClass('active');\n\n        //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n        if (previous_branch_input) {\n            validation.performValidation(previous_branch_input, false);\n        }\n\n        /*\n         show properties for the selected input in properties panel\n         */\n\n        if (!branch_input.question) {\n            //empty question text? show warning\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n        }\n        else {\n\n            //strip html tags from readme type if any\n            if (branch_input.type === consts.README_TYPE) {\n                question = utils.decodeHtml(branch_input.question);\n                question = question.replace(/(<([^>]+)>)/ig, ' ');\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n            }\n            else {\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(branch_input.question.trunc(20));\n            }\n        }\n\n        //toggle title base on number of titles selected within this branch (but only if not checked)\n        if (utils.isMaxTitleLimitReached(branch_inputs)) {\n            if (!branch_input.is_title) {\n                ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n            }\n        }\n        else {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n\n        }\n\n        formbuilder.dom.input_properties.find('.panel-body form').hide();\n        // //formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]');\n        formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n        //hide 'no inputs selected buttons'\n        formbuilder.dom.input_properties_forms_wrapper.find('.input-properties__no-input-selected').hide();\n\n        //if the input type has possible answers, show pager if needed\n        if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n            if (branch_input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n                //show pagination\n                possible_answers_pager.init(branch_input);\n            }\n            else {\n                possible_answers_pager.tearDown(branch_input);\n            }\n        }\n\n        //show save/delete btns\n        formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n        formbuilder.branch.current_input_ref = ref;\n\n        //enable sortable on current input\n        possibleAnswersSortable(branch_input);\n    }\n\n    if (branch_input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\nvar possible_answers_pager = require('actions/possible-answers-pager');\n\nvar callback = function (e) {\n\n    console.log('called group-sortable-mousedown');\n\n    var self = $(this);\n    var ref = self.attr('data-input-ref');\n    var group_input = utils.getGroupInputObjectByRef(ref);\n    var previous_group_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var question;\n\n    //deactivate all inputs in active group sortable collection\n    formbuilder.dom.inputs_collection_sortable.find('.active-group .group-sortable').find('.active').removeClass('active');\n    //activate new clicked element\n    self.addClass('active');\n\n    //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n    if (previous_group_input) {\n        validation.performValidation(previous_group_input, false);\n    }\n\n    /*\n     show properties for the selected input in properties panel\n     */\n    if (!group_input.question) {\n        //empty question text? show warning\n        formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n    }\n    else {\n\n        //strip html tags from readme type if any\n        if (group_input.type === consts.README_TYPE) {\n            question = utils.decodeHtml(group_input.question);\n            question = question.replace(/(<([^>]+)>)/ig, ' ');\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n        }\n        else {\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(group_input.question.trunc(20));\n        }\n    }\n\n    //toggle title base on number of titles selected (but only if not checked)\n    if (utils.isMaxTitleLimitReached(inputs)) {\n        if (!group_input.is_title) {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n        }\n    }\n    else {\n        ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n    }\n\n    formbuilder.dom.input_properties.find('.panel-body form').hide();\n    formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n    //hide 'no inputs selected buttons'\n    formbuilder.dom.input_properties_forms_wrapper.find('.input-properties__no-input-selected').hide();\n\n    //if the input type has possible answers, show pager if needed\n    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n        if (group_input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n            //show pagination\n            possible_answers_pager.init(group_input);\n        }\n        else {\n            possible_answers_pager.tearDown(group_input);\n        }\n    }\n\n    //show save/delete btns\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n    formbuilder.group.current_input_ref = ref;\n\n    if (group_input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n    //enable sortable on current input\n    possibleAnswersSortable(group_input);\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar validation = require('actions/validation');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\nvar possible_answers_pager = require('actions/possible-answers-pager');\n\nvar callback = function (e) {\n\n    var self = $(this);\n    var ref = self.attr('data-input-ref');\n    var owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n    var group_input = utils.getNestedGroupInputObjectByRef(owner_branch, ref);\n    var previous_group_input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n    var branch_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).branch;\n    var question;\n\n    // group_input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + ref + '\"]');\n\n    //deactivate all inputs in active nested group sortable collection\n    formbuilder.dom.inputs_collection_sortable.find('.active-group .group-sortable').find('.active').removeClass('active');\n    //activate new clicked element\n    self.addClass('active');\n\n    //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n    if (previous_group_input) {\n        validation.performValidation(previous_group_input, false);\n    }\n\n    /*\n     show properties for the selected input in properties panel\n     */\n    if (!group_input.question) {\n        //empty question text? show warning\n        formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n    }\n    else {\n        //strip html tags from readme type if any\n        if (group_input.type === consts.README_TYPE) {\n            question = utils.decodeHtml(group_input.question);\n            question = question.replace(/(<([^>]+)>)/ig, ' ');\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n        }\n        else {\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(group_input.question.trunc(20));\n        }\n    }\n\n    //toggle title base on number of titles selected (but only if not checked)\n    if (utils.isMaxTitleLimitReached(branch_inputs)) {\n        if (!group_input.is_title) {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n        }\n    }\n    else {\n        ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n    }\n\n    formbuilder.dom.input_properties.find('.panel-body form').hide();\n    formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n    //hide 'no inputs selected buttons'\n    formbuilder.dom.input_properties_forms_wrapper.find('.input-properties__no-input-selected').hide();\n\n    //if the input type has possible answers, show pager if needed\n    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n        if (group_input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n            //show pagination\n            possible_answers_pager.init(group_input);\n        }\n        else {\n            possible_answers_pager.tearDown(group_input);\n        }\n    }\n\n    //show save/delete btns\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n    formbuilder.group.current_input_ref = ref;\n\n    if (group_input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n\n    //enable sortable on current input\n    possibleAnswersSortable(group_input);\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar jumps = require('actions/jumps');\nvar possible_answers_pager = require('actions/possible-answers-pager');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nfunction _exitBranch(the_input) {\n\n    var active_branch_input;\n    var input = the_input;\n    var branch_validation;\n\n    //if there is any branch to validate, do it before exiting\n    if (formbuilder.branch.current_input_ref) {\n        //validate currently active branch input (in case the user did not click validate himself)\n        active_branch_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        validation.performValidation(active_branch_input, false);\n\n    }\n    //exit\n    input.exitBranchSortable();\n}\n\nfunction _exitGroup(the_input) {\n\n    var active_group_input;\n    var input = the_input;\n\n    //if there is any group to validate, do it before exiting\n    if (formbuilder.group.current_input_ref) {\n        //validate currently active group input (in case the user did not click validate himself)\n        active_group_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        validation.performValidation(active_group_input, false);\n\n        //branch inputs are already attached to the branch property ot the owner input, just validate them\n        input.validateGroupInputs();\n    }\n    //exit\n    input.exitGroupSortable();\n}\n\n\nvar callback = function (e) {\n\n    /***************************************/\n    //hack to remove focus from jump select so it gets refreshed\n    var $focused = $(':focus');\n    var jump_select = $focused.attr('data-jump-logic');\n    if (jump_select === 'goto') {\n        $focused.blur();\n    }\n    //end hack\n    /*************************************/\n\n    var self = $(this);\n    var previous_input;\n    var ref;\n    var input;\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var question;\n    var copy_btn_state;\n    //var pager;\n\n    /*\n     If we are editng a nested branch  or group we are just interested on a click on the exit button\n     to go back to the parent sortable\n     */\n    if (formbuilder.is_editing_branch || formbuilder.is_editing_group) {\n        //we are in branch edit mode, exit is the only action we need to intercept\n        if (self.hasClass('chevron-left')) {\n            //get ref from parent\n            ref = self.parents().eq(1).attr('data-input-ref');\n            input = utils.getInputObjectByRef(ref);\n\n            if (formbuilder.is_editing_branch) {\n                _exitBranch(input);\n            }\n            else {\n                _exitGroup(input);\n            }\n        }\n        else {\n            return false;\n        }\n    }\n    else {\n\n        /*\n         we are editing a top level sortable\n         */\n        previous_input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n        ref = self.attr('data-input-ref');\n        input = utils.getInputObjectByRef(ref);\n\n        //enable sortable on current input\n        possibleAnswersSortable(input);\n\n        //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n        if (previous_input) {\n            validation.performValidation(previous_input, false);\n        }\n\n        //deactivate all inputs in collection\n        formbuilder.dom.inputs_collection_sortable.find('.active').removeClass('active');\n\n        //activate just current clicked input in the collection\n        self.addClass('active');\n\n        /*\n         show properties for the selected input in properties panel\n         */\n        if (!input.question) {\n            //empty question text? show warning\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n        }\n        else {\n\n            //strip html tags from readme type if any\n            if (input.type === consts.README_TYPE) {\n                question = utils.decodeHtml(input.question);\n                question = question.replace(/(<([^>]+)>)/ig, ' ');\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n            }\n            else {\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(input.question.trunc(20));\n            }\n        }\n    }\n\n    //toggle checkbox events for uniqueness if this is a child form\n    // i.e. checkboxes behave like radio\n    if (formbuilder.current_form_index > 0) {\n\n        //do not attach this event for branches\n        if (!formbuilder.is_editing_branch) {\n\n            //get handle of current active properties panel\n            input.dom.advanced_properties_wrapper = formbuilder\n                .dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]')\n                .find('.input-properties__form__advanced-properties');\n\n            //bind function to make only a single checkbox selected at a time\n            input.dom.advanced_properties_wrapper\n                .find('.input-properties__form__advanced-properties__uniqueness input')\n                .off().on('change', function () {\n\n                    //get the current check/unckeck state of the checkbox the user has click to restore it\n                    var currentCheckBoxState = $(this).prop('checked');\n\n                    //uncheck all\n                    $(this).parents('.input-properties__form__advanced-properties__uniqueness')\n                        .find('input[type=\"checkbox\"]')\n                        .prop('checked', false);\n\n                    //check/uncheck the selected one based on the previous state\n                    $(this).prop('checked', currentCheckBoxState);\n                });\n        }\n    }\n\n\n    //toggle title base on number of titles selected (but only if not checked)\n    if (utils.isMaxTitleLimitReached(inputs)) {\n        if (!input.is_title) {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n        }\n    }\n    else {\n        ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n    }\n\n    ////if any jump, refresh the jumps selected destination label as it might have changed (current selected input only)\n    if (input.jumps.length > 0) {\n        jumps.refreshInputJumpsDom(input, inputs);\n    }\n\n    //show current active input properties panel\n    //formbuilder.dom.input_properties.find('.panel-body form').removeClass('shown').addClass('hidden');\n    formbuilder.dom.input_properties.find('.panel-body form').css('display', 'none');\n    formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n\n    // //if the input type has possible answers, show pager if needed\n    if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n        // pager = formbuilder.dom.input_properties\n        //    .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n        //    .find('.possible-answers__list_pager');\n        if (input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n            //show pagination\n            possible_answers_pager.init(input);\n        }\n        else {\n            possible_answers_pager.tearDown(input);\n        }\n    }\n\n    //show save/delete btns\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n    //hide message about no input selected, as input gets focus\n    formbuilder.dom.input_properties_no_input_selected.hide();\n\n    formbuilder.current_input_ref = ref;\n\n    if (input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n\n    //toggle copy button\n    copy_btn_state = input.dom.is_valid ? consts.BTN_ENABLED : consts.BTN_DISABLED;\n    ui.input_properties_panel.toggleCopyInputButton(input.ref, copy_btn_state);\n\n};\n\nmodule.exports = callback;\n","'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar callback = function (e) {\n\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n\n    console.log(e.target);\n    console.log($(this));\n\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    //get selected initial answer\n    var initial_answer = input.dom.properties_panel\n        .find('.input-properties__form__advanced-properties')\n        .find('.input-properties__form__advanced-properties__default')\n        .find('select').find(':selected');\n\n    console.log(initial_answer);\n\n    if (initial_answer.val() === input.default && input.default !== '') {\n        initial_answer.text(utils.getPossibleAnswerLabel(input));\n    }\n\n    console.log(input);\n    console.log('refresh initial answer');\n\n\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar callback = function () {\n\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    var owner_branch;\n\n    //is editing a branch?\n    if (formbuilder.is_editing_branch) {\n        //override input to be the branch input\n        input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n        //handle nested group inside a branch\n        if (formbuilder.is_editing_group) {\n            owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n    }\n    else {\n        //is editing a group?\n        if (formbuilder.is_editing_group) {\n            //override input to be the branch input\n            input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n    }\n\n    if ($(this).attr('data-jump-logic')) {\n        console.log('it is a jump');\n    }\n\n    if ($(this).attr('data-initial-answer')) {\n        console.log('multi select');\n        input.updatePossibleInitialAnswers();\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr, File, saveAs*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar validation = require('actions/validation');\nvar input_duplicator = require('actions/input-duplicator');\nvar toast = require('config/toast');\n\n/*\n handle click action on input properties panel in the right sidebar (use event delegation)\n we check the class of the target element to trigger the proper action\n */\nvar callback = function (e) {\n\n    console.log('properties panel clicked.');\n\n    var undo = require('actions/undo');\n    var possible_answers = require('actions/possible-answers');\n    var input_factory = require('factory/input-factory');\n    //get hold of the current active input in the input collection (middle column)\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    var first_input_ref;\n    var nested_group;\n    var owner_branch;\n    //get hold of tapped element dom element\n    var target = $(this);\n    var csv;\n    var form_index = formbuilder.current_form_index;\n    var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n\n    formbuilder.render_action = consts.RENDER_ACTION_DO;\n\n    function _getInput() {\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get nested group input\n            owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //get selected branch input\n                input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n            }\n\n            if (formbuilder.is_editing_group) {\n                //get selected group input\n                input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n            }\n        }\n\n        return input;\n    }\n\n    function _validateBranch() {\n\n        //check the branch has got at least 1 input left\n\n        var active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n        if (active_branch.branch.length > 0) {\n            validation.performValidation(active_branch.branch[0], false);\n        }\n        else {\n            //invalid the form as it does not have any inputs\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n            formbuilder.dom.save_project_btn.off('click');\n        }\n    }\n\n    function _validateForm() {\n\n        var form_index = formbuilder.current_form_index;\n\n        if (formbuilder.project_definition.data.project.forms[form_index].inputs.length > 0) {\n            first_input_ref = formbuilder.project_definition.data.project.forms[form_index].inputs[0].ref;\n            if (first_input_ref) {\n                validation.performValidation(utils.getInputObjectByRef(first_input_ref), false);\n            }\n        }\n        else {\n            //invalid the form as it does not have any inputs\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n            formbuilder.dom.save_project_btn.off('click');\n\n            //add no question message\n            formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').removeClass('hidden');\n        }\n    }\n\n    //get hold of advanced properties panel for this input\n    input.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    /***************************************************************\n     * Remove selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__buttons--remove-input')) {\n\n        var deleteQuestion  = function() {\n            //re-enable draggable if needed\n            if ($('ul#inputs-tools-list li div.input').hasClass('dragging-disabled')) {\n                ui.input_tools.enable();\n            }\n\n            //enable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n\n            //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n            if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n                //remove nested group\n                input_factory.removeNestedGroupInput(formbuilder.branch.active_branch_ref, formbuilder.group.current_input_ref);\n                toastr.warning(messages.warning.INPUT_DELETED);\n                _validateForm();\n                //push state to enable undoing the action (deleting input)\n                undo.pushState();\n                return false;\n            } else {\n\n                //nested group?\n                if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n                    //to handle nested group\n                } else {\n\n                    if (formbuilder.is_editing_branch) {\n                        input_factory.removeBranchInput(input.ref, formbuilder.branch.current_input_ref);\n                        toastr.warning(messages.warning.INPUT_DELETED);\n\n                        //run validation as I might have deleted the only invalid input for the branch\n                        //since there is not a previous one, so it uses the first input of the top parent form (if any) just to trigger the validation\n                        _validateBranch();\n\n                        //push state to enable undoing the action (deleting input)\n                        undo.pushState();\n                        return;\n                    }\n\n                    if (formbuilder.is_editing_group) {\n                        input_factory.removeGroupInput(input.ref, formbuilder.group.current_input_ref);\n                        toastr.warning(messages.warning.INPUT_DELETED);\n                        //push state to enable undoing the action (deleting input)\n                        undo.pushState();\n                        return;\n                    }\n                }\n\n                //remove input from input collection (also remove its properties)\n                input_factory.removeInput(input.ref);\n                toastr.warning(messages.warning.INPUT_DELETED);\n\n                //todo I need to do the same for branches, groups and nested groups\n                //run validation as I might have deleted the only invalid input\n                //there is not a previous one, so it uses the first input of the top parent form (if any)\n                _validateForm();\n                //push state to enable undoing the action (deleting input)\n                undo.pushState();\n\n                //show message and import button when no inputs left\n\n                //remove no questions message and upload button, as now we have at least 1 input\n                //todo avoid to to this all the time?\n                if (inputs.length === 0) {\n                    formbuilder.dom.inputs_collection\n                        .find('.input-properties__no-questions-message')\n                        .hide()\n                        .removeClass('hidden')\n                        .fadeIn();\n\n                    //hide title warning message, passing a count > 1\n                    ui.inputs_collection.toggleTitleWarning(1, false);\n\n                    //disable download form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__export-form').addClass('disabled');\n\n                    //disable print as pdf form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__print-as-pdf').addClass('disabled');\n                }\n                return false;\n            }\n        };\n\n        // Show the warning modal\n        var totalEntries = parseInt($('.total-entries').data('total-entries'), 10) || 0;\n        if(totalEntries > 0) {\n            $('#warning-delete-question').modal('show');\n            $('.btn-confirm-delete-question').off('click').on('click', function () {\n                $('#warning-delete-question').modal('hide');\n                deleteQuestion();\n            });\n        }\n        else{\n            deleteQuestion();\n        }\n    }\n\n    /***************************************************************\n     * Copy selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__buttons--copy-input')) {\n        console.log('copying input ***************************************************');\n\n        var input_copied;\n        var search_inputs_total = utils.getSearchInputsTotal();\n\n        input = _getInput();\n\n        //if the input is not valid, reject copy action\n        if (!input.dom.is_valid) {\n            toast.showError(messages.error.INPUT_NOT_VALID);\n            return;\n        }\n\n        //if we reached the max number of questions for this form, bail out\n        if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n            toast.showError(messages.error.MAX_QUESTIONS_LIMIT_REACHED + ' (' + consts.INPUTS_MAX_ALLOWED + ')');\n            ui.input_tools.disable();\n            return;\n        }\n\n        //if the input is of type search and we reached the limit already, bail out\n        if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n\n            //warn the user if limit was reached\n            if (search_inputs_total === consts.LIMITS.search_inputs_max) {\n                toast.showError(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n                return;\n            }\n            //if we are reaching the search input limits with this copy, hide search question tool\n            if (search_inputs_total === consts.LIMITS.search_inputs_max - 1) {\n                //hide search input from question list\n                ui.input_tools.hideSearchInput();\n            }\n        }\n\n        //show overlay\n        formbuilder.dom.overlay.fadeIn();\n\n        //get copy if original input\n        input_copied = input_duplicator.createInputCopy(input);\n\n        console.log('original input', window.CircularJSON.stringify(input));\n\n        console.log('input_copied', window.CircularJSON.stringify(input_copied));\n\n        //add copied input to project definition\n        input_duplicator.pushInput(input_copied);\n\n        //append the copied input markup\n        input_duplicator.appendInputToDom(input_copied);\n\n        /** imp:\n         * After the input is copied when editing a branch, we check the formbuilder current ref\n         * If the formbuilder.current_input_ref is not referencing the branch\n         * buth the inner branch input we reset it to reference the active branch\n         */\n        //HACK:\n        if (formbuilder.is_editing_branch) {\n            var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n            if (owner_input_index === undefined) {\n                owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.branch.active_branch_ref);\n                formbuilder.current_input_ref = formbuilder.branch.active_branch_ref;\n            }\n        }\n        //end HACK:\n\n\n\n        //hide overlay (with delay)\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST, function () {\n                toast.showSuccess(messages.success.INPUT_COPIED);\n            });\n        }, consts.ANIMATION_SLOW);\n    }\n\n    /***************************************************************\n     * Validate selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__buttons--validate-input')) {\n        validation.performValidation(_getInput(), true);\n    }\n\n    /***************************************************************\n     * Add possible answer\n     **************************************************************/\n    if (target.hasClass('input-properties__form__possible-answers__add-answer')) {\n\n        var possible_answers_max = consts.LIMITS.possible_answers_max;\n\n        input = _getInput();\n\n        if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            possible_answers_max = consts.LIMITS.possible_answers_max_search;\n        }\n\n        //add possible answer (if total is less than max allowed)\n        if (input.possible_answers.length < possible_answers_max) {\n            input.addPossibleAnswer();\n            undo.pushState();\n        }\n    }\n\n    /***************************************************************\n     * Remove possible answer\n     **************************************************************/\n    if (target.hasClass('input-properties__form__possible-answers__list__remove-answer')) {\n\n        input = _getInput();\n\n        //we need to leave at least 1 possible answer\n        if (input.possible_answers.length >= 2) {\n            input.removePossibleAnswer(target.closest('li').index());\n            undo.pushState();\n        }\n    }\n\n    /***************************************************************\n     * Add jump to selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__form__jumps__add-jump')) {\n\n        input = _getInput();\n\n        //disable save project button as the new added jump makes the input invalid\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n        //set input as invalid\n        input.dom.is_valid = false;\n\n        //flag input dom in input collection as invalid\n        ui.inputs_collection.showInputInvalidIcon(input.ref);\n\n        //flag current form as invalid\n        ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n        input.addJump();\n        undo.pushState();\n    }\n\n    /***************************************************************\n     * Remove selected jump\n     **************************************************************/\n    if (target.hasClass('input-properties__form__jumps__remove-jump')) {\n\n        input = _getInput();\n\n        input.removeJump(target);\n\n        //revalidate input after deleting a jump as the jump might have been the only thing keeping it invalid\n        validation.performValidation(input, false);\n        undo.pushState();\n    }\n\n    /***************************************************************\n     * Edit branch\n     **************************************************************/\n    if (target.hasClass('input-properties__form__edit-branch')) {\n        target.attr('disabled', true);\n\n        input.enterBranchSortable();\n    }\n    if (target.hasClass('input-properties__form__exit-branch-editing')) {\n        target.attr('disabled', true);\n        target.prev('.input-properties__form__edit-branch').attr('disabled', false);\n        input.exitBranchSortable();\n    }\n\n    /***************************************************************\n     * Edit group\n     **************************************************************/\n    if (target.hasClass('input-properties__form__edit-group')) {\n        target.attr('disabled', true);\n\n        //check whether we are editing a group nested into a branch\n        if (formbuilder.is_editing_branch) {\n\n            nested_group = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n            if (nested_group) {\n                //user clicked on edit nested group button\n                input = nested_group;\n                input.enterGroupSortable(true);\n            }\n        }\n        else {\n            input.enterGroupSortable(false);\n        }\n    }\n\n    if (target.hasClass('input-properties__form__exit-group-editing')) {\n        target.attr('disabled', true);\n        target.prev('.input-properties__form__edit-branch').attr('disabled', false);\n\n        //check whether we are editing a group nested into a branch\n        if (formbuilder.is_editing_branch) {\n            nested_group = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n            if (nested_group) {\n                //user clicked on edit nested group button\n                input = nested_group;\n                input.exitGroupSortable(true);\n            }\n        }\n        else {\n            input.exitGroupSortable(false);\n        }\n    }\n\n    if (target.hasClass('possible_answers__export-csv')) {\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        csv = possible_answers.exportPossibleAnswersCSV();\n\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n\n            if (csv) {\n                //do export\n                var file;\n\n                try {\n                    file = new File([csv.data], csv.filename, { type: 'text/plain:charset=utf-8' });\n                    saveAs(file);\n                }\n                catch (error) {\n                    //Microsoft browsers?\n                    if (window.navigator.msSaveBlob) {\n                        return window.navigator.msSaveBlob(new window.Blob([csv.data], { type: 'text/plain:charset=utf-8' }), csv.filename);\n                    }\n                    else {\n                        //browser not supported yet\n                        toast.showError(messages.error.BROWSER_NOT_SUPPORTED);\n                    }\n                }\n            }\n            else {\n                //show error\n                toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n            }\n        }, consts.ANIMATION_SUPER_SLOW);\n    }\n\n    if (target.hasClass('possible_answers__import-csv')) {\n\n        //import file first then show modal to pick which column (if more than one)\n        //todo not use window, use formbuilder object\n        if (!formbuilder.isOpeningFileBrowser) {\n\n            var file_input = target.find('.possible_answers__import-csv-input-file');\n\n            formbuilder.isOpeningFileBrowser = true;\n\n            file_input.off('change').on('change', function () {\n                possible_answers.importCSVFile(this.files);\n                $(this).val(null);\n            });\n\n            target.find('.possible_answers__import-csv-input-file').trigger('click');\n        }\n\n        //to avoid a infinte loop (since we are triggering the click event)\n        //we remove the flag later, to be able to upload another file\n        //even if the user tapped on \"cancel\"\n        window.setTimeout(function () {\n            formbuilder.isOpeningFileBrowser = false;\n        }, 3000);\n\n    }\n\n    if (target.hasClass('possible_answers__delete-all')) {\n        possible_answers.deleteAllAnswers();\n    }\n\n    if (target.hasClass('possible_answers__order-az')) {\n        possible_answers.orderPossibleAnswers(consts.POSSIBLE_ANSWERS_ORDER.AZ);\n    }\n\n    if (target.hasClass('possible_answers__order-za')) {\n        possible_answers.orderPossibleAnswers(consts.POSSIBLE_ANSWERS_ORDER.ZA);\n    }\n\n    if (target.hasClass('possible_answers__order-shuffle')) {\n        possible_answers.orderPossibleAnswers(consts.POSSIBLE_ANSWERS_ORDER.SHUFFLE);\n    }\n\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar jumps = require('actions/jumps');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\n\nvar callback = function (e) {\n\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var jump_destinations;\n    var owner_branch;\n\n    //is editing a branch?\n    if (formbuilder.is_editing_branch) {\n        //override inputs, get branch inputs from owner input\n        inputs = input.branch;\n        //override input to be the branch input\n        input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n        //handle nested group inside a branch\n        if (formbuilder.is_editing_group) {\n            inputs = input.group;\n            owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n    }\n    else {\n        //is editing a group?\n        if (formbuilder.is_editing_group) {\n            //override inputs, get group inputs from owner input\n            inputs = input.group;\n            //override input to be the branch input\n            input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n    }\n\n    //get all jumps available\n    jump_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n    //check if the <select> is either a jump logic or a multiple choice input\n    if ($(this).attr('data-jump-logic')) {\n\n        var focused_select = $(this);\n        var focused_select_id = focused_select.attr('id');\n\n        //split on the dash to remove the first part of \"focused_select_id\" as it can\n        //be 1-, 2-, 11-, 45-.... so:\n        var focused_select_id_parts = focused_select_id.split('-');\n        focused_select_id_parts.shift();\n        focused_select_id = focused_select_id_parts.join('-');\n        //todo the above is faster with a regex, when there is time...\n\n        switch (focused_select_id) {\n\n            //for open answer input type like  'text', this will be set to 'always'\n            case input.ref + '-logic-when':\n                //list al the available conditions\n                jumps.listJumpConditions(focused_select);\n                break;\n            /*\n             get all possible answers for current input and list them as options\n             (for open answer input type like  'text', this will be hidden)\n             */\n            case input.ref + '-logic-answer':\n                jumps.listJumpPossibleAnswers(focused_select, input);\n                break;\n\n            //get all possible jump destinations for current input and list them as options\n            case input.ref + '-logic-goto':\n                jumps.listJumpDestinations(focused_select, jump_destinations);\n                break;\n        }\n    }\n    else {\n        input.listPossibleInitialAnswers();\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar jumps = require('actions/jumps');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar validation = require('actions/validation');\n\nvar callback = function (e) {\n\n    //ignore left and right arrow keyboard keys (otherwise the user cannot edit a string)\n    //from the docs:\n    // The event.which property normalizes event.keyCode and event.charCode.\n    // It is recommended to watch event.which for keyboard key input.\n    if (e.which === 37 || e.which === 39) {\n        return;\n    }\n\n    var input;\n    var input_question_validation;\n    var possible_answer_validation;\n    var target = $(this);\n    var undo = require('actions/undo');//it is here otherwise it breaks when compiling...go figure??\n    // Capture initial cursor position, as we are replacing the input value on keyup, to avoid the cursor go to the end of the string\n    var position = target[0].selectionStart;\n\n    function _inputIsValid() {\n\n        input.dom.is_valid = true;\n\n        //validate input to refresh dom\n        validation.performValidation(input, false);\n\n        target[0].selectionEnd = position;    // Set the cursor back to the initial position.\n    }\n\n    function _getInput() {\n\n        var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n        var current_branch;\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            //get owner branch\n            current_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n            //get nested group input\n            input = utils.getNestedGroupInputObjectByRef(current_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //get selected branch input\n                input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n            }\n\n            if (formbuilder.is_editing_group) {\n                //get selected group input\n                input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n            }\n        }\n\n        return input;\n    }\n\n    input = _getInput();\n    //get handle of input properties panel\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    //hide errors\n    input.hideQuestionErrors();\n\n    if (target.parent().hasClass('input-properties__form__question')) {\n        //get question\n        input.question = $(this).val();\n\n        //validate question or header\n        if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n            input_question_validation = input.isHeaderTextValid();\n        }\n        else {\n            input_question_validation = input.isQuestionTextValid();\n        }\n\n        if (!input_question_validation.is_valid) {\n            // warn user question text is wrong\n            input.dom.is_valid = false;\n\n            //highlight wrong input and show error message\n            input.showQuestionErrors(input_question_validation.error.message);\n\n            //disable edit btn for groups or branches\n            if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n                input.toggleEditButton(false);\n            }\n\n            //validate all inputs (to toggle save project button on keyup)\n            validation.performValidation(input, false);\n            target[0].selectionEnd = position;    // Set the cursor back to the initial position.\n        }\n        else {\n\n            //branch and group inputs are invalid if they do not have any inputs\n            if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n\n                //enable edit btn for groups or branches\n                input.toggleEditButton(true);\n\n                if (input.type === consts.BRANCH_TYPE && input.branch.length === 0) {\n                    input.dom.is_valid = false;\n                }\n                if (input.type === consts.GROUP_TYPE && input.group.length === 0) {\n                    input.dom.is_valid = false;\n                }\n                if (input.dom.is_valid) {\n                    _inputIsValid();\n                }\n            }\n            else {\n                _inputIsValid();\n            }\n        }\n    }\n\n    if (target.parent().hasClass('input-properties__form__possible-answers__list__possible_answer_item')) {\n\n        possible_answer_validation = validation.isPossibleAnswerValid(target.val());\n\n        //validate each possible answer and show embedded errors if any\n        if (!possible_answer_validation.is_valid) {\n            // warn user question text is wrong\n            input.dom.is_valid = false;\n\n            //highlight wrong answer and show error message\n            input.showPossibleAnswerErrors(target.parent().parent(), possible_answer_validation.error.message);\n\n            validation.performValidation(input, false);\n            target[0].selectionEnd = position;    // Set the cursor back to the initial position.\n\n        } else {\n            _inputIsValid();\n        }\n    }\n\n    //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n    undo.pushState(true);\n};\n\nmodule.exports = callback;\n","/* global $, Ftoastr*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar save = require('actions/save');\n\nvar callback = function () {\n\n    var count;\n    var inputs = [];\n    var active_input;\n    var active_branch;\n\n    if (formbuilder.is_editing_branch) {\n\n        active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n        //group in a branch?\n        if (formbuilder.is_editing_group) {\n            //set active input to be the active group input\n            active_input = utils.getNestedGroupInputObjectByRef(active_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            active_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        }\n\n        //save current input\n        save.saveProperties(active_input);\n\n        inputs = active_branch.branch;\n        count = utils.getTitleCount(inputs);\n        ui.inputs_collection.toggleTitleWarning(count, true);\n\n    }\n    else {\n        //is it a group?\n        if (formbuilder.is_editing_group) {\n            //set active input to be the active group input\n            active_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n        else {\n            //form level input\n            active_input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n        }\n        //save current input\n        save.saveProperties(active_input);\n\n        inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        count = utils.getTitleCount(inputs);\n        //if there is not any title set form the form, show warning\n        ui.inputs_collection.toggleTitleWarning(count, false);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar errors = require('actions/errors');\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar form_factory = require('factory/form-factory');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar undo = require('actions/undo');\n\nvar callback = function (evt) {\n\n    var target = $(evt.relatedTarget);// Button that triggered the modal\n    var modal = $(this);\n    var form_name_input;\n    var form_ref;\n    var is_adding_new_form = false;\n    var form = {};\n    var next_form_index;\n\n    //get partial\n    modal.html(formbuilder.dom.partials.modal_edit_form_name);\n    form_name_input = modal.find('.modal-body input');\n\n    //validate on keyup for better UX todo\n    form_name_input.on('keyup', function () {\n        console.log('activated');\n    });\n\n    if (target.hasClass('main__tabs_add-form')) {\n        console.log('************ - add new form - **************');\n        //todo\n        is_adding_new_form = true;\n        form_ref = utils.generateFormRef();\n        next_form_index = formbuilder.project_definition.data.project.forms.length;\n    }\n    else {\n        //set current form name in modal\n        form_name_input.val(formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].name);\n        form_ref = formbuilder.current_form_ref;\n    }\n\n    //bind save changes button\n    $('.main__modal--edit-form-name__save-btn').off().on('click', function () {\n\n        //get updated value\n        var name = form_name_input.val();\n        var is_form_name_valid;\n        var form_index = formbuilder.current_form_index;\n        var forms = formbuilder.project_definition.data.project.forms;\n\n        //hide errors\n        errors.hideFormNameErrors(modal);\n\n        //validate form name\n        is_form_name_valid = validation.isFormNameValid(name, is_adding_new_form);\n\n        if (!is_form_name_valid.is_valid) {\n            //show errors\n            errors.showFormNameErrors(modal, is_form_name_valid.error.message);\n        }\n        else {\n\n            //disable button to avoid double clicks\n            $(this).off().attr('disabled', true);\n\n            if (is_adding_new_form) {\n\n                //add child form\n                form_factory.createChildForm(name, form_ref, next_form_index, true);\n\n                //disable save project button as we do not accept empty forms\n                ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n                undo.pushState();\n            }\n            else {\n                //update name for current form\n                formbuilder.project_definition.data.project.forms[form_index].name = name;\n                formbuilder.project_definition.data.project.forms[form_index].slug = utils.slugify(name);\n\n                //show name of form in tab and inputs collection container, truncating form name (>10) for UI purposes\n                formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name')\n                    .text(name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)));\n\n                //tab, target the active one\n                formbuilder.dom.forms_tabs.find('.active a')\n                    .text(name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)))\n                    .append('&nbsp;<i class=\"form-state fa fa-check\"></i>');\n\n                //enable save project button\n                ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n            }\n\n            //hide add child form button if the form total is MAX_NUMBER_OF_NESTED_CHILD_FORMS\n            if (formbuilder.project_definition.data.project.forms.length === consts.MAX_NUMBER_OF_NESTED_CHILD_FORMS) {\n                formbuilder.dom.forms_tabs.find('.main__tabs_add-form').parent().hide();\n            }\n\n            //resize form tabs\n            ui.forms_tabs.resizeFormTabs();\n\n            //close modal (with a little delay for better UX, no FOUC)\n            window.setTimeout(function () {\n                modal.modal('hide');\n                //force a backdrop removal as sometimes it is triggered twice\n                $('.modal-backdrop').remove();\n            }, 100);\n        }\n    });\n};\n\nmodule.exports = callback;\n\n\n","/* global $, toastr*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\n\n//todo maybe this callback is not needed anymore\nvar callback = function () {\n\n    //get hold of modal;\n    var modal = $(this);\n\n    //bind buttons\n    modal.find('.table').off().on('click', '.btn', function () {\n\n        var button = $(this);\n        var current_input_regex_property;\n\n        if (formbuilder.is_editing_group) {\n            current_input_regex_property = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + formbuilder.group.current_input_ref + '\"]')\n                .find('.input-properties__form__advanced-properties__regex input');\n        }\n        else {\n\n            if (formbuilder.is_editing_branch) {\n                current_input_regex_property = formbuilder.dom.input_properties_forms_wrapper\n                    .find('form[data-input-ref=\"' + formbuilder.branch.current_input_ref + '\"]')\n                    .find('.input-properties__form__advanced-properties__regex input');\n            }\n            else {\n\n                current_input_regex_property = formbuilder.dom.input_properties_forms_wrapper\n                    .find('form[data-input-ref=\"' + formbuilder.current_input_ref + '\"]')\n                    .find('.input-properties__form__advanced-properties__regex input');\n            }\n        }\n\n        //apply the selected regex\n        current_input_regex_property.val(consts.REGEX[button.attr('data-apply-regex')]);\n\n        modal.modal('hide');\n    });\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar toast = require('config/toast');\n\nvar callback = function (e) {\n\n    function _renderQuestion(input) {\n\n        //strip html tags from readme type if any\n        if (input.type === consts.README_TYPE) {\n            input.question = utils.decodeHtml(input.question);\n            input.question = input.question.replace(/(<([^>]+)>)/ig, ' ');\n            html += '<hr/>';\n        }\n\n        html += '<h4 class=\"question\">' + input.question + '</h4>';\n\n        if (input.type === consts.TEXTAREA_TYPE) {\n            html += '<table border=\"1\" width=\"100%\">';\n            html += '<tr><td></td></td></tr>';\n            html += '<tr><td></td></td></tr>';\n            html += '<tr><td></td></td></tr>';\n            html += '<tr><td></td></td></tr>';\n            html += '</table>';\n        }\n        else {\n            if (input.type !== consts.README_TYPE) {\n                html += '<table border=\"1\" width=\"100%\">';\n                html += '<tr><td></td></td></tr>';\n                html += '</table>';\n            }\n            else {\n                html += '<hr/>';\n            }\n        }\n    }\n\n    function _renderPossibleAnswers(input) {\n        $.each(input.possible_answers, function (index, possible_answer) {\n\n            switch (input.type) {\n                case consts.SEARCH_SINGLE_TYPE:\n                case consts.SEARCH_MULTIPLE_TYPE:\n\n                    if (index === 0) {\n                        html += '<ul class=\"possible-answers-list\">';\n                    }\n\n                    html += '<li><h5>' + possible_answer.answer + '</h5></li>';\n\n                    if (index === input.possible_answers.length - 1) {\n                        html += '</ul>';\n                    }\n                    break;\n                //render dropdown and radio as radio buttons (single choice)\n                case consts.DROPDOWN_TYPE:\n                case consts.RADIO_TYPE:\n                    html += '<div class=\"radio-type\"><h5>';\n                    html += '<input type=\"radio\"  value=\"' + possible_answer.answer + '\">';\n                    html += '<label for=\"' + possible_answer.answer + '\">' + possible_answer.answer + '</label>';\n                    html += '</h5></div>';\n                    break;\n                case consts.CHECKBOX_TYPE:\n                    html += '<div class=\"checkbox-type\"><h5>';\n                    html += '<input type=\"checkbox\"  value=\"' + possible_answer.answer + '\">';\n                    html += '<label for=\"' + possible_answer.answer + '\">' + possible_answer.answer + '</label>';\n                    html += '</h5></div>';\n                    break;\n                default:\n                //do nothing\n            }\n        });\n    }\n\n\n    var html = '';\n\n    //add form title\n    html += '';\n    var index = formbuilder.current_form_index;\n\n    //create a deep copy of the project object properties\n    var project_definition_json = window.CircularJSON.parse(window.CircularJSON.stringify(formbuilder.project_definition));\n    var is_valid_form = true;\n    var project_slug = project_definition_json.data.project.slug;\n    var form = project_definition_json.data.project.forms[index];\n\n    if (form.inputs.length === 0) {\n        toast.showError(messages.error.FORM_IS_INVALID);\n        return;\n    }\n\n    //print project name as header\n    html += '<h2>' + project_definition_json.data.project.name + '</h2>';\n\n    //print form name as header\n    html += '<h3>' + form.name + '</h3>';\n\n    $(form.inputs).each(function (inputIndex, input) {\n\n        //get valid jump destinations\n        var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, form.inputs, false);\n\n        //extra validation for jumps, check if the destination still exists and it is valid\n        $(input.jumps).each(function (jumpIndex, jump) {\n            //does the jump \"to\" property reference a valid destination input?\n            if (!jump_destinations[jump.to]) {\n                //invalid destination found\n                is_valid_form = false;\n            }\n        });\n\n        switch (input.type) {\n\n            case consts.BRANCH_TYPE:\n                html += '<h4 class=\"branch-header\">' + input.question + '</h4>';\n\n                html += '<table border=\"1\" cellpadding=\"10\" cellspacing=\"10\">';\n                html += '<tr>';\n                html += '<td>';\n\n                $(input.branch).each(function (branchInputIndex, branch_input) {\n\n                    if (!branch_input.dom.is_valid) {\n                        is_valid_form = false;\n                    }\n\n                    delete branch_input.dom;\n\n                    //todo validate branch jumps\n                    jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n                    //extra validation for jumps, check if the destination still exists and it is valid\n                    $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                        //does the jump \"to\" property reference a valid destination input?\n                        if (!jump_destinations[branchJump.to]) {\n                            //invalid destination found\n                            is_valid_form = false;\n                        }\n                    });\n\n                    //multiple choice question?\n                    if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        html += '<h4 class=\"question\">' + branch_input.question + '</h4>';\n                        //render possible answers\n                        _renderPossibleAnswers(branch_input);\n                    }\n                    else {\n                        _renderQuestion(branch_input);\n                    }\n\n                    $(branch_input.group).each(function (index, group_input) {\n\n                        if (!group_input.dom.is_valid) {\n                            is_valid_form = false;\n                        }\n                        delete group_input.dom;\n\n                        //multiple choice question?\n                        if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                            html += '<h4 class=\"question\">' + group_input.question + '</h4>';\n                            //render possible answers\n                            _renderPossibleAnswers(group_input);\n                        }\n                        else {\n                            _renderQuestion(group_input);\n                        }\n                    });\n                });\n\n                html += '</td>';\n                html += '</tr>';\n                html += '</table>';\n                break;\n\n            case consts.GROUP_TYPE:\n                html += '<h4 class=\"group-header\">' + input.question + '</h4>';\n\n                html += '<table border=\"1\" cellpadding=\"10\" cellspacing=\"10\">';\n                html += '<tr>';\n                html += '<td>';\n\n\n                $(input.group).each(function (index, group_input) {\n                    if (!group_input.dom.is_valid) {\n                        is_valid_form = false;\n                    }\n                    delete group_input.dom;\n\n                    //multiple choice question?\n                    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        html += '<h4 class=\"question\">' + group_input.question + '</h4>';\n                        //render possible answers\n                        _renderPossibleAnswers(group_input);\n                    }\n                    else {\n                        _renderQuestion(group_input);\n                    }\n                });\n\n                html += '</td>';\n                html += '</tr>';\n                html += '</table>';\n                break;\n\n            default:\n                //multiple choice question?\n                if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                    html += '<h4 class=\"question\">' + input.question + '</h4>';\n                    //render possible answers\n                    _renderPossibleAnswers(input);\n                }\n                else {\n                    //open answer question\n                    _renderQuestion(input);\n                }\n        }\n\n        if (!input.dom.is_valid) {\n            is_valid_form = false;\n        }\n        delete input.dom;\n    });\n\n    if (is_valid_form) {\n        //do print\n        $('.print-preview-wrapper').empty().append(html);\n        window.print();\n    }\n    else {\n        toast.showError(messages.error.FORM_IS_INVALID);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr, Flatted, require */\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar toast = require('config/toast');\n\n\n/*\n handle click action on save project button\n */\nvar callback = function (e) {\n\n    //for testing\n    var url = '../postdump/index.php';\n    var validation = require('actions/validation');\n    var current_input = utils.getCurrentlySelectedInput();\n\n    /***************************************************************\n     * Save project\n     **************************************************************/\n\n    //save the currently selected input just in case\n    if (current_input) {\n        validation.performValidation(utils.getCurrentlySelectedInput(), false);\n    }\n\n    //create a deep copy of the project object properties\n    var project_definition_json = Flatted.parse(Flatted.stringify(formbuilder.project_definition));\n    //clean up forms from extra properties\n\n    var cleanedForms = save.doCleaningBeforeSaving(project_definition_json.data.project.forms);\n\n    if (cleanedForms.all_jumps_valid && cleanedForms.invalid_jumps_question === '') {\n        //*****************************************************************************************************\n        //after cleaning, do extra validation, the same one that runs when importing a form -------------------------\n        var result = {\n            is_valid: true,\n            error: {\n                message: null\n            }\n        };\n\n        $(project_definition_json.data.project.forms).each(function (formIndex, form) {\n\n            var validateBeforeSaving = require('actions/validation').validateBeforeSaving;\n\n            result = validateBeforeSaving(form.ref, form.inputs);\n\n            if (!result.is_valid) {\n                return false;//exit loop\n            }\n        });\n\n        //catch forms invalid here\n        if (!result.is_valid) {\n            toast.showError(result.error.message);\n            return false;\n        }\n\n        //******************************************************************************************************\n        //all valid, start saving ------------------------------------------------------------------------------\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST);\n\n        //for local testing only\n        if (window.location.href.indexOf('localhost/') !== -1 && window.location.href.indexOf('epicollect5-formbuilder/') !== -1) {\n            consts.PROJECT_URL = url;\n            console.log('Saved project definition ->', window.CircularJSON.stringify(project_definition_json));\n        }\n\n        $.ajax({\n            url: consts.PROJECT_URL,\n            //  contentType: 'application/vnd.api+json',\n            data: window.btoa(pako.gzip(JSON.stringify(project_definition_json), {\n                'to': 'string'\n            }\n            )),\n            //  data: JSON.stringify(project_definition_json),\n            //   dataType: 'json',\n            method: 'POST',\n            crossDomain: true,\n            success: function (data) {\n                window.setTimeout(function () {\n                    formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST, function () {\n                        toast.showSuccess(messages.success.PROJECT_SAVED);\n                    });\n\n                }, consts.ANIMATION_SLOW);\n                console.log(data);\n                console.log('posted successfully');\n\n            },\n            error: function (xhr, error, response) {\n\n                var error_obj;\n                var titles = '';\n\n                try {\n                    error_obj = JSON.parse(xhr.responseText);\n                    console.log(xhr.responseText);\n                    console.log(xhr, error, response);\n                    //get server errors\n                    $(error_obj.errors).each(function (index, error) {\n                        titles += '<br/>' + error.title;\n                    });\n                } catch (error) {\n                    console.log(error);\n                }\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toast.showError(messages.error.PROJECT_NOT_SAVED + titles, 3000);\n            }\n        }\n        );\n    }\n    else {\n        toast.showError(messages.error.JUMP_INVALID + cleanedForms.invalid_jumps_question);\n    }\n};\n\nmodule.exports = callback;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar template = require('template');\nvar toast = require('config/toast');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nvar group_sortable = function () {\n\n    var group_input;\n\n    return {\n        cursor: 'move',\n        items: '.input',\n        revert: 100,\n        //axis: 'y',// it causes the placeholder to be always active\n        containment: 'parent',\n        tolerance: 'pointer',\n        // forcePlaceholderSize: true,\n        placeholder: 'input-collection-drop-placeholder',\n\n        //triggered when a new input is dropped over the sortable\n        receive: function (e, jquery_ui) {\n\n            var form_index = formbuilder.current_form_index;\n            var previous_group_input_ref = formbuilder.group.current_input_ref;\n            var current_element;\n            var group_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).group;\n            var group_input_ref = utils.generateBranchGroupInputRef(formbuilder.current_input_ref);\n            var group_input_index = group_inputs.length;\n            var group_input_type = jquery_ui.item.attr('data-type');\n            var input_factory = require('factory/input-factory');\n            var owner_branch;\n\n            //if we are editing a branch, it means this is a nested group, update references accordingly\n            if (formbuilder.is_editing_branch) {\n                console.log('we are editing a nested group');\n\n                group_inputs = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref).group;\n                group_input_ref = utils.generateBranchGroupInputRef(formbuilder.branch.current_input_ref);\n                group_input_index = group_inputs.length;\n            }\n\n            //do not consider group/branch inputs within a group\n            if (group_input_type === consts.BRANCH_TYPE || group_input_type === consts.GROUP_TYPE) {\n                return false;\n            }\n            else {\n\n                formbuilder.group.current_input_ref = group_input_ref;\n\n                //validate previous input (if any) to show embedded errors (in case the user did not press validate button)\n                //todo is this an overkill?\n                if (previous_group_input_ref) {\n\n                    if (formbuilder.is_editing_branch) {\n                        //this is a nested group,get owner branch\n                        owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n                        validation.performValidation(utils.getNestedGroupInputObjectByRef(owner_branch, previous_group_input_ref), false);\n                    }\n                    else {\n                        validation.performValidation(utils.getGroupInputObjectByRef(previous_group_input_ref), false);\n                    }\n\n                }\n\n                console.log('group sortable receive');\n\n                formbuilder.group.collection_is_being_sorted = false;\n\n                //generate input object based on type and set index incrementally\n                group_input = input_factory.createInput(group_input_type, group_input_ref);\n                console.log(group_input);\n\n                //disable current active element\n                current_element = formbuilder.dom.inputs_collection_sortable.find('.active');\n                current_element.removeClass('active');\n\n                //add input to collection as the last one\n                group_inputs.push(group_input);\n            }\n\n            //disable save project button as by default an input is invalid when it is created\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n        },\n        stop: function (e, jquery_ui) {\n\n            var undo = require('actions/undo');\n            var form_index = formbuilder.current_form_index;\n            var group_input_ref = formbuilder.group.current_input_ref;\n            var owner_input_ref = formbuilder.current_input_ref;\n            var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var group_inputs = inputs[owner_input_index].group;\n            var placeholder_text = messages.error.NO_QUESTION_TEXT_YET;\n            var input_type = jquery_ui.item.attr('data-type');\n            var properties_panel_html;\n\n            //disable draggable if we hit the max amount of inputs allowed\n            if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n                ui.input_tools.disable();\n            }\n            //reject group/branch inputs here\n            if (input_type === consts.BRANCH_TYPE || input_type === consts.GROUP_TYPE) {\n                jquery_ui.item.remove();\n                //if group inputs length is zero, show help text placeholder\n                //todo\n            }\n            else {\n                //count search inputs\n                if(input_type === consts.SEARCH_SINGLE_TYPE && !formbuilder.group.collection_is_being_sorted) {\n                    //if the limit is reached, hide search from input tools\n                    if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n                        ui.input_tools.hideSearchInput();\n                        //show warning to user\n                        toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')')\n                    }\n                }\n\n                //if we are editing a branch, it means this is a nested group\n                if (formbuilder.is_editing_branch) {\n                    console.log('we are editing a nested group');\n                    owner_input_ref = formbuilder.branch.current_input_ref;\n                    group_inputs = utils.getBranchInputObjectByRef(owner_input_ref).group;\n                }\n\n                jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n                //get the index where the input was dropped (skip when list is empty)\n                formbuilder.group.to_index = jquery_ui.item.index() === 0 ? jquery_ui.item.index() : jquery_ui.item.index() - 1;\n\n                //hide message about no input selected, as dropped input gets focus\n                formbuilder.dom.input_properties_no_input_selected.hide();\n\n\n                /*\n                 if the user is dragging a new input over, it was added as the last element of the array\n                 otherwise the current input position is set in the start event\n                 */\n                if (!formbuilder.group.collection_is_being_sorted) {\n\n                    //override 'from_index' as we are dropping a new element (min value for length is 1, as we add the input in the `receive` function)\n                    formbuilder.group.from_index = group_inputs.length - 1;\n\n                    //move inputs to keep the array sequence like the input sequence on screen\n                    group_inputs.move(formbuilder.group.from_index, formbuilder.group.to_index);\n\n                    jquery_ui.item.addClass('active');\n                    jquery_ui.item.attr('data-input-ref', group_input_ref);\n\n                    //append input id and a warning icon, as by default the question does not have any text\n                    jquery_ui.item.find('.input-inner').append(ui.inputs_collection.getInputStateIconsHTML());\n                    jquery_ui.item.find('span.question-preview').text(placeholder_text);\n\n                    //show input properties for the new dropped input\n                    formbuilder.dom.input_properties.find('.panel-body form').hide();\n                    formbuilder.dom.input_properties.find('.panel-title span').text(placeholder_text);\n\n                    //create properties panel in right sidebar for this input (common properties)\n                    properties_panel_html = template.getInputPropertiesPanelHTML(group_input);\n\n                    //append input and show it as it gets selected by default\n                    formbuilder.dom.input_properties_forms_wrapper.hide();\n                    $(properties_panel_html).removeClass('hidden').appendTo(formbuilder.dom.input_properties_forms_wrapper);\n\n                    formbuilder.dom.input_properties_forms_wrapper.fadeIn(consts.ANIMATION_FAST);\n\n                    //show action buttons for input\n                    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n                    if (!formbuilder.is_editing_branch) {\n\n                        //formbuilder.dom.input_properties.off('keyup');\n\n                        //this is NOT nested group\n                        //triggered when users type in the header input field for branches or groups\n                        if (group_input.type === consts.GROUP_TYPE) {\n                            formbuilder.dom.input_properties.on('keyup', 'input', input_properties_keyup_callback);\n                        }\n                    }\n\n                    //enable sortable on current input\n                    possibleAnswersSortable(group_input);\n                }\n                else {\n                    //'from_index is set in start event of sortable'\n                    //move inputs to keep the array sequence like the input sequence on screen\n                    group_inputs.move(formbuilder.group.from_index, formbuilder.group.to_index);\n\n                    //run the validation on all group jumps, as we might have some invalid destinations after re-ordering\n                    //I am forced to do this against all the branch inputs\n                    validation.validateJumpsAfterSorting(group_inputs);\n\n                    jquery_ui.item.addClass('active');\n                }\n            }\n\n            //add this state for undoing, so it is easier to rebind everything\n            formbuilder.render_action = consts.RENDER_ACTION_DO;\n            undo.pushState();\n\n            if (input_type === consts.README_TYPE) {\n                $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n            }\n        },\n        //this callback is triggered when the user start dragging an existing input from the sortable\n        start: function (e, jquery_ui) {\n\n            //get current input position, as we need to move from here\n            formbuilder.group.collection_is_being_sorted = true;\n            formbuilder.group.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index() - 1;\n            //de-activate all inputs in collection\n            formbuilder.dom.inputs_collection_sortable.removeClass('active');\n\n        },\n        scroll: true,\n        snap: false,\n        over: function (e, jquery_ui) {\n\n            var owner_input_ref = formbuilder.group.active_group_ref;\n            var owner_input = utils.getInputObjectByRef(owner_input_ref);\n\n            //if we are editing a nested group, grab the nested group\n            if (formbuilder.is_editing_branch) {\n                owner_input = utils.getBranchInputObjectByRef(owner_input_ref);\n            }\n\n            //hide help text if the list is empty and we are hovering with an input\n            if (owner_input.group.length === 0) {\n                //remove input from dom collection (middle column)\n                formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + owner_input_ref + '\"]')\n                    .find('.input-properties__no-group-questions-message')\n                    .hide();\n            }\n        }\n    };\n};\n\nmodule.exports = group_sortable();\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\n\nvar possibleAnswersSortable = function (input) {\n\n    var validation = require('actions/validation');\n\n    //if not multiple choice type, return\n    if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) === -1) {\n        return false;\n    }\n\n    //attach sortable only once per each input to keep low memory usage\n    if ($.inArray(input.ref, formbuilder.possible_answers.enabled_sortable) === -1) {\n\n        //enable sortable for this input\n        formbuilder.dom.input_properties_forms_wrapper\n            .find('.input-properties__form__possible-answers__list').sortable({\n            axis: 'y',\n            containment: 'parent',\n            handle: '.input-properties__form__possible-answers__list__drag-answer',\n            cancel: '',\n            helper: 'clone',\n            tolerance: 'pointer',\n            placeholder: 'possible-answers-drop-placeholder',\n            stop: function (e, jquery_ui) {\n                //'from_index is set in start event of sortable'\n                formbuilder.possible_answers.to_index = jquery_ui.item.index('') === 0 ? jquery_ui.item.index() : jquery_ui.item.index();\n\n                //move inputs to keep the possible answers sequence like the sequence on screen (dom)\n                input.possible_answers.move(formbuilder.possible_answers.from_index, formbuilder.possible_answers.to_index);\n\n                //save possible answers\n                input.savePossibleAnswers();\n                //validate input\n                validation.performValidation(input, false);\n\n                //enable save project button as user made a change\n                //and ALL the inputs are valid\n\n                //enable save project button if all inputs are valid\n                if (validation.areAllInputsValid(formbuilder.project_definition)) {\n                    //enable save project button (if disabled)\n                    ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                    formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n                }\n            },\n            start: function(e, jquery_ui){\n                formbuilder.possible_answers.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index();\n            }\n        }).disableSelection();\n\n        //keep track of the current inpuot so we do not attach the event more than once\n        formbuilder.possible_answers.enabled_sortable.push(input.ref);\n    }\n};\n\nmodule.exports = possibleAnswersSortable;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar template = require('template');\nvar undo = require('actions/undo');\nvar toast = require('config/toast');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nvar sortable = function () {\n\n    var input;\n\n    formbuilder.dom.inputs_collection_sortable.sortable({\n        zIndex: 9999,\n        cursor: 'move',\n        items: '> div.input',\n        revert: 100,\n        //axis: 'y',// it causes the placeholder to be always active\n        containment: 'parent',\n        // containment: 'document', no!\n        tolerance: 'pointer',\n        // forcePlaceholderSize: true,\n        placeholder: 'input-collection-drop-placeholder',\n\n        //triggered when a new input is dropped over the sortable\n        receive: function (e, jquery_ui) {\n\n            var input_factory = require('factory/input-factory');\n            var form_index = formbuilder.current_form_index;\n            var form_ref = formbuilder.current_form_ref;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var previous_input_ref = formbuilder.current_input_ref;\n            var input_type = jquery_ui.item.attr('data-type');\n            var input_index = inputs.length;\n            var input_ref = utils.generateInputRef(form_ref);\n\n            //validate previous input (if any) to show embedded errors (in case the user did not press validate button)\n            if (previous_input_ref && input_index > 0) {\n                validation.performValidation(utils.getInputObjectByRef(previous_input_ref), false);\n            }\n\n            //console.log('sortable receive');\n            jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n            formbuilder.collection_is_being_sorted = false;\n            //generate input object based on type and set index incrementally\n            input = input_factory.createInput(input_type, input_ref);\n            formbuilder.current_input_ref = input.ref;\n            // console.log(input);\n\n            //disable current active element\n            var current_element = formbuilder.dom.inputs_collection_sortable.find('.active');\n            current_element.removeClass('active');\n\n            //add input to collection as the last one\n            inputs.push(input);\n            //console.log(inputs);\n\n            //hide message about no input selected, as dropped input gets focus\n            formbuilder.dom.input_properties_no_input_selected.hide();\n\n            //get hold of advanced properties panel for this input\n            input.dom.advanced_properties_wrapper = formbuilder\n                .dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]')\n                .find('.input-properties__form__advanced-properties');\n\n            //disable save project button as by default an input is invalid when it is created\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n            //set form tab as invalid, as the new input will be invalid by default\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n\n\n        },\n        stop: function (e, jquery_ui) {\n\n            var form_index = formbuilder.current_form_index;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var placeholder_text = messages.error.NO_QUESTION_TEXT_YET;\n            var input_type = jquery_ui.item.attr('data-type');\n            var properties_panel_html;\n\n            //disable draggable if we hit the max amount of inputs allowed\n            if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n                ui.input_tools.disable();\n            }\n\n            //hide search input if we hit the max (globally) but only when adding new inputs\n            if (input_type === consts.SEARCH_SINGLE_TYPE && !formbuilder.collection_is_being_sorted) {\n                if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n                    ui.input_tools.hideSearchInput();\n                    console.log('search limit reached');\n\n                    //show warning to user\n                    toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n                }\n            }\n\n            //console.log('sortable stop');\n            jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n            var input_ref = formbuilder.current_input_ref;\n\n            //get the index where the input was dropped (skip when list is empty)\n            console.log(jquery_ui.item.index());\n            //here from_index is based on the siblings, so we need to remove the indexes for the warning messages <div>\n            //we have 2 <div>, so remove 2\n            formbuilder.to_index = jquery_ui.item.index('') === 0 ? jquery_ui.item.index() : jquery_ui.item.index() - 2;\n\n            /*\n             if the user is dragging a new input over, it was added as the last element of the array\n             otherwise the current input position is set in the start event\n             */\n            if (!formbuilder.collection_is_being_sorted) {\n\n                //override 'from_index' as we are dropping a new element\n                formbuilder.from_index = inputs.length - 1;\n\n                //move inputs to keep the array sequence like the input sequence on screen\n                inputs.move(formbuilder.from_index, formbuilder.to_index);\n\n                jquery_ui.item.addClass('active');\n                jquery_ui.item.attr('data-input-ref', input_ref);\n\n                //append input id and a warning icon, as by default the question does not have any text\n                jquery_ui.item.find('.input-inner').append(ui.inputs_collection.getInputStateIconsHTML());\n\n                //add placeholder text on current input (based on input type)\n                if (input_type === consts.BRANCH_TYPE) {\n                    //it is a branch, add branch placeholder\n                    placeholder_text = messages.error.NO_BRANCH_HEADER_YET;\n                }\n\n                if (input_type === consts.GROUP_TYPE) {\n                    //it is a group, add group placeholder\n                    placeholder_text = messages.error.NO_GROUP_HEADER_YET;\n                }\n\n                jquery_ui.item.find('span.question-preview').text(placeholder_text);\n\n                //show input properties for the new dropped input\n                formbuilder.dom.input_properties.find('.panel-body form').hide();\n                formbuilder.dom.input_properties.find('.panel-title span').text(placeholder_text);\n\n                //create properties panel in right sidebar for this input (common properties)\n                properties_panel_html = template.getInputPropertiesPanelHTML(input);\n\n                //append input and show it as it gets selected by default\n                formbuilder.dom.input_properties_forms_wrapper.hide();\n                $(properties_panel_html).removeClass('hidden').appendTo(formbuilder.dom.input_properties_forms_wrapper);\n                formbuilder.dom.input_properties_forms_wrapper.fadeIn(consts.ANIMATION_FAST);\n\n                //show action buttons for input\n                formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n                //for branches, enable keyup to check for validation of header text\n                //triggered when users type in the header input field for branches or groups\n\n                if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n                    //formbuilder.dom.input_properties.off('keyup').on('keyup', 'input', input_properties_keyup_callback);\n                }\n                else {\n                    // formbuilder.dom.input_properties.off('keyup');\n                }\n\n                //enable sortable on current input (only when it gets created)\n                possibleAnswersSortable(input);\n            }\n            else {\n\n                //todo do I need to bind keyup for branches and groups here?\n\n                //'from_index is set in start event of sortable'\n                //move inputs to keep the array sequence like the input sequence on screen\n                inputs.move(formbuilder.from_index, formbuilder.to_index);\n\n                //run the validation on all jumps, as we might have some invalid destinations after re-ordering\n                //I am forced to do this against all the inputs\n                validation.validateJumpsAfterSorting(inputs);\n\n                jquery_ui.item.addClass('active');\n            }\n\n\n            //push state to enable undoing the action (adding/dragging input)\n            formbuilder.render_action = consts.RENDER_ACTION_DO;\n            undo.pushState();\n\n            if (input_type === consts.README_TYPE) {\n                $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n            }\n\n            //if there is not any title set, show warning\n            //but only if there are any inputs\n            if (inputs.length > 0) {\n                ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(inputs), false);\n            }\n            else {\n                //hide it, passing a count > 1\n                ui.inputs_collection.toggleTitleWarning(1, false);\n\n                //disable download form button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__export-form').addClass('disabled');\n\n                //disable print as pdf form button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__print-as-pdf').addClass('disabled');\n            }\n\n\n\n        },\n        //this callback is triggered when the user start dragging an existing input from the sortable\n        start: function (e, jquery_ui) {\n\n            //get current input position, as we need to move from here (if there is any input)\n            formbuilder.collection_is_being_sorted = true;\n            //here from_index is based on the siblings, so we need to remove the indexes for the warning messages <div>\n            //we have 2 <div>, so remove 2\n            formbuilder.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index() - 2;\n\n            //de-activate all inputs in collection\n            formbuilder.dom.inputs_collection_sortable.removeClass('active');\n        },\n        over: function () {\n            var form_index = formbuilder.current_form_index;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            //remove no questions message and upload button if no inputs\n            if (inputs.length === 0) {\n                formbuilder.dom.inputs_collection\n                    .find('.input-properties__no-questions-message')\n                    .addClass('hidden');\n            }\n        },\n        out: function () {\n            var form_index = formbuilder.current_form_index;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            //show no questions message and upload button if no inputs\n            if (inputs.length === 0) {\n                formbuilder.dom.inputs_collection\n                    .find('.input-properties__no-questions-message')\n                    .hide()\n                    .removeClass('hidden')\n                    .fadeIn(consts.ANIMATION_FAST);\n            }\n        },\n        scroll: true\n    }).disableSelection();\n};\n\nmodule.exports = sortable;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9hcHAuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL2Vycm9ycy5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvaW5wdXQtZHVwbGljYXRvci5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvanVtcHMuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3BhcnNlL2luZGV4LmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wYXJzZS9tZXRob2RzL2dldEJyYW5jaElucHV0c0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3BhcnNlL21ldGhvZHMvZ2V0R3JvdXBJbnB1dHNIVE1MLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wYXJzZS9tZXRob2RzL2luaXRGb3JtYnVpbGRlci5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9yZW5kZXJDaGlsZEZvcm1zLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wYXJzZS9tZXRob2RzL3JlbmRlcklucHV0cy5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9yZW5kZXJQcm9qZWN0LmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLXBhZ2VyLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL2luZGV4LmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5kb0NsZWFuaW5nQmVmb3JlU2F2aW5nLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlQWxsSW5wdXRQcm9wZXJ0aWVzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlSnVtcHMuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVQb3NzaWJsZUFuc3dlcnMuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVQcm9wZXJ0aWVzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlVW5pcXVlbmVzcy5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvdW5kby5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvdmFsaWRhdGlvbi5qcyIsImpzL2FwcF9tb2R1bGVzL2NvbmZpZy9jb25zdHMuanMiLCJqcy9hcHBfbW9kdWxlcy9jb25maWcvZXh0ZW5kLW5hdGl2ZXMuanMiLCJqcy9hcHBfbW9kdWxlcy9jb25maWcvZm9ybWJ1aWxkZXIuanMiLCJqcy9hcHBfbW9kdWxlcy9jb25maWcvaW5pdC5qcyIsImpzL2FwcF9tb2R1bGVzL2NvbmZpZy9tZXNzYWdlcy5qcyIsImpzL2FwcF9tb2R1bGVzL2NvbmZpZy90b2FzdC5qcyIsImpzL2FwcF9tb2R1bGVzL2ZhY3RvcnkvZm9ybS1mYWN0b3J5LmpzIiwianMvYXBwX21vZHVsZXMvZmFjdG9yeS9pbnB1dC1mYWN0b3J5LmpzIiwianMvYXBwX21vZHVsZXMvZmFjdG9yeS9pbnB1dC1tdWx0aXBsZS1hbnN3ZXJzLXByb3RvdHlwZS5qcyIsImpzL2FwcF9tb2R1bGVzL2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcy5qcyIsImpzL2FwcF9tb2R1bGVzL2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlLmpzIiwianMvYXBwX21vZHVsZXMvaGVscGVycy9pbXBvcnQtZm9ybS12YWxpZGF0aW9uLmpzIiwianMvYXBwX21vZHVsZXMvaGVscGVycy91aS5qcyIsImpzL2FwcF9tb2R1bGVzL2hlbHBlcnMvdXRpbHMuanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvYXVkaW8uanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvYmFyY29kZS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9icmFuY2guanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvY2hlY2tib3guanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvZGF0ZS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9kcm9wZG93bi5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9ncm91cC5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9pbnRlZ2VyLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL2xvY2F0aW9uLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3Bob25lLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3Bob3RvLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3JhZGlvLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3JlYWRtZS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9zZWFyY2guanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvdGV4dC5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy90ZXh0YXJlYS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy90aW1lLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3ZpZGVvLmpzIiwianMvYXBwX21vZHVsZXMvbG9hZGVycy9sb2FkLWNoaWxkLWZvcm0tY29udGFpbmVycy5qcyIsImpzL2FwcF9tb2R1bGVzL2xvYWRlcnMvbG9hZC1jb21wb25lbnRzLmpzIiwianMvYXBwX21vZHVsZXMvbG9hZGVycy9sb2FkLWNvbnRhaW5lcnMuanMiLCJqcy9hcHBfbW9kdWxlcy9sb2FkZXJzL2xvYWQtaW5wdXQtcHJvcGVydGllcy12aWV3cy5qcyIsImpzL2FwcF9tb2R1bGVzL2xvYWRlcnMvbG9hZC1wYXJ0aWFscy5qcyIsImpzL2FwcF9tb2R1bGVzL2xvYWRlcnMvbG9hZC1wcm9qZWN0LmpzIiwianMvYXBwX21vZHVsZXMvdGVtcGxhdGUvaW5kZXguanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUJhc2ljUHJvcGVydGllc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUlucHV0UHJvcGVydGllc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUlucHV0VG9vbEhUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2dldEFkdmFuY2VkVGFiQnRuSFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MLmpzIiwianMvYXBwX21vZHVsZXMvdGVtcGxhdGUvbWV0aG9kcy9nZXRKdW1wVGFiQnRuSFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0SnVtcHNMaXN0SFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzSFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzTGlzdC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzUGFnZS5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0VW5pcXVlbmVzc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL3ByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL3JlcGxhY2VDb21tb25BZHZhbmNlZFByb3BlcnRpZXMuanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9icmFuY2gtc29ydGFibGUuanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9kcmFnZ2FibGUuanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9jb25maXJtLWltcG9ydC1wb3NzaWJsZS1hbnN3ZXJzLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZGVsZXRlLWFsbC1xdWVzdGlvbnMtY2xpY2stY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9kZWxldGUtZm9ybS1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2V4cG9ydC1mb3JtLWNsaWNrLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZm9ybS10YWItY2xpY2stY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbXBvcnQtZm9ybS1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tYnJhbmNoLXNvcnRhYmxlLW1vdXNlZG93bi1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tZ3JvdXAtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1uZXN0ZWQtZ3JvdXAtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWFkdmFuY2VkLXRhYi1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtY2hhbmdlLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtZm9jdXMtY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWtleXVwLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy10aXRsZS1jaGVja2JveC1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL21vZGFsLWZvcm0tY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9tb2RhbC1yZWdleC1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3ByaW50LWFzLXBkZi1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2dyb3VwLXNvcnRhYmxlLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZS5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL3NvcnRhYmxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbE1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2bkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ24wQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdHFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcGZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdjVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuLy9tb2R1bGVzIGFyZSByZXF1aXJlZCB1c2luZyBhYnNvbHV0ZSBwYXRocyBpbiBicm93c2VyaWZ5OiBodHRwczovL2dvby5nbC9Va2NjR3pcbnZhciBpbml0ID0gcmVxdWlyZSgnY29uZmlnL2luaXQnKTtcbnZhciBleHRlbmRfbmF0aXZlcyA9IHJlcXVpcmUoJ2NvbmZpZy9leHRlbmQtbmF0aXZlcycpO1xudmFyIGxvYWRfY29tcG9uZW50cyA9IHJlcXVpcmUoJ2xvYWRlcnMvbG9hZC1jb21wb25lbnRzJyk7XG52YXIgbG9hZF9wcm9qZWN0ID0gcmVxdWlyZSgnbG9hZGVycy9sb2FkLXByb2plY3QnKTtcblxuLy9sb2FkIHByb2plY3QgZmlyc3RcbiQud2hlbihcbiAgICBsb2FkX3Byb2plY3QoKVxuKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAvL2xvYWQgcGFydGlhbCB2aWV3cyBmb3IgaW5kZXguaHRtbCwgZXh0ZW5kIG5hdGl2ZXMsIHRoZW4gaW5pdCBhcHBcbiAgICAkLndoZW4oXG4gICAgICAgIGxvYWRfY29tcG9uZW50cygpLFxuICAgICAgICBleHRlbmRfbmF0aXZlcygpKVxuICAgICAgIC50aGVuKGluaXQpO1xufSk7XG5cbi8qXG4gU2V0IG1pZGRsZSBhbmQgcmlnaHQgcGFuZWwgdG8gdGhlIHNhbWUgaGVpZ2h0IG9mIHRoZSBpbnB1dHMtY29sbGVjdGlvbiBwYW5lbFxuIE1heWJlIHRoZXJlIGlzIGEgcHVyZSBjc3Mgc29sdXRpb24gKGZsZXhib3gpLCBidXQgbWlkZGxlIGNvbHVtbiBuZWVkcyB0byBiZSBzY3JvbGxhYmxlIHRob3VnaCB3aGVuIEkgYWRkIGlucHV0c1xuIEZvciB0aGUgdGltZSBiZWluZyB0aGlzIHdpbGwgZG9cbiAqL1xuLy92YXIgaW5wdXRzX2NvbGxlY3Rpb25faGVpZ2h0ID0gJCgnLmlucHV0cy10b29scycpLmhlaWdodCgpO1xuLy8kKCcubWFpbiAucGFuZWwtYm9keScpLmhlaWdodChpbnB1dHNfY29sbGVjdGlvbl9oZWlnaHQpO1xuXG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxuXG52YXIgZXJyb3JzID0ge1xuXG4gICAgLy9oaWRlIGFsbCBwcm9wZXJ0aWVzIGVycm9ycyBmb3IgdGhlIGN1cnJlbnQgc2VsZWN0ZWQgaW5wdXRcbiAgICBoaWRlUHJvcGVydGllc0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsKSB7XG5cbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSB0aGVfcHJvcGVydGllc19wYW5lbDtcblxuICAgICAgICAvL3JlbW92ZSBpbmxpbmUgZXJyb3JzXG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3F1ZXN0aW9uJykucmVtb3ZlQ2xhc3MoJ2hhcy1lcnJvciBoYXMtZmVlZGJhY2snKTtcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gPiBpJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiBzcGFuLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJykudGV4dCgnJyk7XG5cbiAgICAgICAgLy9yZW1vdmUgdmlzdWFsIGVycm9ycyBmcm9tIHRhYnNcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicyAubmF2LXRhYnMgaScpLmFkZENsYXNzKCdpbnZpc2libGUnKTtcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicyAubmF2LXRhYnMgaScpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG4gICAgfSxcblxuICAgIGhpZGVQb3NzaWJsZUFuc3dlcnNFcnJvcnM6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgICAgICAvL3RvZG8gdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgMyB0aW1lcyB3aG5lIHZhbGlkYXRpbmcgb24ga2V5dXAsIGxvb2sgaW5vdCBpdCB3aGVuIHRoZXJlIGlzIHRpbWVcbiAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2VyX2xpc3QgPSBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCcpO1xuXG4gICAgICAgICQocG9zc2libGVfYW5zd2VyX2xpc3QpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXQgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgJChwb3NzaWJsZV9hbnN3ZXIpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0X19wb3NzaWJsZV9hbnN3ZXJfaXRlbScpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3IgaGFzLWZlZWRiYWNrJyk7XG5cbiAgICAgICAgICAgICQocG9zc2libGVfYW5zd2VyKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAudGV4dCgnJyk7Ly9zZXQgZXJyb3IgZGVzY3JpcHRpb25cblxuICAgICAgICB9KTtcbiAgICAgICAgLy9yZW1vdmUgdmlzdWFsIGVycm9ycyBmcm9tIHRhYnMgKGlmIHRoZSBpbnB1dCBpcyB2YWxpZCwgdGhlcmUgbWlnaHQgYmUgc29tZSBjdW5jdXJyZW5jeSBjb25kaXRpb25zKVxuICAgICAgICBpZiAoaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicyAubmF2LXRhYnMgaScpLmFkZENsYXNzKCdpbnZpc2libGUnKTtcbiAgICAgICAgICAgIGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX190YWJzIC5uYXYtdGFicyBpJykucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3ZhbGlkYXRpb24tZXJyb3InKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBoaWRlVGFiQnV0dG9uc0Vycm9yczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RvZG8gbWF5YmUgdGhpcyBpcyBub3QgbmVlZGVkXG4gICAgfSxcblxuICAgIGhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnM6IGZ1bmN0aW9uIChpbnB1dCwgdGhlX3Byb3BlcnRpZXMpIHtcblxuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSB0aGVfcHJvcGVydGllcztcbiAgICAgICAgdmFyIGlMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBmb3JtYnVpbGRlci5kb21cbiAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX18nICsgcHJvcGVydGllc1tpXSlcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hhcy1lcnJvciBoYXMtZmVlZGJhY2snKTtcblxuICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fJyArIHByb3BlcnRpZXNbaV0gKyAnIGknKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfXycgKyBwcm9wZXJ0aWVzW2ldICsgJyBzcGFuLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgLnRleHQoJycpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vaGlkZSBpbmxpbmUgZXJyb3JzIGZyb20ganVtcHMgKHJlZCBvdWxpbmUgYW5kIGVycm9yIG1lc3NhZ2UpXG4gICAgaGlkZUp1bXBzRXJyb3JzOiBmdW5jdGlvbiAodGhlX2p1bXBzX2xpc3QpIHtcblxuICAgICAgICB2YXIganVtcF9saXN0ID0gdGhlX2p1bXBzX2xpc3Q7XG4gICAgICAgIHZhciBqdW1wX3Byb3BlcnRpZXMgPSBbJ3doZW4nLCAnYW5zd2VyJywgJ2dvdG8nXTtcblxuICAgICAgICAkKGp1bXBfbGlzdCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGp1bXApIHtcbiAgICAgICAgICAgICQoanVtcF9wcm9wZXJ0aWVzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgcHJvcCkge1xuICAgICAgICAgICAgICAgICQoanVtcClcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLScgKyBwcm9wKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hhcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0KCcnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgc2hvd1F1ZXN0aW9uVGV4dEVycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsLCB0aGVfZXJyb3JfbWVzc2FnZSkge1xuXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gdGhlX3Byb3BlcnRpZXNfcGFuZWw7XG4gICAgICAgIHZhciBlcnJvciA9IHRoZV9lcnJvcl9tZXNzYWdlO1xuXG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0IGFuZCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24nKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdoYXMtZXJyb3IgaGFzLWZlZWRiYWNrJyk7XG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3F1ZXN0aW9uIGknKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiBzcGFuLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC50ZXh0KGVycm9yKS8vc2V0IGVycm9yIGRlc2NyaXB0aW9uXG4gICAgICAgICAgICAuaGlkZSgpXG4gICAgICAgICAgICAuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9zaG93ICchJyBvbiBhZmZlY3RlZCB0YWIsIGluIHRoaXMgY2FzZSB0aGUgYmFzaWMgcHJvcGVydGllcyB0YWIgKGZpcnN0KVxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX190YWJzIC5uYXYtdGFicyBpOmZpcnN0JylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaW52aXNpYmxlJylcbiAgICAgICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAvL3NldCBwcm9wZXJ0aWVzIHRhYiB0ZXh0IHRvIHJlZFxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX190YWJzIC5uYXYtdGFicyBpOmZpcnN0JylcbiAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgLmFkZENsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG5cblxuICAgIH0sXG5cbiAgICBzaG93Rm9ybU5hbWVFcnJvcnM6IGZ1bmN0aW9uICh0aGVfbW9kYWwsIHRoZV9lcnJvcl9tZXNzYWdlKSB7XG5cbiAgICAgICAgdmFyIG1vZGFsID0gdGhlX21vZGFsO1xuICAgICAgICB2YXIgZXJyb3IgPSB0aGVfZXJyb3JfbWVzc2FnZTtcblxuICAgICAgICBtb2RhbC5maW5kKCcubW9kYWwtYm9keSAuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgLnRleHQoZXJyb3IpLy9zZXQgZXJyb3IgZGVzY3JpcHRpb25cbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC5mYWRlSW4oMzAwKTtcbiAgICB9LFxuXG4gICAgaGlkZUZvcm1OYW1lRXJyb3JzOiBmdW5jdGlvbiAodGhlX21vZGFsKSB7XG5cbiAgICAgICAgdmFyIG1vZGFsID0gdGhlX21vZGFsO1xuICAgICAgICBtb2RhbC5maW5kKCcubW9kYWwtYm9keSAuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgLnRleHQoJycpO1xuICAgIH0sXG5cbiAgICBzaG93UG9zc2libGVBbnN3ZXJFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcG9zc2libGVfYW5zd2VyLCB0aGVfZXJyb3JfbWVzc2FnZSkge1xuXG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXIgPSB0aGVfcG9zc2libGVfYW5zd2VyO1xuICAgICAgICB2YXIgcHJvcGVydGllc19wYW5lbCA9IHBvc3NpYmxlX2Fuc3dlci5wYXJlbnRzKCkuZXEoOSk7XG4gICAgICAgIHZhciBlcnJvciA9IHRoZV9lcnJvcl9tZXNzYWdlO1xuXG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0IGFuZCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgcG9zc2libGVfYW5zd2VyLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0X19wb3NzaWJsZV9hbnN3ZXJfaXRlbScpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2hhcy1lcnJvciBoYXMtZmVlZGJhY2snKTtcblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXIuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC50ZXh0KGVycm9yKS8vc2V0IGVycm9yIGRlc2NyaXB0aW9uXG4gICAgICAgICAgICAuaGlkZSgpXG4gICAgICAgICAgICAuZmFkZUluKDMwMCk7XG5cblxuICAgICAgICAvL3Nob3cgJyEnIG9uIGFmZmVjdGVkIHRhYiwgaW4gdGhpcyBjYXNlIHRoZSBiYXNpYyBwcm9wZXJ0aWVzIHRhYiAoZmlyc3QpXG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX3RhYnMgLm5hdi10YWJzIGk6Zmlyc3QnKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdpbnZpc2libGUnKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbigzMDApO1xuXG4gICAgICAgIC8vc2V0IHByb3BlcnRpZXMgdGFiIHRleHQgdG8gcmVkXG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX3RhYnMgLm5hdi10YWJzIGk6Zmlyc3QnKVxuICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ3ZhbGlkYXRpb24tZXJyb3InKTtcblxuICAgIH0sXG5cbiAgICBzaG93U2luZ2xlQWR2YW5jZWRQcm9wZXJ0eUVycm9yOiBmdW5jdGlvbiAodGhlX3dyYXBwZXIsIHRoZV9wcm9wZXJ0eSwgdGhlX2Vycm9yKSB7XG5cbiAgICAgICAgdmFyIHByb3AgPSB0aGVfcHJvcGVydHk7XG4gICAgICAgIHZhciBlcnJvciA9IHRoZV9lcnJvcjtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSB0aGVfd3JhcHBlcjtcblxuICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfXycgKyBwcm9wKS5hZGRDbGFzcygnaGFzLWVycm9yIGhhcy1mZWVkYmFjaycpO1xuXG4gICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fJyArIHByb3AgKyAnIGknKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbigzMDApO1xuXG4gICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fJyArIHByb3AgKyAnIHNwYW4uaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgLnRleHQoZXJyb3IpXG4gICAgICAgICAgICAuaGlkZSgpXG4gICAgICAgICAgICAuZmFkZUluKDMwMCk7XG5cbiAgICAgICAgLy9zaG93ICchJyBvbiBhZmZlY3RlZCB0YWIsIGluIHRoaXMgY2FzZSB0aGUgYWR2YW5jZWQgcHJvcGVydGllcyB0YWJcbiAgICAgICAgd3JhcHBlci5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcubmF2LXRhYnMnKS5maW5kKCdpLmFkdmFuY2VkLWVycm9yJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaW52aXNpYmxlJylcbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC5mYWRlSW4oMzAwKTtcblxuICAgICAgICAvL3NldCBwcm9wZXJ0aWVzIHRhYiB0ZXh0IHRvIHJlZFxuICAgICAgICB3cmFwcGVyLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5uYXYtdGFicycpLmZpbmQoJ2kuYWR2YW5jZWQtZXJyb3InKVxuICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ3ZhbGlkYXRpb24tZXJyb3InKTtcbiAgICB9LFxuXG4gICAgc2hvd1NpbmdsZUp1bXBFcnJvcnM6IGZ1bmN0aW9uICh0aGVfanVtcF9pdGVtX3dyYXBwZXIsIHRoZV9wcm9wZXJ0aWVzKSB7XG5cbiAgICAgICAgdmFyIGp1bXBfcHJvcGVydGllcyA9IHRoZV9wcm9wZXJ0aWVzO1xuICAgICAgICB2YXIgd3JhcHBlciA9IHRoZV9qdW1wX2l0ZW1fd3JhcHBlcjtcbiAgICAgICAgdmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuXG4gICAgICAgIC8vanVtcCBjb25kaXRpb24gd2FzIG5vdCBzZWxlY3RlZFxuICAgICAgICBpZiAoanVtcF9wcm9wZXJ0aWVzLndoZW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS13aGVuJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hhcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgIC50ZXh0KG1lc3NhZ2VzLmVycm9yLkpVTVBfQ09ORElUSU9OX05PVF9TRUxFQ1RFRCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2p1bXAgYW5zd2VyIG5vdCBzZWxlY3RlZFxuICAgICAgICBpZiAoanVtcF9wcm9wZXJ0aWVzLmFuc3dlcl9yZWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS1hbnN3ZXInKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGFzLWVycm9yICcpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgIC50ZXh0KG1lc3NhZ2VzLmVycm9yLkpVTVBfQU5TV0VSX05PVF9TRUxFQ1RFRCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2p1bXAgZGVzdGluYXRpb24gbm90IHNlbGVjdGVkXG4gICAgICAgIGlmIChqdW1wX3Byb3BlcnRpZXMudG8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS1nb3RvJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hhcy1lcnJvciAnKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAudGV4dChtZXNzYWdlcy5lcnJvci5KVU1QX0RFU1RJTkFUSU9OX05PVF9TRUxFQ1RFRCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2p1bXAgZGVzdGluYXRpb24gbm90IHZhbGlkIChhZnRlciBkcmFnZ2luZylcbiAgICAgICAgaWYgKCFqdW1wX3Byb3BlcnRpZXMuaGFzX3ZhbGlkX2Rlc3RpbmF0aW9uKSB7XG4gICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLWdvdG8nKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGFzLWVycm9yJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgLnRleHQobWVzc2FnZXMuZXJyb3IuSlVNUF9ERVNUSU5BVElPTl9OT1RfU0VMRUNURUQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2cod3JhcHBlci5wYXJlbnRzKCkuZXEoNSkpO1xuXG4gICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2hvd0p1bXBUYWJFcnJvcih3cmFwcGVyKTtcbiAgICB9LFxuXG4gICAgc2hvd0JyYW5jaElucHV0c0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsLCB0aGVfZXJyb3JfbWVzc2FnZSkge1xuXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gdGhlX3Byb3BlcnRpZXNfcGFuZWw7XG4gICAgICAgIHZhciBlcnJvciA9IHRoZV9lcnJvcl9tZXNzYWdlO1xuICAgICAgICB2YXIgYnJhbmNoX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgdmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuXG5cbiAgICAgICAgLy9zaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3ItLWJyYW5jaC1lcnJvcicpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpXG4gICAgICAgICAgICAudGV4dChlcnJvcik7XG4gICAgICAgIC8vLmhpZGUoKVxuICAgICAgICAvLyAgLmZhZGVJbigzMDApO1xuXG4gICAgICAgIC8vdG9nZ2xlIGljb24gdG8gd2FybmluZ1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihicmFuY2hfaW5wdXRfcmVmKTtcbiAgICB9LFxuXG4gICAgc2hvd0dyb3VwSW5wdXRzRXJyb3JzOiBmdW5jdGlvbiAodGhlX3Byb3BlcnRpZXNfcGFuZWwsIHRoZV9lcnJvcl9tZXNzYWdlKSB7XG5cbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSB0aGVfcHJvcGVydGllc19wYW5lbDtcbiAgICAgICAgdmFyIGVycm9yID0gdGhlX2Vycm9yX21lc3NhZ2U7XG4gICAgICAgIHZhciBicmFuY2hfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICB2YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG5cblxuICAgICAgICAvL3Nob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvci0tZ3JvdXAtZXJyb3InKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdpbnZpc2libGUnKVxuICAgICAgICAgICAgLnRleHQoZXJyb3IpO1xuICAgICAgICAvLyAuaGlkZSgpXG4gICAgICAgIC8vLmZhZGVJbigzMDApO1xuXG4gICAgICAgIC8vdG9nZ2xlIGljb24gdG8gd2FybmluZ1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihicmFuY2hfaW5wdXRfcmVmKTtcbiAgICB9LFxuXG4gICAgaGlkZUJyYW5jaElucHV0c0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsKSB7XG4gICAgICAgIC8vc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIHRoZV9wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvci0tYnJhbmNoLWVycm9yJylcbiAgICAgICAgICAgIC5hZGRDbGFzcygnaW52aXNpYmxlJylcbiAgICAgICAgICAgIC50ZXh0KCcmbmJzcDsnKTtcbiAgICB9LFxuXG4gICAgaGlkZUdyb3VwSW5wdXRzRXJyb3JzOiBmdW5jdGlvbiAodGhlX3Byb3BlcnRpZXNfcGFuZWwpIHtcbiAgICAgICAgLy9zaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgdGhlX3Byb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yLS1ncm91cC1lcnJvcicpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2ludmlzaWJsZScpXG4gICAgICAgICAgICAudGV4dCgnJm5ic3A7Jyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBlcnJvcnM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xudmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcblxudmFyIGNvcHkgPSB7XG5cbiAgICBwdXNoSW5wdXQ6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgYnJhbmNoX2lucHV0cztcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0cztcblxuICAgICAgICAvL3JlbW92ZSBqdW1wcyAodGhleSB3b3VsZCBiZSBpbnZhbGlkIHdoZW4gY29waWVkLCBzbyBub3Qgd29ydGh5KVxuICAgICAgICBpbnB1dC5qdW1wcyA9IFtdO1xuXG4gICAgICAgIC8vYWxzbywgZG8gbm90IGNvcHkgdGhlIHRpdGxlLCBzZXQgaXQgYXMgZmFsc2UgKGFzIHdlIG1pZ2h0IGdvIG92ZXIgdGhlIDMgdGl0bGUgbGltaXRzKVxuICAgICAgICBpbnB1dC5pc190aXRsZSA9IGZhbHNlO1xuICAgICAgICAvL2FkZCBpbnB1dCB0byBjb2xsZWN0aW9uIGFzIHRoZSBsYXN0IG9uZVxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICB2YXIgYnJhbmNoX2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2luZGV4ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRDdXJyZW50SW5kZXhCeVJlZihicmFuY2hfaW5kZXgsIGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYpO1xuXG4gICAgICAgICAgICAvL3B1c2ggbmVzdGVkIGdyb3VwIGlucHV0XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0XG4gICAgICAgICAgICAgICAgLmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF1cbiAgICAgICAgICAgICAgICAuaW5wdXRzW2JyYW5jaF9pbmRleF1cbiAgICAgICAgICAgICAgICAuYnJhbmNoW25lc3RlZF9ncm91cF9pbmRleF1cbiAgICAgICAgICAgICAgICAuZ3JvdXAucHVzaChpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL3B1c2ggdG9wIGxldmVsIGlucHV0XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cy5wdXNoKGlucHV0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKS5icmFuY2g7XG4gICAgICAgICAgICAgICAgLy9wdXNoIGJyYW5jaCBpbnB1dFxuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dHMucHVzaChpbnB1dCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRzID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKS5ncm91cDtcbiAgICAgICAgICAgICAgICAvL3B1c2ggZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgICAgICBncm91cF9pbnB1dHMucHVzaChpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgYXBwZW5kSW5wdXRUb0RvbTogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGlucHV0X2h0bWwgPSBzZWxmLmNyZWF0ZUlucHV0SFRNTChpbnB1dCk7XG4gICAgICAgIHZhciBhY3RpdmVfYnJhbmNoX3NvcnRhYmxlO1xuICAgICAgICB2YXIgYWN0aXZlX2dyb3VwX3NvcnRhYmxlO1xuXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG5cbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2FjdGl2ZSBncm91cCByZWYgPSAnICsgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZik7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdhY3RpdmUgYnJhbmNoIHJlZiA9ICcgKyBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuXG4gICAgICAgICAgICAvL3RvZG9cbiAgICAgICAgICAgIC8vZ2V0IGFjdGl2ZSBncm91cCBzb3J0YWJsZVxuICAgICAgICAgICAgYWN0aXZlX2dyb3VwX3NvcnRhYmxlID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5ncm91cC1zb3J0YWJsZScpO1xuXG4gICAgICAgICAgICAvL2FwcGVuZCBtYXJrdXAgdG8gZ3JvdXAgc29ydGFibGVcbiAgICAgICAgICAgIGFjdGl2ZV9ncm91cF9zb3J0YWJsZS5hcHBlbmQoaW5wdXRfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL2FwcGVuZCB0byB0b3AgbGV2ZWwgc29ydGFibGVcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuYXBwZW5kKGlucHV0X2h0bWwuY29sbGVjdGlvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAgICAgLy9nZXQgYWN0aXZlIGJyYW5jaCBzb3J0YWJsZVxuICAgICAgICAgICAgICAgIGFjdGl2ZV9icmFuY2hfc29ydGFibGUgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5icmFuY2gtc29ydGFibGUnKTtcblxuICAgICAgICAgICAgICAgIC8vYXBwZW5kIG1hcmt1cCB0byBicmFjbmggc29ydGFibGVcbiAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoX3NvcnRhYmxlLmFwcGVuZChpbnB1dF9odG1sLmNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICAgICAgLy9nZXQgYWN0aXZlIGdyb3VwIHNvcnRhYmxlXG4gICAgICAgICAgICAgICAgYWN0aXZlX2dyb3VwX3NvcnRhYmxlID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmdyb3VwLXNvcnRhYmxlJyk7XG5cbiAgICAgICAgICAgICAgICAvL2FwcGVuZCBtYXJrdXAgdG8gZ3JvdXAgc29ydGFibGVcbiAgICAgICAgICAgICAgICBhY3RpdmVfZ3JvdXBfc29ydGFibGUuYXBwZW5kKGlucHV0X2h0bWwuY29sbGVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2FwcGVuZCBwYW5lbHNcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5hcHBlbmQoaW5wdXRfaHRtbC5wYW5lbHMpO1xuICAgIH0sXG5cbiAgICBjcmVhdGVJbnB1dEhUTUw6IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBwYXJzZSA9IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UnKTtcbiAgICAgICAgdmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgLy9jcmVhdGUgaHRtbCBlbGVtZW50IGZvciBpbnB1dCBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICB2YXIgaW5wdXRfY29sbGVjdGlvbl9odG1sID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dFRvb2xIVE1MKGlucHV0KTtcbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbDtcbiAgICAgICAgdmFyIGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCA9ICcnO1xuXG5cbiAgICAgICAgLy9pZiBpdCBpcyBhIGJyYW5jaCwgbG9vcCBhbGwgdGhlIGJyYW5jaCBpbnB1dHMgKHRoZXJlIG11c3QgYmUgYXQgbGVhc3QgYSBicmFuY2ggaW5wdXQpXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgIC8vdG9kbyBjaGVjayB0aGUgc2Vjb25zIGFyZyBvZiBnZXRCcmFuY2hJbnB1dHNIVE1MLCBJIGhhZCB0byBwYXNzIGBpbnB1dHMubGVuZ3RoIC0gMWBcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRzX2h0bWwgPSBwYXJzZS5nZXRCcmFuY2hJbnB1dHNIVE1MKGlucHV0LCBpbnB1dHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBpbnB1dF9jb2xsZWN0aW9uX2h0bWwgPSBpbnB1dF9jb2xsZWN0aW9uX2h0bWwucmVwbGFjZSgne3ticmFuY2gtY29udGVudH19JywgYnJhbmNoX2lucHV0c19odG1sLmNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgLy90b2RvIGNoZWNrIHdoZXJlIHRoZSBzdHJpbmcgcmVwbGFjZW1lbnQgaGFwcGVuc1xuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19wYW5lbF9odG1sICs9IGJyYW5jaF9pbnB1dHNfaHRtbC5wYW5lbHM7XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIGl0IGlzIGEgZ3JvdXAsIGxvb3AgYWxsIHRoZSBncm91cCBpbnB1dHMgKHRoZXJlIG11c3QgYmUgYXQgbGVhc3QgYSBncm91cCBpbnB1dClcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG5cbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5kZXggPSBudWxsO1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0c19odG1sID0gJyc7XG5cbiAgICAgICAgICAgIC8vaXMgdGhpcyBhIG5lc3RlZCBncm91cCAoaW5zaWRlIGEgYnJhbmNoKVxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1RoaXMgaXMgYSBuZXN0ZWQgZ3JvdXAgaW4gYSBicmFuY2gnKVxuICAgICAgICAgICAgICAgIGJyYW5jaF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgICAgICB2YXIgYnJhbmNoX2lucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzW2JyYW5jaF9pbmRleF0uYnJhbmNoO1xuXG4gICAgICAgICAgICAgICAgLy93ZSBpbnNlcnQgdGhlIG5ldyBuZXN0ZWQgZ3JvdXAgYXMgdGhlIGxhc3QgcXVlc3Rpb24gaW4gdGhlIGN1cnJlbnQgYnJhbmNoXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0c19odG1sID0gcGFyc2UuZ2V0R3JvdXBJbnB1dHNIVE1MKGlucHV0LCBicmFuY2hfaW5kZXgsIGJyYW5jaF9pbnB1dHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBncm91cF9pbnB1dHNfaHRtbCA9IHBhcnNlLmdldEdyb3VwSW5wdXRzSFRNTChpbnB1dCwgaW5wdXRzLmxlbmd0aCAtIDEsIGJyYW5jaF9pbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnB1dF9jb2xsZWN0aW9uX2h0bWwgPSBpbnB1dF9jb2xsZWN0aW9uX2h0bWwucmVwbGFjZSgne3tncm91cC1jb250ZW50fX0nLCBncm91cF9pbnB1dHNfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgICAgIC8vdG9kbyBjaGVjayB3aGVyZSB0aGUgc3RyaW5nIHJlcGxhY2VtZW50IGhhcHBlbnNcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCArPSBncm91cF9pbnB1dHNfaHRtbC5wYW5lbHM7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NyZWF0ZSBwcm9wZXJ0aWVzIHBhbmVsIGZvciBjdXJyZW50IGlucHV0XG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWxfaHRtbCA9IHRlbXBsYXRlLmdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTChpbnB1dCk7XG5cbiAgICAgICAgLyogQWRkIHRoZSBncm91cCBvciBicmFuY2ggaW5wdXRzIHBhbmVscyBtYXJrdXAgKGlmIGFueSlcbiAgICAgICAgIFRoZSBwYW5lbHMgYXJlIG5vdCBhdHRhY2hlZCBpbiB0aGUgcmlnaHQgb3JkZXIgaW4gdGhlIGRvbSBidXQgaXQgZG9lcyBub3QgbWF0dGVyLFxuICAgICAgICAgYXMgb25seSBvbmUgaXMgc2hvd24gYXQgYSB0aW1lXG4gICAgICAgICAqL1xuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBpbnB1dF9jb2xsZWN0aW9uX2h0bWwsXG4gICAgICAgICAgICBwYW5lbHM6IGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbFxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBjcmVhdGVQb3NzaWJsZUFuc3dlcnNDb3B5OiBmdW5jdGlvbiAocG9zc2libGVfYW5zd2Vycykge1xuXG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2NvcHkgPSBbXTtcblxuICAgICAgICAkLmVhY2gocG9zc2libGVfYW5zd2VycywgZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0gPSB7fTtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlcjtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyX3JlZiA9IHV0aWxzLmdlbmVyYXRlVW5pcUlEKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBwb3NzaWJsZV9hbnN3ZXJzX2NvcHk7XG4gICAgfSxcblxuICAgIGNyZWF0ZUlucHV0Q29weTogZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAgICAgdmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaW5wdXRfY29waWVkX3JlZiA9IHV0aWxzLmdlbmVyYXRlSW5wdXRDb3B5UmVmKCk7XG4gICAgICAgIHZhciBpbnB1dF9jb3BpZWQgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0KGlucHV0LnR5cGUsIGlucHV0X2NvcGllZF9yZWYpO1xuICAgICAgICB2YXIgcmVmX21hcCA9IFtdO1xuXG4gICAgICAgIC8vc2V0IGlucHV0IGNvcHkgcHJvcGVydGllcyB0byBvcmlnaW5hbCBpbnB1dCBwcm9wZXJ0aWVzXG4gICAgICAgIC8vIChvbmx5IHRoZSBvbmUgc2F2ZWQgaW4gdGhlIHByb2plY3QgZGVmaW5pdGlvbiwgbGVhdmUgdGhlIG90aGVycyBpbnRhY3QsXG4gICAgICAgIC8vIGFuZCBETyBOT1QgY29weSB0aGUgcmVmISlcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gaW5wdXRfY29waWVkKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQuaGFzT3duUHJvcGVydHkocHJvcGVydHkpICYmIHByb3BlcnR5ICE9PSAncmVmJykge1xuXG4gICAgICAgICAgICAgICAgLyogSW1wb3J0YW50OiBicmFuY2gvZ3JvdXAgaXMgYW4gYXJyYXksIHNvIHBlcmZvcm0gZGVlcCBjb3B5XG4gICAgICAgICAgICAgICAgICogdXNpbmcgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmopKTtcbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIFRoaXMgaXMgYmVjYXVzZSBhcnJheS5zbGljZSBkb2VzIG5vdCBwZXJmb3JtIGEgZGVlcCBjb3B5IG9uIGFueXRoaW5nIG5lc3RlZCwganVzdCBvbiBhIHBsYWluIGFycmF5XG4gICAgICAgICAgICAgICAgICogYW5kICQuZXh0ZW5kKHRydWUsIFtdLCBvbGRBcnJheSkgd2FzIG5vdCB3b3JraW5nXG4gICAgICAgICAgICAgICAgICogKi9cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkJSQU5DSF9UWVBFOlxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfY29waWVkLmJyYW5jaCA9IHdpbmRvdy5DaXJjdWxhckpTT04ucGFyc2Uod2luZG93LkNpcmN1bGFySlNPTi5zdHJpbmdpZnkoaW5wdXQuYnJhbmNoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IHRoZSBwcm90b3R5cGUgcGVyIGVhY2ggYnJhbmNoIGlucHV0IChub3QgZG9uZSBieSBDaXJjdWxhckpTT04pXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9jb3BpZWQuYnJhbmNoLmZvckVhY2goZnVuY3Rpb24gKGNvcGllZEJyYW5jaElucHV0LCBjb3BpZWRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmJyYW5jaC5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2VCcmFuY2hJbnB1dCwgc291cmNlSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUluZGV4ID09PSBjb3BpZWRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGNvcGllZEJyYW5jaElucHV0LCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yoc291cmNlQnJhbmNoSW5wdXQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuR1JPVVBfVFlQRTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29weSBvYmplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0X2NvcGllZC5ncm91cCA9IHdpbmRvdy5DaXJjdWxhckpTT04ucGFyc2Uod2luZG93LkNpcmN1bGFySlNPTi5zdHJpbmdpZnkoaW5wdXQuZ3JvdXApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIHByb3RvdHlwZSBwZXIgZWFjaCBncm91cCBpbnB1dCAobm90IGRvbmUgYnkgQ2lyY3VsYXJKU09OKVxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfY29waWVkLmdyb3VwLmZvckVhY2goZnVuY3Rpb24gKGNvcGllZEdyb3VwSW5wdXQsIGNvcGllZEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuZ3JvdXAuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlR3JvdXBJbnB1dCwgc291cmNlSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUluZGV4ID09PSBjb3BpZWRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGNvcGllZEdyb3VwSW5wdXQsIE9iamVjdC5nZXRQcm90b3R5cGVPZihzb3VyY2VHcm91cElucHV0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9jb3BpZWRbcHJvcGVydHldID0gaW5wdXRbcHJvcGVydHldO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9icmFuY2hcbiAgICAgICAgcmVmX21hcCA9IHNlbGYuY3JlYXRlQnJhbmNoQ29weShpbnB1dF9jb3BpZWQucmVmLCBpbnB1dF9jb3BpZWQuYnJhbmNoLCBpbnB1dCk7XG5cbiAgICAgICAgLy9ncm91cDpcbiAgICAgICAgc2VsZi5vdmVycmlkZUdyb3VwQ29weVJlZnMoaW5wdXRfY29waWVkLnJlZiwgaW5wdXRfY29waWVkLmdyb3VwLCBpbnB1dCk7XG5cbiAgICAgICAgLy9vdmVycmlkZSBwb3NzaWJsZSBhbnN3ZXJzIFwiYW5zd2VyX3JlZlwiIG9uIGNvcGllZCB0b3AgbGV2ZWwgaW5wdXQgKG9uIG11bHRpcGxlIGFuc3dlcnMgdHlwZSBvbmx5KVxuICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0X2NvcGllZC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGlucHV0X2NvcGllZC5wb3NzaWJsZV9hbnN3ZXJzID0gc2VsZi5jcmVhdGVQb3NzaWJsZUFuc3dlcnNDb3B5KGlucHV0X2NvcGllZC5wb3NzaWJsZV9hbnN3ZXJzKTtcblxuICAgICAgICAgICAgLy90b2RvIGNoZWNrIHdoYXQgdGhlIGRlZmF1bHQgcHJvcGVydHkgaXMgc2V0IHRvLCB3aGV0aGVyIG51bGwgb3IgZW1wdHkgc3RyaW5nXG4gICAgICAgICAgICBpZiAoIShpbnB1dC5kZWZhdWx0ID09PSAnJyB8fCBpbnB1dC5kZWZhdWx0ID09PSBudWxsKSkge1xuICAgICAgICAgICAgICAgIC8vdGhlcmUgaXMgYSBkZWZhdWx0IHZhbHVlIHRvIHJlbWFwIVxuICAgICAgICAgICAgICAgIGlucHV0X2NvcGllZC5kZWZhdWx0ID0gc2VsZi5nZXREZWZhdWx0VmFsdWVGcm9tSW5wdXRDb3B5KGlucHV0LCBpbnB1dF9jb3BpZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9jbGVhciBqdW1wcyBmb3IgdG9wIGxldmVsIGlucHV0ICh3aGVuIG5vdCBhIGJyYW5jaCEpXG4gICAgICAgIGlmIChpbnB1dF9jb3BpZWQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgICAgICAvL3VwZGF0ZSBqdW1wcyBmb3IgYWxsIHRoZSBicmFuY2ggaW5wdXRzXG4gICAgICAgICAgICBzZWxmLnVwZGF0ZUJyYW5jaEp1bXBzKGlucHV0X2NvcGllZC5icmFuY2gsIHJlZl9tYXApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5wdXRfY29waWVkLmp1bXBzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICAvL2NvcHkgcHJvdG90eXBlXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihpbnB1dF9jb3BpZWQsIE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnB1dCkpO1xuXG4gICAgICAgIHJldHVybiBpbnB1dF9jb3BpZWQ7XG4gICAgfSxcblxuICAgIHVwZGF0ZUJyYW5jaEp1bXBzOiBmdW5jdGlvbiAoYnJhbmNoLCByZWZfbWFwKSB7XG4gICAgICAgIC8vdG8gc3RvcmUgdGhlIG5ldyBqdW1wc1xuICAgICAgICB2YXIgdXBkYXRlZF9qdW1wcztcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICQoYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hfaW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuXG4gICAgICAgICAgICB1cGRhdGVkX2p1bXBzID0gW107XG5cbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXQuanVtcHMubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGppLCBqdW1wKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShicmFuY2hfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSB0aGUganVtcCByZWZlcmVuY2VzXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkX2p1bXBzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW46IGp1bXAud2hlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogc2VsZi5nZXRKdW1wVG9WYWx1ZUZyb21SZWZNYXAocmVmX21hcCwganVtcC50byksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zd2VyX3JlZjogcmVmX21hcFticmFuY2hfaW5kZXhdLmFuc3dlcl9yZWZzW2p1bXAuYW5zd2VyX3JlZl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgdGhlIGp1bXAgcmVmZXJlbmNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9qdW1wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuOiBqdW1wLndoZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IHNlbGYuZ2V0SnVtcFRvVmFsdWVGcm9tUmVmTWFwKHJlZl9tYXAsIGp1bXAudG8pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuc3dlcl9yZWY6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3JlcGxhY2UganVtcHMgd2l0aCB1cGRhdGVkIG9uZXNcbiAgICAgICAgICAgIGJyYW5jaF9pbnB1dC5qdW1wcyA9IHVwZGF0ZWRfanVtcHM7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBvdmVycmlkZUdyb3VwQ29weVJlZnM6IGZ1bmN0aW9uIChjb3BpZWRJbnB1dFJlZiwgY29waWVkR3JvdXAsIG9yaWdpbmFsSW5wdXQpIHtcblxuICAgICAgICAkKGNvcGllZEdyb3VwKS5lYWNoKGZ1bmN0aW9uIChjb3BpZWRHcm91cElucHV0SW5kZXgsIGNvcGllZEdyb3VwSW5wdXQpIHtcblxuICAgICAgICAgICAgdmFyIGdyb3VwX2Fuc3dlcl9yZWZfbWFwID0ge307XG5cbiAgICAgICAgICAgIGNvcGllZEdyb3VwSW5wdXQucmVmID0gdXRpbHMuZ2VuZXJhdGVOZXN0ZWRHcm91cElucHV0UmVmKGNvcGllZElucHV0UmVmKTtcblxuICAgICAgICAgICAgLy9vdmVycmlkZSBhbnkgXCJhbnN3ZXJfcmVmXCJcbiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoY29waWVkR3JvdXBJbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcblxuICAgICAgICAgICAgICAgIHZhciBncm91cF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHkgPSBbXTtcblxuICAgICAgICAgICAgICAgICQuZWFjaChjb3BpZWRHcm91cElucHV0LnBvc3NpYmxlX2Fuc3dlcnMsIGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19hbnN3ZXJfcmVmID0gdXRpbHMuZ2VuZXJhdGVVbmlxSUQoKTtcblxuICAgICAgICAgICAgICAgICAgICBncm91cF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdID0ge307XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlcjtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XS5hbnN3ZXJfcmVmID0gbmV3X2Fuc3dlcl9yZWY7XG5cbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfYW5zd2VyX3JlZl9tYXBbcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWZdID0gbmV3X2Fuc3dlcl9yZWY7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL292ZXJyaWRlIHBvc3NpYmxlIGFuc3dlcnMgZm9yIHRoaXMgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgICAgICBjb3BpZWRHcm91cElucHV0LnBvc3NpYmxlX2Fuc3dlcnMgPSBncm91cF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbWFwIGRlZmF1bHQgdmFsdWUgdG8gbmV3IGFuc3dlcl9yZWZcbiAgICAgICAgICAgICAgICBpZiAoIShjb3BpZWRHcm91cElucHV0LmRlZmF1bHQgPT09ICcnIHx8IGNvcGllZEdyb3VwSW5wdXQuZGVmYXVsdCA9PT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy90aGVyZSBpcyBhIGRlZmF1bHQgdmFsdWUgdG8gcmVtYXAhXG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoY29waWVkR3JvdXBJbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcGllZEdyb3VwSW5wdXQuZGVmYXVsdCA9IGdyb3VwX2Fuc3dlcl9yZWZfbWFwW29yaWdpbmFsSW5wdXQuZ3JvdXBbY29waWVkR3JvdXBJbnB1dEluZGV4XS5kZWZhdWx0XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgY3JlYXRlQnJhbmNoQ29weTogZnVuY3Rpb24gKHJlZiwgYnJhbmNoLCBpbnB1dCkge1xuXG4gICAgICAgIHZhciBicmFuY2hfY29weSA9IFtdO1xuICAgICAgICB2YXIgYnJhbmNoX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weTtcbiAgICAgICAgdmFyIHJlZl9tYXAgPSBbXTtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9qdW1wc19jb3B5O1xuICAgICAgICB2YXIgYW5zd2VyX3JlZl9tYXA7XG4gICAgICAgIHZhciBuZXdfYW5zd2VyX3JlZnM7XG4gICAgICAgIHZhciBuZXN0ZWRfZ3JvdXBfY29weSA9IFtdO1xuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weTtcblxuICAgICAgICAkKGJyYW5jaCkuZWFjaChmdW5jdGlvbiAoYnJhbmNoX2luZGV4LCBicmFuY2hfaW5wdXQpIHtcblxuICAgICAgICAgICAgYnJhbmNoX2NvcHlbYnJhbmNoX2luZGV4XSA9IGJyYW5jaF9pbnB1dDtcbiAgICAgICAgICAgIGJyYW5jaF9jb3B5W2JyYW5jaF9pbmRleF0ucmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKHJlZik7XG5cbiAgICAgICAgICAgIHJlZl9tYXBbYnJhbmNoX2luZGV4XSA9IHtcbiAgICAgICAgICAgICAgICBqdW1wczogYnJhbmNoX2lucHV0Lmp1bXBzLFxuICAgICAgICAgICAgICAgIGFuc3dlcl9yZWZzOiB7fVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy9tYXAgb2xkIC0gbmV3IGlucHV0IHJlZlxuICAgICAgICAgICAgcmVmX21hcFticmFuY2hfaW5kZXhdLm9sZF9yZWYgPSBpbnB1dC5icmFuY2hbYnJhbmNoX2luZGV4XS5yZWY7XG4gICAgICAgICAgICByZWZfbWFwW2JyYW5jaF9pbmRleF0ubmV3X3JlZiA9IGJyYW5jaF9jb3B5W2JyYW5jaF9pbmRleF0ucmVmO1xuXG4gICAgICAgICAgICAvL292ZXJyaWRlIGFueSBcImFuc3dlcl9yZWZcIiBhbmQgdXBkYXRlIGp1bXBzXG4gICAgICAgICAgICAvL3RvZG8gYWxsIHRoZSBqdW1wcywgdGhlcmUgaXMgdGhlIGp1bXAgYWx3YXlzIGFzIHdlbGwhISEhIVxuICAgICAgICAgICAgaWYgKCQuaW5BcnJheShicmFuY2hfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG5cbiAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5ID0gW107XG4gICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0X2p1bXBzX2NvcHkgPSBbXTtcbiAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmX21hcCA9IHt9O1xuXG4gICAgICAgICAgICAgICAgJC5lYWNoKGJyYW5jaF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLCBmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vYnVpbGQgYSBtYXAgdG8gdXBkYXRlIGp1bXBzIHJlZmVyZW5jZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19hbnN3ZXJfcmVmID0gdXRpbHMuZ2VuZXJhdGVVbmlxSUQoKTtcbiAgICAgICAgICAgICAgICAgICAgYW5zd2VyX3JlZl9tYXBbcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWZdID0gbmV3X2Fuc3dlcl9yZWY7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9vdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XS5hbnN3ZXIgPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyO1xuICAgICAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XS5hbnN3ZXJfcmVmID0gbmV3X2Fuc3dlcl9yZWZcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgcG9zc2libGUgYW5zd2VycyBmb3IgdGhpcyBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXQucG9zc2libGVfYW5zd2VycyA9IGJyYW5jaF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHk7XG5cbiAgICAgICAgICAgICAgICBuZXdfYW5zd2VyX3JlZnMgPSBhbnN3ZXJfcmVmX21hcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld19hbnN3ZXJfcmVmcyA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vYWRkIGFuc3dlcl9yZWZzIG1hcCB0byBqdW1wcyBtYXBcbiAgICAgICAgICAgIHJlZl9tYXBbYnJhbmNoX2luZGV4XS5hbnN3ZXJfcmVmcyA9IG5ld19hbnN3ZXJfcmVmcztcblxuICAgICAgICAgICAgLy9yZW1hcCBkZWZhdWx0IHZhbHVlIHRvIG5ldyBhbnN3ZXJfcmVmXG4gICAgICAgICAgICBpZiAoIShicmFuY2hfaW5wdXQuZGVmYXVsdCA9PT0gJycgfHwgYnJhbmNoX2lucHV0LmRlZmF1bHQgPT09IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgLy90aGVyZSBpcyBhIGRlZmF1bHQgdmFsdWUgdG8gcmVtYXAhXG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShicmFuY2hfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dC5kZWZhdWx0ID0gbmV3X2Fuc3dlcl9yZWZzW2JyYW5jaF9pbnB1dC5kZWZhdWx0XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vYSBncm91cCB3aXRoaW4gYSBicmFuY2g6XG5cbiAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChuZXN0ZWRfZ3JvdXBfaW5wdXRfaW5kZXgsIG5lc3RlZF9ncm91cF9pbnB1dCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0X2Fuc3dlcl9yZWZfbWFwID0ge307XG5cbiAgICAgICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfY29weVtuZXN0ZWRfZ3JvdXBfaW5wdXRfaW5kZXhdID0gbmVzdGVkX2dyb3VwX2lucHV0O1xuICAgICAgICAgICAgICAgIG5lc3RlZF9ncm91cF9jb3B5W25lc3RlZF9ncm91cF9pbnB1dF9pbmRleF0ucmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGJyYW5jaFticmFuY2hfaW5kZXhdLnJlZik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KG5lc3RlZF9ncm91cF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcblxuICAgICAgICAgICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5ID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKG5lc3RlZF9ncm91cF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLCBmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X2Fuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL292ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbmVzdGVkX2dyb3VwX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RlZF9ncm91cF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdLmFuc3dlcl9yZWYgPSBuZXdfYW5zd2VyX3JlZjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRfYW5zd2VyX3JlZl9tYXBbcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWZdID0gbmV3X2Fuc3dlcl9yZWY7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgcG9zc2libGUgYW5zd2VycyBmb3IgdGhpcyBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgbmVzdGVkX2dyb3VwX2lucHV0LnBvc3NpYmxlX2Fuc3dlcnMgPSBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vcmVtYXAgZGVmYXVsdCB2YWx1ZSB0byBuZXcgYW5zd2VyX3JlZlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShuZXN0ZWRfZ3JvdXBfaW5wdXQuZGVmYXVsdCA9PT0gJycgfHwgbmVzdGVkX2dyb3VwX2lucHV0LmRlZmF1bHQgPT09IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoZXJlIGlzIGEgZGVmYXVsdCB2YWx1ZSB0byByZW1hcCFcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkobmVzdGVkX2dyb3VwX2lucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RlZF9ncm91cF9pbnB1dC5kZWZhdWx0ID0gZ3JvdXBfaW5wdXRfYW5zd2VyX3JlZl9tYXBbYnJhbmNoX2lucHV0Lmdyb3VwW25lc3RlZF9ncm91cF9pbnB1dF9pbmRleF0uZGVmYXVsdF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlZl9tYXA7XG4gICAgfSxcblxuICAgIGdldERlZmF1bHRWYWx1ZUZyb21JbnB1dENvcHk6IGZ1bmN0aW9uIChvcmlnaW5hbCwgY29weSkge1xuXG4gICAgICAgIHZhciBvcmlnaW5hbF9kZWZhdWx0X2Fuc3dlcl9yZWZfaW5kZXggPSAtMTtcblxuICAgICAgICAkKG9yaWdpbmFsLnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZiA9PT0gb3JpZ2luYWwuZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsX2RlZmF1bHRfYW5zd2VyX3JlZl9pbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY29weS5wb3NzaWJsZV9hbnN3ZXJzW29yaWdpbmFsX2RlZmF1bHRfYW5zd2VyX3JlZl9pbmRleF0uYW5zd2VyX3JlZjtcblxuICAgIH0sXG5cbiAgICBnZXRKdW1wVG9WYWx1ZUZyb21SZWZNYXA6IGZ1bmN0aW9uIChyZWZfbWFwLCB0bykge1xuXG4gICAgICAgIHZhciBqdW1wX3RvID0gbnVsbDtcblxuICAgICAgICAvL2lmIHRvIGlkIFwiRU5EXCIsIGp1c3QgcmV0dXJuIGl0XG4gICAgICAgIGlmICh0byA9PT0gY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGKSB7XG4gICAgICAgICAgICBqdW1wX3RvID0gY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9vdGhlcndpc2UgcmV0dXJuIHRoZSBuZXcgcmVmXG4gICAgICAgICAgICAkKHJlZl9tYXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBtYXApIHtcbiAgICAgICAgICAgICAgICBpZiAobWFwLm9sZF9yZWYgPT09IHRvKSB7XG4gICAgICAgICAgICAgICAgICAgIGp1bXBfdG8gPSBtYXAubmV3X3JlZjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGp1bXBfdG9cbiAgICB9LFxuXG4gICAgZGVlcENsb25lV2l0aFByb3RvdHlwZU1hcDogZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBzYW1lIHByb3RvdHlwZVxuICAgICAgICB2YXIgY29weSA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikpO1xuXG4gICAgICAgIC8vIENvcHkgcHJvcGVydGllc1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTtcbiAgICAgICAgICAgICAgICBjb3B5W2tleV0gPSAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JykgPyBzZWxmLmRlZXBDbG9uZVdpdGhQcm90b3R5cGVNYXAodmFsdWUpIDogdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29weTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvcHk7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBqdW1wcyA9IHtcblxuICAgIGFkZEp1bXA6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBqdW1wc19saXN0X3dyYXBwZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHMgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19saXN0Jyk7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG4gICAgICAgIHZhciBqdW1wX2luZGV4ID0gaW5wdXQuanVtcHMubGVuZ3RoO1xuXG4gICAgICAgIC8vaWYgdGhlIG51bWJlciBvZiBqdW1wcyBpcyBhbHJlYWR5IGVxdWFsIHRvIHRoZSBudW1iZXIgb2YgcG9zc2libGUgYW5zd2VycywgZG8gbm90IGFkZCBqdW1wXG4gICAgICAgIC8vRG8gdGhpcyBjaGVjayBvbmx5IGZvciBtdWx0aXBsZSBhbnN3ZXJzIGlucHV0cywgYXMgc2luZ2xlIGFuc3dlciBpbnB1dHMgZG8gaGF2ZSB6ZXJvIHBvc3NpYmxlX2Fuc3dlcnMgYXQgYWxsIHRpbWVzLlxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPj0gaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIGp1bXBzLCByZW1vdmUgJ25vIGp1bXBzIHNldCcgaXRlbVxuICAgICAgICBqdW1wc19saXN0X3dyYXBwZXIucGFyZW50KCkuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19uby1qdW1wcy1tZXNzYWdlJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAvL2FwcGVuZCBhIGp1bXAgd2l0aCBjb25kaXRpb24gZGlzYWJsZWQgYW5kIHNldCB0byAnYWx3YXlzJyBqdW1wXG4gICAgICAgICAgICAvL3dlIGRvIHRoaXMgYmVjYXVzZSBvbiBFQzUgd2hlbiB0aGUgcXVlc3Rpb24gaXMgYW4gb3BlbiBhbnN3ZXIsIGEganVtcCB3aWxsIGFsd2F5cyBqdW1wIG5vIG1hdHRlciB0aGUgYW5zd2VyIGdpdmVuXG4gICAgICAgICAgICAvLyBqdW1wc19saXN0X3dyYXBwZXIuYXBwZW5kKCk7XG5cbiAgICAgICAgICAgIGh0bWwgKz0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLmp1bXBfbGlzdF9pdGVtX2Fsd2F5c19qdW1wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9qdW1wcyBnZXQgZnVsbCBmdW5jdGlvbmFsaXR5IHdpdGggbXVsdGlwbGUgYW5zd2VycyBpbnB1dCB0eXBlc1xuICAgICAgICAgICAgaHRtbCArPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMuanVtcF9saXN0X2l0ZW07XG4gICAgICAgIH1cblxuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1sb2dpYy13aGVufX0vZywganVtcF9pbmRleCArICctJyArIGlucHV0LnJlZiArICctbG9naWMtd2hlbicpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1sb2dpYy1hbnN3ZXJ9fS9nLCBqdW1wX2luZGV4ICsgJy0nICsgaW5wdXQucmVmICsgJy1sb2dpYy1hbnN3ZXInKTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtbG9naWMtZ290b319L2csIGp1bXBfaW5kZXggKyAnLScgKyBpbnB1dC5yZWYgKyAnLWxvZ2ljLWdvdG8nKTtcblxuICAgICAgICBqdW1wc19saXN0X3dyYXBwZXIuYXBwZW5kKGh0bWwpO1xuXG4gICAgICAgIC8vYWRkIGVtcHR5IGp1bXAgdG8gaW5wdXRcbiAgICAgICAgaW5wdXQuanVtcHMucHVzaCh7fSk7XG5cbiAgICAgICAgLy9zaG93IGp1bXAgaWNvbiBpbiBpbnB1dCB0b29sXG4gICAgICAgIC8vdG9kb1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdIC5pbnB1dC1pbm5lcicpO1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0gLmlucHV0LWlubmVyIC5qdW1wLXN0YXRlJykucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXG4gICAgfSxcblxuICAgIHJlbW92ZUp1bXA6IGZ1bmN0aW9uICh0aGVfY3VycmVudF9pbnB1dCwgdGhlX3JlbW92ZV9idG4pIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfY3VycmVudF9pbnB1dDtcbiAgICAgICAgdmFyIGp1bXBfaXRlbSA9IHRoZV9yZW1vdmVfYnRuLnBhcmVudCgpO1xuICAgICAgICB2YXIganVtcF9saXN0ID0ganVtcF9pdGVtLnBhcmVudCgpO1xuICAgICAgICAvLyBqdW1wIGluZGV4IHN0YXJ0cyBmcm9tIDEsIGFzIGluZGV4IDAgaXMgJ25vIGp1bXBzIHlldCcgcGxhY2Vob2xkZXIsIHdyYXBwZWQgaW4gYSA8bGk+IHRhZ1xuICAgICAgICB2YXIganVtcF9pbmRleCA9IGp1bXBfaXRlbS5pbmRleCgpO1xuXG4gICAgICAgIC8vcmVtb3ZlIHNlbGVjdGVkIGZyb20gZG9tXG4gICAgICAgIGp1bXBfaXRlbS5yZW1vdmUoKTtcblxuICAgICAgICAvL3JlbW92ZSBmcm9tIG1lbW9yeVxuICAgICAgICBpbnB1dC5qdW1wcy5zcGxpY2UoKGp1bXBfaW5kZXggLSAxKSwgMSk7XG5cbiAgICAgICAgLy9pZiBubyBqdW1wcywgc2hvdyBtZXNzYWdlXG4gICAgICAgIGlmIChqdW1wX2xpc3QuZmluZCgnbGknKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vaWYgbm8ganVtcHMgeWV0LCByZW1vdmUgJ25vIGp1bXBzIHNldCcgaXRlbVxuICAgICAgICAgICAganVtcF9saXN0LnBhcmVudCgpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbm8tanVtcHMtbWVzc2FnZScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgLy9oaWRlIGp1bXBzIGljb24gZnJvbSBpbnB1dCB0b29sXG4gICAgICAgICAgICAvL3RvZG9cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXSAuaW5wdXQtaW5uZXIgLmp1bXAtc3RhdGUnKS5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgbGlzdEp1bXBQb3NzaWJsZUFuc3dlcnM6IGZ1bmN0aW9uICh0aGVfc2VsZWN0LCB0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgZm9jdXNlZF9zZWxlY3QgPSB0aGVfc2VsZWN0O1xuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG5cbiAgICAgICAgLy90cmlnZ2VyIGEgc2F2ZSBpbiBjYXNlIHRoZSB1c2VyIHR5cGVkIGluIGEgcG9zc2liaWxlIGFuc3dlciBhbmQgc3dpdGNoZWQgZGlyZWN0bHkgdG8gdGhlIGp1bXAgdGFiXG4gICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcblxuICAgICAgICBmb2N1c2VkX3NlbGVjdC5lbXB0eSgpO1xuICAgICAgICAkKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGh0bWwgKz0gJzxvcHRpb24gdmFsdWU9XCInO1xuICAgICAgICAgICAgaHRtbCArPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZiArICdcIj4nO1xuICAgICAgICAgICAgaHRtbCArPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyLnRydW5jKDUwKTtcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvb3B0aW9uPic7XG4gICAgICAgIH0pO1xuICAgICAgICBmb2N1c2VkX3NlbGVjdC5hcHBlbmQoaHRtbCk7XG4gICAgfSxcblxuICAgIC8vbGlzdCBqdW1wIGNvbnNpdGlvbnMgKGlzLCBpcyBub3QgZXRjLi4uKVxuICAgIGxpc3RKdW1wQ29uZGl0aW9uczogZnVuY3Rpb24gKHRoZV9zZWxlY3QpIHtcblxuICAgICAgICB2YXIgZm9jdXNlZF9zZWxlY3QgPSB0aGVfc2VsZWN0O1xuICAgICAgICB2YXIgcG9zc2libGVfY29uZGl0aW9ucyA9IGNvbnN0cy5KVU1QX0NPTkRJVElPTlM7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG5cbiAgICAgICAgZm9jdXNlZF9zZWxlY3QuZW1wdHkoKTtcbiAgICAgICAgJChwb3NzaWJsZV9jb25kaXRpb25zKS5lYWNoKGZ1bmN0aW9uIChpKSB7XG5cbiAgICAgICAgICAgIGh0bWwgKz0gJzxvcHRpb24gdmFsdWU9XCInO1xuICAgICAgICAgICAgaHRtbCArPSB0aGlzLmtleSArICdcIj4nO1xuICAgICAgICAgICAgaHRtbCArPSB0aGlzLnRleHQ7XG4gICAgICAgICAgICBodG1sICs9ICc8L29wdGlvbj4nO1xuICAgICAgICB9KTtcbiAgICAgICAgZm9jdXNlZF9zZWxlY3QuYXBwZW5kKGh0bWwpO1xuICAgIH0sXG5cbiAgICAvL2R5bmFtaWNhbGx5IHNob3cgYSBsaXN0IG9mIHBvc3NpYmxlIGRlc3RpbmF0aW9uIGZvciBhIGp1bXBcbiAgICBsaXN0SnVtcERlc3RpbmF0aW9uczogZnVuY3Rpb24gKHRoZV9zZWxlY3QsIHRoZV9qdW1wX2Rlc3RpbmF0aW9ucykge1xuXG4gICAgICAgIHZhciBmb2N1c2VkX3NlbGVjdCA9IHRoZV9zZWxlY3Q7XG4gICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucyA9IHRoZV9qdW1wX2Rlc3RpbmF0aW9ucztcblxuICAgICAgICAvKlxuICAgICAgICAganVtcHMgY2FuIGdvIG9ubHkgZm9yd2FyZCwgcG9zc2libGUganVtcHMgZGVzdGluYXRpb25zIGFyZSBpbmRleCBvZiBjdXJyZW50IGlucHV0ICsxLFxuICAgICAgICAgYXMgaXQgbm90IHBvc3NpYmxlIHRvIGp1bXAgdG8gYW4gYWRqYWNlbnQgaW5wdXRcbiAgICAgICAgICovXG4gICAgICAgIGZvY3VzZWRfc2VsZWN0LmVtcHR5KCk7XG4gICAgICAgICQoanVtcF9kZXN0aW5hdGlvbnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBkZXN0aW5hdGlvbikge1xuXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb247XG4gICAgICAgICAgICB2YXIgcHVyaWZpZWRSZWFkbWUgPSAnJztcblxuICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnF1ZXN0aW9uID09PSAnJykge1xuICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb24gPSBtZXNzYWdlcy5lcnJvci5OT19CUkFOQ0hfSEVBREVSX1lFVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gbWVzc2FnZXMuZXJyb3IuTk9fUVVFU1RJT05fVEVYVF9ZRVQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL3N0cmlwIGFsbCB0YWdzIGZvciBwcmV2aWV3IHdpdGhpbiBzZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgcHVyaWZpZWRSZWFkbWUgPSB1dGlscy5kZWNvZGVIdG1sKGRlc3RpbmF0aW9uLnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcHVyaWZpZWRSZWFkbWUgPSB1dGlscy5zdHJpcFRhZ3MocHVyaWZpZWRSZWFkbWUpO1xuICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbiA9IHB1cmlmaWVkUmVhZG1lLnRydW5jKDUwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gZGVzdGluYXRpb24ucXVlc3Rpb24udHJ1bmMoNTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvY3VzZWRfc2VsZWN0LmFwcGVuZCgnPG9wdGlvbiB2YWx1ZT1cIicgKyBkZXN0aW5hdGlvbi5yZWYgKyAnXCI+JyArIHF1ZXN0aW9uICsgJyA8L29wdGlvbj4nKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vLy9pZiBhbnkganVtcCwgcmVmcmVzaCB0aGUganVtcHMgc2VsZWN0ZWQgZGVzdGluYXRpb24gbGFiZWwgYXMgaXQgbWlnaHQgaGF2ZSBjaGFuZ2VkXG4gICAgcmVmcmVzaElucHV0SnVtcHNEb206IGZ1bmN0aW9uIChpbnB1dCwgaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIHNlbGVjdGVkX2Rlc3RpbmF0aW9ucyA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLWdvdG8gc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpO1xuICAgICAgICB2YXIgcHVyaWZpZWRSZWFkbWUgPSAnJztcblxuICAgICAgICB2YXIgYXZhaWxhYmxlX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnMoaW5wdXQsIGlucHV0cyk7XG5cbiAgICAgICAgLy9sb29wIGVhY2gganVtcFxuICAgICAgICAkKGlucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChqdW1wSW5kZXgsIGp1bXApIHtcblxuICAgICAgICAgICAgLy9maW5kIHRoZSBkZXN0aW5hdGlvbiBcInF1ZXN0aW9uXCIgYW5kIHVwZGF0ZSB0aGUgdGV4dCBzaG93biBpbiB0aGUgZHJvcGRvd24gXCJnbyB0b1wiXG4gICAgICAgICAgICAkKGF2YWlsYWJsZV9kZXN0aW5hdGlvbnMpLmVhY2goZnVuY3Rpb24gKGRlc3RpbmF0aW9uSW5kZXgsIGRlc3RpbmF0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoanVtcC50byA9PT0gZGVzdGluYXRpb24ucmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc3RyaXAgYWxsIHRhZ3MgZm9yIHByZXZpZXcgd2l0aGluIHNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgcHVyaWZpZWRSZWFkbWUgPSB1dGlscy5kZWNvZGVIdG1sKGRlc3RpbmF0aW9uLnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1cmlmaWVkUmVhZG1lID0gdXRpbHMuc3RyaXBUYWdzKHB1cmlmaWVkUmVhZG1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZWN0ZWRfZGVzdGluYXRpb25zW2p1bXBJbmRleF0pLnRleHQocHVyaWZpZWRSZWFkbWUudHJ1bmMoNTApKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZWN0ZWRfZGVzdGluYXRpb25zW2p1bXBJbmRleF0pLnRleHQoZGVzdGluYXRpb24ucXVlc3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBqdW1wcztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIGZvcm1fZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvZm9ybS1mYWN0b3J5Jyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBtZXRob2RzID0ge1xuICAgIGdldEJyYW5jaElucHV0c0hUTUw6IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9nZXRCcmFuY2hJbnB1dHNIVE1MJyksXG4gICAgZ2V0R3JvdXBJbnB1dHNIVE1MOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvZ2V0R3JvdXBJbnB1dHNIVE1MJyksXG4gICAgcmVuZGVySW5wdXRzOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVySW5wdXRzJyksXG4gICAgcmVuZGVyUHJvamVjdDogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL3JlbmRlclByb2plY3QnKSxcbiAgICByZW5kZXJDaGlsZEZvcm1zOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVyQ2hpbGRGb3JtcycpLFxuICAgIGluaXRGb3JtYnVpbGRlcjogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL2luaXRGb3JtYnVpbGRlcicpXG59O1xuXG52YXIgcGFyc2UgPSB7XG5cbiAgICBhY3Rpb246ICcnLFxuXG4gICAgcmVuZGVySW5wdXRzOiBmdW5jdGlvbiAodGhlX2lucHV0cykge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5yZW5kZXJJbnB1dHModGhlX2lucHV0cyk7XG4gICAgfSxcblxuICAgIGdldEJyYW5jaElucHV0c0hUTUw6IGZ1bmN0aW9uICh0aGVfaW5wdXQsIHRoZV9pbmRleCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRCcmFuY2hJbnB1dHNIVE1MKHRoZV9pbnB1dCwgdGhlX2luZGV4KTtcbiAgICB9LFxuICAgIC8vYnJhbmNoIGluZGV4IGlzIHNldCB3aGVuIGl0IGlzIGEgbmVzdGVkIGdyb3VwIG9ubHlcbiAgICBnZXRHcm91cElucHV0c0hUTUw6IGZ1bmN0aW9uICh0aGVfaW5wdXQsIHRoZV9pbmRleCwgdGhlX2JyYW5jaF9pbmRleCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRHcm91cElucHV0c0hUTUwodGhlX2lucHV0LCB0aGVfaW5kZXgsIHRoZV9icmFuY2hfaW5kZXgpO1xuICAgIH0sXG5cbiAgICByZW5kZXJQcm9qZWN0OiBmdW5jdGlvbiAocHJvamVjdF9kZWZpbml0aW9uLCBhY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMucmVuZGVyUHJvamVjdChwcm9qZWN0X2RlZmluaXRpb24sIGFjdGlvbik7XG4gICAgfSxcblxuICAgIGluaXRGb3JtYnVpbGRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5pbml0Rm9ybWJ1aWxkZXIoKTtcbiAgICB9LFxuXG4gICAgLy9yZW5kZXIgY2hpbGRyZW4gZm9ybXMgcmVjdXJzaXZlbHlcbiAgICByZW5kZXJDaGlsZEZvcm06IGZ1bmN0aW9uICh0aGVfY2hpbGRfZm9ybXMpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMucmVuZGVyQ2hpbGRGb3Jtcyh0aGVfY2hpbGRfZm9ybXMpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcGFyc2U7XG5cbiIsIid1c2Ugc3RyaWN0JztcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbnZhciBnZXRCcmFuY2hJbnB1dHNIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX2luZGV4KSB7XG5cbiAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgdmFyIGluZGV4ID0gdGhlX2luZGV4O1xuICAgIHZhciBicmFuY2hfcHJvcGVydGllcztcbiAgICB2YXIgaHRtbDtcbiAgICB2YXIgYnJhbmNoX3NvcnRhYmxlX2h0bWwgPSB1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRFbXB0eUNvbGxlY3Rpb25Tb3J0YWJsZUhUTUwoY29uc3RzLkJSQU5DSF9UWVBFKTtcbiAgICB2YXIgYnJhbmNoX2lucHV0X2NvbGxlY3Rpb25faHRtbCA9ICcnO1xuICAgIHZhciBicmFuY2hfcHJvcGVydGllc19wYW5lbF9odG1sID0gJyc7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbCA9ICcnO1xuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBpbnB1dC5yZWY7XG5cbiAgICAvL2lmIG5vIGJyYW5jaCBpbnB1dHMsIHNob3cgXCJubyBicmFuY2ggaW5wdXRzIG1lc3NhZ2VcIlxuXG4gICAgJC5lYWNoKGlucHV0LmJyYW5jaCwgZnVuY3Rpb24gKGJyYW5jaF9pbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgLy9jcmVhdGUgaHRtbCBicmFuY2ggZWxlbWVudCBmb3IgaW5wdXQgY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgaHRtbCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXRUb29sSFRNTChicmFuY2hfaW5wdXQpO1xuICAgICAgICBicmFuY2hfaW5wdXRfY29sbGVjdGlvbl9odG1sICs9IGh0bWw7XG5cbiAgICAgICAgLy9jb3B5IGlucHV0IHByb3BlcnRpZXMgZnJvbSBzdG9yZWQgYnJhbmNoIGlucHV0XG4gICAgICAgIGJyYW5jaF9wcm9wZXJ0aWVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShicmFuY2hfaW5wdXQpKTtcblxuICAgICAgICAvL2dlbmVyYXRlIG5ldyBicmFuY2ggaW5wdXQgd2l0aCBhdHRhY2hlZCBwcm90b3R5cGVcbiAgICAgICAgYnJhbmNoX2lucHV0ID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dChicmFuY2hfcHJvcGVydGllcy50eXBlLCBicmFuY2hfcHJvcGVydGllcy5yZWYpO1xuXG4gICAgICAgIC8vc2V0IGJyYW5jaCBpbnB1dCBwcm9wZXJ0aWVzIHRvIHN0b3JlZCBwcm9wZXJ0aWVzIChvbmx5IHRoZSBvbmUgc2F2ZWQgaW4gdGhlIHByb2plY3QgZGVmaW5pdGlvbiwgbGVhdmUgdGhlIG90aGVycyBpbnRhY3QpXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIGJyYW5jaF9pbnB1dCkge1xuICAgICAgICAgICAgaWYgKGJyYW5jaF9wcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dFtwcm9wZXJ0eV0gPSBicmFuY2hfcHJvcGVydGllc1twcm9wZXJ0eV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy9zZXQgYnJhbmNoIGlucHV0IGFzIHZhbGlkLCBhcyBieSBkZWZhdWx0IGl0IGlzIGdlbmVyYXRlZCBhcyBpbnZhbGlkXG4gICAgICAgIGJyYW5jaF9pbnB1dC5kb20uaXNfdmFsaWQgPSB0cnVlO1xuXG4gICAgICAgIC8vb3ZlcnJpZGUgJ2dsb2JhbCcgYnJhbmNoIGlucHV0IG9iaiBsaXRlcmFsIHdpdGggbmV3bHkgY3JlYXRlZFxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzW2luZGV4XS5icmFuY2hbYnJhbmNoX2luZGV4XSA9IGJyYW5jaF9pbnB1dDtcblxuICAgICAgICAvL2lmIGl0IGlzIGEgZ3JvdXAsIGxvb3AgYWxsIHRoZSBuZXN5ZWQgZ3JvdXAgaW5wdXRzICh0aGVyZSBtdXN0IGJlIGF0IGxlYXN0IGEgZ3JvdXAgaW5wdXQpXG4gICAgICAgIGlmIChicmFuY2hfaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vcGFzcyBpbiBicmFuY2hfaW5kZXggYXMgdGhpcyBpcyBhIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbnB1dHNfaHRtbCA9IHNlbGYuZ2V0R3JvdXBJbnB1dHNIVE1MKGJyYW5jaF9pbnB1dCwgaW5kZXgsIGJyYW5jaF9pbmRleCk7XG4gICAgICAgICAgICBicmFuY2hfaW5wdXRfY29sbGVjdGlvbl9odG1sID0gYnJhbmNoX2lucHV0X2NvbGxlY3Rpb25faHRtbC5yZXBsYWNlKCd7e2dyb3VwLWNvbnRlbnR9fScsIG5lc3RlZF9ncm91cF9pbnB1dHNfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgICAgIGJyYW5jaF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gbmVzdGVkX2dyb3VwX2lucHV0c19odG1sLnBhbmVscztcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9wZXIgZWFjaCBicmFuY2ggaW5wdXQgd2l0aCBwb3NzaWJsZSBhbnN3ZXJzIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGJyYW5jaF9pbnB1dC50eXBlKSA+IC0xKSB7XG4gICAgICAgICAgICAvL3dlIGhhdmUgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2JyYW5jaF9pbnB1dC5yZWZdID0ge307XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bYnJhbmNoX2lucHV0LnJlZl0ucGFnZSA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dldCBwcm9wZXJ0aWVzIHBhbmVsIGZvciBicmFuY2ggaW5wdXRcbiAgICAgICAgcHJvcGVydGllc19wYW5lbF9odG1sID0gdGVtcGxhdGUuZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MKGJyYW5jaF9pbnB1dCk7XG4gICAgICAgIGJyYW5jaF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuXG4gICAgfSk7XG5cbiAgICBicmFuY2hfc29ydGFibGVfaHRtbCA9IGJyYW5jaF9zb3J0YWJsZV9odG1sLnJlcGxhY2UoJ3t7YnJhbmNoLWlucHV0c319JywgYnJhbmNoX2lucHV0X2NvbGxlY3Rpb25faHRtbCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjb2xsZWN0aW9uOiBicmFuY2hfc29ydGFibGVfaHRtbCxcbiAgICAgICAgcGFuZWxzOiBicmFuY2hfcHJvcGVydGllc19wYW5lbF9odG1sXG4gICAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0QnJhbmNoSW5wdXRzSFRNTDtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbnZhciBnZXRHcm91cElucHV0c0hUTUwgPSBmdW5jdGlvbiAodGhlX2lucHV0LCB0aGVfaW5kZXgsIHRoZV9icmFuY2hfaW5kZXgpIHtcblxuICAgIHZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciBpbmRleCA9IHRoZV9pbmRleDtcbiAgICB2YXIgYnJhbmNoX2luZGV4ID0gdGhlX2JyYW5jaF9pbmRleDtcbiAgICB2YXIgZ3JvdXBfcHJvcGVydGllcztcbiAgICB2YXIgaHRtbDtcbiAgICB2YXIgZ3JvdXBfc29ydGFibGVfaHRtbCA9IHVpLmlucHV0c19jb2xsZWN0aW9uLmdldEVtcHR5Q29sbGVjdGlvblNvcnRhYmxlSFRNTChjb25zdHMuR1JPVVBfVFlQRSk7XG4gICAgdmFyIGdyb3VwX2lucHV0X2NvbGxlY3Rpb25faHRtbCA9ICcnO1xuICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsX2h0bWwgPSAnJztcbiAgICB2YXIgZ3JvdXBfcHJvcGVydGllc19wYW5lbF9odG1sID0gJyc7XG5cbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IGlucHV0LnJlZjtcblxuICAgICQuZWFjaChpbnB1dC5ncm91cCwgZnVuY3Rpb24gKGdyb3VwX2luZGV4LCBncm91cF9pbnB1dCkge1xuXG4gICAgICAgIC8vY3JlYXRlIGh0bWwgZ3JvdXAgZWxlbWVudCBmb3IgaW5wdXQgY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgaHRtbCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXRUb29sSFRNTChncm91cF9pbnB1dCk7XG4gICAgICAgIGdyb3VwX2lucHV0X2NvbGxlY3Rpb25faHRtbCArPSBodG1sO1xuXG4gICAgICAgIC8vY29weSBpbnB1dCBwcm9wZXJ0aWVzIGZyb20gc3RvcmVkIGdyb3VwIGlucHV0XG4gICAgICAgIGdyb3VwX3Byb3BlcnRpZXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGdyb3VwX2lucHV0KSk7XG5cbiAgICAgICAgLy9nZW5lcmF0ZSBuZXcgZ3JvdXAgaW5wdXQgd2l0aCBhdHRhY2hlZCBwcm90b3R5cGVcbiAgICAgICAgZ3JvdXBfaW5wdXQgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0KGdyb3VwX3Byb3BlcnRpZXMudHlwZSwgZ3JvdXBfcHJvcGVydGllcy5yZWYpO1xuXG4gICAgICAgIC8vc2V0IGdyb3VwIGlucHV0IHByb3BlcnRpZXMgdG8gc3RvcmVkIHByb3BlcnRpZXMgKG9ubHkgdGhlIG9uZSBzYXZlZCBpbiB0aGUgcHJvamVjdCBkZWZpbml0aW9uLCBsZWF2ZSB0aGUgb3RoZXJzIGludGFjdClcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChncm91cF9wcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0W3Byb3BlcnR5XSA9IGdyb3VwX3Byb3BlcnRpZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9zZXQgZ3JvdXAgaW5wdXQgYXMgdmFsaWQsIGFzIGJ5IGRlZmF1bHQgaXQgaXMgZ2VuZXJhdGVkIGFzIGludmFsaWRcbiAgICAgICAgZ3JvdXBfaW5wdXQuZG9tLmlzX3ZhbGlkID0gdHJ1ZTtcblxuICAgICAgICAvL292ZXJyaWRlICdnbG9iYWwnIGdyb3VwIGlucHV0IG9iaiBsaXRlcmFsIHdpdGggbmV3bHkgY3JlYXRlZFxuICAgICAgICBpZiAoYnJhbmNoX2luZGV4ID09PSBudWxsKSB7XG4gICAgICAgICAgICAvL3RoaXMgaXMgYSBmaXJzdCBsZXZlbCBncm91cFxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0c1tpbmRleF0uZ3JvdXBbZ3JvdXBfaW5kZXhdID0gZ3JvdXBfaW5wdXQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3RoaXMgaXMgYSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3RcbiAgICAgICAgICAgICAgICAuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XVxuICAgICAgICAgICAgICAgIC5pbnB1dHNbaW5kZXhdXG4gICAgICAgICAgICAgICAgLmJyYW5jaFt0aGVfYnJhbmNoX2luZGV4XVxuICAgICAgICAgICAgICAgIC5ncm91cFtncm91cF9pbmRleF0gPSBncm91cF9pbnB1dDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcGVyIGVhY2ggZ3JvdXAgaW5wdXQgd2l0aCBwb3NzaWJsZSBhbnN3ZXJzIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGdyb3VwX2lucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIC8vd2UgaGF2ZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bZ3JvdXBfaW5wdXQucmVmXSA9IHt9O1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2dyb3VwX2lucHV0LnJlZl0ucGFnZSA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsX2h0bWwgPSB0ZW1wbGF0ZS5nZXRJbnB1dFByb3BlcnRpZXNQYW5lbEhUTUwoZ3JvdXBfaW5wdXQpO1xuICAgICAgICBncm91cF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuICAgIH0pO1xuXG4gICAgZ3JvdXBfc29ydGFibGVfaHRtbCA9IGdyb3VwX3NvcnRhYmxlX2h0bWwucmVwbGFjZSgne3tncm91cC1pbnB1dHN9fScsIGdyb3VwX2lucHV0X2NvbGxlY3Rpb25faHRtbCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjb2xsZWN0aW9uOiBncm91cF9zb3J0YWJsZV9odG1sLFxuICAgICAgICBwYW5lbHM6IGdyb3VwX3Byb3BlcnRpZXNfcGFuZWxfaHRtbFxuICAgIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldEdyb3VwSW5wdXRzSFRNTDtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG52YXIgZm9ybV9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9mb3JtLWZhY3RvcnknKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX2JyYW5jaF9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1jb2xsZWN0aW9uLWJyYW5jaC1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2snKTtcblxudmFyIGluaXRGb3JtYnVpbGRlciA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgcHJvamVjdDtcbiAgICB2YXIgZm9ybXM7XG4gICAgdmFyIHN0YXRlO1xuICAgIC8vIHZhciBwcm9qZWN0X2RlZmluaXRpb247XG4gICAgdmFyIGFjdGl2ZV9icmFuY2g7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2hfaW5wdXQ7XG4gICAgdmFyIGFjdGl2ZV9uZXN0ZWRfZ3JvdXA7XG5cblxuICAgIC8vZHJvcCBhbnkgcmVmZXJlbmNlIHRvIGlucHV0IHJlZiwgYXMgd2Ugc3RhcnQgd2l0aCBubyBpbnB1dCBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoID0gZmFsc2U7XG4gICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IGZhbHNlO1xuXG4gICAgLy9yZS1lbmFibGUgYnJhbmNoIGlucHV0IHRvb2wgaW4gbGVmdCBzaWRlYmFyXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZmlsdGVyKCcuaW5wdXQtYnJhbmNoJykuc2hvdygpO1xuICAgIC8vcmUtZW5hYmxlIGdyb3VwIGlucHV0IHRvb2wgaW4gbGVmdCBzaWRlYmFyXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZmlsdGVyKCcuaW5wdXQtZ3JvdXAnKS5zaG93KCk7XG5cbiAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA+PSBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4KSB7XG4gICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgfVxuXG4gICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24sIGFzIHRoZXJlIGlzIG5vIHBvaW50IHNhdmluZyBhIHByb2plY3Qgd2l0aCBubyBjaGFuZ2VzXG4gICAgLy9pdCB3aWxsIGJlIHJlLWVuYWJsZSBhcyBzb29uIHRoZSB1c2VyIG1ha2UgYSBjaGFuZ2VcbiAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoJ2NsaWNrJyk7XG5cbiAgICAvL3doZW4gdW5kb2luZ1xuICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9VTkRPKSB7XG5cbiAgICAgICAgLy9nZXQgY3VycmVudCBwcm9qZWN0IGRlZmluaXRpb24gYXMgd2UgaGF2ZSBhbGwgdGhlIG1ldGhvZHMgYXR0YWNoZWQgdG8gaW5wdXRzIChpdCBpcyB0aGUgcHJldmlvdXMgc3RhdGUganVzdCByZW5kZXJlZCBvbiBzY3JlZW4pXG4gICAgICAgIC8vcHJvamVjdF9kZWZpbml0aW9uID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uO1xuICAgICAgICBzdGF0ZSA9IGZvcm1idWlsZGVyLnByZXZpb3VzX3N0YXRlO1xuICAgICAgICBwcm9qZWN0ID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdDtcbiAgICAgICAgZm9ybXMgPSBwcm9qZWN0LmZvcm1zLnNsaWNlKCk7XG5cbiAgICAgICAgLy9sZXQncyBzZXQgYWxsIGlucHV0cyBhcyBkaXNhYmxlZCB0byBzdGFydCB3aXRoXG4gICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIC8vcnVuIHZhbGlkYXRpb24gb24gZWFjaCBmb3JtXG4gICAgICAgICQoZm9ybXMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBmb3JtKSB7XG5cbiAgICAgICAgICAgIC8vc2V0IGZvcm0gZG9tIHJlZmVyZW5jZXMgKGZvciB0aGUgdmFsaWRhdGlvbiBhbmQgZG9tIGNoYW5nZXMpXG4gICAgICAgICAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKGZvcm0ucmVmKTtcblxuICAgICAgICAgICAgLy9zZXQgZm9ybWJ1aWxkZXIgc3RldCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gZm9ybS5yZWY7XG5cbiAgICAgICAgICAgIC8vdG9kbyBjaGVjayB0aGlzIGZvciBicmFuY2hlcywgZ3JvdXBzIGFuZCBuZXN0ZWQgZ3JvdXBzXG4gICAgICAgICAgICAkKGZvcm0uaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgd2UgaGF2ZSBhbiBhY3RpdmUgaW5wdXQgYWZ0ZXIgdW5kb2luZ1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5yZWYgPT09IHN0YXRlLmFjdGl2ZV9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBzdGF0ZS5hY3RpdmVfaW5wdXRfcmVmO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vcnVuIGEgdmFsaWRhdGlvbiBhZnRlciB0aGUgZG9tIGlzIGNyZWF0ZWQgbG9vcGluZyBhbGwgdGhlIGlucHV0cyB3aGljaCBhcmUgc2V0IGFzIGZhbHNlLCBhbmQgc2V0IGRvbSBhY2NvcmRpbmdseVxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGlucHV0LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmFyZUZvcm1JbnB1dHNWYWxpZChpbmRleCkpIHtcbiAgICAgICAgICAgICAgICAvL3NldCB2YWxpZCBpY29uIG9uIGZvcm1cbiAgICAgICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vc2V0IGludmFsaWQgaWNvbiBvbiBmb3JtXG4gICAgICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9zZXQgZm9ybWJ1aWxkZXIgaW50ZXJmYWNlIHRvIHByZXZpb3VzIHN0YXRlXG4gICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCA9IHN0YXRlLmFjdGl2ZV9mb3JtX2luZGV4O1xuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gc3RhdGUuYWN0aXZlX2Zvcm1fcmVmO1xuICAgICAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9yZWYpO1xuICAgICAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCA9IHN0YXRlLndhc19lZGl0aW5nX2JyYW5jaDtcbiAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IHN0YXRlLndhc19lZGl0aW5nX2dyb3VwO1xuXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL3RvZG8gcmUtZW5hYmxlIHRoZSBuZXN0ZWQgZ3JvdXAgdGhhdCB3YXMgYmVpbmcgZWRpdGVkXG5cblxuICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybWJ1aWxkZXIpO1xuXG4gICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihzdGF0ZS5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICBhY3RpdmVfbmVzdGVkX2dyb3VwID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBPYmplY3RCeVJlZihhY3RpdmVfYnJhbmNoLCBzdGF0ZS5hY3RpdmVfZ3JvdXBfcmVmKTtcbiAgICAgICAgICAgIGFjdGl2ZV9icmFuY2guZW50ZXJCcmFuY2hTb3J0YWJsZSgpO1xuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IHN0YXRlLmFjdGl2ZV9icmFuY2hfcmVmOy8vdGhlIGJyYW5jaCB0aGF0IHdhcyBhY3RpdmUgd2hlbiB1bmRvaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYgPSBzdGF0ZS5hY3RpdmVfZ3JvdXBfcmVmOy8vdGhlIG5lc3RlZCBncm91cCB0aGF0IHdhcyBhY3RpdmUgd2hlbiB1bmRvaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmID0gc3RhdGUuYWN0aXZlX2dyb3VwX3JlZjsvL3RoZSBuZXN0ZWQgZ3JvdXAgdGhhdCB3YXMgYWN0aXZlIHdoZW4gdW5kb2luZ1xuXG4gICAgICAgICAgICBhY3RpdmVfbmVzdGVkX2dyb3VwLmVudGVyR3JvdXBTb3J0YWJsZSh0cnVlKTtcblxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9yZS1lbmFibGUgdGhlIGJyYW5jaCB0aGF0IHdhcyBiZWluZyBlZGl0ZWRcbiAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihzdGF0ZS5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICAgICAgYWN0aXZlX2JyYW5jaC5lbnRlckJyYW5jaFNvcnRhYmxlKCk7XG5cbiAgICAgICAgICAgICAgICAvL3NldCB0aGUgYWN0aXZlIGJyYW5jaCBpbnB1dCBpZiB0aGVyZSB3YXMgb25lIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmFjdGl2ZV9icmFuY2hfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciBhIHN5bnRoZXRpYyBjbGljayBvbiB0aGUgYnJhbmNoIHNvcnRhYmxlIChkb20pXG4gICAgICAgICAgICAgICAgICAgIC8vYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgICAgICAgICAkKCcuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYgKyAnXCJdJykudHJpZ2dlcignbW91c2Vkb3duJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zd2l0Y2ggdG8gcHJldmlvdXNseSBhY3RpdmUgcHJvcGVydGllcyB0YWJcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLm5hdi10YWJzX190YWItYnRuLWl0ZW0gYVtocmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9wcm9wZXJ0aWVzX3RhYiArICdcIl0nKS50YWIoJ3Nob3cnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSB0aGUgYnJhbmNoIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmVfZ3JvdXAgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKHN0YXRlLmFjdGl2ZV9ncm91cF9yZWYpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZV9ncm91cC5lbnRlckdyb3VwU29ydGFibGUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5hY3RpdmVfZ3JvdXBfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciBhIHN5bnRoZXRpYyBjbGljayBvbiB0aGUgYnJhbmNoIHNvcnRhYmxlIChkb20pXG4gICAgICAgICAgICAgICAgICAgIC8vYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgICAgICAgICAkKCcuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2dyb3VwX2lucHV0X3JlZiArICdcIl0nKS50cmlnZ2VyKCdtb3VzZWRvd24nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3N3aXRjaCB0byBwcmV2aW91c2x5IGFjdGl2ZSBwcm9wZXJ0aWVzIHRhYlxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicyAubmF2LXRhYnNfX3RhYi1idG4taXRlbSBhW2hyZWY9XCInICsgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiICsgJ1wiXScpLnRhYignc2hvdycpO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIHRoZSB1c2VyIHdhcyBlZGl0aW5nIG1haW4gZm9ybXMsIHJlYmluZCBldmVudHNcbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiAhZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICAvKiBkbyB0aGlzIGFzIHdlIG1pZ2h0IGhhdmUgaGFkIGFuIGFjdGl2ZSBicmFuY2ggd2hlbiBjbGlja2luZyB1bmRvICoqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIC8vZW5hYmxlIGZvcm0gdGFiIGJ1dHRvbnNcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMudG9nZ2xlRm9ybVRhYnNCdXR0b25zKHsgZW5hYmxlOiB0cnVlIH0pO1xuICAgICAgICAgICAgLy9zZXQgZHJhZ2dhYmxlIHRvIHdvcmsgd2l0aCBtYWluIHNvcnRhYmxlXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5kcmFnZ2FibGUoJ29wdGlvbicsICdjb25uZWN0VG9Tb3J0YWJsZScsICcuc29ydGFibGUnKTtcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgICAgICBmb3JtX2ZhY3RvcnkudW5iaW5kRm9ybVBhbmVsc0V2ZW50cygpO1xuICAgICAgICAgICAgZm9ybV9mYWN0b3J5LnVwZGF0ZUZvcm1idWlsZGVyRG9tUmVmZXJlbmNlcyhmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0ucmVmKTtcbiAgICAgICAgICAgIGZvcm1fZmFjdG9yeS5iaW5kRm9ybVBhbmVsc0V2ZW50cygpO1xuXG4gICAgICAgICAgICAvL3N3aXRjaCB0byBwcmV2aW91c2x5IGFjdGl2ZSBmb3JtXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCdhW2RhdGEtZm9ybS1pbmRleD0nICsgc3RhdGUuYWN0aXZlX2Zvcm1faW5kZXggKyAnXScpLnRhYignc2hvdycpO1xuXG4gICAgICAgICAgICAvL2FjdGl2YXRlIHByZXZpb3VzIGlucHV0IGZyb20gZG9tIGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pLCBpZiBvbmUgd2FzIGFjdGl2ZSBpbiB0aGUgcHJldmlvdXMgc3RhdGVcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmICsgJ1wiXScpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgIC8vc2hvdyBhY3RpdmUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiArICdcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgICAgICAvL3N3aXRjaCB0byBwcmV2aW91c2x5IGFjdGl2ZSBwcm9wZXJ0aWVzIHRhYlxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicyAubmF2LXRhYnNfX3RhYi1idG4taXRlbSBhW2hyZWY9XCInICsgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiICsgJ1wiXScpLnRhYignc2hvdycpO1xuXG4gICAgICAgICAgICAgICAgLy9oaWRlIG1lc3NhZ2Ugbm8gaW5wdXQgd2FzIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tXG4gICAgICAgICAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5kZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgaWYgKGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPT09IGNvbnN0cy5SRU5ERVJfQUNUSU9OX0RPKSB7XG4gICAgICAgIC8vd2UgYXJlIHJlbmRlcmluZyBhbiBleGlzdGluZyBwcm9qZWN0LCBzbyBzd2l0Y2ggZG9tIHJlZmVyZW5jZXMgdG8gdG9wIGxldmVsIGZvcm0gd2hpY2ggaXMgc2hvd24gYnkgZGVmYXVsdFxuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPSAwO1xuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1swXS5yZWY7XG4gICAgICAgIC8vZm9ybV9mYWN0b3J5LnVuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcbiAgICAgICAgZm9ybV9mYWN0b3J5LnVwZGF0ZUZvcm1idWlsZGVyRG9tUmVmZXJlbmNlcyhmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zWzBdLnJlZik7XG5cbiAgICAgICAgLy9oaWRlIGFkZCBjaGlsZCBmb3JtIGJ1dHRvbiBpZiB0aGUgZm9ybSB0b3RhbCBpcyBNQVhfTlVNQkVSX09GX05FU1RFRF9DSElMRF9GT1JNU1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcy5sZW5ndGggPT09IGNvbnN0cy5NQVhfTlVNQkVSX09GX05FU1RFRF9DSElMRF9GT1JNUykge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnLm1haW5fX3RhYnNfYWRkLWZvcm0nKS5wYXJlbnQoKS5oaWRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBzZWxmLmRlZmVycmVkLnJlc29sdmUoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGluaXRGb3JtYnVpbGRlcjtcblxuXG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciBmb3JtX2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2Zvcm0tZmFjdG9yeScpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcblxudmFyIHJlbmRlckNoaWxkRm9ybXMgPSBmdW5jdGlvbiAodGhlX2NoaWxkX2Zvcm1zKSB7XG5cbiAgICB2YXIgY2hpbGRfZm9ybXMgPSB0aGVfY2hpbGRfZm9ybXM7XG4gICAgdmFyIGNoaWxkX2Zvcm0gPSBjaGlsZF9mb3Jtcy5zaGlmdCgpO1xuICAgIHZhciBjaGlsZF9pbnB1dHM7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4Kys7XG5cbiAgICAvL3JlbmRlciBjaGlsZCBmb3JtXG4gICAgJC53aGVuKGZvcm1fZmFjdG9yeS5jcmVhdGVDaGlsZEZvcm0oY2hpbGRfZm9ybS5uYW1lLCBjaGlsZF9mb3JtLnJlZiwgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LCBmYWxzZSkpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vYXBwZW5kIGlucHV0cyBhbmQgdGhlaXIgcHJvcGVydGllcyBwYW5lbHNcbiAgICAgICAgY2hpbGRfaW5wdXRzID0gc2VsZi5yZW5kZXJJbnB1dHMoY2hpbGRfZm9ybS5pbnB1dHMpO1xuICAgICAgICAvL3JlcGxhY2Ugb2JqZWN0IGxpdGVyYWwgaW5wdXRzIHdpdGggbmV3bHkgZ2VuZXJhdGVkIG9uZXMgdmlhIGZhY3RvcnkgKGkuZS4gdXNpbmcgbmV3KSBzbyB0aGV5IGdldCB0aGUgcHJvdG90eXBlXG4gICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHMgPSBjaGlsZF9pbnB1dHMuc2xpY2UoKTtcblxuICAgICAgICAvL3JlbW92ZSBubyBxdWVzdGlvbnMgbWVzc2FnZVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLXF1ZXN0aW9ucy1tZXNzYWdlJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgIC8vaGlkZSBwcm9wZXJ0aWVzIHBhbmVsIGJ1dHRvbnMgYXMgbm8gaW5wdXQgaXMgc2VsZWN0ZWRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KCk7XG5cbiAgICAgICAgLy9yZW5kZXIgbmV4dCBjaGlsZCBmb3JtIHJlY3Vyc2l2ZWx5XG4gICAgICAgIGlmIChjaGlsZF9mb3Jtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBzZWxmLnJlbmRlckNoaWxkRm9ybXMoY2hpbGRfZm9ybXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5pbml0Rm9ybWJ1aWxkZXIoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlbmRlckNoaWxkRm9ybXM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xuXG52YXIgcmVuZGVySW5wdXRzID0gZnVuY3Rpb24gKHRoZV9pbnB1dHMpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgaW5wdXRzID0gdGhlX2lucHV0cztcbiAgICB2YXIgaHRtbDtcbiAgICB2YXIgcHJvcGVydGllcztcbiAgICB2YXIgcHJvcGVydGllc19wYW5lbF9odG1sO1xuICAgIHZhciBnZW5lcmF0ZWRfaW5wdXRzID0gW107XG4gICAgdmFyIGlucHV0X2NvbGxlY3Rpb25faHRtbCA9ICcnO1xuICAgIHZhciBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgPSAnJztcblxuXG4gICAgJC5lYWNoKGlucHV0cywgZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuXG4gICAgICAgIHZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG5cbiAgICAgICAgLy8vKipcbiAgICAgICAgLy8gKiBMb29wIGFsbCBqdW1wcyB0byByZW1vdmUgYW55IFwiaGFzX3ZhbGlkX2Rlc3RpbmF0aW9uXCIgcHJvcGVydHlcbiAgICAgICAgLy8gKiB0aGlzIHdhcyBjYXVzZWQgYnkgYSBidWcgc28gYSBmZXcgcHJvamVjdHMgaGF2ZSBpdC5cbiAgICAgICAgLy8gKiBJbnN0ZWFkIG9mIGhhY2tpbmcgdGhlIGRiLCB3ZSBzYW5pdGlzZSB0aGF0IGhlcmVcbiAgICAgICAgLy8gKiBzbyB0aGUgbmV4dCB0aW1lIHRoZXkgc2F2ZSB0aGUgcHJvamVjdCBpcyBva1xuICAgICAgICAvLyAqL1xuICAgICAgICAvLyQoaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24oanVtcEluZGV4LCBqdW1wKXtcbiAgICAgICAgLy8gICAgZGVsZXRlIGp1bXAuaGFzX3ZhbGlkX2Rlc3RpbmF0aW9uO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIC8vY3JlYXRlIGh0bWwgZWxlbWVudCBmb3IgaW5wdXQgY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgaHRtbCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXRUb29sSFRNTChpbnB1dCk7XG4gICAgICAgIGlucHV0X2NvbGxlY3Rpb25faHRtbCArPSBodG1sO1xuXG4gICAgICAgIC8vY29weSBpbnB1dCBwcm9wZXJ0aWVzIGZyb20gc3RvcmVkIGlucHV0XG4gICAgICAgIHByb3BlcnRpZXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGlucHV0KSk7XG5cbiAgICAgICAgLy9nZW5lcmF0ZSBuZXcgaW5wdXQgd2l0aCBhdHRhY2hlZCBwcm90b3R5cGVcbiAgICAgICAgaW5wdXQgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0KHByb3BlcnRpZXMudHlwZSwgcHJvcGVydGllcy5yZWYpO1xuXG4gICAgICAgIC8vb24gbG9hZCAod2hlbiBsb2FkaW5nIGFuIGV4aXN0aW5nIHByb2plY3QpXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9ETykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbmRlciBvbiBsb2FkJyk7XG4gICAgICAgICAgICAvL3NldCBpbnB1dCBhcyB2YWxpZCwgYXMgaXQgaXMgZ2VuZXJhdGVkIGFzIGludmFsaWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vc2V0IGlucHV0IHByb3BlcnRpZXMgdG8gc3RvcmVkIGlucHV0IHByb3BlcnRpZXMgKG9ubHkgdGhlIG9uZSBzYXZlZCBpbiB0aGUgcHJvamVjdCBkZWZpbml0aW9uLCBsZWF2ZSB0aGUgb3RoZXJzIGludGFjdClcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gaW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIGlucHV0W3Byb3BlcnR5XSA9IHByb3BlcnRpZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9vdmVycmlkZSAnZ2xvYmFsJyBpbnB1dCBvYmogbGl0ZXJhbCB3aXRoIG5ld2x5IGNyZWF0ZWRcbiAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0c1tpbmRleF0gPSBpbnB1dDtcblxuICAgICAgICAvL2lmIGl0IGlzIGEgYnJhbmNoLCBsb29wIGFsbCB0aGUgYnJhbmNoIGlucHV0cyAodGhlcmUgbXVzdCBiZSBhdCBsZWFzdCBhIGJyYW5jaCBpbnB1dClcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSkge1xuXG4gICAgICAgICAgICAvL3NldCBlZGl0IGJyYW5jaCB0byB0cnVlIHdoZW4gcmVuZGVyaW5nIGZyb20gYSBzYXZlZCBwcm9qZWN0LFxuICAgICAgICAgICAgLy9iZWNhdXNlIHdlIGFyZSByZS11c2luZyBmdW5jdGlvbnMgdGhhdCBleHBlY3RzIHRoaXMgZmxhZyB0byBiZSB0cnVlXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCA9IHRydWU7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9oZWFkZXIgPSBpbnB1dC5xdWVzdGlvbjtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZiA9IGlucHV0LnJlZjtcblxuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dHNfaHRtbCA9IHNlbGYuZ2V0QnJhbmNoSW5wdXRzSFRNTChpbnB1dCwgaW5kZXgpO1xuICAgICAgICAgICAgaW5wdXRfY29sbGVjdGlvbl9odG1sID0gaW5wdXRfY29sbGVjdGlvbl9odG1sLnJlcGxhY2UoJ3t7YnJhbmNoLWNvbnRlbnR9fScsIGJyYW5jaF9pbnB1dHNfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCArPSBicmFuY2hfaW5wdXRzX2h0bWwucGFuZWxzO1xuXG4gICAgICAgICAgICAvL3Jlc2V0IGVkaXQgYnJhbmNoIGZsYWdcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoID0gZmFsc2U7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYgPSBudWxsO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaWYgaXQgaXMgYSBncm91cCwgbG9vcCBhbGwgdGhlIGdyb3VwIGlucHV0cyAodGhlcmUgbXVzdCBiZSBhdCBsZWFzdCBhIGdyb3VwIGlucHV0KVxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IHRydWU7XG4gICAgICAgICAgICAvL3RvZG8gc2hvdWxkIEkgc2V0IGFjdGl2ZSBncm91cCBoZWFkZXIgYW5kIGFjdGl2ZSBncm91cCByZWY/XG4gICAgICAgICAgICAvL3RvZG8gbWF5YmUgYmVjYXVzZSBJIGRvIG5pdCBoYXZlIGp1bXBzIGluIGdyb3Vwcz9cblxuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0c19odG1sID0gc2VsZi5nZXRHcm91cElucHV0c0hUTUwoaW5wdXQsIGluZGV4LCBudWxsKTtcbiAgICAgICAgICAgIGlucHV0X2NvbGxlY3Rpb25faHRtbCA9IGlucHV0X2NvbGxlY3Rpb25faHRtbC5yZXBsYWNlKCd7e2dyb3VwLWNvbnRlbnR9fScsIGdyb3VwX2lucHV0c19odG1sLmNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19wYW5lbF9odG1sICs9IGdyb3VwX2lucHV0c19odG1sLnBhbmVscztcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9wZXIgZWFjaCBpbnB1dCB3aXRoIHBvc3NpYmxlIGFuc3dlcnMga2VlcCB0cmFjayBvZiBwYWdpbmF0aW9uXG4gICAgICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgPiAtMSkge1xuICAgICAgICAgICAgLy93ZSBoYXZlIHBvc3NpYmxlIGFuc3dlcnNcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdID0ge307XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlID0gMTtcbiAgICAgICAgfVxuICAgICAgICAvL2NyZWF0ZSBwcm9wZXJ0aWVzIHBhbmVsIGZvciBjdXJyZW50IGlucHV0XG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWxfaHRtbCA9IHRlbXBsYXRlLmdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTChpbnB1dCk7XG4gICAgICAgIGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCArPSBwcm9wZXJ0aWVzX3BhbmVsX2h0bWw7XG5cbiAgICAgICAgLy9oaWRlIHBhbmVscyBhcyBieSBkZWZhdWx0IG5vIGlucHV0cyBhcmUgc2VsZWN0ZWRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybScpLmhpZGUoKTtcblxuICAgICAgICAvL3NhdmUgbmV3bHkgZ2VuZXJhdGVkIGlucHV0XG4gICAgICAgIGdlbmVyYXRlZF9pbnB1dHMucHVzaChpbnB1dCk7XG4gICAgfSk7XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuYXBwZW5kKGlucHV0X2NvbGxlY3Rpb25faHRtbCk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5hcHBlbmQoaW5wdXRfcHJvcGVydGllc19wYW5lbF9odG1sKTtcblxuICAgIHJldHVybiBnZW5lcmF0ZWRfaW5wdXRzO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSByZW5kZXJJbnB1dHM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xudmFyIGZvcm1fZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvZm9ybS1mYWN0b3J5Jyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG5cbnZhciByZW5kZXJQcm9qZWN0ID0gZnVuY3Rpb24gKHByb2plY3RfZGVmaW5pdGlvbikge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBmb3JtcyA9IHByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXMuc2xpY2UoKTsvL25lZWQgYSBkZWVwIGNvcHlcbiAgICB2YXIgaW5wdXRzO1xuXG4gICAgc2VsZi5kZWZlcnJlZCA9IG5ldyAkLkRlZmVycmVkKCk7XG5cbiAgICAvL2lmIHVuZG9pbmcsIHJlc2V0IGZvcm1idWlsZGVyIG9uIHRvcCBwYXJlbnQgZm9ybVxuICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9VTkRPKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZXNldHRpbmcgcmVmZXJlbmNlcyB0byB0b3AgcGFyZW50IGZvcm0nKTtcbiAgICAgICAgZm9ybV9mYWN0b3J5LnVwZGF0ZUZvcm1idWlsZGVyRG9tUmVmZXJlbmNlcyhmb3Jtc1swXS5yZWYpO1xuICAgIH1cblxuICAgIC8vcmVuZGVyIHRvcCBwYXJlbnQgZm9ybSBieSBkZWZhdWx0IGFzIHRoZSBmb3JtYnVpbGRlciBsb2Fkcy5cbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPSAwO1xuICAgIGlucHV0cyA9IHNlbGYucmVuZGVySW5wdXRzKGZvcm1zWzBdLmlucHV0cyk7XG5cbiAgICAvL3JlbW92ZSBubyBxdWVzdGlvbnMgbWVzc2FnZSAoaWYgYW55IGlucHV0cylcbiAgICBpZiAoaW5wdXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1xdWVzdGlvbnMtbWVzc2FnZScpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICB9XG5cbiAgICAvL3Nob3cgbm8gdGl0bGUgd2FybmluZyAoaWYgbm8gdGl0bGUgc2V0IGZvciB0aGUgZmlyc3QgZm9ybSBhbmQgd2UgaGF2ZSBpbnB1dHMpXG4gICAgaWYgKHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKSA9PT0gMCAmJiBpbnB1dHMubGVuZ3RoID4gMCkge1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoMCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8vdG9nZ2xlIGZvcm0gaWNvbiB0byBhIGdyZWVuIGNoY2sgaWYgdGhlIHRvcCBwYXJlbnQgZm9ybSBpcyB2YWxpZFxuICAgIGlmICh2YWxpZGF0aW9uLmFyZUZvcm1JbnB1dHNWYWxpZCgwKSkge1xuICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKDApO1xuXG4gICAgICAgIC8vZW5hYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAvL2VuYWJsZSBwcmludCBhcyBwZGYgZm9ybSBidXR0b25cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICB9XG5cbiAgICAvL2lmIG5vIGlucHV0cywgZGlzYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvblxuICAgIGlmIChpbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgLy9lbmFibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxuXG4gICAgLy9yZXBsYWNlIG9iamVjdCBsaXRlcmFsIGlucHV0cyB3aXRoIG5ld2x5IGdlbmVyYXRlZCBvbmVzIHZpYSBmYWN0b3J5IChpLmUuIHVzaW5nIG5ldykgc28gdGhleSBnZXQgdGhlIHByb3RvdHlwZVxuICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0uaW5wdXRzID0gaW5wdXRzLnNsaWNlKCk7XG5cbiAgICAvL3JlbW92ZSBmaXJzdCBmb3JtIGFzIGl0IGlzIGFscmVhZHkgcmVuZGVyZWRcbiAgICBmb3Jtcy5zaGlmdCgpO1xuXG4gICAgLy9yZW5kZXIgY2hpbGQgZm9ybXMgcmVjdXJzaXZlbHkgKGlmIGFueSlcbiAgICBpZiAoZm9ybXMubGVuZ3RoID4gMCkge1xuICAgICAgICBzZWxmLnJlbmRlckNoaWxkRm9ybXMoZm9ybXMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2VsZi5pbml0Rm9ybWJ1aWxkZXIoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2VsZi5kZWZlcnJlZC5wcm9taXNlKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlbmRlclByb2plY3Q7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyLCBQYXBhKi9cbid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZ2V0UG9zc2libGVBbnN3ZXJQYWdlID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9nZXRQb3NzaWJsZUFuc3dlcnNQYWdlJyk7XG5cbnZhciBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyID0ge1xuXG4gICAgaW5pdDogZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgcGFnZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXInKTtcbiAgICAgICAgdmFyIHBhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlO1xuICAgICAgICB2YXIgdG90YWwgPSBNYXRoLmNlaWwoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggLyBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UpO1xuXG4gICAgICAgIHBhZ2VyLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgcGFnZXIuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXJfX2N1cnJlbnQnKVxuICAgICAgICAgICAgLmh0bWwocGFnZSk7XG4gICAgICAgIHBhZ2VyLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyX190b3RhbCcpXG4gICAgICAgICAgICAuaHRtbCh0b3RhbCk7XG5cbiAgICAgICAgLy9hdHRhY2ggaGFuZGxlcnMgdG8gcGFnaW5hdGlvbiBidXR0b25zXG4gICAgICAgIHZhciBwcmV2X2J0biA9IHBhZ2VyLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyX19wcmV2Jyk7XG4gICAgICAgIHZhciBuZXh0X2J0biA9IHBhZ2VyLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyX19uZXh0Jyk7XG5cbiAgICAgICAgLy93aGVuIHRoZSBwYWdlciBpcyBzaG93biwgc2V0IG1pbi1oZWlnaHQgb24gcGFyZW50IGNvbnRhaW5lclxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKVxuICAgICAgICAgICAgLnBhcmVudCgpLmNzcygnbWluLWhlaWdodCcsICczMjVweCcpO1xuXG4gICAgICAgIHZhciB3YXNfY2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICBuZXh0X2J0bi5vZmYoKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCduZXh0IGJ1dHRvbiBjbGlja2VkJyk7XG4gICAgICAgICAgICB2YXIgbmV4dF9wYWdlO1xuXG4gICAgICAgICAgICAvL3ZhbGlkYXRlIGFuc3dlcnMgY3VycmVudGx5IGluIHRoZSBkb21cbiAgICAgICAgICAgIC8vaWYgYW55IGVycm9yLCB3YXJuIHVzZXIgaW5zdGVhZCBvZiBjaGFuZ2luZyBwYWdlXG4gICAgICAgICAgICAvL3NvIHRoZSB1c2VyIGhhcyB0aGUgY2hhbmNlIHRvIGZpeCB0aGVtXG4gICAgICAgICAgICBpZiAoIXNlbGYuYXJlVmFsaWRQb3NzaWJsZUFuc3dlcnNJbkRPTShpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAvL3Nob3cgZXJyb3JcbiAgICAgICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuUE9TU0lCTEVfQU5TV0VSU19JTlZBTElEKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghd2FzX2NsaWNrZWQpIHtcbiAgICAgICAgICAgICAgICB3YXNfY2xpY2tlZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAvL3NhdmUgcG9zc2libGUgYW5zd2VycyBjdXJyZW50bHkgb24gdGhlIGRvbVxuICAgICAgICAgICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcblxuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlIDwgdG90YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IG5leHQgcG9zc2libGUgYW5zd2VycyBwYWdlIGluIGRvbVxuICAgICAgICAgICAgICAgICAgICBuZXh0X3BhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlICsgMTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA9IG5leHRfcGFnZTtcblxuICAgICAgICAgICAgICAgICAgICBnZXRQb3NzaWJsZUFuc3dlclBhZ2UoaW5wdXQsIG5leHRfcGFnZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgZG9tIHdpdGggY3VycmVudCBwYWdlXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VyLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyX19jdXJyZW50JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKG5leHRfcGFnZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9yZXN0b3JlIGJ1dHRvbiBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhc19jbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU0xPVylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdhc19jbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBwcmV2X2J0bi5vZmYoKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncHJldiBidXR0b24gY2xpY2tlZCcpO1xuICAgICAgICAgICAgLy9zaG93IG5leHQgcG9zc2libGUgYW5zd2VycyBwYWdlIGluIGRvbVxuICAgICAgICAgICAgdmFyIHByZXZfcGFnZTtcblxuICAgICAgICAgICAgaWYgKCFzZWxmLmFyZVZhbGlkUG9zc2libGVBbnN3ZXJzSW5ET00oaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgLy9zaG93IGVycm9yXG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUlNfSU5WQUxJRCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXdhc19jbGlja2VkKSB7XG4gICAgICAgICAgICAgICAgd2FzX2NsaWNrZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgLy9zYXZlIHBvc3NpYmxlIGFuc3dlcnMgY3VycmVudGx5IG9uIHRoZSBkb21cbiAgICAgICAgICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJldl9wYWdlID0gZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSAtIDE7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgPSBwcmV2X3BhZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2V0UG9zc2libGVBbnN3ZXJQYWdlKGlucHV0LCBwcmV2X3BhZ2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIGRvbSB3aXRoIGN1cnJlbnQgcGFnZVxuICAgICAgICAgICAgICAgICAgICBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fY3VycmVudCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaHRtbChwcmV2X3BhZ2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdG9yZSBidXR0b24gZnVuY3Rpb25hbGl0eVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXNfY2xpY2tlZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU0xPVyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgd2FzX2NsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vaGlkZSBwYWdlciBhbmQgcmVzdG9yZSBwb3NzaWJsZSBhbnN3ZXJzIGNvbnRhaW5lciBoZWlnaHRcbiAgICB0ZWFyRG93bjogZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAgICAgdmFyIHBhZ2VyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgIC5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyJyk7XG5cbiAgICAgICAgLy9yZXN0b3JlIGhlaWdodFxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKVxuICAgICAgICAgICAgLnBhcmVudCgpLmNzcygnbWluLWhlaWdodCcsICdhdXRvJyk7XG5cbiAgICAgICAgcGFnZXIuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgPSAxO1xuICAgIH0sXG5cbiAgICBhcmVWYWxpZFBvc3NpYmxlQW5zd2Vyc0luRE9NOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIGFyZV9wb3NzaWJsZV9hbnN3ZXJzX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2VycyA9IHByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QgbGknKTtcblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRfaW5wdXQgPSAkKHBvc3NpYmxlX2Fuc3dlcikuZmluZCgnZGl2IGlucHV0Jyk7XG4gICAgICAgICAgICB2YXIgYW5zd2VyID0gY3VycmVudF9pbnB1dC52YWwoKTtcblxuICAgICAgICAgICAgLy8gLy9zdHJpcCBodG1sIHRhZ3MgKGFuZ2xlIGJyYWNrZXRzKVxuICAgICAgICAgICAgLy8gYW5zd2VyID0gYW5zd2VyLnJlcGxhY2UoL1s8Pl0vaWcsICcnKTtcblxuICAgICAgICAgICAgLy9zYW5pdGlzZSA8IGFuZCA+IHJlcGxhY2luZyBieSB1bmljb2RlXG4gICAgICAgICAgICBhbnN3ZXIgPSBhbnN3ZXIucmVwbGFjZUFsbCgnPicsICdcXHVmZTY1Jyk7XG4gICAgICAgICAgICBhbnN3ZXIgPSBhbnN3ZXIucmVwbGFjZUFsbCgnPCcsICdcXHVmZTY0Jyk7XG5cbiAgICAgICAgICAgIGlmIChhbnN3ZXIgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcnNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGFyZV9wb3NzaWJsZV9hbnN3ZXJzX3ZhbGlkO1xuICAgIH0sXG5cbiAgICByZWNhbGN1bGF0ZVBhZ2luYXRpb246IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIC8vZ2V0IGN1cnJlbnQgcGFnZSBhbmQgdG90YWwgb2YgcG9zc2liZSBhbnN3ZXJzXG4gICAgICAgIHZhciBwYWdlID0gZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZTtcbiAgICAgICAgdmFyIHRvdGFsID0gTWF0aC5jZWlsKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIC8gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKTtcblxuICAgICAgICB2YXIgcGFnZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXInKTtcblxuICAgICAgICBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fY3VycmVudCcpXG4gICAgICAgICAgICAuaHRtbChwYWdlKTtcbiAgICAgICAgcGFnZXIuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXJfX3RvdGFsJylcbiAgICAgICAgICAgIC5odG1sKHRvdGFsKTtcblxuICAgICAgICAvL2hpZGUgcGFnZXIgaWYgbm90IG5lZWRlZFxuICAgICAgICBpZiAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPD0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSB7XG4gICAgICAgICAgICBwYWdlci5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVjYWxjdWxhdGVQb3NzaWJsZUFuc3dlcnNET006IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdCA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuZmluZCgnbGknKTtcbiAgICAgICAgdmFyIGxvb2t1cF9pbmRleDtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcl90b19hcHBlbmQ7XG4gICAgICAgIHZhciBsaXN0X2l0ZW07XG4gICAgICAgIHZhciBwcmV2X3BhZ2U7XG4gICAgICAgIHZhciBjdXJyZW50X3BhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlO1xuXG4gICAgICAgIC8qYWRkIG9uZSBhbnN3ZXIgdG8gdGhlIGJvdHRvbSB0byBmaWxsIHRoZSBwYWdlIChpZiBhbnkpXG4gICAgICAgIGhlcmUgd2UgYXJlIGNoZWNraW5nIHRoZSBwb3NzaWJsZSBhbnN3ZXJzIGN1cnJlbnRseSBvbiB0aGUgZG9tXG4gICAgICAgIHRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgcmVtb3ZlIHRoZSAxMDB0aCBhbnN3ZXIgZnJvbSB0aGUgZG9tIGFuZCB3ZSBoYXZlIG1vcmUgYW5zd2Vyc1xuICAgICAgICB0byBzaG93XG4gICAgICAgICogKi9cbiAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID09PSAoY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlIC0gMSkpIHtcblxuICAgICAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID4gcG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcblxuICAgICAgICAgICAgICAgIC8vYXBwZW5kIGFuc3dlciB0byB0aGUgYm90dG9tIG9mIGN1cnJlbnQgcGFnZVxuICAgICAgICAgICAgICAgIGxpc3RfaXRlbSA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscy5wb3NzaWJsZV9hbnN3ZXJfbGlzdF9pdGVtO1xuICAgICAgICAgICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlcn19JywgcG9zc2libGVfYW5zd2VyX3RvX2FwcGVuZC5hbnN3ZXIpO1xuICAgICAgICAgICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlci1yZWZ9fScsIHBvc3NpYmxlX2Fuc3dlcl90b19hcHBlbmQuYW5zd2VyX3JlZik7XG5cbiAgICAgICAgICAgICAgICBsaXN0X2l0ZW0gPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbTtcbiAgICAgICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXJ9fScsIHBvc3NpYmxlX2Fuc3dlcl90b19hcHBlbmQuYW5zd2VyKTtcbiAgICAgICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBwb3NzaWJsZV9hbnN3ZXJfdG9fYXBwZW5kLmFuc3dlcl9yZWYpO1xuXG4gICAgICAgICAgICAgICAgLy9hcHBlbmQgdG8gZG9tXG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0LmFwcGVuZChsaXN0X2l0ZW0pO1xuXG4gICAgICAgICAgICAgICAgLy91cGRhdGUgcGFnaW5hdGlvblxuICAgICAgICAgICAgICAgIHNlbGYucmVjYWxjdWxhdGVQYWdpbmF0aW9uKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgIGlmIHRoZSBwb3NzaWJsZSBhbnN3ZXJzIGluIHRoZSBkb20gaXMgMCwgaXQgbWVhbnMgdGhlIHVzZXIgcmVtb3ZlZCBhbGwgdGhlIGFuc3dlcnNcbiAgICAgICAgZnJvbSB0aGUgZG9tLCB0aGVyZWZvcmUgd2UgaGF2ZSB0b1xuICAgICAgICAqICovXG4gICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMCkge1xuXG4gICAgICAgICAgICAvL2dvIHRvIHByZXZpb3VzIHBhZ2VcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UtLTtcbiAgICAgICAgICAgIHByZXZfcGFnZSA9IGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2U7XG4gICAgICAgICAgICBnZXRQb3NzaWJsZUFuc3dlclBhZ2UoaW5wdXQsIHByZXZfcGFnZSk7XG5cbiAgICAgICAgICAgIC8vdXBkYXRlIHBhZ2luYXRpb24gYnV0dG9uc1xuICAgICAgICAgICAgc2VsZi5yZWNhbGN1bGF0ZVBhZ2luYXRpb24oaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciwgUGFwYSovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGltcG9ydF9mb3JtX3ZhbGlkYXRpb24gPSByZXF1aXJlKCdoZWxwZXJzL2ltcG9ydC1mb3JtLXZhbGlkYXRpb24nKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG52YXIgY29uZmlybV9pbXBvcnRfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9jb25maXJtLWltcG9ydC1wb3NzaWJsZS1hbnN3ZXJzLWNhbGxiYWNrJyk7XG52YXIgZ2V0UG9zc2libGVBbnN3ZXJQYWdlID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9nZXRQb3NzaWJsZUFuc3dlcnNQYWdlJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xudmFyIGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldFBvc3NpYmxlQW5zd2Vyc0xpc3QnKTtcbnZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG5cbnZhciBwb3NzaWJsZV9hbnN3ZXJzID0ge1xuXG4gICAgYWRkUG9zc2libGVBbnN3ZXI6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciBhbnN3ZXJfcmVmO1xuICAgICAgICB2YXIgbGlzdF9pdGVtID0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLnBvc3NpYmxlX2Fuc3dlcl9saXN0X2l0ZW07XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnM7XG4gICAgICAgIHZhciBhcmVBbGxQT3NzaWJsZUFuc3dlcnNWYWxpZGluRG9tID0gdHJ1ZTtcblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QgPSBwcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcblxuICAgICAgICAvL1ZhbGlkYXRlIGFuc3dlcnMgY3VycmVudGx5IGluIGRvbVxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzID0gcG9zc2libGVfYW5zd2Vyc19saXN0LmZpbmQoJ2xpIGRpdiBpbnB1dCcpO1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQoJChwb3NzaWJsZV9hbnN3ZXIpLnZhbCgpKS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgIGFyZUFsbFBPc3NpYmxlQW5zd2Vyc1ZhbGlkaW5Eb20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vd2FybiB1c2VyIGlmIHRoZXJlIGlzIGFueSBlcnJvciB0byBmaXgsIGFuZCBleGl0XG4gICAgICAgIGlmICghYXJlQWxsUE9zc2libGVBbnN3ZXJzVmFsaWRpbkRvbSkge1xuICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUl9FTVBUWSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL3doZW4gdGhlcmUgaXMgbW9yZSB0aGFuIDEgcG9zc2libGUgYW5zd2VycywgZW5hYmxlIGFsbCByZW1vdmUgYnV0dG9uc1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuZmluZCgnbGkgZGl2IHNwYW4gYnV0dG9uJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG5cbiAgICAgICAgLy9wcmVwYXJlIGRvbSBmb3IgcG9zc2libGUgYW5zd2VyIGxpc3QgaXRlbVxuICAgICAgICAvL2dlbmVyYXRlIHVuaXFpZCBoZXJlIGFuZCBhcHBlbmQgaXQgdG8gdGhlIGRvbSB0byBiZSB1c2VkIGxhdGVyXG4gICAgICAgIGFuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuXG4gICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlcn19JywgY29uc3RzLlBPU1NJQklMRV9BTlNXRVJfUExBQ0VIT0xERVIpO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBhbnN3ZXJfcmVmKTtcblxuICAgICAgICAvL2xvYWQgaHRtbCBzbmlwcGV0IGJhc2VkIG9uIGlucHV0IHR5cGVcblxuICAgICAgICAvL2RvIHdlIGhhdmUgcGFnaW5hdGlvbj9cbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZSkge1xuXG4gICAgICAgICAgICAvL29rLCBzbyBnbyB0byBsYXN0IHBvc3NpYmxlIGFuc3dlcnMgcGFnZVxuICAgICAgICAgICAgLy90b2RvIGNoZWNrIHVzZXIgaXMgbm90IHRoZXJlIGFscmVhZHlcbiAgICAgICAgICAgIHZhciBsYXN0X3BhZ2UgPSBNYXRoLmNlaWwoKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoICsgMSkgLyAoY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSk7XG5cbiAgICAgICAgICAgIC8vc2F2ZSBhbnN3ZXJzIGN1cnJlbnRseSBpbiB0aGUgZG9tXG4gICAgICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG5cbiAgICAgICAgICAgIC8vdXBkYXRlIGdsb2JhbCBmbGFnIHRvIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA9IGxhc3RfcGFnZTtcbiAgICAgICAgICAgIGdldFBvc3NpYmxlQW5zd2VyUGFnZShpbnB1dCwgbGFzdF9wYWdlKTtcblxuICAgICAgICAgICAgLy9HZXQgdXBkYXRlZCBsaXN0XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzID0gcHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCBsaScpO1xuXG4gICAgICAgICAgICAvL0FwcGVuZCBhbnN3ZXIgdG8gY3VycmVudCBsaXN0IGlmIHRoZXJlIGlzIGFueSByb29tLFxuICAgICAgICAgICAgLy9vdGhlcndpc2UgY3JlYXRlIG5ldyBwYWdlXG4gICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiAoY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlIC0gMSkpIHtcbiAgICAgICAgICAgICAgICAvL2dvIHRvIGEgYnJhbmQgbmV3IHBhZ2VcbiAgICAgICAgICAgICAgICBnZXRQb3NzaWJsZUFuc3dlclBhZ2UoaW5wdXQsIChsYXN0X3BhZ2UgKyAxKSk7XG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2VycyA9IHByb3BlcnRpZXNfcGFuZWxcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0IGxpICcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuYXBwZW5kKGxpc3RfaXRlbSkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgICAgIC8vc2F2ZSB0aGUgbmV3IGFuc3dlciAoYm90aCBkb20gYW5kIGlucHV0IG9iamVjdClcbiAgICAgICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgYW5zd2VyOiBjb25zdHMuUE9TU0lCSUxFX0FOU1dFUl9QTEFDRUhPTERFUixcbiAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiBhbnN3ZXJfcmVmXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcblxuICAgICAgICAgICAgLy9zaG93IHBhZ2VyXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLmluaXQoaW5wdXQpO1xuXG4gICAgICAgICAgICAvL3VwZGF0ZSBwYWdpbmF0aW9uXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnJlY2FsY3VsYXRlUGFnaW5hdGlvbihpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuYXBwZW5kKGxpc3RfaXRlbSkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIG1heCBudW1iZXIgb2YgYWxsb3dlZCBwb3NzaWJsZSBhbnN3ZXJzIHJlYWNoZWQsIGRpc2FibGUgXCJBZGQgYW5zd2VyXCIgYnV0dG9uXG4gICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFOlxuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG4gICAgICAgICAgICAgICAgLy91cCB0byAxMDAwXG4gICAgICAgICAgICAgICAgaWZcbiAgICAgICAgICAgICAgICAgICAgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXhfc2VhcmNoKSB7XG4gICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlQWRkQW5zd2VyQnRuKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkNIRUNLQk9YX1RZUEU6XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5SQURJT19UWVBFOlxuICAgICAgICAgICAgY2FzZSBjb25zdHMuRFJPUERPV05fVFlQRTpcbiAgICAgICAgICAgICAgICAvL3VwIHRvIDMwMFxuXG4gICAgICAgICAgICAgICAgaWZcbiAgICAgICAgICAgICAgICAgICAgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVBZGRBbnN3ZXJCdG4odHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIC8vZG8gbm90aGluZ1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZVBvc3NpYmxlQW5zd2VyOiBmdW5jdGlvbiAodGhlX2lucHV0LCB0aGVfYW5zd2VyX2luZGV4X2RvbSkge1xuXG4gICAgICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICAgICAgdmFyIGFuc3dlcl9pbmRleF9kb20gPSB0aGVfYW5zd2VyX2luZGV4X2RvbTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdDtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnM7XG4gICAgICAgIHZhciBjdXJyZW50X3BhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlO1xuXG4gICAgICAgIGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QgPSBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0Jyk7XG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMgPSBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuZmluZCgnbGknKTtcblxuICAgICAgICAvKiBjaGVjayBpZiB0aGUgcG9zc2libGUgYW5zd2VyIGhhcyBnb3QgYSBqdW1wIGF0dGFjaGVkXG4gICAgICAgICBpZiBzbywgdGhlIGp1bXAgd2lsbCBiZSBkcm9wcGVkIHNvIGFzayB0aGUgdXNlciB0byBjb25maXJtIGFjdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgLy90b2RvIGNoZWNrIGlmIHRoZSBqdW1wIGlzIGp1c3QgZHJvcHBlZFxuXG4gICAgICAgIC8vZG8gbm90IGRvIGFueXRoaW5nIGlmIHRoZXJlIGlzIG9ubHkgMSBwb3NzaWJsZSBhbnN3ZXJcbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmICdwb3NzaWJsZV9hbnN3ZXJzJyBsZW5ndGggaXMgMiwgYWZ0ZXIgcmVtb3ZpbmcgdGhlIGVsZW1lbnQgZGlzYWJsZSB0aGUgb25lIGxlZnQsIHNvIHdlIGhhdmUgYXQgbGVhc3QgMSBwb3NzaWJsZSBhbnN3ZXJcbiAgICAgICAgcG9zc2libGVfYW5zd2Vycy5lcShhbnN3ZXJfaW5kZXhfZG9tKS5mYWRlT3V0KDIwMCwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAvL2dldCBwb3NzaWJsZSBhbnN3ZXIgaW5kZXggb2Zmc2V0IGJhc2VkIG9uIHdoYXQgcGFnZSB3ZSBhcmUgc2hvd2luZyBpbiB0aGUgRE9NXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gKGN1cnJlbnRfcGFnZSAtIDEpICogY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlO1xuXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIGRvbVxuICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy9yZW1vdmUgYW5zd2VyIGZyb20gcHJvamVjdCBkZWZpbml0aW9uXG4gICAgICAgICAgICBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLnNwbGljZShvZmZzZXQgKyBhbnN3ZXJfaW5kZXhfZG9tLCAxKTtcblxuICAgICAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0LmZpbmQoJ2xpIGRpdiBzcGFuIGJ1dHRvbicpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgbWF4IG51bWJlciBvZiBhbGxvd2VkIHBvc3NpYmxlIGFuc3dlcnMgcmVhY2hlZCwgZGlzYWJsZSBcIkFkZCBhbnN3ZXJcIiBidXR0b25cbiAgICAgICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRTpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRTpcbiAgICAgICAgICAgICAgICAgICAgLy91cCB0byAxMDAwXG4gICAgICAgICAgICAgICAgICAgIGlmXG4gICAgICAgICAgICAgICAgICAgICAgICAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPCBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4X3NlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVBZGRBbnN3ZXJCdG4oZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHBvc3NpYmxlIGFuc3dlcnMgaW4gZG9tICh3aGVuIG5lZWRlZClcbiAgICAgICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci5yZWNhbGN1bGF0ZVBvc3NpYmxlQW5zd2Vyc0RPTShpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkNIRUNLQk9YX1RZUEU6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuUkFESU9fVFlQRTpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5EUk9QRE9XTl9UWVBFOlxuICAgICAgICAgICAgICAgICAgICAvL3VwIHRvIDMwMFxuICAgICAgICAgICAgICAgICAgICBpZlxuICAgICAgICAgICAgICAgICAgICAgICAgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIDwgY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVBZGRBbnN3ZXJCdG4oZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHBvc3NpYmxlIGFuc3dlcnMgaW4gZG9tICh3aGVuIG5lZWRlZClcbiAgICAgICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci5yZWNhbGN1bGF0ZVBvc3NpYmxlQW5zd2Vyc0RPTShpbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW5wdXQudXBkYXRlUG9zc2libGVJbml0aWFsQW5zd2VycygpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIC8vZG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3RvZG8gY2hlY2sgd2hhdCB0aGlzIGRvZXMgaGVyZSwgd2hlbiByZW1vdmluZyBhbiBhbnN3ZXI/XG4gICAgICAgICAgICAvLyBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG5cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHVwZGF0ZUp1bXBQb3NzaWJsZUFuc3dlcnM6IGZ1bmN0aW9uICh0aGVfaW5wdXQsIHRoZV9qdW1wX3BhbmVsKSB7XG5cbiAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgICAgICB2YXIganVtcF9wYW5lbCA9IHRoZV9qdW1wX3BhbmVsO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIGlMZW5ndGggPSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aDtcblxuICAgICAgICAvL2ZpbmQgYW5zd2VyIDxzZWxlY3Q+KHMpXG4gICAgICAgIHZhciBzZWxlY3RzX3RvX3RhcmdldCA9IGp1bXBfcGFuZWxcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xpc3QgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19saXN0LWl0ZW0gLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19sb2dpYy0tYW5zd2VyIHNlbGVjdCcpO1xuXG4gICAgICAgIHNlbGVjdHNfdG9fdGFyZ2V0LmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG5cbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkX29wdGlvbiA9IHRhcmdldC5maW5kKCdvcHRpb246c2VsZWN0ZWQnKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50X3NlbGVjdGVkX2Fuc3dlcl9pZCA9IHdpbmRvdy5wYXJzZUludChzZWxlY3RlZF9vcHRpb24udmFsKCksIDEwKTtcblxuICAgICAgICAgICAgLy9nZXQgdGhlIHVwZGF0ZWQgYW5zd2VyIHRleHQgZnJvbSBcInBvc3NpYmxlIGFuc3dlcnNcIlxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3NlbGVjdGVkX2Fuc3dlcl9pZCA9PT0gaW5wdXQucG9zc2libGVfYW5zd2Vyc1tpXS5hbnN3ZXJfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfb3B0aW9uLnRleHQoY3VycmVudF9zZWxlY3RlZF9hbnN3ZXJfaWQgKyAnIC0gJyArIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnNbaV0uYW5zd2VyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCQodGhpcykuYXR0cignaWQnKSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkKHRoaXMpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vZ2V0IHNlbGVjdGVkIHBvc3NpYmxlIGFuc3dlciBhbmQgc2F2ZSBpdCBpbiB0aGUgaW5wdXQgb2JqZWN0IGFzIHRoZSBkZWZhdWx0IGFuc3dlclxuICAgIHVwZGF0ZVBvc3NpYmxlSW5pdGlhbEFuc3dlcnM6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcbiAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgICAgICB2YXIgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciBzZWxlY3RlZF9hbnN3ZXI7XG5cbiAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgICAgICAuZG9tXG4gICAgICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgICAgIHBvc3NpYmxlX2luaXRpYWxfYW5zd2Vyc19saXN0ID0gaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYucGFuZWwtYm9keSBkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBzZWxlY3QnKTtcblxuICAgICAgICBzZWxlY3RlZF9hbnN3ZXIgPSBwb3NzaWJsZV9pbml0aWFsX2Fuc3dlcnNfbGlzdC5maW5kKCdvcHRpb246c2VsZWN0ZWQnKTtcblxuICAgICAgICBpbnB1dC5kZWZhdWx0ID0gc2VsZWN0ZWRfYW5zd2VyLnZhbCgpO1xuXG4gICAgfSxcblxuICAgIGxpc3RQb3NzaWJsZUluaXRpYWxBbnN3ZXJzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG5cbiAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2VycztcbiAgICAgICAgdmFyIHBvc3NpYmxlX2luaXRpYWxfYW5zd2Vyc19saXN0O1xuICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgIHZhciBhbnN3ZXJfcmVmO1xuICAgICAgICB2YXIgc2VsZWN0ZWQgPSAnJztcblxuICAgICAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMgPSBpbnB1dC5kb21cbiAgICAgICAgICAgIC5wcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgLnBhbmVsLWJvZHkgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCBsaScpO1xuXG5cbiAgICAgICAgY29uc29sZS5sb2cocG9zc2libGVfYW5zd2Vycyk7XG5cblxuICAgICAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgICAgIC5kb21cbiAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QgPSBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGRpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IHNlbGVjdCcpO1xuXG4gICAgICAgIC8vZW1wdHkgbGlzdCBhbmQgcmUtYXBwZW5kIGl0ZW1zIHRvZG8gbWF5YmUgdG9vIGV4cGVuc2l2ZSwgZmluZCBhIGJldHRlciB3YXlcbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QuZW1wdHkoKTtcblxuICAgICAgICAvL2FwcGVuZCAnbm9uZScgc2VsZWN0aW9uLCB1c2luZyBpbmRleCAwIGFzIG5vdGhpbmcgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiXCI+Tm9uZTwvb3B0aW9uPicpO1xuXG4gICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMuZm9yRWFjaChmdW5jdGlvbiAocG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgICAgIHZhciBhbnN3ZXJfcmVmID0gcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWY7XG4gICAgICAgICAgICB2YXIgYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlclxuXG4gICAgICAgICAgICAvL3ByZSBzZWxlY3QgcHJldmlvdXNseSBzYXZlZCBvcHRpb25cbiAgICAgICAgICAgIHNlbGVjdGVkID0gKGFuc3dlcl9yZWYgPT09IGlucHV0LmRlZmF1bHQpID8gJ3NlbGVjdGVkJyA6ICcnO1xuXG4gICAgICAgICAgICBwb3NzaWJsZV9pbml0aWFsX2Fuc3dlcnNfbGlzdC5hcHBlbmQoJzxvcHRpb24gdmFsdWU9XCInICsgYW5zd2VyX3JlZiArICdcIiAnICsgc2VsZWN0ZWQgKyAnID4nICsgYW5zd2VyICsgJzwvb3B0aW9uPicpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgZXhwb3J0UG9zc2libGVBbnN3ZXJzQ1NWOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIGlucHV0O1xuICAgICAgICB2YXIgYW5zd2VycyA9IFtdO1xuICAgICAgICB2YXIgZmlsZW5hbWU7XG5cbiAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRBY3RpdmVJbnB1dCgpO1xuXG4gICAgICAgIC8vYWJvcnQgaWYgbm8gcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICBpZiAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYWJvcnQgaWYgcG9zc2libGUgYW5zd2VycyBhcmUgaW52YWxpZFxuICAgICAgICBpZiAoIWltcG9ydF9mb3JtX3ZhbGlkYXRpb24uYXJlUG9zc2libGVBbnN3ZXJzVmFsaWQoaW5wdXQucG9zc2libGVfYW5zd2VycywgaW5wdXQudHlwZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZmlsZW5hbWUgZ2V0cyB2ZXJ5IGxvbmcgaWYgd2UgdXNlIHRoZSBpbnB1dCByZWYuLi5zbyB3ZSBkbyBub3RcbiAgICAgICAgZmlsZW5hbWUgPSBpbnB1dC5xdWVzdGlvbi50cnVuYygyMCkgKyAnX19wb3NzaWJsZV9hbnN3ZXJzLmNzdic7XG5cbiAgICAgICAgJChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG4gICAgICAgICAgICBhbnN3ZXJzW2luZGV4XSA9IFtwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3BlY2lmeWluZyBmaWVsZHMgYW5kIGRhdGEgZXhwbGljaXRseVxuICAgICAgICB2YXIgY3N2ID0gUGFwYS51bnBhcnNlKHtcbiAgICAgICAgICAgIGZpZWxkczogW2lucHV0LnF1ZXN0aW9uXSxcbiAgICAgICAgICAgIGRhdGE6IGFuc3dlcnNcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgcXVvdGVzOiBmYWxzZSxcbiAgICAgICAgICAgIHF1b3RlQ2hhcjogJycsXG4gICAgICAgICAgICBkZWxpbWl0ZXI6ICcsJyxcbiAgICAgICAgICAgIGhlYWRlcjogdHJ1ZSxcbiAgICAgICAgICAgIG5ld2xpbmU6ICdcXHJcXG4nXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkYXRhOiBjc3YsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmlsZW5hbWVcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgaW1wb3J0Q1NWRmlsZTogZnVuY3Rpb24gKGZpbGVzKSB7XG5cbiAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1swXTtcbiAgICAgICAgdmFyIGZpbGVfcGFydHM7XG4gICAgICAgIHZhciBmaWxlX2V4dDtcbiAgICAgICAgdmFyIGdldFBvc3NpYmxlQW5zd2Vyc0hUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldFBvc3NpYmxlQW5zd2Vyc0hUTUwnKTtcblxuICAgICAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVJbigwKTtcblxuICAgICAgICBmb3JtYnVpbGRlci5pc09wZW5pbmdGaWxlQnJvd3NlciA9IGZhbHNlO1xuXG4gICAgICAgIC8vaWYgdGhlIHVzZXIgY2FuY2VscyB0aGUgYWN0aW9uXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5DU1ZfRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZpbGVfcGFydHMgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcbiAgICAgICAgZmlsZV9leHQgPSBmaWxlX3BhcnRzW2ZpbGVfcGFydHMubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgLy9pdCBtdXN0IGJlIGNzdlxuICAgICAgICBpZiAoZmlsZV9leHQgIT09IGNvbnN0cy5DU1ZfRklMRV9FWFRFTlNJT04pIHtcbiAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuQ1NWX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy9maWxlIGlzIHZhbGlkLCBsZXQncyBwYXJzZSBpdFxuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICB2YXIganNvbiA9IFBhcGEucGFyc2UoY29udGVudCwgeyBoZWFkZXI6IHRydWUsIGRlbGltaXRlcjogJywnIH0pO1xuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBqc29uLm1ldGEuZmllbGRzO1xuICAgICAgICAgICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTsvL2l0IGlzIGhlcmUgb3RoZXJ3aXNlIGl0IGJyZWFrcyB3aGVuIGNvbXBpbGluZy4uLmdvIGZpZ3VyZT8/XG4gICAgICAgICAgICB2YXIgbW9kYWwgPSAkKCcjY3N2LWltcG9ydC1wb3NzaWJsZV9hbnN3ZXJzJyk7XG5cbiAgICAgICAgICAgIGlmIChqc29uLmRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy9lbXB0eSBjc3YgZmlsZSwgc2hvdyBlcnJvclxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuQ1NWX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3RvZG8gc2hvdyBtb2RhbCBhc2tpbmcgd2hpY2ggY29sdW1zIGFuZCB3aGV0aGVyIHRvIHJlcGxhY2Ugb3Igbm90IHRoZSBleGlzdGluZyBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICBtb2RhbC5tb2RhbCgpO1xuXG4gICAgICAgICAgICBtb2RhbC5vZmYoKS5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uX3BpY2tlciA9ICQoJyNjc3YtaW1wb3J0LXBvc3NpYmxlX2Fuc3dlcnMnKS5maW5kKCcucG9zc2libGUtYW5zd2Vycy1jb2x1bW4tcGlja2VyJyk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbl9pdGVtcyA9ICcnO1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZEhlYWRlckluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zO1xuICAgICAgICAgICAgICAgIHZhciB1c2VyV2FudHN0b1JlcGxhY2VBbnN3ZXJzO1xuICAgICAgICAgICAgICAgIHZhciBkb2VzRmlyc3RSb3dDb250YWluc0hlYWRlcnM7XG4gICAgICAgICAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbWF4ID0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heDtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSB1dGlscy5nZXRBY3RpdmVJbnB1dCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfbWF4ID0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heF9zZWFyY2g7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZXNldCBjb2x1bW4gcGlja2VyXG4gICAgICAgICAgICAgICAgY29sdW1uX3BpY2tlci5maW5kKCcuYnRuJykuaHRtbCgnUGljayBjb2x1bW4nICsgJyA8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPicpO1xuICAgICAgICAgICAgICAgIGNvbHVtbl9waWNrZXIuZmluZCgnLmJ0bicpLnZhbCgnJyk7XG5cbiAgICAgICAgICAgICAgICAvL3Jlc2V0IG90aGVyIGNvbnRyb2xzXG4gICAgICAgICAgICAgICAgbW9kYWwuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnNfX2ZpcnN0LXJvdy1oZWFkZXJzIGlucHV0JykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgbW9kYWwuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnNfX2FwcGVuZC1vci1yZXBsYWNlIGlucHV0I3JlcGxhY2UnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGUgaW1wb3J0IGJ1dHRvblxuICAgICAgICAgICAgICAgIG1vZGFsLmZpbmQoJy5wb3NzaWJsZV9hbnN3ZXJzLXBlcmZvcm0taW1wb3J0JykuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAgICAgICAgIC8vc2hvdyBsaXN0IG9mIGhlYWRlcnMgc28gdGhlIHVzZXIgY2FuIHNlbGVjdCB3aGljaCBjb2x1bW4gdG8gdXNlXG4gICAgICAgICAgICAgICAgLy9nZW5lcmF0ZSBsaXN0IGl0ZW1zXG4gICAgICAgICAgICAgICAgJChoZWFkZXJzKS5lYWNoKGZ1bmN0aW9uIChoZWFkZXJJbmRleCwgaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbl9pdGVtcyArPSAnPGxpPic7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbl9pdGVtcyArPSAnPGEgaHJlZj1cIiNcIj4nICsgaGVhZGVyLnRydW5jKDI1KSArICc8L2E+JztcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uX2l0ZW1zICs9ICc8L2xpPic7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2FwcGVuZCBpdGVtc1xuICAgICAgICAgICAgICAgIGNvbHVtbl9waWNrZXIuZmluZCgnLmRyb3Bkb3duLW1lbnUnKS5lbXB0eSgpLmFwcGVuZChjb2x1bW5faXRlbXMpO1xuXG4gICAgICAgICAgICAgICAgLy9zaG93IHNlbGVjdGVkIGNvbHVuIGluIGRyb3Bkb3duIHBpY2tlclxuICAgICAgICAgICAgICAgIGNvbHVtbl9waWNrZXIuZmluZCgnLmRyb3Bkb3duLW1lbnUgbGknKS5vZmYoKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50cygnLnBvc3NpYmxlLWFuc3dlcnMtY29sdW1uLXBpY2tlcicpLmZpbmQoJy5idG4nKS5odG1sKCQodGhpcykudGV4dCgpICsgJyA8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPicpO1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5wb3NzaWJsZS1hbnN3ZXJzLWNvbHVtbi1waWNrZXInKS5maW5kKCcuYnRuJykudmFsKCQodGhpcykuZGF0YSgndmFsdWUnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRIZWFkZXJJbmRleCA9ICQodGhpcykuaW5kZXgoKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2VuYWJsZSBpbXBvcnQgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLmZpbmQoJy5wb3NzaWJsZV9hbnN3ZXJzLXBlcmZvcm0taW1wb3J0JykuYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICQoJy5wb3NzaWJsZV9hbnN3ZXJzLXBlcmZvcm0taW1wb3J0Jykub2ZmKCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2hvdyBvdmVybGF5IGFuZCBjdXJzb3JcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKDApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IHBhcmFtZXRlcnMgZnJvbSBtb2RhbFxuICAgICAgICAgICAgICAgICAgICB1c2VyV2FudHN0b1JlcGxhY2VBbnN3ZXJzID0gbW9kYWwuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnNfX2FwcGVuZC1vci1yZXBsYWNlJykuZmluZCgnI3JlcGxhY2UnKS5pcygnOmNoZWNrZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgZG9lc0ZpcnN0Um93Q29udGFpbnNIZWFkZXJzID0gbW9kYWwuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnNfX2ZpcnN0LXJvdy1oZWFkZXJzJykuZmluZCgnLmNoZWNrYm94IGlucHV0JykuaXMoJzpjaGVja2VkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hZGQgY2FsbGJhY2sgdG8gaGFuZGxlIHRoZSBpbXBvcnRcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcldhbnRzdG9SZXBsYWNlQW5zd2VyczogdXNlcldhbnRzdG9SZXBsYWNlQW5zd2VycyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvZXNGaXJzdFJvd0NvbnRhaW5zSGVhZGVyczogZG9lc0ZpcnN0Um93Q29udGFpbnNIZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGlucHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0ZWRKc29uOiBqc29uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRIZWFkZXJJbmRleDogc2VsZWN0ZWRIZWFkZXJJbmRleFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maXJtX2ltcG9ydF9jYWxsYmFjayhwYXJhbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm1vZGFsKCdoaWRlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbWF4IG51bWJlciBvZiBhbGxvd2VkIHBvc3NpYmxlIGFuc3dlcnMgcmVhY2hlZCwgZGlzYWJsZSBcIkFkZCBhbnN3ZXJcIiBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9nZ2xlQWRkQW5zd2VyQnRuKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IHBvc3NpYmxlX2Fuc3dlcnNfbWF4KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZWNhbGN1bGF0ZSBwYWdpbmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnJlY2FsY3VsYXRlUGFnaW5hdGlvbihpbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gaWYgYWxsIGlucHV0cyBhcmUgdmFsaWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmFyZUFsbElucHV0c1ZhbGlkKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIChpZiBkaXNhYmxlZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc2hvdyB0b2FzdCBjb25maXJtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Quc2hvd1N1Y2Nlc3MobWVzc2FnZXMuc3VjY2Vzcy5QT1NTSUJMRV9BTlNXRVJTX0lNUE9SVEVEKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcHVzaCBzdGF0ZSB0byBlbmFibGUgdW5kb2luZyB0aGUgYWN0aW9uICh0eXBpbmcpIHBhc3NpbmcgXCJ0cnVlXCIgc28gaXQgZ2V0cyBhIGJpdCBvZiB0aHJvdHRsaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NVUEVSX1NMT1cpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc2hvdyBlcnJvci93YXJuaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUlNfSU5WQUxJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NVUEVSX1NMT1cpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy9hZGQgZXZlbnRzIHRvIGhpZGUgdGhlIG1vZGFsIG1hbnVhbGx5ICh3YXMgbnQgd29ya2luZywgZ28gZmlndXJlKVxuICAgICAgICAgICAgbW9kYWwuZmluZCgnYnV0dG9uW2RhdGEtZGlzbWlzcz1cIm1vZGFsXCJdJykub25lKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtb2RhbC5tb2RhbCgnaGlkZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7XG4gICAgfSxcblxuICAgIG9yZGVyUG9zc2libGVBbnN3ZXJzOiBmdW5jdGlvbiAob3JkZXJfdHlwZSkge1xuICAgICAgICAvL2dldCBjdXJyZW50IGlucHV0IG9iamVjdFxuICAgICAgICB2YXIgaW5wdXQgPSB1dGlscy5nZXRBY3RpdmVJbnB1dCgpO1xuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2VycyA9IGlucHV0LnBvc3NpYmxlX2Fuc3dlcnM7XG5cbiAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA9IDE7XG4gICAgICAgIC8vc2hvdyBvdmVybGF5IGFuZCBjdXJzb3JcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKDApO1xuXG4gICAgICAgIHN3aXRjaCAob3JkZXJfdHlwZSkge1xuICAgICAgICAgICAgLy9vcmRlciBBIC0gWiBmb3IgVVRGLTggbGFuZ3VhZ2VzXG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QT1NTSUJMRV9BTlNXRVJTX09SREVSLkFaOlxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMgPSBwb3NzaWJsZV9hbnN3ZXJzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuYW5zd2VyLmxvY2FsZUNvbXBhcmUoYi5hbnN3ZXIsIHVuZGVmaW5lZCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlUHVuY3R1YXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1lcmljOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLy9vcmRlciBaIC0gQSBmb3IgVVRGLTggbGFuZ3VhZ2VzXG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QT1NTSUJMRV9BTlNXRVJTX09SREVSLlpBOlxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMgPSBwb3NzaWJsZV9hbnN3ZXJzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIuYW5zd2VyLmxvY2FsZUNvbXBhcmUoYS5hbnN3ZXIsIHVuZGVmaW5lZCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlUHVuY3R1YXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1lcmljOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUE9TU0lCTEVfQU5TV0VSU19PUkRFUi5TSFVGRkxFOlxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMgPSB1dGlscy5zaHVmZmxlQXJyYXkocG9zc2libGVfYW5zd2Vycyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgb3JkZXJlZF9saXN0X2h0bWwgPSBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0KHBvc3NpYmxlX2Fuc3dlcnMpO1xuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2Vyc19saXN0O1xuICAgICAgICB2YXIgcHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG5cbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0ID0gcHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0Jyk7XG5cbiAgICAgICAgLy9yZW1vdmUgY3VycmVudCBhbnN3ZXJzIGZyb20gZG9tIGFuZCBhcHBlbmQgb3JkZXJlZCBvbmVzXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdFxuICAgICAgICAgICAgLmVtcHR5KClcbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC5hcHBlbmQob3JkZXJlZF9saXN0X2h0bWwpXG4gICAgICAgICAgICAuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9yZWNhbGN1bGF0ZSBwYWdpbmF0aW9uXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIucmVjYWxjdWxhdGVQYWdpbmF0aW9uKGlucHV0KTtcblxuICAgICAgICAvL3B1c2ggc3RhdGUgdG8gZW5hYmxlIHVuZG9pbmcgdGhlIGFjdGlvbiAodHlwaW5nKSBwYXNzaW5nIFwidHJ1ZVwiIHNvIGl0IGdldHMgYSBiaXQgb2YgdGhyb3R0bGluZ1xuICAgICAgICB1bmRvLnB1c2hTdGF0ZShmYWxzZSk7XG5cbiAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBhcyB1c2VyIG1hZGUgYSBjaGFuZ2VcbiAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5zYXZlX3Byb2plY3RfYnRuLm9mZigpLm9uKCdjbGljaycsIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayk7XG5cbiAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NVUEVSX1NMT1cpO1xuXG4gICAgfSxcblxuICAgIGRlbGV0ZUFsbEFuc3dlcnM6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgaW5wdXQ7XG4gICAgICAgIHZhciBhbnN3ZXJfcmVmID0gdXRpbHMuZ2VuZXJhdGVVbmlxSUQoKTtcbiAgICAgICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTsvL2l0IGlzIGhlcmUgb3RoZXJ3aXNlIGl0IGJyZWFrcyB3aGVuIGNvbXBpbGluZy4uLmdvIGZpZ3VyZT8/XG5cbiAgICAgICAgLy9zaG93IG92ZXJsYXkgYW5kIGN1cnNvclxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlSW4oMCk7XG5cbiAgICAgICAgLy9nZXQgY3VycmVudCBpbnB1dCBvYmplY3RcbiAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRBY3RpdmVJbnB1dCgpO1xuXG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciBsaXN0X2l0ZW0gPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbTtcbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdCA9IHByb3BlcnRpZXNfcGFuZWxcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCcpO1xuXG4gICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlcn19JywgY29uc3RzLlBPU1NJQklMRV9BTlNXRVJfUExBQ0VIT0xERVIpO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBhbnN3ZXJfcmVmKTtcbiAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsIGNvbnN0cy5ESVNBQkxFRF9TVEFURSk7XG5cblxuICAgICAgICAvL2xvYWQgaHRtbCBzbmlwcGV0IGJhc2VkIG9uIGlucHV0IHR5cGVcbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0LmVtcHR5KCkuaGlkZSgpLmFwcGVuZChsaXN0X2l0ZW0pLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgIC8vcmVzZXQgYXJyYXkgb2YgcG9zc2libGUgYW5zd2VycyB0byAxIHNpbmdsZSBkZWZhdWx0IGVsZW1lbnRcbiAgICAgICAgaW5wdXQucG9zc2libGVfYW5zd2VycyA9IFt7XG4gICAgICAgICAgICBhbnN3ZXJfcmVmOiB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpLFxuICAgICAgICAgICAgYW5zd2VyOiBjb25zdHMuUE9TU0lCSUxFX0FOU1dFUl9QTEFDRUhPTERFUlxuICAgICAgICB9XTtcblxuICAgICAgICAvL3B1c2ggc3RhdGUgdG8gZW5hYmxlIHVuZG9pbmcgdGhlIGFjdGlvbiAodHlwaW5nKSBwYXNzaW5nIFwidHJ1ZVwiIHNvIGl0IGdldHMgYSBiaXQgb2YgdGhyb3R0bGluZ1xuICAgICAgICB1bmRvLnB1c2hTdGF0ZShmYWxzZSk7XG5cbiAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiAoaWYgZGlzYWJsZWQpXG4gICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgICAgIC8vZW5hYmxlIGFkZCBhbnN3ZXIgYnV0dG9uXG4gICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlQWRkQW5zd2VyQnRuKGZhbHNlKTtcblxuICAgICAgICAvL3Jlc2V0IHBhZ2luYXRpb25cbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci50ZWFyRG93bihpbnB1dCk7XG5cbiAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NVUEVSX1NMT1cpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcG9zc2libGVfYW5zd2VycztcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBzYXZlQWxsSW5wdXRQcm9wZXJ0aWVzID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlQWxsSW5wdXRQcm9wZXJ0aWVzJyk7XG52YXIgc2F2ZVByb3BlcnRpZXMgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVQcm9wZXJ0aWVzJyk7XG52YXIgc2F2ZVBvc3NpYmxlQW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZS9tb2R1bGUuc2F2ZVBvc3NpYmxlQW5zd2VycycpO1xudmFyIHNhdmVBZHZhbmNlZFByb3BlcnRpZXMgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVBZHZhbmNlZFByb3BlcnRpZXMnKTtcbnZhciBzYXZlSnVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVKdW1wcycpO1xudmFyIHNhdmVVbmlxdWVuZXNzID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlVW5pcXVlbmVzcycpO1xudmFyIGRvQ2xlYW5pbmdCZWZvcmVTYXZpbmcgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUvbW9kdWxlLmRvQ2xlYW5pbmdCZWZvcmVTYXZpbmcnKTtcblxudmFyIHNhdmUgPSB7XG5cbiAgICBzYXZlVW5pcXVlbmVzczogZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuICAgICAgICByZXR1cm4gc2F2ZVVuaXF1ZW5lc3ModGhlX2lucHV0KTtcbiAgICB9LFxuICAgIHNhdmVBbGxJbnB1dFByb3BlcnRpZXM6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHNhdmVBbGxJbnB1dFByb3BlcnRpZXModGhlX2lucHV0KTtcbiAgICB9LFxuICAgIHNhdmVQcm9wZXJ0aWVzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG4gICAgICAgIHJldHVybiBzYXZlUHJvcGVydGllcyh0aGVfaW5wdXQpO1xuICAgIH0sXG4gICAgc2F2ZVBvc3NpYmxlQW5zd2VyczogZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuICAgICAgICByZXR1cm4gc2F2ZVBvc3NpYmxlQW5zd2Vycyh0aGVfaW5wdXQpO1xuICAgIH0sXG4gICAgc2F2ZUFkdmFuY2VkUHJvcGVydGllczogZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuICAgICAgICByZXR1cm4gc2F2ZUFkdmFuY2VkUHJvcGVydGllcyh0aGVfaW5wdXQpO1xuICAgIH0sXG4gICAgc2F2ZUp1bXBzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG4gICAgICAgIHJldHVybiBzYXZlSnVtcHModGhlX2lucHV0KTtcbiAgICB9LFxuICAgIGRvQ2xlYW5pbmdCZWZvcmVTYXZpbmc6IGZ1bmN0aW9uICh0aGVfZm9ybXMpIHtcbiAgICAgICAgcmV0dXJuIGRvQ2xlYW5pbmdCZWZvcmVTYXZpbmcodGhlX2Zvcm1zKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNhdmU7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cblxudmFyIGRvQ2xlYW5pbmdCZWZvcmVTYXZpbmcgPSBmdW5jdGlvbiAoZm9ybXMpIHtcblxuICAgIHZhciBpbnZhbGlkX2p1bXBzX3F1ZXN0aW9uID0gJyc7XG4gICAgdmFyIGFsbF9qdW1wc192YWxpZCA9IHRydWU7XG5cbiAgICAkKGZvcm1zKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZm9ybSkge1xuICAgICAgICAkKGZvcm0uaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbnB1dEluZGV4LCBpbnB1dCkge1xuXG4gICAgICAgICAgICAvL3JlbW92ZSBXb3JkIFVuaWNvZGUgY2hhcnMgZnJvbSBxdWVzdGlvbiAoaWYgYW55KVxuICAgICAgICAgICAgZm9ybS5pbnB1dHNbaW5wdXRJbmRleF0ucXVlc3Rpb24gPSB1dGlscy5yZXBsYWNlV29yZENoYXJzKGlucHV0LnF1ZXN0aW9uKTtcblxuICAgICAgICAgICAgLy9nZXQgdmFsaWQganVtcCBkZXN0aW5hdGlvbnNcbiAgICAgICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoaW5wdXRJbmRleCwgaW5wdXQsIGZvcm0uaW5wdXRzLCBmYWxzZSk7XG5cbiAgICAgICAgICAgIC8vZXh0cmEgdmFsaWRhdGlvbiBmb3IganVtcHMsIGNoZWNrIGlmIHRoZSBkZXN0aW5hdGlvbiBzdGlsbCBleGlzdHMgYW5kIGl0IGlzIHZhbGlkXG4gICAgICAgICAgICAkKGlucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChqdW1wSW5kZXgsIGp1bXApIHtcbiAgICAgICAgICAgICAgICAvL2RvZXMgdGhlIGp1bXAgXCJ0b1wiIHByb3BlcnR5IHJlZmVyZW5jZSBhIHZhbGlkIGRlc3RpbmF0aW9uIGlucHV0P1xuICAgICAgICAgICAgICAgIC8vLy90ZXN0OiBzY3JldyB1cCB0aGUganVtcC50b1xuICAgICAgICAgICAgICAgIC8vIGp1bXAudG8gPSAnc2ZkZ2cnO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1tqdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgICAgICAvL2ludmFsaWQgZGVzdGluYXRpb24gZm91bmRcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZF9qdW1wc19xdWVzdGlvbiA9IGlucHV0LnF1ZXN0aW9uO1xuICAgICAgICAgICAgICAgICAgICBhbGxfanVtcHNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbnkgbGVmdG92ZXIgZXh0cmEgcHJvcGVydHkgZnJvbSBqdW1wIChpZiBhbnkpXG4gICAgICAgICAgICAgICAgLy9oYWNrIHRvIGF2b2lkIGh1Z2UgcmVmYWN0b3JpbmcgYW5kIHRlc3RpbmcgOylcbiAgICAgICAgICAgICAgICBpbnB1dC5qdW1wc1tqdW1wSW5kZXhdID0ge1xuICAgICAgICAgICAgICAgICAgICB0bzoganVtcC50byxcbiAgICAgICAgICAgICAgICAgICAgd2hlbjoganVtcC53aGVuLFxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiBqdW1wLmFuc3dlcl9yZWZcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoaW5wdXQuYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hJbnB1dEluZGV4LCBicmFuY2hfaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgYnJhbmNoX2lucHV0LmRvbTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIFdvcmQgVW5pY29kZSBjaGFycyBmcm9tIHF1ZXN0aW9uIChpZiBhbnkpXG4gICAgICAgICAgICAgICAgaW5wdXQuYnJhbmNoW2JyYW5jaElucHV0SW5kZXhdLnF1ZXN0aW9uID0gdXRpbHMucmVwbGFjZVdvcmRDaGFycyhicmFuY2hfaW5wdXQucXVlc3Rpb24pO1xuXG4gICAgICAgICAgICAgICAgLy90b2RvIHZhbGlkYXRlIGJyYW5jaCBqdW1wc1xuICAgICAgICAgICAgICAgIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5cyhicmFuY2hJbnB1dEluZGV4LCBicmFuY2hfaW5wdXQsIGlucHV0LmJyYW5jaCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAvL2V4dHJhIHZhbGlkYXRpb24gZm9yIGp1bXBzLCBjaGVjayBpZiB0aGUgZGVzdGluYXRpb24gc3RpbGwgZXhpc3RzIGFuZCBpdCBpcyB2YWxpZFxuICAgICAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hKdW1wSW5kZXgsIGJyYW5jaEp1bXApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9kb2VzIHRoZSBqdW1wIFwidG9cIiBwcm9wZXJ0eSByZWZlcmVuY2UgYSB2YWxpZCBkZXN0aW5hdGlvbiBpbnB1dD9cbiAgICAgICAgICAgICAgICAgICAgLy8vL3Rlc3Q6IHNjcmV3IHVwIHRoZSBqdW1wLnRvXG4gICAgICAgICAgICAgICAgICAgIC8vIGJyYW5jaEp1bXAudG8gPSAnc2ZkZ2cnO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghanVtcF9kZXN0aW5hdGlvbnNbYnJhbmNoSnVtcC50b10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgaW52YWxpZF9qdW1wc19xdWVzdGlvbiA9ICcgKGJyYW5jaCkgJyArIGJyYW5jaF9pbnB1dC5xdWVzdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbF9qdW1wc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgYW55IGxlZnRvdmVyIGV4dHJhIHByb3BlcnR5IGZyb20ganVtcCAoaWYgYW55KVxuICAgICAgICAgICAgICAgICAgICAvL2hhY2sgdG8gYXZvaWQgaHVnZSByZWZhY3RvcmluZyBhbmQgdGVzdGluZyA7KVxuICAgICAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXQuanVtcHNbYnJhbmNoSnVtcEluZGV4XSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvOiBicmFuY2hKdW1wLnRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2hlbjogYnJhbmNoSnVtcC53aGVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5zd2VyX3JlZjogYnJhbmNoSnVtcC5hbnN3ZXJfcmVmXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9yZW1vdmUgV29yZCBVbmljb2RlIGNoYXJzIGZyb20gcXVlc3Rpb24gKGlmIGFueSlcbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0Lmdyb3VwW2luZGV4XS5xdWVzdGlvbiA9IHV0aWxzLnJlcGxhY2VXb3JkQ2hhcnMoZ3JvdXBfaW5wdXQucXVlc3Rpb24pO1xuXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBncm91cF9pbnB1dC5kb207XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBncm91cF9pbnB1dCkge1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgV29yZCBVbmljb2RlIGNoYXJzIGZyb20gcXVlc3Rpb24gKGlmIGFueSlcbiAgICAgICAgICAgICAgICBpbnB1dC5ncm91cFtpbmRleF0ucXVlc3Rpb24gPSB1dGlscy5yZXBsYWNlV29yZENoYXJzKGdyb3VwX2lucHV0LnF1ZXN0aW9uKTtcblxuICAgICAgICAgICAgICAgIGRlbGV0ZSBncm91cF9pbnB1dC5kb207XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcgZGVsZXRlIGlucHV0LmRvbTsgY2FsbGVkICoqKioqKionKTtcbiAgICAgICAgICAgIGRlbGV0ZSBpbnB1dC5kb207XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW52YWxpZF9qdW1wc19xdWVzdGlvbjogaW52YWxpZF9qdW1wc19xdWVzdGlvbixcbiAgICAgICAgYWxsX2p1bXBzX3ZhbGlkOiBhbGxfanVtcHNfdmFsaWRcbiAgICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBkb0NsZWFuaW5nQmVmb3JlU2F2aW5nO1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG5cbnZhciBzYXZlQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICB2YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xuICAgIHZhciBpbml0aWFsX2Fuc3dlcl92YWxpZGF0aW9uO1xuXG4gICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgIC5kb21cbiAgICAgICAgLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAvL2NsZWFyIGFsbCBhZHZhbmNlZCBwcm9wZXJ0aWVzIGVycm9ycyBmcm9tIGRvbVxuICAgIGlucHV0LmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoKTtcblxuXG4gICAgLy9zZXQgcHJvcGVydGllcyBidXQgc2tpcCBpZiBpdCBpcyBhIHJlYWRtZVxuICAgIGlmIChpbnB1dC50eXBlICE9PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgLy9zZXQgZGVmYXVsdFxuICAgICAgICBpbnB1dC5kZWZhdWx0ID0gaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBpbnB1dCcpLnZhbCgpO1xuICAgICAgICBpbnB1dC5kZWZhdWx0ID0gaW5wdXQuZGVmYXVsdCA9PT0gJycgPyBudWxsIDogaW5wdXQuZGVmYXVsdDtcblxuICAgICAgICAvL3N0cmlwIGh0bWwgdGFncyBhbmQgcmVzZXQgaW5wdXQgdG8gc2FuaXRpc2VkIHZhbHVlXG4gICAgICAgIGlmIChpbnB1dC5kZWZhdWx0KSB7XG4gICAgICAgICAgICBpbnB1dC5kZWZhdWx0ID0gaW5wdXQuZGVmYXVsdC5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBpbnB1dCcpLnZhbChpbnB1dC5kZWZhdWx0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vc2V0IHJlZ2V4XG4gICAgICAgIGlucHV0LnJlZ2V4ID0gaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fcmVnZXggaW5wdXQnKS52YWwoKTtcbiAgICAgICAgaW5wdXQucmVnZXggPSBpbnB1dC5yZWdleCA9PT0gJycgPyBudWxsIDogaW5wdXQucmVnZXg7XG5cbiAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3MgYW5kIHJlc2V0IGlucHV0IHRvIHNhbml0aXNlZCB2YWx1ZVxuICAgICAgICBpZiAoaW5wdXQucmVnZXgpIHtcbiAgICAgICAgICAgIGlucHV0LnJlZ2V4ID0gaW5wdXQucmVnZXgucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcnKTtcbiAgICAgICAgICAgIGlucHV0LmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0JykudmFsKGlucHV0LnJlZ2V4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vc2V0IHZlcmlmaWNhdGlvbiBmbGFnXG4gICAgICAgIGlucHV0LnZlcmlmeSA9IGlucHV0LmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RvdWJsZS1lbnRyeSBpbnB1dCcpLmlzKCc6Y2hlY2tlZCcpO1xuXG4gICAgICAgIC8qIGdldCB1bmlxdWVuZXNzIGZsYWcgKi9cbiAgICAgICAgc2F2ZS5zYXZlVW5pcXVlbmVzcyhpbnB1dCk7XG5cbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8vdmFsaWRhdGUgaW5pdGlhbCBhbnN3ZXJcbiAgICBpbml0aWFsX2Fuc3dlcl92YWxpZGF0aW9uID0gaW5wdXQuaXNJbml0aWFsQW5zd2VyVmFsaWQoKTtcbiAgICBpZiAoIWluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0XG4gICAgICAgIGlucHV0LnNob3dBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoY29uc3RzLkRFRkFVTFRfUFJPUEVSVFksIGluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBzYXZlQWR2YW5jZWRQcm9wZXJ0aWVzO1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuXG52YXIgc2F2ZUFsbElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG4gICAgdmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuICAgIHZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2g7XG4gICAgdmFyIGFjdGl2ZV9ncm91cDtcbiAgICB2YXIgYnJhbmNoX2lucHV0c192YWxpZGF0aW9uO1xuICAgIHZhciBncm91cF9pbnB1dHNfdmFsaWRhdGlvbjtcbiAgICB2YXIgbmVzdGVkX2dyb3VwX293bmVyX2JyYW5jaF92YWxpZGF0aW9uO1xuXG4gICAgLy9zYXZlIGJhc2ljIHByb3BlcnRpZXNcbiAgICBpbnB1dC5zYXZlUHJvcGVydGllcygpO1xuXG4gICAgLy9pZiB0aGUgc2VsZWN0ZWQgaW5wdXQgaXMgYSBtdWx0aXBsZSBjaG9pY2UgaW5wdXQsIHNhdmUgcG9zc2libGUgYW5zd2Vyc1xuICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xKSB7XG4gICAgICAgIC8vdG9kbyB3ZSBhcmUgdGVzdGluZyBwZXJmb3JtYW5jZVxuICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG4gICAgfVxuICAgIC8vc2F2ZSBhZHZhbmNlZCBwcm9wZXJ0aWVzIChub3QgZm9yIG1lZGlhIG9yIGJyYW5jaCBvciBncm91cCB0eXBlcylcbiAgICBpZiAoY29uc3RzLk1FRElBX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpID09PSAtMSAmJiBpbnB1dC50eXBlICE9PSBjb25zdHMuQlJBTkNIX1RZUEUgJiYgaW5wdXQudHlwZSAhPT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgaW5wdXQuc2F2ZUFkdmFuY2VkUHJvcGVydGllcygpO1xuICAgIH1cblxuICAgIC8vc2F2ZSBqdW1wc1xuICAgIC8vIGlmIChpbnB1dC50eXBlICE9PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGlucHV0LnNhdmVKdW1wcygpO1xuICAgIH1cblxuICAgIC8vc2F2ZSBicmFuY2ggaW5wdXRzIGlmIHRoZSBicmFuY2ggaW5wdXQgb3duZXIgaXMgdmFsaWQgKGhlYWRlciBpcyBub3QgZW1wdHkpXG4gICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSAmJiBpbnB1dC5kb20uaXNfdmFsaWQpIHtcblxuICAgICAgICAvL3NldCBoZWFkZXIgcHJldmlld1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRRdWVzdGlvblByZXZpZXcoaW5wdXQucmVmLCBpbnB1dC5xdWVzdGlvbi50cnVuYyg1MCkpO1xuXG4gICAgICAgIC8vYnJhbmNoIGlucHV0cyBhcmUgYWxyZWFkeSBhdHRhY2hlZCB0byB0aGUgYnJhbmNoIHByb3BlcnR5LCBqdXN0IHZhbGlkYXRlIHRoZW1cbiAgICAgICAgLy90b2RvIGNoZWNrIHRoaXMgYXMgSSBzaG91bGQgZG8gc29tZXRoaW5nIGlmIHRoZXJlIGlzIGEgdmFsaWQvaW52YWxpZCBvbmU/XG4gICAgICAgIGlucHV0LnZhbGlkYXRlQnJhbmNoSW5wdXRzKCk7XG4gICAgfVxuXG4gICAgLy9zYXZlIGJyYW5jaCBpbnB1dHMgaWYgdGhlIGJyYW5jaCBpbnB1dCBvd25lciBpcyB2YWxpZCAoaGVhZGVyIGlzIG5vdCBlbXB0eSlcbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUgJiYgaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG5cbiAgICAgICAgLy9zZXQgaGVhZGVyIHByZXZpZXdcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KGlucHV0LnJlZiwgaW5wdXQucXVlc3Rpb24udHJ1bmMoNTApKTtcblxuICAgICAgICAvL2JyYW5jaCBpbnB1dHMgYXJlIGFscmVhZHkgYXR0YWNoZWQgdG8gdGhlIGJyYW5jaCBwcm9wZXJ0eSwganVzdCB2YWxpZGF0ZSB0aGVtXG4gICAgICAgIGlucHV0LnZhbGlkYXRlR3JvdXBJbnB1dHMoKTtcbiAgICB9XG5cbiAgICAvL2lmIHdlIGFyZSBlZGl0aW5nIGEgbmVzdGVkIGdyb3VwXG4gICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcblxuICAgICAgICAvLyBpZiB3ZSBhcmUgZWRpdGluZyBhIG5lc3RlZCBncm91cCwgYW5kIGFsbCB0aGUgbmVzdGVkIGdyb3VwIGlucHV0cyBhcmUgdmFsaWQsXG4gICAgICAgIC8vIHNldCB0aGUgbmVzdGVkIGdyb3VwIGlucHV0IG93bmVyIGFzIHZhbGlkIGFuZCB0b2dnbGUgdmFsaWQgaWNvbiBmb3IgdGhlIG93bmVyIGdyb3VwIGlucHV0XG4gICAgICAgIGFjdGl2ZV9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgIGFjdGl2ZV9ncm91cCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwT2JqZWN0QnlSZWYoYWN0aXZlX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZik7XG4gICAgICAgIGdyb3VwX2lucHV0c192YWxpZGF0aW9uID0gdmFsaWRhdGlvbi52YWxpZGF0ZUdyb3VwSW5wdXRzKGFjdGl2ZV9ncm91cCk7XG5cbiAgICAgICAgaWYgKGdyb3VwX2lucHV0c192YWxpZGF0aW9uLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBhY3RpdmVfZ3JvdXAuZG9tLmlzX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFZhbGlkSWNvbihhY3RpdmVfZ3JvdXAucmVmKTtcblxuICAgICAgICAgICAgLy9pZiB0aGUgbmVzdGVkIGdyb3VwIGlzIHZhbGlkLCBpcyB0aGUgb3duZXIgYnJhbmNoIHZhbGlkIHRoZW4/XG4gICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfb3duZXJfYnJhbmNoX3ZhbGlkYXRpb24gPSBhY3RpdmVfYnJhbmNoLnZhbGlkYXRlQnJhbmNoSW5wdXRzKCk7XG5cbiAgICAgICAgICAgIC8vdG9kbyBkbyBpIG5lZWQgdG8gZG8gc29tZXRoaW5nIGhlcmUgIGJhc2VkIG9uIHRoZSBhYm92ZSByZXN1bHQ/XG5cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGFjdGl2ZV9ncm91cC5yZWYpO1xuICAgICAgICAgICAgYWN0aXZlX2dyb3VwLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuXG5cbiAgICAgICAgLy8gaWYgd2UgYXJlIGVkaXRpbmcgYSBicmFuY2gsIGFuZCBhbGwgdGhlIGFjdGl2ZSBicmFuY2ggaW5wdXRzIGFyZSB2YWxpZCxcbiAgICAgICAgLy8gc2V0IHRoZSBicmFuY2ggaW5wdXQgb3duZXIgYXMgdmFsaWQgYW5kIHRvZ2dsZSB2YWxpZCBpY29uIGZvciB0aGUgb3duZXIgYnJhbmNoIGlucHV0XG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAvL2dldCBjdXJyZW50IGFjdGl2ZSBicmFuY2ggYW5kIHZhbGlkYXRlXG4gICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgYnJhbmNoX2lucHV0c192YWxpZGF0aW9uID0gdmFsaWRhdGlvbi52YWxpZGF0ZUJyYW5jaElucHV0cyhhY3RpdmVfYnJhbmNoKTtcblxuICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dHNfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuXG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0VmFsaWRJY29uKGFjdGl2ZV9icmFuY2gucmVmKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoLmRvbS5pc192YWxpZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihhY3RpdmVfYnJhbmNoLnJlZik7XG4gICAgICAgICAgICAgICAgYWN0aXZlX2JyYW5jaC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHdlIGFyZSBlZGl0aW5nIGEgZ3JvdXAsIGFuZCBhbGwgdGhlIGFjdGl2ZSBncm91cCBpbnB1dHMgYXJlIHZhbGlkLFxuICAgICAgICAvLyBzZXQgdGhlIGdyb3VwIGlucHV0IG93bmVyIGFzIHZhbGlkIGFuZCB0b2dnbGUgdmFsaWQgaWNvbiBmb3IgdGhlIG93bmVyIGJyYW5jaCBpbnB1dFxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICAvL2dldCBjdXJyZW50IGFjdGl2ZSBncm91cCBhbmQgdmFsaWRhdGVcbiAgICAgICAgICAgIGFjdGl2ZV9ncm91cCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZik7XG4gICAgICAgICAgICBncm91cF9pbnB1dHNfdmFsaWRhdGlvbiA9IHZhbGlkYXRpb24udmFsaWRhdGVHcm91cElucHV0cyhhY3RpdmVfZ3JvdXApO1xuXG4gICAgICAgICAgICBpZiAoZ3JvdXBfaW5wdXRzX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcblxuICAgICAgICAgICAgICAgIGFjdGl2ZV9ncm91cC5kb20uaXNfdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFZhbGlkSWNvbihhY3RpdmVfZ3JvdXAucmVmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGFjdGl2ZV9ncm91cC5yZWYpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZV9ncm91cC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gc2F2ZUFsbElucHV0UHJvcGVydGllcztcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIHNhdmVKdW1wcyA9IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgdmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGp1bXBzX2xpc3Rfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHMgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19saXN0Jyk7XG5cbiAgICB2YXIganVtcHMgPSBqdW1wc19saXN0X3dyYXBwZXIuZmluZCgnbGknKTtcbiAgICB2YXIganVtcF9wcm9wZXJ0aWVzID0ge1xuICAgICAgICBhcmVfdmFsaWQ6IG51bGwsXG4gICAgICAgIHdoZW46IG51bGwsXG4gICAgICAgIHRvOiBudWxsLFxuICAgICAgICBhbnN3ZXJfcmVmOiBudWxsLFxuICAgICAgICB0eXBlOiBudWxsXG4gICAgfTtcblxuICAgIGlucHV0LmhpZGVKdW1wc0Vycm9ycyhqdW1wcyk7XG5cbiAgICAvL3Jlc2V0IGFsbCBqdW1wc1xuICAgIGlucHV0Lmp1bXBzID0gW107XG4gICAganVtcHMuZWFjaChmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAganVtcF9wcm9wZXJ0aWVzLmhhc192YWxpZF9kZXN0aW5hdGlvbiA9IHRydWU7XG4gICAgICAgICAgICBqdW1wX3Byb3BlcnRpZXMudHlwZSA9IGlucHV0LnR5cGU7XG5cbiAgICAgICAgICAgIC8vZ2V0IGp1bXAgcHJvcGVydGllc1xuICAgICAgICAgICAganVtcF9wcm9wZXJ0aWVzLndoZW4gPSAkKHRoaXMpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLXdoZW4gc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuICAgICAgICAgICAganVtcF9wcm9wZXJ0aWVzLnRvID0gJCh0aGlzKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS1nb3RvIHNlbGVjdCBvcHRpb246c2VsZWN0ZWQnKS52YWwoKTtcbiAgICAgICAgICAgIGp1bXBfcHJvcGVydGllcy5hbnN3ZXJfcmVmID0gJCh0aGlzKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS1hbnN3ZXIgc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuXG4gICAgICAgICAgICAvL3ZhbGlkYXRlIGp1bXAgcHJvcGVydGllc1xuICAgICAgICAgICAganVtcF9wcm9wZXJ0aWVzLmFyZV92YWxpZCA9IGlucHV0LmlzSnVtcFZhbGlkKGp1bXBfcHJvcGVydGllcyk7XG5cbiAgICAgICAgICAgIGlmICghanVtcF9wcm9wZXJ0aWVzLmFyZV92YWxpZCkge1xuXG4gICAgICAgICAgICAgICAgLy9zaG93IGVycm9yc1xuICAgICAgICAgICAgICAgIGlucHV0LnNob3dTaW5nbGVKdW1wRXJyb3JzKCQodGhpcyksIGp1bXBfcHJvcGVydGllcyk7XG5cbiAgICAgICAgICAgICAgICAvL3NldCBpbnB1dCBhcyBpbnZhbGlkXG4gICAgICAgICAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vc2F2ZSBqdW1wIGFueXdheSwgYXMgaXQgaXMgZmxhZyBhcyBpbnZhbGlkIGFuZCBpdCB3aWxsIGtlZXAgdGhlIHByb2plY3QgaW52YWxpZCB1bnRpbCBpdCBpcyBlaXRoZXIgcmVtb3ZlZCBvciBzZXQgcHJvcGVybHlcbiAgICAgICAgICAgIGlucHV0Lmp1bXBzW2ldID0ge1xuICAgICAgICAgICAgICAgIHRvOiBqdW1wX3Byb3BlcnRpZXMudG8sXG4gICAgICAgICAgICAgICAgLy90aGlzIHdpbGwgYmUgYWx3YXlzICdBTEwnIGZvciB0aGlzIHR5cGUgb2YgaW5wdXRcbiAgICAgICAgICAgICAgICB3aGVuOiBqdW1wX3Byb3BlcnRpZXMud2hlbixcbiAgICAgICAgICAgICAgICAvL3RoaXMgd2lsbCBiZSBudWxsIGZvciBzaW5nbGUgYW5zd2VyIG9wdGlvbnMuIHZhbCgpIGlzIHNldCB0byBhbnN3ZXJfcmVmIG9mIHBvc3NpYmxlIGFuc3dlciBvdGhlcndpc2VcbiAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiBqdW1wX3Byb3BlcnRpZXMuYW5zd2VyX3JlZiB8fCBudWxsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgKTtcbiAgICB1bmRvLnB1c2hTdGF0ZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBzYXZlSnVtcHM7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcblxudmFyIHNhdmVQb3NzaWJsZUFuc3dlcnM7XG5zYXZlUG9zc2libGVBbnN3ZXJzID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciBhbnN3ZXI7XG4gICAgdmFyIGFuc3dlcl9yZWY7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzID0gcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCBsaScpO1xuICAgIHZhciBpc19wb3NzaWJsZV9hc3dlcl92YWxpZDtcbiAgICB2YXIgYW5zd2VyX3JlZnMgPSBbXTtcblxuICAgIHZhciBjdXJyZW50X3BhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlO1xuICAgIHZhciBmcm9tX2luZGV4ID0gKGN1cnJlbnRfcGFnZSAtIDEpICogY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlO1xuXG4gICAgaW5wdXQuZG9tLnByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuXG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIGlucHV0LmhpZGVQb3NzaWJsZUFuc3dlcnNFcnJvcnMocG9zc2libGVfYW5zd2Vycyk7XG5cbiAgICAvKlxuICAgICBQb3NzaWJsZSBhbnN3ZXJzIGFyZSBncmFiYmVkIGZyb20gdGhlIGRvbSwgc28gd2UganVzdCB1cGRhdGUgdGhlIHRleHQgd2l0aCB3aGF0ZXZlciBpcyBzZXRcbiAgICAgKi9cbiAgICBwb3NzaWJsZV9hbnN3ZXJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICB2YXIgY3VycmVudF9pbnB1dCA9ICQocG9zc2libGVfYW5zd2VyKS5maW5kKCdkaXYgaW5wdXQnKTtcblxuICAgICAgICBhbnN3ZXIgPSBjdXJyZW50X2lucHV0LnZhbCgpO1xuXG4gICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIChhbmdsZSBicmFja2V0cylcbiAgICAgICAgLy9hbnN3ZXIgPSBhbnN3ZXIucmVwbGFjZSgvWzw+XS9pZywgJycpO1xuXG4gICAgICAgIC8vc2FuaXRpc2UgPCBhbmQgPiByZXBsYWNpbmcgYnkgdW5pY29kZVxuICAgICAgICBhbnN3ZXIgPSBhbnN3ZXIucmVwbGFjZUFsbCgnPicsICdcXHVmZTY1Jyk7XG4gICAgICAgIGFuc3dlciA9IGFuc3dlci5yZXBsYWNlQWxsKCc8JywgJ1xcdWZlNjQnKTtcblxuICAgICAgICAvL3JlZmxlY3QgY2hhbmdlcyBpbiBkb21cbiAgICAgICAgY3VycmVudF9pbnB1dC5hdHRyKCd2YWx1ZScsIGFuc3dlcik7XG4gICAgICAgIGN1cnJlbnRfaW5wdXQudmFsKGFuc3dlcik7XG5cbiAgICAgICAgYW5zd2VyX3JlZiA9IGN1cnJlbnRfaW5wdXQuYXR0cignZGF0YS1hbnN3ZXItcmVmJyk7XG4gICAgICAgIGlmICghYW5zd2VyX3JlZnMuaW5jbHVkZXMoYW5zd2VyX3JlZikpIHtcbiAgICAgICAgICAgIGFuc3dlcl9yZWZzLnB1c2goYW5zd2VyX3JlZik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL2R1cGxpY2F0ZWQgYW5zd2VyX3JlZiwgc2hvdyBlcnJvclxuICAgICAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBhbnN3ZXIgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgaW5wdXQuc2hvd1Bvc3NpYmxlQW5zd2VyRXJyb3JzKCQocG9zc2libGVfYW5zd2VyKSwgbWVzc2FnZXMuZXJyb3IuUE9TU0lCTEVfQU5TV0VSX0RVUExJQ0FURURfSURFTlRJRklFUik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvL2FkZCBlbGVtZW50IHRvIHRoZSBjb3JyZWN0IHBvc2l0aW9uIGluIHRoZSBhcnJheVxuICAgICAgICAvL2Jhc2VkIG9uIHBhZ2luYXRpb25cbiAgICAgICAgaW5wdXQucG9zc2libGVfYW5zd2Vyc1tmcm9tX2luZGV4ICsgaW5kZXhdID0ge1xuICAgICAgICAgICAgYW5zd2VyOiBhbnN3ZXIsXG4gICAgICAgICAgICBhbnN3ZXJfcmVmOiBhbnN3ZXJfcmVmXG4gICAgICAgIH07XG5cbiAgICAgICAgaXNfcG9zc2libGVfYXN3ZXJfdmFsaWQgPSBpbnB1dC5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQoYW5zd2VyKTtcblxuICAgICAgICAvL3ZhbGlkYXRlIGVhY2ggcG9zc2libGUgYW5zd2VyIGFuZCBzaG93IGVtYmVkZGVkIGVycm9ycyBpZiBhbnlcbiAgICAgICAgaWYgKCFpc19wb3NzaWJsZV9hc3dlcl92YWxpZC5pc192YWxpZCkge1xuICAgICAgICAgICAgLy8gd2FybiB1c2VyIHF1ZXN0aW9uIHRleHQgaXMgd3JvbmdcbiAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBhbnN3ZXIgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgaW5wdXQuc2hvd1Bvc3NpYmxlQW5zd2VyRXJyb3JzKCQocG9zc2libGVfYW5zd2VyKSwgaXNfcG9zc2libGVfYXN3ZXJfdmFsaWQuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gc2F2ZVBvc3NpYmxlQW5zd2VycztcblxuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgc2F2ZVByb3BlcnRpZXMgPSBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG5cbiAgICB2YXIgcXVlc3Rpb25fdGV4dF92YWxpZGF0aW9uO1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcblxuICAgIGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSB0cnVlO1xuXG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIGlucHV0LmhpZGVQcm9wZXJ0aWVzRXJyb3JzKCk7XG5cbiAgICAvL3NldCBxdWVzdGlvbiB0ZXh0IChyZWFkbWUgaXMgdGhlIG9ubHkgb25lIHdpdGggYSB0ZXh0YXJlYSBpbiB0aGUgbWFya3VwKVxuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcblxuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiB0ZXh0YXJlYScpLnZhbCgpLnRyaW0oKTtcblxuICAgICAgICAvL3JlbW92ZSBkb3VibGUgd2hpdGUgc3BhY2VzLCB0YWJzIGFuZCBuZXcgbGluZXMgYW5kICZuYnNwO1xuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IGlucHV0LnF1ZXN0aW9uLnJlcGxhY2UoL1xcc1xccysvZywgJyAnKS5yZXBsYWNlKC8mbmJzcDsvZywgJycpO1xuXG4gICAgICAgIC8vY29udmVydCBodG1sIHRhZ3MgdG8gaHRtbCBlbnRpdGllc1xuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IHV0aWxzLmVuY29kZUh0bWwoaW5wdXQucXVlc3Rpb24pXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiBpbnB1dCcpLnZhbCgpO1xuXG4gICAgICAgIC8vc2FuaXRpc2UgPCBhbmQgPiByZXBsYWNpbmcgYnkgdW5pY29kZVxuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IGlucHV0LnF1ZXN0aW9uLnJlcGxhY2VBbGwoJz4nLCAnXFx1ZmU2NScpO1xuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IGlucHV0LnF1ZXN0aW9uLnJlcGxhY2VBbGwoJzwnLCAnXFx1ZmU2NCcpO1xuICAgICAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gaW5wdXQnKS52YWwoaW5wdXQucXVlc3Rpb24pO1xuXG4gICAgICAgIC8vc2V0IHJlcXVpcmVkIGZsYWdcbiAgICAgICAgaW5wdXQuaXNfcmVxdWlyZWQgPSBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcmVxdWlyZWQtZmxhZyBpbnB1dCcpLmlzKCc6Y2hlY2tlZCcpO1xuXG4gICAgICAgIC8vc2V0IHRpdGxlIGZsYWdcbiAgICAgICAgaW5wdXQuaXNfdGl0bGUgPSBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fdGl0bGUtZmxhZyBpbnB1dCcpLmlzKCc6Y2hlY2tlZCcpO1xuICAgIH1cblxuICAgIC8vdmFsaWRhdGUgcXVlc3Rpb24gdGV4dFxuICAgIHF1ZXN0aW9uX3RleHRfdmFsaWRhdGlvbiA9IGlucHV0LmlzUXVlc3Rpb25UZXh0VmFsaWQoKTtcblxuICAgIGlmICghcXVlc3Rpb25fdGV4dF92YWxpZGF0aW9uLmlzX3ZhbGlkKSB7XG4gICAgICAgIC8vIHdhcm4gdXNlciBxdWVzdGlvbiB0ZXh0IGlzIHdyb25nXG4gICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICBpbnB1dC5kb20uZXJyb3IgPSBxdWVzdGlvbl90ZXh0X3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZTtcblxuICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dCBhbmQgc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIGlucHV0LnNob3dQcm9wZXJ0aWVzRXJyb3JzKHF1ZXN0aW9uX3RleHRfdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlKTtcblxuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gc2F2ZVByb3BlcnRpZXM7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG5cbnZhciBzYXZlVW5pcXVlbmVzcyA9IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgLyogZ2V0IHVuaXF1ZW5lc3MgZmxhZyAqL1xuICAgIHZhciB1bmlxdWVuZXNzID0gaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdW5pcXVlbmVzcyBpbnB1dDpjaGVja2VkJyk7XG4gICAgLy90b3AgcGFyZW50IGZvcm1cbiAgICBpZiAoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID09PSAwKSB7XG4gICAgICAgIC8vdGhpcyBpcyB0aGUgdG9wIGxldmVsIGZvcm0sIGdldCBzaW5nbGUgY2hlY2tib3ggc3RhdGVcbiAgICAgICAgaW5wdXQudW5pcXVlbmVzcyA9ICh1bmlxdWVuZXNzLmxlbmd0aCA+IDApID8gY29uc3RzLlVOSVFVRVNTX0ZPUk0gOiBjb25zdHMuVU5JUVVFU1NfTk9ORTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vZG8gd2UgaGF2ZSBzb21lIGNoZWNrYm94ZXMgc2VsZWN0ZWQ/XG4gICAgICAgIGlmICh1bmlxdWVuZXNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vY2hpbGQgZm9ybSBjYW4gaGF2ZSBlaXRoZXIgaGllcmFyY2h5IG9yIGZvcm0gdW5pcXVlbmVzc1xuICAgICAgICAgICAgaW5wdXQudW5pcXVlbmVzcyA9IHVuaXF1ZW5lc3MuaGFzQ2xhc3MoJ3VuaXF1ZW5lc3MtaGllcmFyY2h5JykgPyBjb25zdHMuVU5JUVVFU1NfSElFUkFSQ0hZIDogY29uc3RzLlVOSVFVRVNTX0ZPUk07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnB1dC51bmlxdWVuZXNzID0gY29uc3RzLlVOSVFVRVNTX05PTkU7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gc2F2ZVVuaXF1ZW5lc3M7XG4iLCIvKiBnbG9iYWwgRmxhdHRlZCovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBwYXJzZSA9IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgZm9ybV9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9mb3JtLWZhY3RvcnknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBwdXNoX3N0YXRlX3RpbWVvdXQ7XG5cbnZhciB1bmRvID0ge1xuXG4gICAgZXhlY3V0ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vc2V0IHJlbmRlciBhY3Rpb24gZmxhZyBzbyB3ZSBrbm93IHdlIGRvIG5vdCBoYXZlIHRvIHB1c2ggYSBzdGF0ZSB3aGVuIHdlIHVuZG8gKHNpbmNlIHdlIGFyZSByZS11c2luZyB0aGUgc2FtZSBmdW5jdGlvbnMpXG4gICAgICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9VTkRPO1xuXG4gICAgICAgIC8vc2hvdyBvdmVybGF5IGFuZCBjdXJzb3IsIG9uIGNvbXBsZXRlIGV4ZWN1dGUgdW5kb1xuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNULCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgb25seSAxIGVsZW1lbnQgaW4gc3RhdGUsIHRoYXQgaXMgdGhlIHN0YXJ0aW5nIHN0YXRlIGFuZCBpdCBjYW5ub3QgYmUgdW5kb25lXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuc3RhdGUubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnN0YXRlLnBvcCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wcmV2aW91c19zdGF0ZSA9IHdpbmRvdy5DaXJjdWxhckpTT04ucGFyc2Uod2luZG93LkNpcmN1bGFySlNPTi5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIuc3RhdGVbZm9ybWJ1aWxkZXIuc3RhdGUubGVuZ3RoIC0gMV0pKTtcblxuICAgICAgICAgICAgLy9yZW1vdmUgYWxsIGNoaWxkIHRhYi1wYW5lbFxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnNfY29udGVudC5maW5kKCcubWFpbl9fdGFicy1jb250ZW50LXRhYnBhbmVsJykubm90KCc6Zmlyc3QnKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy9yZW1vdmUgYWxsIGlucHV0cyBmcm9tIHRvcCBsZXZlbCBmb3JtXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic19jb250ZW50LmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbiAuc29ydGFibGUgLmlucHV0JykucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBwcm9wZXJ0aWVzIHBhbmVscyBmb3IgdG9wIGxldmVsIGZvcm1cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzX2NvbnRlbnQuZmluZCgnLm1haW5fX3RhYnMtY29udGVudC10YWJwYW5lbCAuaW5wdXQtcHJvcGVydGllcyAuaW5wdXQtcHJvcGVydGllc19fZm9ybScpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAvL3JlbW92ZSBmb3JtcyB0YWJzIGJ1dHRvbnMgKG5vdCB0aGUgZmlyc3Qgb25lKVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnLm1haW5fX3RhYnNfX2Zvcm0tYnRuJykubm90KCc6Zmlyc3QnKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy9yZW5kZXIgcHJldmlvdXMgc3RhdGVcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbiA9IGZvcm1idWlsZGVyLnByZXZpb3VzX3N0YXRlLnByb2plY3RfZGVmaW5pdGlvbjsvL3RvZG8gdGVzdCBmb3Igc2lkZSBlZmZlY3Qgb2YgdGhpcyBhc3NpZ25tZW50XG5cbiAgICAgICAgICAgICQud2hlbihwYXJzZS5yZW5kZXJQcm9qZWN0KGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy9hbHdheXMgc3dpdGNoIHRhYnMgdG8gZm9ybSBvZiBpbmRleCAwXG4gICAgICAgICAgICAgICAgLy90b2RvXG5cbiAgICAgICAgICAgICAgICAvL2hpZGUgb3ZlcmxheSB3aXRoIGEgYml0IG9mIGRlbGF5XG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIHVuZG8gYnV0dG9uIGlmIHdlIGRvIG5vdCBoYXZlIGFueSBtb3JlIHN0YXRlXG4gICAgICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLnN0YXRlLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlVW5kb0J0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3Jlc2V0IHN0YXRlIHRvIHJlZ2lzdGVyIG5ldyAgdXNlciBhY3Rpb25zXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9IGNvbnN0cy5SRU5ERVJfQUNUSU9OX0RPO1xuXG4gICAgICAgICAgICAgICAgLy9jbGVhciBwb3NzaWJsZSBhbnN3ZXJzIHNvcnRhYmxlIGVuYWJsZWQgYXJyYXkhXG4gICAgICAgICAgICAgICAgLy90byBiaW5kIHRoZSBzb3J0YWJsZSBldmVudHMgYWdhaW5cbiAgICAgICAgICAgICAgICAvL2l0IG1pZ2h0IGJpbmQgaXQgdHdpY2UgZm9yIHNvbWUgZWxlbWVudHMsIGJ1dCB0aGUgdW5kbyBhY3Rpb24gaXMgbm90IGNvbW1vblxuICAgICAgICAgICAgICAgIC8vc28gaXQgaXMgYWNjZXB0YWJsZSBpbiB0ZXJtcyBvZiBtZW1vcnkgdXNhZ2VcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzLmVuYWJsZWRfc29ydGFibGUgPSBbXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgcHVzaFN0YXRlOiBmdW5jdGlvbiAod2l0aF90aHJvdHRsZSkge1xuXG4gICAgICAgIHZhciBzdGF0ZSA9IHt9O1xuXG4gICAgICAgIC8vcHVzaCBhIHN0YXRlIG9ubHkgd2hlbiB3ZSBhcmUgTk9UIHVuZG9pbmcgOylcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPT09IGNvbnN0cy5SRU5ERVJfQUNUSU9OX1VORE8pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIF9kb1B1c2hTdGF0ZSgpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2NhbGxlZCBwdXNoU3RhdGUnKTtcbiAgICAgICAgICAgIC8vcHVzaCBzdGF0ZVxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLnN0YXRlLmxlbmd0aCA+PSBjb25zdHMuTElNSVRTLm1heF9zdGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5zdGF0ZS5zaGlmdCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdGF0ZS5wcm9qZWN0X2RlZmluaXRpb24gPSBGbGF0dGVkLnBhcnNlKEZsYXR0ZWQuc3RyaW5naWZ5KGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpO1xuICAgICAgICAgICAgLy8gc3RhdGUucHJvamVjdF9kZWZpbml0aW9uID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uO1xuICAgICAgICAgICAgc3RhdGUuYWN0aXZlX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgc3RhdGUuYWN0aXZlX2Zvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICBzdGF0ZS5hY3RpdmVfZm9ybV9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmO1xuXG4gICAgICAgICAgICBzdGF0ZS5hY3RpdmVfcHJvcGVydGllc190YWIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2lucHV0X3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLmFjdGl2ZSBhJykuYXR0cignaHJlZicpO1xuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vdG9kbyBzYXZlIHJlZmVyZW5jZSB0byB0aGUgbmVzdGVkIGdyb3VwIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuXG4gICAgICAgICAgICAgICAgLy9zYXZlIHRoZSBicmFuY2ggdGhhdCB3YXMgYmVpbmcgZWRpdGVkXG4gICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlX2JyYW5jaF9yZWYgPSBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWY7XG5cbiAgICAgICAgICAgICAgICAvL3NhdmUgdGhlIGdyb3VwIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9ncm91cF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSBpbnB1dCByZWYgcmVmZXJlbmNlIHRvIGdldCB0aGUgbmVzdGVkIGdyb3VwIGlucHV0IHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfcHJvcGVydGllc190YWIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9pbnB1dF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicyAuYWN0aXZlIGEnKS5hdHRyKCdocmVmJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zYXZlIHRoZSBicmFuY2ggdGhhdCB3YXMgYmVpbmcgZWRpdGVkXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9icmFuY2hfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2F2ZSB0aGUgYWN0aXZlIGJyYW5jaCBpbnB1dCAoaWYgYW55KVxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfYnJhbmNoX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vc2F2ZSBicmFuY2ggaW5wdXQgYWN0aXZlIHRhYiBpZiBhbnlcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLmFjdGl2ZSBhJykuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2F2ZSB0aGUgZ3JvdXAgdGhhdCB3YXMgYmVpbmcgZWRpdGVkXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9ncm91cF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2F2ZSB0aGUgYWN0aXZlIGJyYW5jaCBpbnB1dCAoaWYgYW55KVxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9ncm91cF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vc2F2ZSBicmFuY2ggaW5wdXQgYWN0aXZlIHRhYiBpZiBhbnlcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2dyb3VwX2lucHV0X3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicyAuYWN0aXZlIGEnKS5hdHRyKCdocmVmJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdGF0ZS53YXNfZWRpdGluZ19icmFuY2ggPSBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaDtcbiAgICAgICAgICAgIHN0YXRlLndhc19lZGl0aW5nX2dyb3VwID0gZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cDtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuc3RhdGUucHVzaChzdGF0ZSk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjdXJyZW50IGZvcm1idWlsZGVyIHN0YXRlJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmb3JtYnVpbGRlci5zdGF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2VuYWJsZSB1bmRvIGJ1dHRvbiB0aGUgZmlyc3QgdGlqZSBhIHN0YXRlIGlzIHB1c2hlZFxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuc3RhdGUubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlVW5kb0J0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpdGhfdGhyb3R0bGUpIHtcbiAgICAgICAgICAgIC8vIFRocm90dGxlIHJlcXVlc3RzXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQocHVzaF9zdGF0ZV90aW1lb3V0KTtcbiAgICAgICAgICAgIHB1c2hfc3RhdGVfdGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KF9kb1B1c2hTdGF0ZSwgNTAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9kb1B1c2hTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1bmRvO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3Mvc2F2ZS1wcm9qZWN0LWNsaWNrLWNhbGxiYWNrJyk7XG52YXIgaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2hlbHBlcnMvaW1wb3J0LWZvcm0tdmFsaWRhdGlvbicpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG5cbnZhciB2YWxpZGF0aW9uID0ge1xuXG4gICAgaXNGb3JtTmFtZVZhbGlkOiBmdW5jdGlvbiAodGhlX25hbWUsIGlzX2FkZGluZ19uZXdfZm9ybSkge1xuXG4gICAgICAgIHZhciBmb3JtcyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXM7XG4gICAgICAgIHZhciBzdHIgPSB0aGVfbmFtZS50cmltKCk7XG4gICAgICAgIHZhciB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgIGlzX3ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBudWxsLFxuICAgICAgICAgICAgICAgIHR5cGU6IGNvbnN0cy5RVUVTVElPTl9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvL3JlamVjdCBhbiBlbXB0eSBzdHJpbmdcbiAgICAgICAgaWYgKHN0ciA9PT0gJycpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuRk9STV9OQU1FX0VNUFRZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9yZWplY3QgaWYgbm90IGFscGhhbnVtZXJpY1xuICAgICAgICAgICAgaWYgKCFjb25zdHMuRk9STV9OQU1FX1JFR0VYLnRlc3Qoc3RyKSkge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLkZPUk1fTkFNRV9JTlZBTElEO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNfYWRkaW5nX25ld19mb3JtKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdGhlIGZvcm0gbmFtZSBhbHJlYWR5IGV4aXN0cyAoY2FzZSBpbnNlbnNpdGl2ZSlcbiAgICAgICAgICAgICAgICAgICAgJChmb3JtcykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGZvcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gc3RyLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5GT1JNX05BTUVfRVhJU1Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9LFxuXG4gICAgLy9jaGVjayBmb3IgZW1wdHkgc3RyaW5nIGFuZCB0aGUgcHJlc2VuY2Ugb2YgZWl0aGVyICd8JyBvciAnX3NraXBwM2RfJyB3aGljaCBhcmUgcmVzZXJ2ZWQgd29yZHMvY2hhcnNcbiAgICBpc1F1ZXN0aW9uVGV4dFZhbGlkOiBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgICAgICB2YXIgcXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbjtcbiAgICAgICAgdmFyIHN0ciA9IHF1ZXN0aW9uLnRyaW0oKTtcbiAgICAgICAgdmFyIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgaXNfdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogY29uc3RzLlFVRVNUSU9OX1BST1BFUlRZXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmIChzdHIgPT09ICcnKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLlFVRVNUSU9OX1RFWFRfRU1QVFk7XG4gICAgICAgIH1cbiAgICAgICAgLy9yZWFkbWUgdGV4dCB0b28gbG9uZz9cbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgLy9jb252ZXJ0IGFueSBodG1sIGVudGl0aWVzIHRvIHRhZ3NcbiAgICAgICAgICAgIHN0ciA9IHV0aWxzLmRlY29kZUh0bWwoc3RyKTtcbiAgICAgICAgICAgIC8vc3RyaXAgdGFnc1xuICAgICAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnJyk7XG4gICAgICAgICAgICAvL2NoZWNrIFJFQUwgbGVuZ3RoXG4gICAgICAgICAgICBpZiAoc3RyLnRyaW0oKS5sZW5ndGggPiBjb25zdHMuTElNSVRTLnJlYWRtZV9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5RVUVTVElPTl9MRU5HVEhfTElNSVRfRVhDRUVERUQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL290aGVyIHF1ZXN0aW9ucyB0ZXh0IHRvbyBsb25nXG4gICAgICAgIGlmIChpbnB1dC50eXBlICE9PSBjb25zdHMuUkVBRE1FX1RZUEUgJiYgc3RyLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucXVlc3Rpb25fbGVuZ3RoKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLlFVRVNUSU9OX0xFTkdUSF9MSU1JVF9FWENFRURFRDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9LFxuXG4gICAgaXNQb3NzaWJsZUFuc3dlclZhbGlkOiBmdW5jdGlvbiAodGhlX3Bvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgIHZhciBzdHIgPSB0aGVfcG9zc2libGVfYW5zd2VyLnRyaW0oKTtcbiAgICAgICAgdmFyIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgaXNfdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogY29uc3RzLlFVRVNUSU9OX1BST1BFUlRZXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHN0ciA9PT0gJycpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuUE9TU0lCTEVfQU5TV0VSX0VNUFRZO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9LFxuXG4gICAgLy9jaGVjayBpZiB0aGlzIGlzIHZhbGlkIGFnYWluc3QgdGhlIGlucHV0IHR5cGUgb3IgdGhlIHJlZ2V4XG4gICAgaXNJbml0aWFsQW5zd2VyVmFsaWQ6IGZ1bmN0aW9uICh0aGVfdHlwZSwgdGhlX2RlZmF1bHQsIHRoZV9yZWdleCkge1xuXG4gICAgICAgIHZhciBzdHIgPSB0aGVfZGVmYXVsdCB8fCAnJztcbiAgICAgICAgdmFyIHJlZ2V4ID0gdGhlX3JlZ2V4O1xuICAgICAgICB2YXIgdHlwZSA9IHRoZV90eXBlO1xuICAgICAgICB2YXIgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICB0eXBlOiBjb25zdHMuREVGQVVMVF9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHN0ciA9IHN0ci50cmltKCk7XG5cbiAgICAgICAgLy9kb2VzIHRoZSBpbml0aWFsIGFuc3dlciBwYXNzIHRoZSByZWdleD9cbiAgICAgICAgaWYgKHJlZ2V4ICYmIHN0cikge1xuICAgICAgICAgICAgaWYgKCFzdHIubWF0Y2gocmVnZXgpKSB7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuSU5JVElBTF9BTlNXRVJfTk9UX01BVENISU5HX1JFR0VYO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUgPT09IGNvbnN0cy5QSE9ORV9UWVBFKSB7XG4gICAgICAgICAgICAvL2lzIHRoZSBpbml0aWFsIGFuc3dlciBhIHZhbGlkIHBob25lIG51bWJlciBmb3JtYXQ/XG4gICAgICAgICAgICAvL3RvZG8gdGhpcyBpcyBoYWlyeSwgdG9vIG1hbnkgb3B0aW9uc1xuICAgICAgICAgICAgLy92YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy92YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuSU5JVElBTF9BTlNXRVJfTk9UX1BIT05FX05VTUJFUjtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlO1xuICAgIH0sXG4gICAgLy9jb252ZXJ0IHZhbHVlIHRvIGEgZmxvYXQgYW5kIGNoZWNrIGlmIGl0IGlzIGFuIGludGVnZXJcbiAgICBpc1ZhbHVlSW50OiBmdW5jdGlvbiAobikge1xuICAgICAgICBuID0gcGFyc2VGbG9hdChuKTtcbiAgICAgICAgcmV0dXJuIE51bWJlcihuKSA9PT0gbiAmJiBuICUgMSA9PT0gMDtcbiAgICB9LFxuICAgIC8vY29udmVydCB2YWx1ZSB0byBhIGZsb2F0IGFuZCBjaGVjayBpZiBpdCBpcyBhIGRlY2ltYWwgb3JcbiAgICBpc1ZhbHVlRmxvYXQ6IGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIG4gPSBwYXJzZUZsb2F0KG4pO1xuICAgICAgICByZXR1cm4gbiA9PT0gTnVtYmVyKG4pICYmIG4gJSAxICE9PSAwO1xuICAgIH0sXG5cbiAgICAvL2lzIHRoaXMgcmlnaHQ/IHRvZG8gZG91YmxlIGNoZWNrIHRoaXMgYW5kIG1heWJlIHJlZmFjdG9yIGludGVnZXIvZGVjaW1hbCB2YWxpZGF0aW9uIGluIGludGVnZXIuanNcbiAgICBpc01pbk1heFZhbHVlVmFsaWQ6IGZ1bmN0aW9uICh0eXBlLCB2YWx1ZSkge1xuXG4gICAgICAgIHZhciBtaW5tYXhfdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdmFyIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgaXNfdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogY29uc3RzLk1BWF9WQUxVRV9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0eXBlID09PSBjb25zdHMuSU5URUdFUl9UWVBFICYmIG1pbm1heF92YWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICAgIC8vbWluIG11c3QgYmUgYW4gaW50ZWdlciwgbm90IGEgZmxvYXRcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1ZhbHVlSW50KG1pbm1heF92YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5WQUxVRV9NVVNUX0JFX0lOVEVHRVI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlO1xuICAgIH0sXG5cbiAgICBpc0p1bXBWYWxpZDogZnVuY3Rpb24gKHRoZV9qdW1wLCB0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIganVtcCA9IHRoZV9qdW1wO1xuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBpc192YWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBpbnB1dHM7XG4gICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucztcblxuICAgICAgICAvL2lmIGVkaXRpbmcgYSBicmFuY2gsIGdldCBqdW1wcyBkZXN0aW5hdGlvbnMgd2l0aGluIHRoZSBhY3RpdmUgYnJhbmNoXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgaW5wdXRzID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpLmJyYW5jaDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgIH1cblxuICAgICAgICBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnMoaW5wdXQsIGlucHV0cyk7XG5cbiAgICAgICAgaWYgKGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMuaW5kZXhPZihqdW1wLnR5cGUpICE9PSAtMSkge1xuICAgICAgICAgICAgLy9tdWx0aXBsZSBhbnN3ZXJzIHZhbGlkYXRpb25cbiAgICAgICAgICAgIGlmIChqdW1wLnRvID09PSB1bmRlZmluZWQgfHwganVtcC53aGVuID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2Fuc3dlcl9yZWYgaW4gbmVlZGVkIHdoZW4gSVMgYW5zIElTIE5PVCBvbmx5XG4gICAgICAgICAgICBpZiAoanVtcC5hbnN3ZXJfcmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoanVtcC53aGVuID09PSAnSVMnIHx8IGp1bXAud2hlbiA9PT0gJ0lTX05PVCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3NpbmdsZSBhbnN3ZXIgdmFsaWRhdGlvbiAoaXQgd2lsbCBhbHdheXMganVtcCwgc28gY2hlY2sgaWYgZGVzdGluYXRpb24gaXMgc2V0KVxuICAgICAgICAgICAgaWYgKGp1bXAudG8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2NoZWNrIHRoZSBkZXN0aW5hdGlvbiBpcyB2YWxpZCAodGhlIHVzZXIgbWlnaHQgaGF2ZSBkcmFnZ2VkIHRoZSBpbnB1dCBhcm91bmQpXG4gICAgICAgIGlmIChpc192YWxpZCkge1xuXG4gICAgICAgICAgICB2YXIgcmVmcyA9IGp1bXBfZGVzdGluYXRpb25zLm1hcChmdW5jdGlvbiAoZGVzdGluYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVzdGluYXRpb24ucmVmO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgaWYgKHJlZnMuaW5kZXhPZihqdW1wLnRvKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGp1bXAuaGFzX3ZhbGlkX2Rlc3RpbmF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBqdW1wLmhhc192YWxpZF9kZXN0aW5hdGlvbiBqdXN0IGluIGNhc2UgaXQgd2FzIHRoZXJlIGZyb20gYSBwcmV2aW91cyBlcnJvclxuICAgICAgICAgICAgICAgIC8vdGhpcyBoYXBwZW5zIGJlY2F1c2UgSSBhbSBtdXRhdGluZyB0aGUgb2JqZWN0ISBzaGFtZSBvbiBtZSwgdG9vIG11Y2ggd29yayByZWZhY3RvcmluZyA7KVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBqdW1wLmhhc192YWxpZF9kZXN0aW5hdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNfdmFsaWQ7XG4gICAgfSxcblxuICAgIC8vdG9kbyBJIGRvIG5vdCB0aGluayB0aGlzIGlzIHVzZWQgYW55bW9yZVxuICAgIGlzUG9zc2libGVBbnN3ZXJsaW5rZWRUb0p1bXA6IGZ1bmN0aW9uICh0aGVfcG9zc2libGVfYW5zd2VyLCB0aGVfanVtcHMpIHtcblxuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2VyID0gdGhlX3Bvc3NpYmxlX2Fuc3dlcjtcbiAgICAgICAgdmFyIGp1bXBzID0gdGhlX2p1bXBzO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIGlMZW5ndGggPSBqdW1wcy5sZW5ndGg7XG4gICAgICAgIHZhciBoYXNfbGlua2VkX2p1bXAgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoanVtcHNbaV0uYW5zd2VyX2lkID09PSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX2lkKSB7XG4gICAgICAgICAgICAgICAgaGFzX2xpbmtlZF9qdW1wID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGFzX2xpbmtlZF9qdW1wO1xuICAgIH0sXG5cbiAgICAvL3BlcmZvcm0gdmFsaWRhdGlvbiBvbiBhbiBpbnB1dCBhbmQgb3B0aW9uYWxseSBzaG93IHRvYXN0IG5vdGlmaWNhdGlvblxuICAgIHBlcmZvcm1WYWxpZGF0aW9uOiBmdW5jdGlvbiAodGhlX2lucHV0LCBzaG93X3RvYXN0KSB7XG5cbiAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgdmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuICAgICAgICB2YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG4gICAgICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgICAgIHZhciBxdWVzdGlvbjtcbiAgICAgICAgdmFyIGNvcHlfYnRuX3N0YXRlID0gaW5wdXQuZG9tLmlzX3ZhbGlkID8gY29uc3RzLkJUTl9FTkFCTEVEIDogY29uc3RzLkJUTl9ESVNBQkxFRDtcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgU2F2ZSB3aWxsIGltcGxpY2l0bHkgcnVuIHRoZSB2YWxpZGF0aW9uIVxuICAgICAgICAgKi9cbiAgICAgICAgc2F2ZS5zYXZlQWxsSW5wdXRQcm9wZXJ0aWVzKGlucHV0KTtcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLy9zaG93IHZpc3VhbCBmZWVkYmFjayBpZiB0aGUgcHJvcGVydGllcyBhcmUgdmFsaWRcbiAgICAgICAgaWYgKGlucHV0LmRvbS5pc192YWxpZCkge1xuXG4gICAgICAgICAgICAvL3VwZGF0ZSB0aGUganVzdCBzYXZlZCBpbnB1dCBzaG93aW5nIGEgcHJldmlldyBvZiB0aGUgcXVlc3Rpb24gdGV4dCAobGltaXQgdG8gNTAgY2hhcnMpXG4gICAgICAgICAgICAvL3N0cmlwIGh0bWwgdGFncyBmcm9tIHJlYWRtZSB0eXBlIGlmIGFueVxuICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuXG4gICAgICAgICAgICAgICAgLy9zdGFydCB3aXRoIGRlY29uZGluZyB0aGUgaHRtbFxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gdXRpbHMuZGVjb2RlSHRtbChpbnB1dC5xdWVzdGlvbik7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgJzwnIGFuZCAnPicgZnJvbSBkZWNvZGVkIHN0cmluZyAoYXMgaHRtbCBlbnRpdGllcylcbiAgICAgICAgICAgICAgICAvL3RhZ3MgYWxyZWFkeSBwYXJzZWQgKDxiPiwgPGk+LCA8dT4pIHNob3VsZCBnbyB0aHJvdWdoXG4gICAgICAgICAgICAgICAgLy90b2RvIHRlc3QgdGhpcyB3ZWxsXG4gICAgICAgICAgICAgICAgdmFyIHB1cmlmaWVkSHRtbCA9IHV0aWxzLnJlcGxhY2VBbGxPY2N1cnJlbmNlcyhxdWVzdGlvbiwgJyZsdDsnLCAnXFx1ZmU2NCcpO1xuICAgICAgICAgICAgICAgIHB1cmlmaWVkSHRtbCA9IHV0aWxzLnJlcGxhY2VBbGxPY2N1cnJlbmNlcyhwdXJpZmllZEh0bWwsICcmZ3Q7JywgJ1xcdWZlNjUnKTtcblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGxpbmsgcHJvdG9jb2xcbiAgICAgICAgICAgICAgICBwdXJpZmllZEh0bWwgPSB1dGlscy5yZXBsYWNlQWxsT2NjdXJyZW5jZXMocHVyaWZpZWRIdG1sLCAnaHR0cDovLycsICcnKTtcbiAgICAgICAgICAgICAgICBwdXJpZmllZEh0bWwgPSB1dGlscy5yZXBsYWNlQWxsT2NjdXJyZW5jZXMocHVyaWZpZWRIdG1sLCAnaHR0cHM6Ly8nLCAnJyk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBub3QgYWxsb3dlZCB0YWdzXG4gICAgICAgICAgICAgICAgcHVyaWZpZWRIdG1sID0gdXRpbHMuc3RyaXBUYWdzKHB1cmlmaWVkSHRtbCwgY29uc3RzLlJFQURNRV9BTExPV0VEX1RBR1MpO1xuXG4gICAgICAgICAgICAgICAgLy9zYXZlIHB1cmlmaWVkIHF1ZXN0aW9uXG4gICAgICAgICAgICAgICAgaW5wdXQucXVlc3Rpb24gPSB1dGlscy5lbmNvZGVIdG1sKHB1cmlmaWVkSHRtbCk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBBTEwgdGFncyBmb3IgcHJldmlldyBvbmx5XG4gICAgICAgICAgICAgICAgcXVlc3Rpb24gPSBwdXJpZmllZEh0bWwucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICAgICAgLy93cmFwIGluIGRvdWJsZSBxdW90ZXMgdG8gZXNjYXBlIGh0bWwgaW4gdGhlIHByZXZpZXcgc28gPGJyPiBkbyBub3QgZ2V0IHJlbmRlcmVkXG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KGlucHV0LnJlZiwgJ1wiJyArIHF1ZXN0aW9uLnRydW5jKGNvbnN0cy5MSU1JVFMucXVlc3Rpb25fcHJldmlld19sZW5ndGgpICsgJ1wiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRRdWVzdGlvblByZXZpZXcoaW5wdXQucmVmLCBpbnB1dC5xdWVzdGlvbi50cnVuYyhjb25zdHMuTElNSVRTLnF1ZXN0aW9uX3ByZXZpZXdfbGVuZ3RoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vcmVwbGFjZSB3YXJuaW5nIGljb24gd2l0aCBncmVlbiBjaGVja1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0VmFsaWRJY29uKGlucHV0LnJlZik7XG5cbiAgICAgICAgICAgIC8vc2hvdyBxdWVzdGlvbiBwcmV2aWV3IG9uIGlucHV0IHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbiA9IHF1ZXN0aW9uLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgICAgIC8vd3JhcCBpbiBkb3VibGUgcXVvdGVzIHRvIGVzY2FwZSBodG1sIHJlbmRlcmluZyBpbiBwcmV2aWV3XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zaG93SW5wdXRRdWVzdGlvblByZXZpZXcoJ1wiJyArIHF1ZXN0aW9uLnRydW5jKDIwKSArIFwiXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zaG93SW5wdXRRdWVzdGlvblByZXZpZXcoaW5wdXQucXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNob3dfdG9hc3QpIHtcbiAgICAgICAgICAgICAgICB0b2FzdC5zaG93U3VjY2VzcyhtZXNzYWdlcy5zdWNjZXNzLklOUFVUX1ZBTElEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gaWYgYWxsIGlucHV0cyBhcmUgdmFsaWRcbiAgICAgICAgICAgIGlmICh0aGlzLmFyZUFsbElucHV0c1ZhbGlkKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCcqKiBhbGwgZ29vZCAqKicpO1xuICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgICAgICAgICAgICAgLy9yZXBsYWNlIHdhcm5pbmcgaWNvbiB3aXRoIGdyZWVuIGNoZWNrIG9uIGN1cnJlbnQgZm9ybSB0YWJcbiAgICAgICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvbiBvbiBjdXJyZW50IGZvcm1cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAgICAgICAgIC8vZW5hYmxlIHBybnQgYXMgcGRmIGJ1dHRvblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBpZiBpbnB1dHMgYXJlIGFsbCB2YWxpZCBmb3IgY3VycmVudCBmb3JtIG9ubHlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hcmVGb3JtSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KSkge1xuICAgICAgICAgICAgICAgICAgICAvL3JlcGxhY2Ugd2FybmluZyBpY29uIHdpdGggZ3JlZW4gY2hlY2sgb24gY3VycmVudCBmb3JtIHRhYlxuICAgICAgICAgICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9lbmFibGUgZG93bmxvYWQgZm9ybSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9kaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGlucHV0LnF1ZXN0aW9uKSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGlucHV0LmRvbS5lcnJvciA/IGlucHV0LmRvbS5lcnJvciA6IGlucHV0LnF1ZXN0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkJSQU5DSF9UWVBFOlxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLk5PX0JSQU5DSF9IRUFERVJfWUVUO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkdST1VQX1RZUEU6XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuTk9fR1JPVVBfSEVBREVSX1lFVDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3VwZGF0ZSBxdWVzdGlvbiBwcmV2aWV3XG4gICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihpbnB1dC5yZWYpO1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KGlucHV0LnJlZiwgbWVzc2FnZSk7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldyhtZXNzYWdlKTtcblxuICAgICAgICAgICAgaWYgKHNob3dfdG9hc3QpIHtcbiAgICAgICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuSU5QVVRfTk9UX1ZBTElELCAyMDAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5zYXZlX3Byb2plY3RfYnRuLm9mZignY2xpY2snKTtcblxuICAgICAgICAgICAgLy9zaG93IHdhcm5pbmcgaWNvbiBvbiBjdXJyZW50IGZvcm0gdGFiXG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uIG9uIGN1cnJlbnQgZm9ybVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIC8vZGlzYWJsZSBwcmludCBhcyBwZGYgYnV0dG9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdG9nZ2xlIGNvcHkgYnV0dG9uICh2YWxpZCwgZW5hYmxlIGJ1dHRvbiBlbHNlIGRpc2FibGUpXG4gICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlQ29weUlucHV0QnV0dG9uKGlucHV0LnJlZiwgY29weV9idG5fc3RhdGUpO1xuICAgIH0sXG5cbiAgICBhcmVBbGxJbnB1dHNWYWxpZDogZnVuY3Rpb24gKHByb2plY3RfZGVmaW5pdGlvbikge1xuICAgICAgICB2YXIgYXJlX2FsbF92YWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBmb3JtcyA9IHByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXM7XG5cbiAgICAgICAgbG9vcDE6XG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBmb3Jtcy5sZW5ndGg7IGluZGV4KyspIHtcblxuICAgICAgICAgICAgLy9kbyBub3QgYWNjZXB0IGZvcm1zIHdpdGggbm8gaW5wdXRzXG4gICAgICAgICAgICBpZiAoZm9ybXNbaW5kZXhdLmlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBhcmVfYWxsX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAodmFyIGlucHV0X2luZGV4ID0gMDsgaW5wdXRfaW5kZXggPCBmb3Jtc1tpbmRleF0uaW5wdXRzLmxlbmd0aDsgaW5wdXRfaW5kZXgrKykge1xuXG4gICAgICAgICAgICAgICAgaWYgKCFmb3Jtc1tpbmRleF0uaW5wdXRzW2lucHV0X2luZGV4XS5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX2FsbF92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhayBsb29wMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFyZV9hbGxfdmFsaWQ7XG4gICAgfSxcblxuICAgIGFyZUZvcm1JbnB1dHNWYWxpZDogZnVuY3Rpb24gKGZvcm1faW5kZXgpIHtcblxuICAgICAgICB2YXIgYXJlX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgdmFyIGZvcm0gPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdO1xuXG4gICAgICAgIC8vZG8gbm90IGFjY2VwdCBmb3JtcyB3aXRoIG5vIGlucHV0c1xuICAgICAgICBpZiAoZm9ybS5pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vbG9vcCBhbGwgaW5wdXRzIHRvIHNlZSBpZiB0aGV5IGFyZSBhbGwgdmFsaWRcbiAgICAgICAgJChmb3JtLmlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAoIWlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgIGFyZV92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGFyZV92YWxpZDtcbiAgICB9LFxuXG4gICAgLy8gYSBicmFuY2ggaXMgdmFsaWQgd2hlbiB0aGUgYnJhbmNoIGhlYWRlciBpcyBub3QgZW1wdHkgYW5kIHRoZXJlIGlzIGF0IGxlYXN0IGEgdmFsaWQgYnJhbmNoIHF1ZXN0aW9uXG4gICAgLy8gYWxzbywgYWxsIHRoZSBicmFuY2ggcXVlc3Rpb25zIG5lZWQgdG8gcGFzcyB2YWxpZGF0aW9uIHRvIG1ha2UgYSBicmFuY2ggdmFsaWRcbiAgICB2YWxpZGF0ZUJyYW5jaElucHV0czogZnVuY3Rpb24gKHRoZV9icmFuY2hfb3duZXIpIHtcblxuICAgICAgICB2YXIgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICB0eXBlOiBjb25zdHMuREVGQVVMVF9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBicmFuY2hfb3duZXIgPSB0aGVfYnJhbmNoX293bmVyO1xuXG4gICAgICAgIGlmIChicmFuY2hfb3duZXIuYnJhbmNoLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5OT19CUkFOQ0hfSU5QVVRTX0ZPVU5EO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9jaGVjayBpZiBBTEwgdGhlIGJyYW5jaCBpbnB1dHMgYXJlIHZhbGlkIGFuZCByZXR1cm4gYXMgc29vbiBhcyB0aGUgZmlyc3QgaW52YWxpZCBpcyBmb3VuZFxuICAgICAgICAgICAgJChicmFuY2hfb3duZXIuYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnKiogaW5wdXQgZG9tIGlzX3ZhbGlkIGZvciBicmFuY2hlcycpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGlucHV0LmRvbS5pc192YWxpZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dC5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLklOVkFMSURfQlJBTkNIX0lOUFVUUztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9LFxuXG4gICAgLy8gYSBncm91cCBpcyB2YWxpZCB3aGVuIHRoZSBncm91cCBoZWFkZXIgaXMgbm90IGVtcHR5IGFuZCB0aGVyZSBpcyBhdCBsZWFzdCBhIHZhbGlkIGdyb3VwIHF1ZXN0aW9uXG4gICAgLy8gYWxzbywgYWxsIHRoZSBncm91cCBxdWVzdGlvbnMgbmVlZCB0byBwYXNzIHZhbGlkYXRpb24gdG8gbWFrZSBhIGdyb3VwIHZhbGlkXG4gICAgdmFsaWRhdGVHcm91cElucHV0czogZnVuY3Rpb24gKHRoZV9ncm91cF9pbnB1dCkge1xuXG4gICAgICAgIHZhciB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgIGlzX3ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBudWxsLFxuICAgICAgICAgICAgICAgIHR5cGU6IGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdyb3VwX2lucHV0ID0gdGhlX2dyb3VwX2lucHV0O1xuXG4gICAgICAgIGlmIChncm91cF9pbnB1dC5ncm91cC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuTk9fR1JPVVBfSU5QVVRTX0ZPVU5EO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9jaGVjayBpZiBBTEwgdGhlIGdyb3VwIGlucHV0cyBhcmUgdmFsaWQgYW5kIHJldHVybiBhcyBzb29uIGFzIHRoZSBmaXJzdCBpbnZhbGlkIGlzIGZvdW5kXG4gICAgICAgICAgICAkKGdyb3VwX2lucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuSU5WQUxJRF9HUk9VUF9JTlBVVFM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgfSxcblxuICAgIHZhbGlkYXRlSnVtcHNBZnRlclNvcnRpbmc6IGZ1bmN0aW9uIChpbnB1dHMpIHtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbiAgICAgICAgdmFyIGlucHV0c190b192YWxpZGF0ZSA9IGlucHV0cztcbiAgICAgICAgdmFyIGp1bXBzX2xpc3Rfd3JhcHBlcl9kb207XG4gICAgICAgIHZhciBqdW1wc19kb207XG4gICAgICAgIHZhciBqdW1wX2RvbTtcblxuICAgICAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0cyBiYXNlZCBhbmQgY3VycmVudCBvbmVcbiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGlucHV0c190b192YWxpZGF0ZS5sZW5ndGg7IGluZGV4KyspIHtcblxuICAgICAgICAgICAgdmFyIGlucHV0ID0gaW5wdXRzX3RvX3ZhbGlkYXRlW2luZGV4XTtcbiAgICAgICAgICAgIHZhciBhcmVfanVtcHNfdmFsaWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAvL2hpZGUgYWxsIGVycm9ycyBmb3IgYSBqdW1wIGluIHRoZSBkb21cbiAgICAgICAgICAgIGp1bXBzX2xpc3Rfd3JhcHBlcl9kb20gPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wcyAuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xpc3QnKTtcblxuICAgICAgICAgICAganVtcHNfZG9tID0ganVtcHNfbGlzdF93cmFwcGVyX2RvbS5maW5kKCdsaScpO1xuXG4gICAgICAgICAgICAvL2hpZGUgYWxsIHRoZSBqdW1wcyBlcnJvclxuICAgICAgICAgICAgaW5wdXQuaGlkZUp1bXBzRXJyb3JzKGp1bXBzX2RvbSk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGp1bXBfaW5kZXggPSAwOyBqdW1wX2luZGV4IDwgaW5wdXQuanVtcHMubGVuZ3RoOyBqdW1wX2luZGV4KyspIHtcblxuICAgICAgICAgICAgICAgIHZhciBqdW1wID0gaW5wdXQuanVtcHNbanVtcF9pbmRleF07XG5cbiAgICAgICAgICAgICAgICAvLyBBc3N1bWUgdGhlIGluZGV4IG9mIHRoZSA8bGk+IGluIHRoZSBsaXN0IGlzIHRoZSBzYW1lIG9mIHRoZSBpbmRleCBpbiB0aGUganVtcHMgb2JqZWN0XG4gICAgICAgICAgICAgICAganVtcF9kb20gPSBqdW1wc19kb20uZXEoanVtcF9pbmRleCk7XG5cbiAgICAgICAgICAgICAgICAvL3RvZG8gaWYgYW55IGVycm9yLCBoaWdobGlnaHQgdGhlIHdyb25nIGRlc3RpbmF0aW9uIGluIHRoZSBtYXJrdXBcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuaXNKdW1wVmFsaWQoanVtcCwgaW5wdXQpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGVycm9yc1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5zaG93U2luZ2xlSnVtcEVycm9ycyhqdW1wX2RvbSwganVtcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9rZWVwIHRyYWNrIHRoZSBqdW1wcyBub3cgYXJlIGludmFsaWRcbiAgICAgICAgICAgICAgICAgICAgYXJlX2p1bXBzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zZXQgaW5wdXQgaW4gdGhlIGRvbSBhcyBpbnZhbGlkLCBhbmQgYWxzbyB0aGUgZm9ybSBpZiBpdCBpcyB0aGUgb25seSBpbnZhbGlkIG9uZVxuICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihpbnB1dC5yZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy90b2RvIHdoYXQgaWYgSSBoYXZlIG11bHRpcGxlIGp1bXBzIHdpdGggZXJyb3JzP1xuICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLmhpZGVKdW1wVGFiRXJyb3IoanVtcF9kb20pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9JcyB0aGUgaW5wdXQgdmFsaWQgYXNpZGUgZnJvbSB0aGUganVtcHM/IFRoYXQgd291bGQgbWVhbiBhbGwgdGhlIGp1bXBzIHdlcmUgb2ssIGJ1dCB0aGVyZSBtaWdodCBiZSBvdGhlciBlcnJvcnNcbiAgICAgICAgICAgIC8vd2UganVzdCBuZWVkIHRvIGNoZWNrIHRoZSBvYmplY3QgcHJvcGVydGllcywgYXMgdGhleSBkbyBub3QgY2hhbmdlIHdoZW4gc29ydGluZ1xuICAgICAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gc2VsZi5pc0lucHV0T2JqZWN0VmFsaWQoaW5wdXQpICYmIGFyZV9qdW1wc192YWxpZDtcblxuICAgICAgICAgICAgLy9zZXQgaW5wdXQgdmFsaWRhdGlvbiBpY29uIGFjY29yZGluZ2x5XG4gICAgICAgICAgICBpZiAoaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0VmFsaWRJY29uKGlucHV0LnJlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihpbnB1dC5yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICAvL2NoZWNrIGlmIHRoZSBmb3JtIGlzIG5vdyB2YWxpZFxuICAgICAgICBpZiAoc2VsZi5hcmVGb3JtSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KSkge1xuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybVZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuXG4gICAgICAgICAgICAvL2VuYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAgICAgLy9lbmFibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1JbnZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuXG4gICAgICAgICAgICAvL2Rpc2FibGUgZm9ybSBkb3dubG9hZCBidXR0b25cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBwcmludCBhcyBwZGYgZG93bmxvYWQgYnV0dG9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sgaWYgYWxsIGlucHV0cyBhcmUgbm93IHZhbGlkIHRvIGVuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgICAgIGlmIChzZWxmLmFyZUFsbElucHV0c1ZhbGlkKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpIHtcbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGlzSW5wdXRPYmplY3RWYWxpZDogZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaXNfdmFsaWQgPSB0cnVlO1xuXG4gICAgICAgIC8vY2hlY2sgcXVlc3Rpb24gdGV4dCAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAoIXNlbGYuaXNRdWVzdGlvblRleHRWYWxpZChpbnB1dCkuaXNfdmFsaWQpIHtcbiAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cbiAgICAgICAgLy90ZXN0IG1pbiBhbmQgbWF4IGZvciBpbnRlZ2VyICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuSU5URUdFUl9UWVBFKSB7XG5cbiAgICAgICAgICAgIC8vaXMgbWluIGEgaW50P1xuICAgICAgICAgICAgaWYgKGlucHV0Lm1pbiAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuaXNWYWx1ZUludChpbnB1dC5taW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2lzIG1heCBhIGludD9cbiAgICAgICAgICAgIGlmIChpbnB1dC5tYXggIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmlzVmFsdWVJbnQoaW5wdXQubWF4KSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9JZiBib3RoIGFyZSBzZXQsIGFyZSB0aGV5IHZhbGlkP1xuICAgICAgICAgICAgaWYgKGlzX3ZhbGlkICYmIChpbnB1dC5taW4gIT09ICcnICYmIGlucHV0Lm1heCAhPT0gJycpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoaW5wdXQubWluKSA+IHBhcnNlRmxvYXQoaW5wdXQubWF4KSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pZiB0aGUgZGVmYXVsdCBhbnN3ZXIgaXMgc2V0LCBpcyBpdCB2YWxpZD9cbiAgICAgICAgICAgIGlmIChpbnB1dC5kZWZhdWx0ICE9PSAnJykge1xuICAgICAgICAgICAgICAgIGlmICghc2VsZi5pc1ZhbHVlSW50KGlucHV0LmRlZmF1bHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2RlZmF1bHQgYW5zd2VyIGlzIGEgdmFsaWQgaW50LCBpcyBpdCB3aXRoaW4gcmFuZ2U/XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5taW4gIT09ICcnICYmIHBhcnNlSW50KGlucHV0LmRlZmF1bHQsIDApIDwgaW5wdXQubWluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5taW4gIT09ICcnICYmIHBhcnNlSW50KGlucHV0LmRlZmF1bHQsIDApID4gaW5wdXQubWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIC8vdGVzdCBtaW4gYW5kIG1heCBmb3IgZGVjaW1hbCAoZmxvYXQpICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkRFQ0lNQUxfVFlQRSkge1xuICAgICAgICAgICAgLy9pcyBtaW4gYSBmbG9hdCBvciBhbiBpbnRlZ2VyP1xuICAgICAgICAgICAgaWYgKGlucHV0Lm1pbiAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShzZWxmLmlzVmFsdWVGbG9hdChpbnB1dC5taW4pIHx8IHNlbGYuaXNWYWx1ZUludChpbnB1dC5taW4pKSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pcyBtYXggYSBmbG9hdCBvciBpbnRlZ2VyP1xuICAgICAgICAgICAgaWYgKGlucHV0Lm1heCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShzZWxmLmlzVmFsdWVGbG9hdChpbnB1dC5tYXgpIHx8IHNlbGYuaXNWYWx1ZUludChpbnB1dC5tYXgpKSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9JZiBib3RoIGFyZSBzZXQsIGFyZSB0aGV5IHZhbGlkP1xuICAgICAgICAgICAgaWYgKGlzX3ZhbGlkICYmIChpbnB1dC5taW4gIT09ICcnICYmIGlucHV0Lm1heCAhPT0gJycpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoaW5wdXQubWluKSA+IHBhcnNlRmxvYXQoaW5wdXQubWF4KSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pZiB0aGUgZGVmYXVsdCBhbnN3ZXIgaXMgc2V0LCBpcyBpdCB2YWxpZD9cbiAgICAgICAgICAgIGlmIChpbnB1dC5kZWZhdWx0ICE9PSAnJykge1xuICAgICAgICAgICAgICAgIGlmICghKHNlbGYuaXNWYWx1ZUZsb2F0KGlucHV0LmRlZmF1bHQpIHx8IHNlbGYuaXNWYWx1ZUludChpbnB1dC5kZWZhdWx0KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZGVmYXVsdCBhbnN3ZXIgaXMgYSB2YWxpZCBudW1iZXIsIGlzIGl0IHdpdGhpbiByYW5nZT9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0Lm1pbiAhPT0gJycgJiYgcGFyc2VGbG9hdChpbnB1dC5kZWZhdWx0KSA8IGlucHV0Lm1pbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQubWluICE9PSAnJyAmJiBwYXJzZUZsb2F0KGlucHV0LmRlZmF1bHQpID4gaW5wdXQubWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIC8vY2hlY2sgcG9zc2libGUgYW5zd2VycyBmb3IgbXVsdGlwbGUgYW5zd2VyIHR5cGVzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUgIT09IC0xKSkge1xuICAgICAgICAgICAgJChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmlzUG9zc2libGVBbnN3ZXJWYWxpZChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyKS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIC8vZ3JvdXAgdHlwZSBidXQgZW1wdHk/ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUgJiYgaW5wdXQuZ3JvdXAubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIC8vYnJhbmNoIHR5cGUgYnV0IGVtcHR5PyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFICYmIGlucHV0LmJyYW5jaC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cbiAgICAgICAgcmV0dXJuIGlzX3ZhbGlkO1xuICAgIH1cbiAgICAsXG5cbiAgICB2YWxpZGF0ZUJlZm9yZVNhdmluZzogZnVuY3Rpb24gKGZvcm1fcmVmLCBpbnB1dHMpIHtcblxuICAgICAgICB2YXIgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgaW52YWxpZF9xdWVzdGlvbiA9ICcnO1xuICAgICAgICB2YXIgYXJlX2lucHV0c192YWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBhcmVfYnJhbmNoX2lucHV0c192YWxpZCA9IHRydWU7XG4gICAgICAgICQoaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICghaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbi5pc1ZhbGlkSW5wdXQoZm9ybV9yZWYsIGlucHV0LCBmYWxzZSwgZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoaW5wdXQpKTtcbiAgICAgICAgICAgICAgICBpbnZhbGlkX3F1ZXN0aW9uID0gaW5wdXQucXVlc3Rpb24udHJ1bmMoNTApO1xuICAgICAgICAgICAgICAgIGFyZV9pbnB1dHNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7Ly9leGl0IGxvb3Agb25seVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHF1ZXN0aW9uc190b3RhbDtcblxuICAgICAgICBpZiAoIWFyZV9pbnB1dHNfdmFsaWQpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBpbnZhbGlkX3F1ZXN0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sgdG90YWwgbnVtYmVyIG9mIHF1ZXN0aW9ucy9icmFuY2hlc1xuICAgICAgICBxdWVzdGlvbnNfdG90YWwgPSB1dGlscy5nZXRJbnB1dHNUb3RhbChpbnB1dHMpO1xuICAgICAgICBpZiAocXVlc3Rpb25zX3RvdGFsID4gY29uc3RzLklOUFVUU19NQVhfQUxMT1dFRCkge1xuICAgICAgICAgICAgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICAgICAgaXNfdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VzLmVycm9yLlRPT19NQU5ZX1FVRVNUSU9OU19GT1JfQ1VSUkVOVF9GT1JNICsgcXVlc3Rpb25zX3RvdGFsICsgJywgbGltaXQgaXMgJyArIGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQgKyAnISdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgdGl0bGVzIChtYWluIGZvcm0pXG4gICAgICAgIGlmICh1dGlscy5pc01heFRpdGxlTGltaXRFeGNlZWRlZChpbnB1dHMpKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBpc192YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZXMuZXJyb3IuVE9PX01BTllfVElUTEVTXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICAgICAgfVxuICAgICAgICAvL2NoZWNrIHRvdGFsIG51bWJlciBvZiB0aXRsZXMgKGJyYW5jaGVzKVxuICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAodXRpbHMuaXNNYXhUaXRsZUxpbWl0RXhjZWVkZWQoaW5wdXQuYnJhbmNoKSkge1xuICAgICAgICAgICAgICAgIGFyZV9icmFuY2hfaW5wdXRzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWFyZV9icmFuY2hfaW5wdXRzX3ZhbGlkKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBpc192YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZXMuZXJyb3IuVE9PX01BTllfVElUTEVTICsgJyAoYnJhbmNoKSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jaGVjayBqdW1wcyBkZXN0aW5hdGlvbnNcbiAgICAgICAgaWYgKCFpbXBvcnRfZm9ybV92YWxpZGF0aW9uLmFyZUp1bXBzRGVzdGluYXRpb25zVmFsaWQoaW5wdXRzKSkge1xuICAgICAgICAgICAgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICAgICAgaXNfdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VzLmVycm9yLkpVTVBTX0lOVkFMSURcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2Ygc2VhcmNoIGlucHV0c1xuICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA+IGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlcy5lcnJvci5UT09fTUFOWV9TRUFSQ0hfUVVFU1RJT05TXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9XG59XG4gICAgO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHZhbGlkYXRpb247XG5cbiIsIi8qXG4gc2V0IG9mIGNvbnN0YW50cyBhbmQgdmFsdWVzIHRvIHVzZSBhY3Jvc3MgdGhlIGFwcGxpY2F0aW9uXG4gd2UgdXNlIGBjb25zdHNgIGFzIGNvbnN0IGlzIGEgcmVzZXJ2ZWQgd29yZCBhbmQgYGNvbnN0YW50YCBpcyBhIHdpbmRvdyBnbG9iYWwgb2JqZWN0XG4gKi9cbid1c2Ugc3RyaWN0JztcblxuY29uc29sZS5sb2cod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuXG52YXIgY29uc3RzID0ge1xuXG4gICAgUFJPSkVDVF9VUkw6ICcnLFxuICAgIFBST0pFQ1RfTE9HT19VUkw6ICcnLFxuICAgIEJBQ0tfVVJMOiAnJyxcbiAgICBBUElfREVWRUxPUE1FTlRfR0VUX1BBVEg6ICcuLi9wcm9qZWN0LycsXG4gICAgQVBJX0RFVkVMT1BNRU5UX1BPU1RfUEFUSDogJy4uL3Bvc3RkdW1wLycsXG4gICAgQVBJX0RFVkVMT1BNRU5UX1BST0pFQ1Q6ICdwcm9qZWN0Lmpzb24nLFxuXG4gICAgQVBJX1BST0RVQ1RJT05fUEFUSDogJ2FwaS9pbnRlcm5hbC9mb3JtYnVpbGRlci8nLFxuICAgIEFQSV9NRURJQV9QQVRIOiAnYXBpL2ludGVybmFsL21lZGlhLycsXG4gICAgQVBJX1BST0pFQ1RfTE9HT19RVUVSWV9TVFJJTkc6ICc/dHlwZT1waG90byZuYW1lPWxvZ28uanBnJmZvcm1hdD1wcm9qZWN0X21vYmlsZV9sb2dvJyxcbiAgICBBUElfREVWRUxPUE1FTlRfU0VSVkVSOiAnaHR0cDovL2xvY2FsaG9zdC9+bW1lbmVnYXp6by9lcGljb2xsZWN0NS1zZXJ2ZXIvcHVibGljJywvL3RvIGJlIGNoYW5nZWQgYWNjb3JkaW5nbHlcbiAgICBGT1JNQlVJbERFUl9ST09UX0ZPTERFUjogJ2VwaWNvbGxlY3Q1LWZvcm1idWlsZGVyJyxcblxuICAgIFBST0pFQ1RfTkFNRV9NQVhfTEVOR0hUOiAxMDAsXG4gICAgRk9STV9OQU1FX01BWF9MRU5HSFQ6IDUwLFxuICAgIElOUFVUU19NQVhfQUxMT1dFRDogMzAwLFxuICAgIFRBQl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUOiAyMixcbiAgICBJTlBVVFNfQ09MTEVDVElPTl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUOiAyMixcbiAgICBJTlBVVFNfQ09MTEVDVElPTl9CUkFOQ0hfTkFNRV9NQVhfRElTUExBWV9MRU5HSFQ6IDI1LFxuICAgIElOUFVUU19DT0xMRUNUSU9OX0dST1VQX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUOiAyNSxcbiAgICBNQVhfTlVNQkVSX09GX05FU1RFRF9DSElMRF9GT1JNUzogNSxcbiAgICBBTklNQVRJT05fRkFTVDogMTAwLC8vbWlsbGlzZWNvbmRzXG4gICAgQU5JTUFUSU9OX05PUk1BTDogMTUwLFxuICAgIEFOSU1BVElPTl9TTE9XOiA1MDAsXG4gICAgQU5JTUFUSU9OX1NVUEVSX1NMT1c6IDEwMDAsXG5cbiAgICBGT1JNX05BTUVfUkVHRVg6IC9eW1xcd1xcLVxcc10rJC8sIC8vYWxsb3cgb25seSBhbHBoYW51bWVyaWMgY2hhcnMgYW5kICctJywgJ18nXG4gICAgRk9STV9ISUVSQVJDSFlfVFlQRTogJ2hpZXJhcmNoeScsXG4gICAgRk9STV9UWVBFOiAnZm9ybScsXG5cbiAgICBVTklRVUVTU19OT05FOiAnbm9uZScsXG4gICAgVU5JUVVFU1NfRk9STTogJ2Zvcm0nLFxuICAgIFVOSVFVRVNTX0hJRVJBUkNIWTogJ2hpZXJhcmNoeScsXG5cbiAgICAvL2FwcCBpZHMgbmFtZXNwYWNlXG4gICAgTkFNRVNQQUNFX1BSRUZJWDogJ2VjNV8nLFxuXG4gICAgLy9pbnB1dCB0eXBlcyBpY29uc1xuICAgIFRFWFRfVFlQRV9JQ09OOiAnZmEtdGV4dC13aWR0aCcsIC8vXG4gICAgVEVYVEFSRUFfVFlQRV9JQ09OOiAnZmEtc3RpY2t5LW5vdGUtbycsXG4gICAgTlVNRVJJQ19UWVBFX0lDT046ICdmYS1oYXNodGFnJyxcbiAgICBJTlRFR0VSX1RZUEVfSUNPTjogJ2ZhLWhhc2h0YWcnLFxuICAgIERFQ0lNQUxfVFlQRV9JQ09OOiAnZmEtaGFzaHRhZycsXG4gICAgREFURV9UWVBFX0lDT046ICdmYS1jYWxlbmRhcicsXG4gICAgVElNRV9UWVBFX0lDT046ICdmYS1jbG9jay1vJyxcbiAgICBSQURJT19UWVBFX0lDT046ICdmYS1kb3QtY2lyY2xlLW8nLFxuICAgIFJFQURNRV9UWVBFX0lDT046ICdmYS1maWxlLXRleHQtbycsXG4gICAgQ0hFQ0tCT1hfVFlQRV9JQ09OOiAnZmEtY2hlY2stc3F1YXJlLW8nLFxuICAgIERST1BET1dOX1RZUEVfSUNPTjogJ2ZhLWNhcmV0LXNxdWFyZS1vLWRvd24nLFxuICAgIEJBUkNPREVfVFlQRV9JQ09OOiAnZmEtYmFyY29kZScsXG4gICAgTE9DQVRJT05fVFlQRV9JQ09OOiAnZmEtbWFwLW1hcmtlcicsXG4gICAgQVVESU9fVFlQRV9JQ09OOiAnZmEtbWljcm9waG9uZScsXG4gICAgVklERU9fVFlQRV9JQ09OOiAnZmEtdmlkZW8tY2FtZXJhJyxcbiAgICBQSE9UT19UWVBFX0lDT046ICdmYS1jYW1lcmEtcmV0cm8nLFxuICAgIFBIT05FX1RZUEVfSUNPTjogJ2ZhLXBob25lJyxcbiAgICBCUkFOQ0hfVFlQRV9JQ09OOiAnZmEtY2xvbmUnLFxuICAgIEdST1VQX1RZUEVfSUNPTjogJ2ZhLWFsaWduLWp1c3RpZnknLFxuICAgIFNFQVJDSF9TSU5HTEVfVFlQRV9JQ09OOiAnZmEtc2VhcmNoJyxcbiAgICBTRUFSQ0hfTVVMVElQTEVfVFlQRV9JQ09OOiAnZmEtc2VhcmNoJyxcblxuICAgIC8vaW5wdXQgdHlwZXNcbiAgICBURVhUX1RZUEU6ICd0ZXh0JywgLy9cbiAgICBURVhUQVJFQV9UWVBFOiAndGV4dGFyZWEnLFxuICAgIElOVEVHRVJfVFlQRTogJ2ludGVnZXInLFxuICAgIERFQ0lNQUxfVFlQRTogJ2RlY2ltYWwnLFxuICAgIERBVEVfVFlQRTogJ2RhdGUnLFxuICAgIFRJTUVfVFlQRTogJ3RpbWUnLFxuICAgIFJBRElPX1RZUEU6ICdyYWRpbycsXG4gICAgQ0hFQ0tCT1hfVFlQRTogJ2NoZWNrYm94JyxcbiAgICBEUk9QRE9XTl9UWVBFOiAnZHJvcGRvd24nLFxuICAgIEJBUkNPREVfVFlQRTogJ2JhcmNvZGUnLFxuICAgIExPQ0FUSU9OX1RZUEU6ICdsb2NhdGlvbicsXG4gICAgQVVESU9fVFlQRTogJ2F1ZGlvJyxcbiAgICBWSURFT19UWVBFOiAndmlkZW8nLFxuICAgIFBIT1RPX1RZUEU6ICdwaG90bycsXG4gICAgQlJBTkNIX1RZUEU6ICdicmFuY2gnLFxuICAgIEdST1VQX1RZUEU6ICdncm91cCcsXG4gICAgUkVBRE1FX1RZUEU6ICdyZWFkbWUnLFxuICAgIFBIT05FX1RZUEU6ICdwaG9uZScsXG4gICAgU0VBUkNIX1NJTkdMRV9UWVBFOiAnc2VhcmNoc2luZ2xlJyxcbiAgICBTRUFSQ0hfTVVMVElQTEVfVFlQRTogJ3NlYXJjaG11bHRpcGxlJyxcblxuICAgIC8vZGF0ZSBmb3JtYXRzXG4gICAgREFURV9GT1JNQVRfMTogJ2RkL01NL1lZWVknLFxuICAgIERBVEVfRk9STUFUXzI6ICdNTS9kZC9ZWVlZJyxcbiAgICBEQVRFX0ZPUk1BVF8zOiAnWVlZWS9NTS9kZCcsXG4gICAgREFURV9GT1JNQVRfNDogJ01NL1lZWVknLFxuICAgIERBVEVfRk9STUFUXzU6ICdkZC9NTScsXG5cbiAgICAvL3RpbWUgZm9ybWF0c1xuICAgIFRJTUVfRk9STUFUXzE6ICdISDptbTpzcycsXG4gICAgVElNRV9GT1JNQVRfMjogJ2hoOm1tOnNzJyxcbiAgICBUSU1FX0ZPUk1BVF8zOiAnSEg6bW0nLFxuICAgIFRJTUVfRk9STUFUXzQ6ICdoaDptbScsXG4gICAgVElNRV9GT1JNQVRfNTogJ21tOnNzJyxcblxuICAgIC8vcmVzZXJ2ZXJkIHdvcmRzL2NoYXJzXG4gICAgLy9SRVNFUlZFRF9XT1JEX1NLSVBQM0Q6ICdfc2tpcHAzZF8nLFxuICAgIC8vUEFUSF9TRVBBUkFUT1JfTU9CSUxFX0NMSUVOVDogJ3wnLFxuXG4gICAgLy9pbnB1dCBwcm9wZXJ0aWVzIG5hbWVzXG4gICAgREVGQVVMVF9QUk9QRVJUWTogJ2RlZmF1bHQnLFxuICAgIFFVRVNUSU9OX1BST1BFUlRZOiAncXVlc3Rpb24nLFxuICAgIE1JTl9WQUxVRV9QUk9QRVJUWTogJ21pbicsXG4gICAgTUFYX1ZBTFVFX1BST1BFUlRZOiAnbWF4JyxcblxuICAgIC8vYnV0dG9uIGxhYmVsc1xuICAgIFNIT1dfSlVNUFM6ICdTaG93IGp1bXBzJyxcbiAgICBISURFX0pVTVBTOiAnSGlkZSBqdW1wcycsXG4gICAgSlVNUF9UT19FTkRfT0ZfRk9STV9SRUY6ICdFTkQnLFxuICAgIEpVTVBfVE9fRU5EX09GX0ZPUk1fTEFCRUw6ICdFbmQgb2YgZm9ybScsXG5cbiAgICAvL3Bvc3NpYmxlIGFuc3dlcnNcbiAgICBQT1NTSUJJTEVfQU5TV0VSU19DVVNUT01fSUQ6ICdwYV9jdXN0b21faWQnLFxuICAgIFBPU1NJQklMRV9BTlNXRVJfUExBQ0VIT0xERVI6ICdJIGFtIGEgcGxhY2Vob2xkZXIgYW5zd2VyJyxcbiAgICBVU0VfQU5TV0VSX0FTX1RJVExFOiAnVXNlIGFuc3dlciBhcyB0aXRsZScsXG4gICAgTUFYX1RJVExFX0xJTUlUX1JFQUNIRUQ6ICdMaW1pdCBvZiAzIHRpdGxlcyByZWFjaGVkJyxcblxuICAgIC8vcGF0aHNcbiAgICBWSUVXU19QQVRIOiAndmlld3MvJyxcblxuICAgIC8vYnV0dG9ucyBzdGF0dXNcbiAgICBCVE5fRU5BQkxFRDogJ2J0bi1lbmFibGVkJyxcbiAgICBCVE5fRElTQUJMRUQ6ICdidG4tZGlzYWJsZWQnLFxuXG4gICAgRU5BQkxFRF9TVEFURTogJ2VuYWJsZWQnLFxuICAgIERJU0FCTEVEX1NUQVRFOiAnZGlzYWJsZWQnLFxuXG4gICAgLy9hY3Rpb25cbiAgICBSRU5ERVJfQUNUSU9OX1VORE86ICd1bmRvJyxcbiAgICBSRU5ERVJfQUNUSU9OX0RPOiAnZG8nLFxuICAgIFJFTkRFUl9BQ1RJT05fVkFMSURBVEU6ICd2YWxpZGF0ZScsXG5cbiAgICAvL2Zvcm0gZXhwb3J0L2ltcG9ydFxuICAgIEZPUk1fRklMRV9BQ0NFUFRFRF9UWVBFOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgRk9STV9GSUxFX0VYVEVOU0lPTjogJ2pzb24nLFxuXG4gICAgLy9wb3NzaWJsZSBhbnN3ZXJzIGNzdiBpbXBvcnQvZXhwb3J0XG4gICAgQ1NWX0ZJTEVfQUNDRVBURURfVFlQRVM6IFsndGV4dC9jc3YnLCAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsJ10sIC8vTUlNRSB0eXBlc1xuICAgIENTVl9GSUxFX0VYVEVOU0lPTjogJ2Nzdidcbn07XG5cbi8vbXVsdGlwbGUgYW5zd2VycyB0eXBlc1xuY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUyA9IFtcbiAgICBjb25zdHMuUkFESU9fVFlQRSxcbiAgICBjb25zdHMuQ0hFQ0tCT1hfVFlQRSxcbiAgICBjb25zdHMuRFJPUERPV05fVFlQRSxcbiAgICBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUsXG4gICAgY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRVxuXTtcblxuXG5jb25zdHMuU0lOR0xFX0FOU1dFUl9UWVBFUyA9IFtcbiAgICBjb25zdHMuVEVYVF9UWVBFLFxuICAgIGNvbnN0cy5URVhUQVJFQV9UWVBFLFxuICAgIGNvbnN0cy5EQVRFX1RZUEUsXG4gICAgY29uc3RzLlRJTUVfVFlQRSxcbiAgICBjb25zdHMuSU5URUdFUl9UWVBFLFxuICAgIGNvbnN0cy5ERUNJTUFMX1RZUEUsXG4gICAgY29uc3RzLkJBUkNPREVfVFlQRSxcbiAgICBjb25zdHMuUkVBRE1FX1RZUEUsXG4gICAgY29uc3RzLlBIT05FX1RZUEVcbl07XG5cbi8vdGhlc2UgdHlwZXMgZG8gbm90IGhhdmUgdGhlIHJlcXVpcmVkL3VuaXF1ZW5lc3Mgb3B0aW9uXG5jb25zdHMuTUVESUFfQU5TV0VSX1RZUEVTID0gW1xuICAgIGNvbnN0cy5BVURJT19UWVBFLFxuICAgIGNvbnN0cy5QSE9UT19UWVBFLFxuICAgIGNvbnN0cy5WSURFT19UWVBFLFxuICAgIGNvbnN0cy5MT0NBVElPTl9UWVBFXG5dO1xuXG4vL3R5cGVzIHRoYXQgaGF2ZSB0aGUgdmVyaWZ5IG9wdGlvblxuY29uc3RzLlZFUklGWV9BTExPV0VEX1RZUEVTID0gW1xuICAgIGNvbnN0cy5URVhUX1RZUEUsXG4gICAgY29uc3RzLlRFWFRBUkVBX1RZUEUsXG4gICAgY29uc3RzLklOVEVHRVJfVFlQRSxcbiAgICBjb25zdHMuREVDSU1BTF9UWVBFLFxuICAgIGNvbnN0cy5CQVJDT0RFX1RZUEUsXG4gICAgY29uc3RzLlBIT05FX1RZUEVcbl07XG5cbi8vdHlwZXMgdGhhdCBoYXZlIHRoZSB1bmlxdWVzcyBvcHRpb25cbmNvbnN0cy5VTklRVUVORVNTX0FMTE9XRURfVFlQRVMgPSBbXG4gICAgY29uc3RzLlRFWFRfVFlQRSxcbiAgICBjb25zdHMuVEVYVEFSRUFfVFlQRSxcbiAgICBjb25zdHMuREFURV9UWVBFLFxuICAgIGNvbnN0cy5USU1FX1RZUEUsXG4gICAgY29uc3RzLklOVEVHRVJfVFlQRSwvL251bWVyaWNcbiAgICBjb25zdHMuREVDSU1BTF9UWVBFLC8vbnVtZXJpY1xuICAgIGNvbnN0cy5CQVJDT0RFX1RZUEUsXG4gICAgY29uc3RzLlBIT05FX1RZUEVcbl07XG5cbi8vdGhlc2UgdHlwZXMgRE8gaGF2ZSB0aGUgcmVxdWlyZWQgb3B0aW9uXG5jb25zdHMuUkVRVUlSRURfQUxMT1dFRF9UWVBFUyA9IFtcbiAgICBjb25zdHMuVEVYVF9UWVBFLFxuICAgIGNvbnN0cy5URVhUQVJFQV9UWVBFLFxuICAgIGNvbnN0cy5EQVRFX1RZUEUsXG4gICAgY29uc3RzLlRJTUVfVFlQRSxcbiAgICBjb25zdHMuSU5URUdFUl9UWVBFLFxuICAgIGNvbnN0cy5ERUNJTUFMX1RZUEUsXG4gICAgY29uc3RzLkJBUkNPREVfVFlQRSxcbiAgICBjb25zdHMuUEhPTkVfVFlQRSxcbiAgICBjb25zdHMuUkFESU9fVFlQRSxcbiAgICBjb25zdHMuQ0hFQ0tCT1hfVFlQRSxcbiAgICBjb25zdHMuRFJPUERPV05fVFlQRSxcbiAgICBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUsXG4gICAgY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRVxuXTtcblxuXG4vL2p1bXAgY29uZGl0aW9uc1xuY29uc3RzLkpVTVBfQ09ORElUSU9OUyA9IFtcbiAgICB7IGtleTogJ05PX0FOU1dFUl9HSVZFTicsIHRleHQ6ICdubyBhbnN3ZXIgZ2l2ZW4nIH0sXG4gICAgeyBrZXk6ICdJUycsIHRleHQ6ICdhbnN3ZXIgaXMnIH0sXG4gICAgeyBrZXk6ICdJU19OT1QnLCB0ZXh0OiAnYW5zd2VyIGlzIE5PVCcgfSxcbiAgICB7IGtleTogJ0FMTCcsIHRleHQ6ICdhbHdheXMnIH1cbl07XG5cbmNvbnN0cy5MSU1JVFMgPSB7XG4gICAgcXVlc3Rpb25fbGVuZ3RoOiAyNTUsXG4gICAgcmVhZG1lX2xlbmd0aDogMTAwMCxcbiAgICBkZWZhdWx0X2Fuc3dlcl9sZW5ndGg6IDI1NSxcbiAgICByZWdleF9sZW5ndGg6IDUwLFxuICAgIG1pbl92YWx1ZV9sZW5ndGg6IDUwLFxuICAgIG1heF92YWx1ZV9sZW5ndGg6IDUwLFxuICAgIHBvc3NpYmxlX2Fuc3dlcnNfbWF4OiAzMDAsXG4gICAgcG9zc2libGVfYW5zd2Vyc19tYXhfc2VhcmNoOiAxMDAwLFxuICAgIHRpdGxlc19tYXg6IDMsXG4gICAgbWF4X3N0YXRlczogMTAsXG4gICAgcG9zc2libGVfYW5zd2VyX3JlZl9sZW5ndGg6IDEzLFxuICAgIHBvc3NpYmxlX2Fuc3dlcl9tYXhfbGVuZ3RoOiAxNTAsXG4gICAgcG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZTogMTAwLFxuICAgIHNlYXJjaF9pbnB1dHNfbWF4OiA1LFxuICAgIHF1ZXN0aW9uX3ByZXZpZXdfbGVuZ3RoOiA4MFxufTtcblxuY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyA9IHtcbiAgICBwbGFjZWhvbGRlcjogJ1R5cGUgaGVyZS4uLicsXG4gICAgdG9vbGJhcjogW1xuICAgICAgICAvLyBbZ3JvdXBOYW1lLCBbbGlzdCBvZiBidXR0b25dXVxuICAgICAgICBbJ3N0eWxlJywgWydib2xkJywgJ2l0YWxpYycsICd1bmRlcmxpbmUnXV1cbiAgICBdXG59O1xuXG5jb25zdHMuUkVHRVggPSB7XG4gICAgb25seV9sZXR0ZXJzOiAnXlthLXpBLVpdKiQnLFxuICAgIG9ubHlfZGlnaXRzOiAnXlswLTldKyQnLFxuICAgIGxpbWl0X2xlbmd0aF8yMDogJ14uezEsMjB9JCcsXG4gICAgcG9zc2libGVfYW5zd2VyX3JlZjogJ15bYS16QS1aMC05XXsxM30kJyxcbiAgICBpbnB1dF9yZWY6ICdeW2EtekEtWjAtOS1fXXs2MH0kJ1xufTtcblxuY29uc3RzLlJFQURNRV9BTExPV0VEX1RBR1MgPSBbXG4gICAgJzxicj4nLFxuICAgICc8cD4nLFxuICAgICc8Yj4nLFxuICAgICc8c3Ryb25nPicsXG4gICAgJzxpPicsXG4gICAgJzxlbT4nLFxuICAgICc8dT4nXG5dO1xuXG5jb25zdHMuUE9TU0lCTEVfQU5TV0VSU19PUkRFUiA9IHtcbiAgICBBWjogJ2F6JyxcbiAgICBaQTogJ3phJyxcbiAgICBTSFVGRkxFOiAnc2h1ZmZsZSdcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY29uc3RzO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZXh0ZW5kX25hdGl2ZXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvL2Zyb20gaHR0cDovL3d3dy5yZWRpcHMubmV0L2phdmFzY3JpcHQvYXJyYXktbW92ZS9cbiAgICAvL21vdmUgYW4gZWxlbWVudCB3aXRoaW4gc2FtZSBhcnJheSBhbmQgc2hpZnQgb3RoZXIgZWxlbWVudHNcbiAgICBBcnJheS5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uIChmcm9tLCB0bykge1xuICAgICAgICAvLyBsb2NhbCB2YXJpYWJsZXNcbiAgICAgICAgdmFyIGksIHRtcDtcbiAgICAgICAgLy8gY2FzdCBpbnB1dCBwYXJhbWV0ZXJzIHRvIGludGVnZXJzXG4gICAgICAgIGZyb20gPSBwYXJzZUludChmcm9tLCAxMCk7XG4gICAgICAgIHRvID0gcGFyc2VJbnQodG8sIDEwKTtcbiAgICAgICAgLy8gaWYgcG9zaXRpb25zIGFyZSBkaWZmZXJlbnQgYW5kIGluc2lkZSBhcnJheVxuICAgICAgICBpZiAoZnJvbSAhPT0gdG8gJiYgZnJvbSA+PSAwICYmIGZyb20gPD0gdGhpcy5sZW5ndGggJiYgdG8gPj0gMCAmJiB0byA8PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gc2F2ZSBlbGVtZW50ICdmcm9tJ1xuICAgICAgICAgICAgdG1wID0gdGhpc1tmcm9tXTtcbiAgICAgICAgICAgIC8vIG1vdmUgZWxlbWVudCBkb3duIGFuZCBzaGlmdCBvdGhlciBlbGVtZW50cyB1cFxuICAgICAgICAgICAgaWYgKGZyb20gPCB0bykge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IGZyb207IGkgPCB0bzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNbaV0gPSB0aGlzW2kgKyAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBtb3ZlIGVsZW1lbnQgdXAgYW5kIHNoaWZ0IG90aGVyIGVsZW1lbnRzIGRvd25cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IGZyb207IGkgPiB0bzsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNbaV0gPSB0aGlzW2kgLSAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBwdXQgZWxlbWVudCAnZnJvbScgdG8gZGVzdGluYXRpb25cbiAgICAgICAgICAgIHRoaXNbdG9dID0gdG1wO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFN0cmluZy5wcm90b3R5cGUudHJ1bmMgPSBmdW5jdGlvbiAobikge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJzdHIoMCwgbiAtIDEpICsgKHRoaXMubGVuZ3RoID49IG4gPyAnLi4uJyA6ICcnKTtcbiAgICB9O1xuXG4gICAgaWYgKCFTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGgpIHtcbiAgICAgICAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gZnVuY3Rpb24gKHN0cikge1xuICAgICAgICAgICAgcmV0dXJuICF0aGlzLmluZGV4T2Yoc3RyKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvL2luZGV4T2YgcG9seWZpbGxcbiAgICAvLyBQcm9kdWN0aW9uIHN0ZXBzIG9mIEVDTUEtMjYyLCBFZGl0aW9uIDUsIDE1LjQuNC4xNFxuLy8gUmVmZXJlbmNlOiBodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjQuNC4xNFxuICAgIGlmICghQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoc2VhcmNoRWxlbWVudCwgZnJvbUluZGV4KSB7XG5cbiAgICAgICAgICAgIHZhciBrO1xuXG4gICAgICAgICAgICAvLyAxLiBMZXQgTyBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgVG9PYmplY3QgcGFzc2luZ1xuICAgICAgICAgICAgLy8gICAgdGhlIHRoaXMgdmFsdWUgYXMgdGhlIGFyZ3VtZW50LlxuICAgICAgICAgICAgaWYgKHRoaXMgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInRoaXNcIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBPID0gT2JqZWN0KHRoaXMpO1xuXG4gICAgICAgICAgICAvLyAyLiBMZXQgbGVuVmFsdWUgYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBHZXRcbiAgICAgICAgICAgIC8vICAgIGludGVybmFsIG1ldGhvZCBvZiBPIHdpdGggdGhlIGFyZ3VtZW50IFwibGVuZ3RoXCIuXG4gICAgICAgICAgICAvLyAzLiBMZXQgbGVuIGJlIFRvVWludDMyKGxlblZhbHVlKS5cbiAgICAgICAgICAgIHZhciBsZW4gPSBPLmxlbmd0aCA+Pj4gMDtcblxuICAgICAgICAgICAgLy8gNC4gSWYgbGVuIGlzIDAsIHJldHVybiAtMS5cbiAgICAgICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIDUuIElmIGFyZ3VtZW50IGZyb21JbmRleCB3YXMgcGFzc2VkIGxldCBuIGJlXG4gICAgICAgICAgICAvLyAgICBUb0ludGVnZXIoZnJvbUluZGV4KTsgZWxzZSBsZXQgbiBiZSAwLlxuICAgICAgICAgICAgdmFyIG4gPSArZnJvbUluZGV4IHx8IDA7XG5cbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhuKSA9PT0gSW5maW5pdHkpIHtcbiAgICAgICAgICAgICAgICBuID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gNi4gSWYgbiA+PSBsZW4sIHJldHVybiAtMS5cbiAgICAgICAgICAgIGlmIChuID49IGxlbikge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gNy4gSWYgbiA+PSAwLCB0aGVuIExldCBrIGJlIG4uXG4gICAgICAgICAgICAvLyA4LiBFbHNlLCBuPDAsIExldCBrIGJlIGxlbiAtIGFicyhuKS5cbiAgICAgICAgICAgIC8vICAgIElmIGsgaXMgbGVzcyB0aGFuIDAsIHRoZW4gbGV0IGsgYmUgMC5cbiAgICAgICAgICAgIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApO1xuXG4gICAgICAgICAgICAvLyA5LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW5cbiAgICAgICAgICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICAgICAgICAgICAgLy8gYS4gTGV0IFBrIGJlIFRvU3RyaW5nKGspLlxuICAgICAgICAgICAgICAgIC8vICAgVGhpcyBpcyBpbXBsaWNpdCBmb3IgTEhTIG9wZXJhbmRzIG9mIHRoZSBpbiBvcGVyYXRvclxuICAgICAgICAgICAgICAgIC8vIGIuIExldCBrUHJlc2VudCBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlXG4gICAgICAgICAgICAgICAgLy8gICAgSGFzUHJvcGVydHkgaW50ZXJuYWwgbWV0aG9kIG9mIE8gd2l0aCBhcmd1bWVudCBQay5cbiAgICAgICAgICAgICAgICAvLyAgIFRoaXMgc3RlcCBjYW4gYmUgY29tYmluZWQgd2l0aCBjXG4gICAgICAgICAgICAgICAgLy8gYy4gSWYga1ByZXNlbnQgaXMgdHJ1ZSwgdGhlblxuICAgICAgICAgICAgICAgIC8vICAgIGkuICBMZXQgZWxlbWVudEsgYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBHZXRcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgaW50ZXJuYWwgbWV0aG9kIG9mIE8gd2l0aCB0aGUgYXJndW1lbnQgVG9TdHJpbmcoaykuXG4gICAgICAgICAgICAgICAgLy8gICBpaS4gIExldCBzYW1lIGJlIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIFN0cmljdCBFcXVhbGl0eSBDb21wYXJpc29uIEFsZ29yaXRobSB0b1xuICAgICAgICAgICAgICAgIC8vICAgICAgICBzZWFyY2hFbGVtZW50IGFuZCBlbGVtZW50Sy5cbiAgICAgICAgICAgICAgICAvLyAgaWlpLiAgSWYgc2FtZSBpcyB0cnVlLCByZXR1cm4gay5cbiAgICAgICAgICAgICAgICBpZiAoayBpbiBPICYmIE9ba10gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGsrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV4dGVuZF9uYXRpdmVzO1xuXG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG5cbnZhciBmb3JtYnVpbGRlciA9IHtcbiAgICBjdXJyZW50X2Zvcm1fcmVmOiAnJyxcbiAgICBjdXJyZW50X2Zvcm1faW5kZXg6ICcnLFxuICAgIGN1cnJlbnRfaW5wdXRfcmVmOiAnJyxcbiAgICBpc19zb3J0aW5nOiBmYWxzZSxcbiAgICBmcm9tX2luZGV4OiAwLFxuICAgIHRvX2luZGV4OiAwLFxuICAgIHBvc3NpYmxlX2Fuc3dlcnM6IHtcbiAgICAgICAgZW5hYmxlZF9zb3J0YWJsZTogW10sXG4gICAgICAgIGZyb21faW5kZXg6IDAsXG4gICAgICAgIHRvX2luZGV4OiAwXG4gICAgfSxcbiAgICBzdGF0ZTogW10sXG4gICAgZG9tOiB7XG4gICAgICAgIGlucHV0X3Byb3BlcnRpZXM6ICcnLFxuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXI6ICcnLFxuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnM6ICcnLFxuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkOiAnJyxcbiAgICAgICAgaW5wdXRzX2NvbGxlY3Rpb246ICcnLFxuICAgICAgICBpbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZTogJycsXG4gICAgICAgIHBhcnRpYWxzOiB7fSxcbiAgICAgICAgaW5wdXRfcHJvcGVydGllc192aWV3czoge31cbiAgICB9LFxuICAgIGJyYW5jaDoge30sXG4gICAgcHJvamVjdF9kZWZpbml0aW9uOiB7fSwvL3RoaXMgZ2V0cyBsb2FkZWQgZHluYW1pY2FsbHlcblxuICAgIHNldHVwOiBmdW5jdGlvbiAocmVmLCBwYXJ0aWFscywgdmlld3MpIHtcblxuICAgICAgICAvL3NldCByZWZzIGZvciBjdXJyZW50IGZvcm0gKGFsd2F5cyB0b3AgcGFyZW50LCBvbiBsb2FkKVxuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gcmVmO1xuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPSAwO1xuICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb24gPSB7fTtcblxuICAgICAgICAvKiBjYWNoZSBzdGF0aWMgZG9tIHNlbGVjdG9ycyB0byBzcGVlZCB1cCBkeW5hbWljIHF1ZXJpZXNcbiAgICAgICAgIGFuZCBhbHNvIGZvciBjb25zaXN0ZW50IGFuZCBxdWljayBhY2Nlc3MgdGhyb3VnaG91dCB0aGUgY29kZSBhc1xuICAgICAgICAgd2UgYXJlIGFic3RyYWN0aW5nIHRoZSBkb20gYWNjZXNzIGF3YXkgYSBsaXR0bGUgYml0XG5cbiAgICAgICAgIHRvIGdldCB0aGUgZG9tIGVsZW1lbnQsIHdlIGNvbmNhdGVuYXRlIGZpbmQoKSBjYWxscywgYXMgaXQgaXMgZmFzdGVyXG4gICAgICAgICBodHRwOi8vanNwZXJmLmNvbS9maW5kLWNoYWluaW5nLzJcbiAgICAgICAgICovXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbSA9IHtcbiAgICAgICAgICAgIG92ZXJsYXk6ICQoJy53YWl0LW92ZXJsYXknKSxcbiAgICAgICAgICAgIGxvYWRlcjogJCgnLmxvYWRlcicpLFxuICAgICAgICAgICAgbmF2YmFyOiAkKCcubmF2YmFyJyksXG4gICAgICAgICAgICBmb3Jtc190YWJzOiAkKCcubWFpbiAubWFpbl9fdGFicycpLFxuICAgICAgICAgICAgZm9ybXNfdGFic19jb250ZW50OiAkKCcubWFpbiAubWFpbl9fdGFicy1jb250ZW50JyksXG4gICAgICAgICAgICBzYXZlX3Byb2plY3RfYnRuOiAkKCcubWFpbl9fdGFicy1idG5zIC5idG4tZ3JvdXAgLm1haW5fX3RhYnNfX3NhdmUtcHJvamVjdC1idG4nKSxcbiAgICAgICAgICAgIHVuZG9fYnRuOiAkKCcubWFpbl9fdGFicy1idG5zIC5idG4tZ3JvdXAgLm1haW5fX3RhYnNfX3VuZG8tYnRuJyksXG4gICAgICAgICAgICBtYWluX2NvbnRhaW5lcjogJCgnLmNvbnRhaW5lci1mbHVpZCcpLFxuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllczogJCgnIycgKyByZWYgKyAnLWlucHV0LXByb3BlcnRpZXMuaW5wdXQtcHJvcGVydGllcycpLFxuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyOiAkKCcjJyArIHJlZiArICctaW5wdXQtcHJvcGVydGllcy5pbnB1dC1wcm9wZXJ0aWVzID4gLnBhbmVsID4gLnBhbmVsLWJvZHkuaW5wdXRfcHJvcGVydGllc19fZm9ybXNfd3JhcHBlcicpLFxuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19idXR0b25zOiAkKCcjJyArIHJlZiArICctaW5wdXQtcHJvcGVydGllcyAuaW5wdXQtcHJvcGVydGllc19fYnV0dG9ucycpLFxuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZDogJCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJyksXG4gICAgICAgICAgICBpbnB1dHNfY29sbGVjdGlvbjogJCgnIycgKyByZWYgKyAnLWlucHV0cy1jb2xsZWN0aW9uLmlucHV0cy1jb2xsZWN0aW9uJyksXG4gICAgICAgICAgICBpbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZTogJCgnIycgKyByZWYgKyAnLWlucHV0cy1jb2xsZWN0aW9uLmlucHV0cy1jb2xsZWN0aW9uIC5wYW5lbCAucGFuZWwtYm9keScpLFxuICAgICAgICAgICAgaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZTogJCgndWwjaW5wdXRzLXRvb2xzLWxpc3QgbGkgZGl2LmlucHV0JylcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoJC5pc0VtcHR5T2JqZWN0KGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscykgJiYgcGFydGlhbHMpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscyA9IHBhcnRpYWxzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCQuaXNFbXB0eU9iamVjdChmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc192aWV3cykgJiYgdmlld3MpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzID0gdmlld3M7XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYnVpbGRlci5pc09wZW5pbmdGaWxlQnJvd3NlciA9IGZhbHNlO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdmb3JtYnVpbGRlciBvYmplY3QgcmVhZHknKTtcbiAgICB9XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gZm9ybWJ1aWxkZXI7XG4iLCIvKiBnbG9iYWwgdG9hc3RyLCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBkcmFnZ2FibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9kcmFnZ2FibGUnKTtcbnZhciBzb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3NvcnRhYmxlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtY2xpY2stY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19mb2N1c19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtZm9jdXMtY2FsbGJhY2snKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX2NoYW5nZV9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtY2hhbmdlLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc190aXRsZV9jaGVja2JveF9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtdGl0bGUtY2hlY2tib3gtY2FsbGJhY2snKTtcbnZhciBmb3JtX3RhYl9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2Zvcm0tdGFiLWNsaWNrLWNhbGxiYWNrJyk7XG52YXIgbW9kYWxfZWRpdF9mb3JtX25hbWVfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9tb2RhbC1mb3JtLWNhbGxiYWNrJyk7XG52YXIgZXhwb3J0X2Zvcm1fY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9leHBvcnQtZm9ybS1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgcHJpbnRfYXNfcGRmX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvcHJpbnQtYXMtcGRmLWNsaWNrLWNhbGxiYWNrJyk7XG5cbnZhciBpbXBvcnRfZm9ybV9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2ltcG9ydC1mb3JtLWNsaWNrLWNhbGxiYWNrJyk7XG5cbnZhciBkZWxldGVfYWxsX3F1ZXN0aW9uc19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2RlbGV0ZS1hbGwtcXVlc3Rpb25zLWNsaWNrLWNhbGxiYWNrJyk7XG5cbnZhciBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9zYXZlLXByb2plY3QtY2xpY2stY2FsbGJhY2snKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX2tleXVwX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy1rZXl1cC1jYWxsYmFjaycpO1xudmFyIG1vZGFsX3JlZ2V4X2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvbW9kYWwtcmVnZXgtY2FsbGJhY2snKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX2FkdmFuY2VkX3RhYl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtYWR2YW5jZWQtdGFiLWNsaWNrLWNhbGxiYWNrJyk7XG5cblxudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgcGFyc2UgPSByZXF1aXJlKCdhY3Rpb25zL3BhcnNlJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuXG52YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBwcm9qZWN0X25hbWUgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0Lm5hbWU7XG4gICAgdmFyIGZpcnN0X2Zvcm1fbmFtZSA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0ubmFtZTtcblxuICAgIC8vY29uZmlnIHRvYXN0IG5vdGlmaWNhdGlvbiBvcHRpb25zXG4gICAgd2luZG93LnRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgICBjbG9zZUJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgLy8gcHJvZ3Jlc3NCYXI6IHRydWUsXG4gICAgICAgIHBvc2l0aW9uQ2xhc3M6ICd0b2FzdC10b3AtY2VudGVyJyxcbiAgICAgICAgc2hvd0R1cmF0aW9uOiAnMjAwJyxcbiAgICAgICAgaGlkZUR1cmF0aW9uOiAnMzAwJyxcbiAgICAgICAgdGltZU91dDogJzIwMDAnXG4gICAgfTtcblxuICAgIC8vb24gU2FmYXJpIDksIEpTT04uc3RyaW5naWZ5KCkgY2F1c2VzIGEgYnVnLCBzbyB3ZSBvdmVycmlkZSBpdCB3aXRoIGEgTUROIHBvbHlmaWxsXG4gICAgaWYgKHV0aWxzLmlzU2FmYXJpKSB7XG4gICAgICAgIHdpbmRvdy5DaXJjdWxhckpTT04gPSB1dGlscy5KU09OUG9seWZpbGw7XG4gICAgfVxuXG4gICAgLy9zZXQgYmFjayBidXR0b25cbiAgICAkKCcubmF2YmFyLWJhY2stYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlscy5nb0JhY2soKTtcbiAgICB9KTtcblxuICAgIC8vc2V0IHVuZG8gYnV0dG9uXG4gICAgJCgnLm1haW5fX3RhYnNfX3VuZG8tYnRuJykub2ZmKCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB1bmRvLmV4ZWN1dGUoKTtcbiAgICB9KTtcblxuICAgIC8vdG9kbyBkaXNhYmxlIHRleHQgc2VsZWN0aW9uIGlmIGl0IGNhdXNlcyBwcm9ibGVtcyB3aXRoIGRyYWcgYW5kIGRyb3BcblxuICAgIC8vbWFrZSB0ZXh0IG5vdCBzZWxlY3RhYmxlIGZvciBzb3J0YWJsZVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5kaXNhYmxlU2VsZWN0aW9uKCk7XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8qKioqKioqIGF0dGFjaCBVSSBkb20gZXZlbnRzIGFuZCBldmVudCBoYW5kbGVycyAqKioqKioqKiovXG5cbiAgICBkcmFnZ2FibGUoKTtcblxuICAgIC8vaW5pdCBpbnB1dHMgY29sbGVjdGlvbiBhcyBhIHNvcnRhYmxlIChpdCBpcyBhbHNvIGRyb3BwYWJsZSBieSBkZWZhdWx0KVxuICAgIHNvcnRhYmxlKCk7XG5cbiAgICAvL2hhbmRsZSBjbGljayBhY3Rpb24gb24gaW5wdXQgcHJvcGVydGllcyBwYW5lbCBpbiB0aGUgcmlnaHQgc2lkZWJhciAodXNlIGV2ZW50IGRlbGVnYXRpb24pXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub2ZmKCkub24oJ2NsaWNrJywgJ2J1dHRvbi5idG4sIC5wb3NzaWJsZV9hbnN3ZXItbW9yZS1hY3Rpb24nLCBpbnB1dF9wcm9wZXJ0aWVzX2NsaWNrX2NhbGxiYWNrKTtcblxuICAgIC8vaGFuZGxlIGNsaWNrIG9uIHRoZSBhZHZhbmNlZCB0YWIgYnV0dG9uXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub24oJ2NsaWNrJywgJy5hZHZhbmNlZC10YWInLCBpbnB1dF9wcm9wZXJ0aWVzX2FkdmFuY2VkX3RhYl9jYWxsYmFjayk7XG5cbiAgICAvL2F0dGFjaCBkZWxlZ2F0ZSBldmVudCB0byBtb3VzZWRvd24gc28gd2UgY292ZXIgYm90aCBjbGlja3MgYW5kIGNsaWNrIGhvbGQgKyBkcmFnXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VycyBmb2N1cyBvbiBhIHNlbGVjdCBvZiB0aGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdmb2N1cycsICdzZWxlY3QnLCBpbnB1dF9wcm9wZXJ0aWVzX2ZvY3VzX2NhbGxiYWNrKTtcblxuICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgY2hhbmdlIHNlbGVjdGVkIG9wdGlvbiBpbiB0aGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdjaGFuZ2UnLCAnc2VsZWN0JywgaW5wdXRfcHJvcGVydGllc19jaGFuZ2VfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VycyBjaGVjay91bmNrZWNrIHRpdGxlIGluIHRoZSBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub24oJ2NoYW5nZScsICcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fdGl0bGUtZmxhZyBpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfdGl0bGVfY2hlY2tib3hfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIG5hdmlnYXRlcyBmb3JtIGhpZXJhcmNoeSB1c2luZyB0aGUgZm9ybXMgdGFic1xuICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLm9uKCdjbGljaycsICdhW2RhdGEtdG9nZ2xlPVwidGFiXCJdJywgZm9ybV90YWJfY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIG5hdmlnYXRlcyBmb3JtIGhpZXJhcmNoeSB1c2luZyB0aGUgZm9ybXMgdGFic3hcbiAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIHdhbnRzIHRvIGV4cG9ydCBhIGZvcm1cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24ub24oJ2NsaWNrJywgJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgIC8vYXZvaWQgYW55IGFjdGlvbiBpZiBvcHRpb24gaW4gZHJvcGRvd24gaXMgZGlzYWJsZWRcbiAgICAgICAgaWYgKCQoZS50YXJnZXQpLnBhcmVudCgpLmhhc0NsYXNzKGNvbnN0cy5ESVNBQkxFRF9TVEFURSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwb3J0X2Zvcm1fY2xpY2tfY2FsbGJhY2soKTtcbiAgICB9KTtcblxuICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlciB3YW50cyB0byBleHBvcnQgYSBmb3JtXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLm9uKCdjbGljaycsICcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgLy9hdm9pZCBhbnkgYWN0aW9uIGlmIG9wdGlvbiBpbiBkcm9wZG93biBpcyBkaXNhYmxlZFxuICAgICAgICBpZiAoJChlLnRhcmdldCkucGFyZW50KCkuaGFzQ2xhc3MoY29uc3RzLkRJU0FCTEVEX1NUQVRFKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cblxuICAgICAgICBwcmludF9hc19wZGZfY2xpY2tfY2FsbGJhY2soKTtcbiAgICB9KTtcblxuICAgIC8vdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gaW1wb3J0IGEgZm9ybVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2Zvcm0taW1wb3J0IGlucHV0Jykub2ZmKCdjaGFuZ2UnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpbXBvcnRfZm9ybV9jbGlja19jYWxsYmFjayh0aGlzLmZpbGVzKTtcbiAgICAgICAgJCh0aGlzKS52YWwobnVsbCk7XG4gICAgfSk7XG5cbiAgICAvL3RyaWdnZXJlZCB3aGVuIHRoZSB1c2VyIHdhbnRzIHRvIHJlbW92ZSBhbGwgcXVlc3Rpb25zIGF0IG9uY2VcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24ub24oJ2NsaWNrJywgJy5pbnB1dHMtY29sbGVjdGlvbl9fZGVsZXRlLWFsbC1xdWVzdGlvbnMnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBkZWxldGVfYWxsX3F1ZXN0aW9uc19jYWxsYmFjaygpO1xuICAgIH0pO1xuXG4gICAgLy92YWxpZGF0ZSBxdWVzdGlvbiB0ZXh0LyBncm91cCBvciBicmFuY2ggaGVhZGVyLCBwb3NzaWJsZSBhbnN3ZXIgdGV4dCBvbiBrZXl1cFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzXG4gICAgICAgIC5vZmYoJ2tleXVwJylcbiAgICAgICAgLm9uKCdrZXl1cCcsICcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gaW5wdXQsIC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0X19wb3NzaWJsZV9hbnN3ZXJfaXRlbSBpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2spO1xuXG4gICAgLy9ibHVyIGxpbmtzIGFmdGVyIGNsb3NpbmcgbW9kYWxzXG4gICAgJChkb2N1bWVudCkub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICQoJ2EnKS5ibHVyKCk7XG4gICAgfSk7XG5cbiAgICAvL3Nob3cgcHJvamVjdCBuYW1lIGluIG5hdmJhclxuICAgIGZvcm1idWlsZGVyLmRvbS5uYXZiYXIuZmluZCgnLm5hdmJhci1wcm9qZWN0LW5hbWUgc3BhbicpLnRleHQocHJvamVjdF9uYW1lKTtcblxuICAgIC8vc2hvdyBwcm9qZWN0IGxvZ28gaW4gc2lkZWJhclxuICAgIC8vJ3ZhciBsb2dvX3VybCA9IGh0dHBzOi8vdGVzdC5lcGljb2xsZWN0Lm5ldC9hcGkvaW50ZXJuYWwvanNvbi9tZWRpYS9hbnRzLXByb2plY3Q/dHlwZT1waG90byZuYW1lPWxvZ28uanBnJmZvcm1hdD1wcm9qZWN0X21vYmlsZV9sb2dvJ1xuICAgIGNvbnNvbGUubG9nKGNvbnN0cy5QUk9KRUNUX1VSTCk7XG4gICAgY29uc29sZS5sb2cod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuXG4gICAgLy9mb3IgbGl2ZSBzZXJ2ZXIgb25seVxuICAgIC8vIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCdsb2NhbGhvc3QvJykgPT09IC0xICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJ2VwaWNvbGxlY3Q1LWZvcm1idWlsZGVyLycpID09PSAtMSkge1xuICAgIHV0aWxzLnNldFByb2plY3RMb2dvVXJsKCk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLm5hdmJhci5maW5kKCcubmF2YmFyLXByb2plY3QtbmFtZSBpbWcnKS5hdHRyKCdzcmMnLCBjb25zdHMuUFJPSkVDVF9MT0dPX1VSTCk7XG4gICAgLy8gfVxuICAgIC8vZWxzZSB7XG4gICAgLy8gIGZvcm1idWlsZGVyLmRvbS5uYXZiYXIuZmluZCgnLm5hdmJhci1wcm9qZWN0LW5hbWUgaW1nJykucmVtb3ZlKCk7XG4gICAgLy8gfVxuXG4gICAgLy9zaG93IG5hbWUgb2YgZmlyc3QgZm9ybSBpbiBuYXZiYXIgYW5kIGlucHV0cyBjb2xsZWN0aW9uIGNvbnRhaW5lclxuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJykudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19GT1JNKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoZmlyc3RfZm9ybV9uYW1lLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KCcnKTtcblxuICAgIC8vc2V0IGZvcm0gbmFtZSBpbiBmb3JtIHRhYlxuICAgIHVpLmZvcm1zX3RhYnMuc2V0Rmlyc3RGb3JtVGFiTmFtZShmaXJzdF9mb3JtX25hbWUpO1xuXG4gICAgLy9oaWRlIHByb3BlcnRpZXMgcGFuZWwgYnV0dG9ucyBhcyBubyBpbnB1dCBpcyBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dCgpO1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8vaW5pdCBoZWxwIHBvcG92ZXJzIGFuZCB0b29sdGlwc1xuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInBvcG92ZXJcIl0nKS5wb3BvdmVyKCk7XG4gICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoKTtcblxuICAgIC8vZWRpdCBmb3JtIG5hbWUgbW9kYWwgaGFuZGxlclxuICAgICQoJy5tYWluX19tb2RhbC0tZWRpdC1mb3JtLW5hbWUnKS5vbignc2hvdy5icy5tb2RhbCcsIG1vZGFsX2VkaXRfZm9ybV9uYW1lX2NhbGxiYWNrKTtcblxuICAgIC8vcmVnZXggbW9kYWwgaGFuZGxlclxuICAgICQoJyNpbmZvLXJlZ2V4Jykub24oJ3Nob3cuYnMubW9kYWwnLCBtb2RhbF9yZWdleF9jYWxsYmFjayk7XG5cbiAgICAvL3JlbmRlciBwcm9qZWN0IGZyb20gcHJvamVjdCBkZWZpbml0aW9uIGpzb25cbiAgICBmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID0gY29uc3RzLlJFTkRFUl9BQ1RJT05fRE87XG4gICAgJC53aGVuKHBhcnNlLnJlbmRlclByb2plY3QoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkudGhlbihmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLy9zZXQgaW5pdGlhbCBzdGF0ZSwgbm93IGFmdGVyIHJlbmRlciBhbGwgdGhlIGlucHV0cyBoYXZlIHRoZSAnZG9tJyBwcm9wZXJ0eVxuICAgICAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgICAgICBwcm9qZWN0X2RlZmluaXRpb246IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSksXG4gICAgICAgICAgICBhY3RpdmVfaW5wdXRfcmVmOiBudWxsLFxuICAgICAgICAgICAgYWN0aXZlX2Zvcm1faW5kZXg6IDAsXG4gICAgICAgICAgICBhY3RpdmVfZm9ybV9yZWY6IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0ucmVmXG4gICAgICAgIH07XG5cbiAgICAgICAgLy9zZXQgc3RhdGUgYXMgdGhlIHN0YXJ0aW5nIHN0YXRlIHB1c2hpbmcgYSBkZWVwIGNvcHlcbiAgICAgICAgZm9ybWJ1aWxkZXIuc3RhdGUucHVzaChzdGF0ZSk7XG5cbiAgICAgICAgLy9oaWRlIGxvYWRlciBhbmQgc2hvdyBmb3JtYnVpbGRlciBjb250YWluZXJzXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5sb2FkZXIuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICBmb3JtYnVpbGRlci5kb20ubmF2YmFyLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5oaWRlKCkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5tYWluX2NvbnRhaW5lci5yZW1vdmVDbGFzcygnaGlkZGVuJykuaGlkZSgpLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIH0pO1xuXG4gICAgJCh3aW5kb3cpLm9uKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGxlYXZlPyc7XG4gICAgfSk7XG5cbiAgICAvKipcbiAqIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbCgpIHBvbHlmaWxsXG4gKiBodHRwczovL2dvbWFrZXRoaW5ncy5jb20vaG93LXRvLXJlcGxhY2UtYS1zZWN0aW9uLW9mLWEtc3RyaW5nLXdpdGgtYW5vdGhlci1vbmUtd2l0aC12YW5pbGxhLWpzL1xuICogQGF1dGhvciBDaHJpcyBGZXJkaW5hbmRpXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuICAgIGlmICghU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlQWxsKSB7XG4gICAgICAgIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbCA9IGZ1bmN0aW9uIChzdHIsIG5ld1N0cikge1xuICAgICAgICAgICAgLy8gSWYgYSByZWdleCBwYXR0ZXJuXG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHN0cikudG9Mb3dlckNhc2UoKSA9PT0gJ1tvYmplY3QgcmVnZXhwXScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKHN0ciwgbmV3U3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIGEgc3RyaW5nXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKG5ldyBSZWdFeHAoc3RyLCAnZycpLCBuZXdTdHIpO1xuICAgICAgICB9O1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaW5pdDtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xuXG52YXIgbWVzc2FnZXMgPSB7XG5cbiAgICBsYWJlbHM6IHtcbiAgICAgICAgRURJVElOR19GT1JNOiAnRm9ybSA+ICcsXG4gICAgICAgIEVESVRJTkdfQlJBTkNIOiAnQnJhbmNoID4gJyxcbiAgICAgICAgRURJVElOR19HUk9VUDogJ0dyb3VwID4gJyxcbiAgICAgICAgRURJVElOR19ORVNURURfR1JPVVA6ICcgR3JvdXA6ICcsXG4gICAgICAgIEVYSVRfRURJVElORzogJ0JhY2snLFxuICAgICAgICBBRERfQlJBTkNIX0lOUFVUU19IRVJFOiAnQWRkIGJyYW5jaCBxdWVzdGlvbnMgaGVyZScsXG4gICAgICAgIEFERF9HUk9VUF9JTlBVVFNfSEVSRTogJ0FkZCBncm91cCBxdWVzdGlvbnMgaGVyZSdcbiAgICB9LFxuICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgSU5QVVRfVkFMSUQ6ICdRdWVzdGlvbiB2YWxpZCEnLFxuICAgICAgICBGT1JNX0lNUE9SVEVEOiAnRm9ybSBpbXBvcnQgc3VjY2VlZGVkIScsXG4gICAgICAgIFBPU1NJQkxFX0FOU1dFUlNfSU1QT1JURUQ6ICdQb3NzaWJsZSBhbnN3ZXJzIGltcG9ydCBzdWNjZWVkZWQhJyxcbiAgICAgICAgUFJPSkVDVF9TQVZFRDogJ1Byb2plY3Qgc2F2ZWQhJyxcbiAgICAgICAgSlVNUF9ERUxFVEVEOiAnSnVtcCBkZWxldGVkIScsLy90aGlzIHNob3VsZCBiZSBhIHdhcm5pbmdcbiAgICAgICAgSU5QVVRfQ09QSUVEOiAnUXVlc3Rpb24gY29waWVkISdcbiAgICB9LFxuICAgIGVycm9yOiB7XG4gICAgICAgIEZPUk1fQ0FOTk9UX0JFX0RFTEVURUQ6ICdGb3JtIGNhbm5vdCBiZSBkZWxldGVkJyxcbiAgICAgICAgRk9STV9OQU1FX0VNUFRZOiAnRm9ybSBuYW1lIGNhbm5vdCBiZSBlbXB0eScsXG4gICAgICAgIEZPUk1fTkFNRV9JTlZBTElEOiAnRm9ybSBuYW1lIGlzIGludmFsaWQnLFxuICAgICAgICBGT1JNX0ZJTEVfSU5WQUxJRDogJ0Zvcm0gZmlsZSBpcyBpbnZhbGlkJyxcbiAgICAgICAgRk9STV9JU19JTlZBTElEOiAnRm9ybSBpcyBpbnZhbGlkJyxcbiAgICAgICAgRk9STV9OQU1FX0VYSVNUOiAnRm9ybSBuYW1lIGV4aXN0cycsXG4gICAgICAgIElOUFVUX05PVF9WQUxJRDogJ1F1ZXN0aW9uIE5PVCB2YWxpZCEnLFxuICAgICAgICBJTlBVVF9OT1RfU0VMRUNURUQ6ICdObyBxdWVzdGlvbiBzZWxlY3RlZCcsXG4gICAgICAgIFBPU1NJTEVfQU5TV0VSU19DVVNUT01fSURfQ0FOTk9UX1NXSVRDSF9CQUNLOiAnQ2Fubm90IHN3aXRjaCBiYWNrIHRvIGJhc2ljIG1vZGUnLFxuICAgICAgICBRVUVTVElPTl9URVhUX0VNUFRZOiAnVGhpcyBmaWVsZCBjYW5ub3QgYmUgZW1wdHknLFxuICAgICAgICBQT1NTSUJMRV9BTlNXRVJfRU1QVFk6ICdBbnN3ZXIgdGV4dCBjYW5ub3QgYmUgZW1wdHknLFxuICAgICAgICBQT1NTSUJMRV9BTlNXRVJfRFVQTElDQVRFRF9JREVOVElGSUVSOiAnRHVwbGljYXRlZCBpZGVudGlmaWVyLCBwbGVhc2UgcmVtb3ZlJyxcbiAgICAgICAgVkFMVUVfTVVTVF9CRV9JTlRFR0VSOiAnVmFsdWUgbXVzdCBiZSBhbiBpbnRlZ2VyJyxcbiAgICAgICAgTUlOX01VU1RfQkVfU01BTExFUl9USEFOX01BWDogJ01pbiB2YWx1ZSBtdXN0IGJlIHNtYWxsZXIgdGhhbiBNYXgnLFxuICAgICAgICBJTklUSUFMX0FOU1dFUl9PVVRfT0ZfUkFOR0U6ICdWYWx1ZSBpcyBvdXQgb2YgcmFuZ2UnLFxuICAgICAgICBJTklUSUFMX0FOU1dFUl9OT1RfTUFUQ0hJTkdfUkVHRVg6ICdWYWx1ZSBkb2VzIG5vdCBtYXRjaCByZWdleCcsXG4gICAgICAgIElOSVRJQUxfQU5TV0VSX05PVF9QSE9ORV9OVU1CRVI6ICdWYWx1ZSBpcyBub3QgYSBwaG9uZSBudW1iZXInLFxuICAgICAgICBOT19RVUVTVElPTl9URVhUX1lFVDogJ05vIHF1ZXN0aW9uIHRleHQgeWV0JyxcbiAgICAgICAgTk9fQlJBTkNIX0hFQURFUl9ZRVQ6ICdObyBicmFuY2ggaGVhZGVyIHlldCcsXG4gICAgICAgIE5PX0dST1VQX0hFQURFUl9ZRVQ6ICdObyBncm91cCBoZWFkZXIgeWV0JyxcbiAgICAgICAgTk9fQlJBTkNIX0lOUFVUU19GT1VORDogJ05vIGJyYW5jaCBxdWVzdGlvbnMgZm91bmQnLFxuICAgICAgICBOT19HUk9VUF9JTlBVVFNfRk9VTkQ6ICdObyBncm91cCBxdWVzdGlvbnMgZm91bmQnLFxuICAgICAgICBJTlZBTElEX0JSQU5DSF9JTlBVVFM6ICdUaGVyZSBhcmUgaW52YWxpZCBicmFuY2ggcXVlc3Rpb25zJyxcbiAgICAgICAgSU5WQUxJRF9HUk9VUF9JTlBVVFM6ICdUaGVyZSBhcmUgaW52YWxpZCBncm91cCBxdWVzdGlvbnMnLFxuICAgICAgICBKVU1QX0NPTkRJVElPTl9OT1RfU0VMRUNURUQ6ICdZb3UgbXVzdCBjaG9vc2UgYSBjb25kaXRpb24nLFxuICAgICAgICBKVU1QX0FOU1dFUl9OT1RfU0VMRUNURUQ6ICdZb3UgbXVzdCBjaG9vc2UgYW4gYW5zd2VyJyxcbiAgICAgICAgSlVNUF9ERVNUSU5BVElPTl9OT1RfU0VMRUNURUQ6ICdZb3UgbXVzdCBjaG9vc2UgYSB2YWxpZCBkZXN0aW5hdGlvbicsXG4gICAgICAgIEpVTVBfREVTVElOQVRJT05fSU5WQUxJRDogJ0ludmFsaWQgZGVzdGluYXRpb24nLFxuICAgICAgICBQUk9KRUNUX05PVF9TQVZFRDogJ1Byb2plY3QgZXJyb3IhJyxcbiAgICAgICAgSlVNUF9JTlZBTElEOiAnSW52YWxpZCBqdW1wIG9uIHF1ZXN0aW9uOicsXG4gICAgICAgIEpVTVBTX0lOVkFMSUQ6ICdTb21lIGp1bXBzIGFyZSBpbnZhbGlkJyxcbiAgICAgICAgUE9TU0lCTEVfQU5TV0VSU19JTlZBTElEOiAnU29tZSBwb3NzaWJsZSBhbnN3ZXJzIGFyZSBpbnZhbGlkJyxcbiAgICAgICAgQ1NWX0ZJTEVfSU5WQUxJRDogJ0NTViBmaWxlIGlzIGludmFsaWQhJyxcbiAgICAgICAgQlJPV1NFUl9OT1RfU1VQUE9SVEVEOiAnQnJvd3NlciBub3Qgc3VwcG9ydGVkJyxcbiAgICAgICAgTUFYX1FVRVNUSU9OU19MSU1JVF9SRUFDSEVEOiAnUXVlc3Rpb25zIGxpbWl0IHJlYWNoZWQgZm9yIHRoaXMgZm9ybSEnLFxuICAgICAgICBUT09fTUFOWV9TRUFSQ0hfUVVFU1RJT05TOiAnVG9vIG1hbnkgc2VhcmNoIHF1ZXN0aW9ucywgb25seSAnICsgY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCArICcgIHBlciBwcm9qZWN0IGFyZSBhbGxvd2VkIScsXG4gICAgICAgIFRPT19NQU5ZX1RJVExFUzogJ1RvbyBtYW55IHRpdGxlcycsXG4gICAgICAgIFRPT19NQU5ZX1FVRVNUSU9OU19GT1JfQ1VSUkVOVF9GT1JNOiAnVG9vIG1hbnkgcXVlc3Rpb25zIGZvciB0aGlzIGZvcm06ICcsXG4gICAgICAgIFFVRVNUSU9OX0xFTkdUSF9MSU1JVF9FWENFRURFRDogJ0NoYXJhY3RlcnMgbGltaXQgZXhjZWVkZWQnXG4gICAgfSxcbiAgICB3YXJuaW5nOiB7XG4gICAgICAgIFBPU1NJQklMRV9BTlNXRVJfSEFTX0xJTktFRF9KVU1QOiAnVGhlcmUgaXMgYSBqdW1wIGxpbmtlZCB0byB0aGlzIGFuc3dlciwgcGxlYXNlIHJlbW92ZSBpdCBmaXJzdCEnLFxuICAgICAgICBJTlBVVF9ERUxFVEVEOiAnUXVlc3Rpb24gZGVsZXRlZCEnLFxuICAgICAgICBGT1JNX0RFTEVURUQ6ICdGb3JtIGRlbGV0ZWQhJyxcbiAgICAgICAgU0VBUkNIX0lOUFVUU19MSU1JVF9SRUFDSEVEOiAnU2VhcmNoIHF1ZXN0aW9ucyBsaW1pdCByZWFjaGVkISdcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1lc3NhZ2VzO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIG9wdGlvbnMgPSB7XG4gICAgY2xvc2VCdXR0b246IHRydWUsXG4gICAgcG9zaXRpb25DbGFzczogJ3RvYXN0LXRvcC1jZW50ZXInLFxuICAgIHByZXZlbnREdXBsaWNhdGVzOiB0cnVlLFxuICAgIG9uY2xpY2s6IG51bGwsXG4gICAgc2hvd0R1cmF0aW9uOiA1MDAsXG4gICAgaGlkZUR1cmF0aW9uOiA1MDAsXG4gICAgZXh0ZW5kZWRUaW1lT3V0OiAwLFxuICAgIHNob3dNZXRob2Q6ICdmYWRlSW4nLFxuICAgIGhpZGVNZXRob2Q6ICdmYWRlT3V0J1xufTtcblxudmFyIHRvYXN0ID0ge1xuICAgIHNob3dTdWNjZXNzOiBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICBvcHRpb25zLnRpbWVPdXQgPSAyMDAwO1xuICAgICAgICB3aW5kb3cudG9hc3RyLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB3aW5kb3cudG9hc3RyLnN1Y2Nlc3MobWVzc2FnZSk7XG4gICAgfSxcblxuICAgIHNob3dFcnJvcjogZnVuY3Rpb24gKG1lc3NhZ2UsIHRpbWVvdXQpIHtcbiAgICAgICAgb3B0aW9ucy50aW1lT3V0ID0gdGltZW91dCB8fCAwO1xuICAgICAgICB3aW5kb3cudG9hc3RyLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB3aW5kb3cudG9hc3RyLmVycm9yKG1lc3NhZ2UpO1xuICAgIH0sXG5cbiAgICBzaG93V2FybmluZzogZnVuY3Rpb24gKG1lc3NhZ2UsIHRpbWVvdXQpIHtcbiAgICAgICAgb3B0aW9ucy50aW1lT3V0ID0gdGltZW91dCB8fCAwO1xuICAgICAgICB3aW5kb3cudG9hc3RyLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB3aW5kb3cudG9hc3RyLndhcm5pbmcobWVzc2FnZSk7XG4gICAgfSxcblxuICAgIGNsZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHdpbmRvdy50b2FzdHIuY2xlYXIoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHRvYXN0O1xuXG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy1jbGljay1jYWxsYmFjaycpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfZm9jdXNfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWZvY3VzLWNhbGxiYWNrJyk7XG52YXIgZGVsZXRlX2Zvcm1fY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9kZWxldGUtZm9ybS1jbGljay1jYWxsYmFjaycpO1xudmFyIGV4cG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZXhwb3J0LWZvcm0tY2xpY2stY2FsbGJhY2snKTtcbnZhciBwcmludF9hc19wZGZfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9wcmludC1hcy1wZGYtY2xpY2stY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMta2V5dXAtY2FsbGJhY2snKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX3RpdGxlX2NoZWNrYm94X2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy10aXRsZS1jaGVja2JveC1jYWxsYmFjaycpO1xudmFyIGRlbGV0ZV9hbGxfcXVlc3Rpb25zX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZGVsZXRlLWFsbC1xdWVzdGlvbnMtY2xpY2stY2FsbGJhY2snKTtcbnZhciBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9zYXZlLXByb2plY3QtY2xpY2stY2FsbGJhY2snKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybTtcbnZhciBmb3JtcztcblxudmFyIGZvcm1fZmFjdG9yeSA9IHtcblxuICAgIGNyZWF0ZVRhYkJ1dHRvbjogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vY3JlYXRlIG5ldyB0YWIgYnV0dG9uLCBhcHBlbmQgYWZ0ZXIgbGF0ZXN0IGZvcm0gdGFiIGJ1dHRvblxuICAgICAgICB2YXIgZm9ybV90YWJfYnV0dG9uX2h0bWwgPSB1aS5mb3Jtc190YWJzLmdldEZvcm1UYWJCdXR0b25IVE1MKGZvcm0pO1xuICAgICAgICB2YXIgZm9ybV90YWJfYnV0dG9ucyA9IGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJ2xpLm1haW5fX3RhYnNfX2Zvcm0tYnRuJyk7XG4gICAgICAgIGZvcm1fdGFiX2J1dHRvbnMuZXEoZm9ybV90YWJfYnV0dG9ucy5sZW5ndGggLSAxKS5hZnRlcihmb3JtX3RhYl9idXR0b25faHRtbCk7XG4gICAgfSxcblxuICAgIGNyZWF0ZUNoaWxkRm9ybTogZnVuY3Rpb24gKHRoZV9mb3JtX25hbWUsIHRoZV9mb3JtX3JlZiwgdGhlX2Zvcm1faW5kZXgsIGlzX2NyZWF0aW5nX25ld19jaGlsZF9mb3JtKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuICAgICAgICBmb3JtID0ge307XG4gICAgICAgIGZvcm0ubmFtZSA9IHRoZV9mb3JtX25hbWU7XG4gICAgICAgIGZvcm0uc2x1ZyA9IHV0aWxzLnNsdWdpZnkodGhlX2Zvcm1fbmFtZSk7XG4gICAgICAgIGZvcm0ucmVmID0gdGhlX2Zvcm1fcmVmO1xuICAgICAgICBmb3JtLnR5cGUgPSBjb25zdHMuRk9STV9ISUVSQVJDSFlfVFlQRTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gdGhlX2Zvcm1faW5kZXg7XG4gICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9yZWYgPSBmb3JtLnJlZjtcbiAgICAgICAgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG4gICAgICAgIHNlbGYuY3JlYXRlVGFiQnV0dG9uKCk7XG5cbiAgICAgICAgaWYgKGlzX2NyZWF0aW5nX25ld19jaGlsZF9mb3JtKSB7XG4gICAgICAgICAgICBmb3JtLmlucHV0cyA9IFtdO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1t0aGVfZm9ybV9pbmRleF0gPSBmb3JtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9zZXQgdGhlIGZvcm0gdGFiIGJ1dHRvbiB0byBhIHZhbGlkIGdyZWVuIGNoZWNrIGFzIGEgcGFyc2VkIGZyb20gbXVzdCBiZSB2YWxpZFxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybVZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jcmVhdGUgbmV3IHRhYiBjb250ZW50XG4gICAgICAgICQud2hlbih1aS5mb3Jtc190YWJzLmdldEZvcm1UYWJDb250ZW50SFRNTChmb3JtKSkudGhlbihmdW5jdGlvbiAoaHRtbCkge1xuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic19jb250ZW50LmFwcGVuZChodG1sKTtcblxuICAgICAgICAgICAgLy91cGRhdGUgZm9ybWJ1aWxkZXIgZG9tIHJlZmVyZW5jZXMgdG8gcG9pbnQgdG8gdGhlIG5ldyBmb3JtIG1hcmt1cFxuICAgICAgICAgICAgc2VsZi51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybS5yZWYpO1xuXG4gICAgICAgICAgICAvL3Nob3cgbmFtZSBvZiBmb3JtIGluIHRhYiBhbmQgaW5wdXRzIGNvbGxlY3Rpb24gY29udGFpbmVyLCB0cnVuY2F0aW5nIGZvcm0gbmFtZSAoPjEwKSBmb3IgVUkgcHVycG9zZXNcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWRpdC1zdGF0ZScpLnRleHQobWVzc2FnZXMubGFiZWxzLkVESVRJTkdfRk9STSk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoZm9ybS5uYW1lLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUIC0gKGZvcm1zLmxlbmd0aCAqIDIpKSk7XG5cbiAgICAgICAgICAgIC8vc2hvdyBlbXB0eSBpbnB1dCBxdWVzdGlvbiBwcmV2aWV3XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldygnJyk7XG5cbiAgICAgICAgICAgIC8vZW5hYmxlIGRlbGV0ZSBmb3JtIGJ1dHRvbiBhcyB0aGUgbmV3IGZvcm0gd2lsbCBiZSB0aGUgbGFzdCBjaGlsZFxuICAgICAgICAgICAgLy8gKGl0IGlzIHBvc3NpYmxlIHRvIGRlbGV0ZSBmcm9tIHRoZSBsYXN0IGNoaWxkIHVwIHRvIHRoZSBmaXJzdCBjaGlsZCB1cCB0byB0aGUgdG9wIGZvcm0gd2hpY2ggY2Fubm90IGJlIGRlbGV0ZWQpXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zIC5pbnB1dHMtY29sbGVjdGlvbl9fYnV0dG9ucy0tcmVtb3ZlLWZvcm0nKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgICAgICAgICAgLy9zd2l0Y2ggdG8gbmV3bHkgY3JlYXRlZCBmb3JtL3RhYiB3aGVuIGNyZWF0aW5nIGEgY2hpbGQgZm9ybSBvbmx5LCBub3Qgd2hlbiByZW5kZXJpbmcgYW4gZXhpc3RpbmcgcHJvamVjdCBmb3IgZWRpdGluZ1xuICAgICAgICAgICAgaWYgKGlzX2NyZWF0aW5nX25ld19jaGlsZF9mb3JtKSB7XG5cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCdsaSBhW2hyZWY9XCIjJyArIGZvcm0ucmVmICsgJy10YWJwYW5lbFwiXScpLnRhYignc2hvdycpO1xuXG4gICAgICAgICAgICAgICAgLy9iaW5kIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgICAgICAgICAgc2VsZi5iaW5kRm9ybVBhbmVsc0V2ZW50cygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gICAgfSxcblxuICAgIHJlbW92ZUZvcm06IGZ1bmN0aW9uIChwcmV2aW91c19mb3JtX3JlZiwgZm9ybV9yZWYsIGZvcm1fdGFiKSB7XG5cbiAgICAgICAgLy9kZWxldGUgZm9ybSBmcm9tIHByb2plY3QgZGVmaW5pdGlvbiAoaXQgaXMgYWx3YXlzIHRoZSBsYXN0IG9uZSlcbiAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcy5wb3AoKTtcblxuICAgICAgICAvL3JlbW92ZSBmb3JtIG1hcmt1cCBmcm9tIGRvbSAoYSBzaW5nbGUgdGFicGFuZWwsIHdoaWNoIGhhcyBnb3QgYm90aCB0aGUgaW5wdXQgY29sbGVjdGlvbiBhbmQgdGhlIGlucHV0cyBwcm9wZXJ0aWVzKVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic19jb250ZW50LmZpbmQoJyMnICsgZm9ybV9yZWYgKyAnLXRhYnBhbmVsJykucmVtb3ZlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgdGFiXG4gICAgICAgIGZvcm1fdGFiLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vc2V0IGZvcm0gc3RhdGUgdG8gcHJldmlvdXNcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LS07XG5cbiAgICAgICAgLy9zZXQgcmVmIHRvIHByZXZpb3VzIGZvcm1cbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZiA9IHByZXZpb3VzX2Zvcm1fcmVmO1xuICAgICAgICBmb3JtX3JlZiA9IHByZXZpb3VzX2Zvcm1fcmVmO1xuXG4gICAgICAgIC8vdXBkYXRlIGZvcm1idWlsZGVyIGRvbSByZWZlcmVuY2VzIHRvIHBvaW50IHRvIHRoZSBzZWxlY3RlZCBmb3JtIG1hcmt1cFxuICAgICAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKGZvcm1fcmVmKTtcblxuICAgICAgICAvL2VuYWJsZSBkZWxldGUgZm9ybSBidXR0b24gZm9yIHByZXZpb3VzIGZvcm0gYXMgaXQgYmVjb21lcyB0aGUgbGFzdCAoYXNpZGUgZnJvbSBmaXN0IGZvcm0pXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggIT09IDApIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2J1dHRvbnMgLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zLS1yZW1vdmUtZm9ybScpXG4gICAgICAgICAgICAgICAgLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IGFkZCBmb3JtIGJ1dHRvbiBpZiB0b3RhbCBpcyBsZXNzIHRoYW4gbWF4IG51bWJlciBvZiBmb3Jtc1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcy5sZW5ndGggPCBjb25zdHMuTUFYX05VTUJFUl9PRl9ORVNURURfQ0hJTERfRk9STVMpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJy5tYWluX190YWJzX2FkZC1mb3JtJykucGFyZW50KCkuc2hvdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZXNpemUgZm9ybSB0YWJzXG4gICAgICAgIHVpLmZvcm1zX3RhYnMucmVzaXplRm9ybVRhYnMoKTtcblxuXG4gICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gaWYgYWxsIGlucHV0cyBhcmUgdmFsaWRcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlQWxsSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnKiogYWxsIGdvb2QgKionKTtcbiAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICB1cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXM6IGZ1bmN0aW9uICh0aGVfZm9ybV9yZWYpIHtcblxuICAgICAgICB2YXIgZm9ybV9yZWYgPSB0aGVfZm9ybV9yZWY7XG5cbiAgICAgICAgLy91cGRhdGUgZm9ybWJ1aWxkZXIgZG9tIHJlZmVyZW5jZXMgdG8gcG9pbnQgdG8gdGhlIGN1cnJlbnRseSBhY3RpdmUgZm9ybSBtYXJrdXBcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMgPSAkKCcjJyArIGZvcm1fcmVmICsgJy1pbnB1dC1wcm9wZXJ0aWVzLmlucHV0LXByb3BlcnRpZXMnKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlciA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0LXByb3BlcnRpZXMuaW5wdXQtcHJvcGVydGllcyA+IC5wYW5lbCA+IC5wYW5lbC1ib2R5LmlucHV0X3Byb3BlcnRpZXNfX2Zvcm1zX3dyYXBwZXInKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucyA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0LXByb3BlcnRpZXMgLmlucHV0LXByb3BlcnRpZXNfX2J1dHRvbnMnKTtcblxuICAgICAgICAvL3RvZG8gY2hlY2sgdGhpc1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZCA9ICQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpO1xuXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbiA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0cy1jb2xsZWN0aW9uLmlucHV0cy1jb2xsZWN0aW9uJyk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZSA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0cy1jb2xsZWN0aW9uLmlucHV0cy1jb2xsZWN0aW9uIC5wYW5lbCAucGFuZWwtYm9keScpO1xuXG4gICAgfSxcblxuICAgIGJpbmRGb3JtUGFuZWxzRXZlbnRzOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHNvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvc29ydGFibGUnKTtcbiAgICAgICAgdmFyIGltcG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW1wb3J0LWZvcm0tY2xpY2stY2FsbGJhY2snKTtcblxuICAgICAgICBzb3J0YWJsZSgpO1xuXG4gICAgICAgIC8vYXR0YWNoIGRlbGVnYXRlIGV2ZW50IHRvIG1vdXNlZG93biBzbyB3ZSBjb3ZlciBib3RoIGNsaWNrcyBhbmQgY2xpY2sgaG9sZCArIGRyYWdcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuXG4gICAgICAgIC8vaGFuZGxlIGNsaWNrIGFjdGlvbiBvbiBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsIGluIHRoZSByaWdodCBzaWRlYmFyICh1c2UgZXZlbnQgZGVsZWdhdGlvbilcbiAgICAgICAgLy90b2RvIHRlc3QgdGhpcyBpZiBpdCBpcyB1bmJpbmRpbmcgb3RoZXIgZXZlbnRzXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZignY2xpY2snKS5vbignY2xpY2snLCAnYnV0dG9uLmJ0biwgLnBvc3NpYmxlX2Fuc3dlci1tb3JlLWFjdGlvbicsIGlucHV0X3Byb3BlcnRpZXNfY2xpY2tfY2FsbGJhY2spO1xuICAgICAgICAvL3RyaWdnZXJlZCB3aGVuIHVzZXJzIGZvY3VzIG9uIGEgc2VsZWN0IG9mIHRoZSBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdmb2N1cycsICdzZWxlY3QnLCBpbnB1dF9wcm9wZXJ0aWVzX2ZvY3VzX2NhbGxiYWNrKTtcblxuICAgICAgICAvL3RyaWdnZXJlZCB3aGVuIHVzZXIgd2FudHMgdG8gZGVsZXRlIGEgZm9ybVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zLS1yZW1vdmUtZm9ybScpLm9mZignY2xpY2snKS5vbignY2xpY2snLCBkZWxldGVfZm9ybV9jbGlja19jYWxsYmFjayk7XG4gICAgICAgIC8vZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLm9uKCdjbGljaycsICcuaW5wdXRzLWNvbGxlY3Rpb25fX2J1dHRvbnMtLXJlbW92ZS1mb3JtJywgZGVsZXRlX2Zvcm1fY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlciB3YW50cyB0byBleHBvcnQgYSBmb3JtXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgIC8vYXZvaWQgYW55IGFjdGlvbiBpZiBvcHRpb24gaW4gZHJvcGRvd24gaXMgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5wYXJlbnQoKS5oYXNDbGFzcyhjb25zdHMuRElTQUJMRURfU1RBVEUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gcmVtb3ZlIGFsbCBxdWVzdGlvbnMgYXQgb25jZVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24ub24oJ2NsaWNrJywgJy5pbnB1dHMtY29sbGVjdGlvbl9fZGVsZXRlLWFsbC1xdWVzdGlvbnMnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZGVsZXRlX2FsbF9xdWVzdGlvbnNfY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIHdhbnRzIHRvIGV4cG9ydCBhIGZvcm1cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgIC8vYXZvaWQgYW55IGFjdGlvbiBpZiBvcHRpb24gaW4gZHJvcGRvd24gaXMgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5wYXJlbnQoKS5oYXNDbGFzcyhjb25zdHMuRElTQUJMRURfU1RBVEUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmludF9hc19wZGZfY2xpY2tfY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciB3YW50cyB0byBpbXBvcnQgYSBmb3JtXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2Zvcm0taW1wb3J0IGlucHV0Jykub2ZmKCdjaGFuZ2UnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaW1wb3J0X2Zvcm1fY2xpY2tfY2FsbGJhY2sodGhpcy5maWxlcyk7XG4gICAgICAgICAgICAkKHRoaXMpLnZhbChudWxsKTtcblxuICAgICAgICB9KTtcblxuICAgICAgICAvL3ZhbGlkYXRlIHF1ZXN0aW9uIHRleHQvIGdyb3VwIG9yIGJyYW5jaCBoZWFkZXIgb24ga2V5dXBcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub24oJ2tleXVwJywgJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiBpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2spO1xuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgY2hlY2svdW5ja2VjayB0aXRsZSBpbiB0aGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vbignY2hhbmdlJywgJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX190aXRsZS1mbGFnIGlucHV0JywgaW5wdXRfcHJvcGVydGllc190aXRsZV9jaGVja2JveF9jYWxsYmFjayk7XG4gICAgfSxcblxuICAgIHVuYmluZEZvcm1QYW5lbHNFdmVudHM6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLm9mZigpO1xuXG4gICAgICAgIC8vZGVzdHJveSBzb3J0YWJsZSBvbmx5IGlmIGl0IGlzIHNldCBhbHJlYWR5IChzZWUgaHR0cDovL2dvby5nbC9yaU40WWspXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZGF0YSgndWktc29ydGFibGUnKSkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLnNvcnRhYmxlKCdkZXN0cm95Jyk7Ly9SZW1vdmUgdGhlIHBsdWdpbiBmdW5jdGlvbmFsaXR5XG4gICAgICAgIH1cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9mZigpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZm9ybV9mYWN0b3J5O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBBdWRpb0lucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2F1ZGlvJyk7XG52YXIgQmFyY29kZUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2JhcmNvZGUnKTtcbnZhciBCcmFuY2hJbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9icmFuY2gnKTtcbnZhciBDaGVja2JveElucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2NoZWNrYm94Jyk7XG52YXIgRGF0ZUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2RhdGUnKTtcbnZhciBEcm9wZG93bklucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2Ryb3Bkb3duJyk7XG52YXIgTG9jYXRpb25JbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9sb2NhdGlvbicpO1xudmFyIE51bWVyaWNJbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9pbnRlZ2VyJyk7XG52YXIgUGhvdG9JbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9waG90bycpO1xudmFyIFBob25lSW5wdXQgPSByZXF1aXJlKCdpbnB1dHMvcGhvbmUnKTtcbnZhciBSYWRpb0lucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3JhZGlvJyk7XG52YXIgVGV4dElucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3RleHQnKTtcbnZhciBUZXh0YXJlYUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3RleHRhcmVhJyk7XG52YXIgUmVhZG1lSW5wdXQgPSByZXF1aXJlKCdpbnB1dHMvcmVhZG1lJyk7XG52YXIgVGltZUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3RpbWUnKTtcbnZhciBWaWRlb0lucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3ZpZGVvJyk7XG52YXIgR3JvdXBJbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9ncm91cCcpO1xudmFyIFNlYXJjaElucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3NlYXJjaCcpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgcG9zc2libGVfYW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2VycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcblxuLyoqXG4gKiBEZWZpbmUgYW4gaW50ZXJmYWNlIGZvciBjcmVhdGluZyBhbiBvYmplY3QsIGJ1dCBsZXQgc3ViY2xhc3NlcyBkZWNpZGUgd2hpY2ggY2xhc3MgdG8gaW5zdGFudGlhdGUuXG4gKiBGYWN0b3J5IE1ldGhvZCBsZXRzIGEgY2xhc3MgZGVmZXIgaW5zdGFudGlhdGlvbiB0byBzdWJjbGFzc2VzLlxuICovXG52YXIgaW5wdXRfZmFjdG9yeSA9IHtcblxuICAgIC8vc2V0IGRlZmF1bHQgaW5wdXQgYXMgdHlwZSB0ZXh0XG4gICAgdHlwZTogVGV4dElucHV0LFxuXG4gICAgLy9jcmVhdGUgaW5wdXQgYmFzZWQgb24gdHlwZSwgc2V0IGFsc28gaW5kZXggdW5pcXVlIHRvIGVhY2ggaW5wdXRcbiAgICBjcmVhdGVJbnB1dDogZnVuY3Rpb24gKHRoZV90eXBlLCB0aGVfaW5wdXRfcmVmKSB7XG4gICAgICAgIHZhciB0eXBlID0gdGhlX3R5cGU7XG4gICAgICAgIHZhciBpbnB1dF9yZWYgPSB0aGVfaW5wdXRfcmVmO1xuXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQVVESU9fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBBdWRpb0lucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQkFSQ09ERV9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IEJhcmNvZGVJbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkJSQU5DSF9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IEJyYW5jaElucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQ0hFQ0tCT1hfVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBDaGVja2JveElucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuREFURV9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IERhdGVJbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkRST1BET1dOX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gRHJvcGRvd25JbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkdST1VQX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gR3JvdXBJbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkxPQ0FUSU9OX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gTG9jYXRpb25JbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLklOVEVHRVJfVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBOdW1lcmljSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5ERUNJTUFMX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gTnVtZXJpY0lucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUEhPTkVfVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBQaG9uZUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUEhPVE9fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBQaG90b0lucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUkFESU9fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBSYWRpb0lucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVEVYVF9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFRleHRJbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlRFWFRBUkVBX1RZUEU6XG5cbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBUZXh0YXJlYUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUkVBRE1FX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gUmVhZG1lSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5USU1FX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gVGltZUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVklERU9fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBWaWRlb0lucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFNlYXJjaElucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gU2VhcmNoSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IHRoaXMudHlwZShpbnB1dF9yZWYpO1xuICAgIH0sXG5cbiAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBhbmQgbWVtb3J5XG4gICAgcmVtb3ZlSW5wdXQ6IGZ1bmN0aW9uICh0aGVfcmVmKSB7XG5cbiAgICAgICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbiAgICAgICAgdmFyIGlucHV0X3JlZiA9IHRoZV9yZWY7XG4gICAgICAgIHZhciBpbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihpbnB1dF9yZWYpO1xuXG4gICAgICAgIC8vcmVtb3ZlIGVsZW1lbnQgZnJvbSBnbG9iYWwgYXJyYXkgaW4gbWVtb3J5XG4gICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHMuc3BsaWNlKGlucHV0X2luZGV4LCAxKTtcblxuICAgICAgICAvL3JlbW92ZSBwcm9wZXJ0aWVzIGRvbSBlbGVtZW50cyAocmlnaHQgc2lkZWJhcilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnZGl2LnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dF9yZWYgKyAnXCJdJykuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vcmVtb3ZlIGlucHV0IGZyb20gZG9tIGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXRfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL2FmdGVyIGRlbGV0aW9uIG5vIGlucHV0IGlzIHNlbGVjdGVkLCBzaG93IG1lc3NhZ2UgYW5kIGhpZGUgY29udGV4dCBidXR0b25zXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAvL3Nob3cgYWN0aW9uIGJ1dHRvbiBmb3IgaW5wdXRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9yZW1vdmUgdHJhY2sgb2YgdGhpcyBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA8PSAoY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy9yZW1vdmUgYnJhbmNoIGlucHV0IGZyb20gZG9tIGFuZCBtZW1vcnlcbiAgICByZW1vdmVCcmFuY2hJbnB1dDogZnVuY3Rpb24gKHRoZV9vd25lcl9pbnB1dF9yZWYsIHRoZV9icmFuY2hfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIG93bmVyX2lucHV0X3JlZiA9IHRoZV9vd25lcl9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9yZWYgPSB0aGVfYnJhbmNoX2lucHV0X3JlZjtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9pbmRleCA9IHV0aWxzLmdldEJyYW5jaElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfaW5kZXgsIGJyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uYnJhbmNoO1xuXG4gICAgICAgIC8vcmVtb3ZlIGVsZW1lbnQgZnJvbSBnbG9iYWwgb2JqZWN0IGluIG1lbW9yeSAoYW5kIHN0b3JlIHRoZSByZW1vdmVkIGVsZW1lbnQgZm9yIGxhdGVyIHVzZSlcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dCA9IGJyYW5jaF9pbnB1dHMuc3BsaWNlKGJyYW5jaF9pbnB1dF9pbmRleCwgMSlbMF07XG5cbiAgICAgICAgLy9yZW1vdmUgcHJvcGVydGllcyBkb20gZWxlbWVudHMgKHJpZ2h0IHNpZGViYXIpXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgYnJhbmNoX2lucHV0X3JlZiArICdcIl0nKS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCkucmVtb3ZlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgaW5wdXQgZnJvbSBkb20gY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBicmFuY2hfaW5wdXRfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL2FmdGVyIGRlbGV0aW9uIG5vIGJyYW5jaCBpbnB1dCBpcyBzZWxlY3RlZCwgc28gc2hvdyBtZXNzYWdlIGFuZCBoaWRlIGNvbnRleHQgYnV0dG9uc1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgLy9oaWRlIGFjdGlvbiBidXR0b24gZm9yIGlucHV0XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgIC8vaWYgYnJhbmNoIGlzIGVtcHR5LCBzaG93IG1lc3NhZ2VcbiAgICAgICAgaWYgKGJyYW5jaF9pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1icmFuY2gnKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tYnJhbmNoLXF1ZXN0aW9ucy1tZXNzYWdlJykuc2hvdygpO1xuXG4gICAgICAgICAgICAvL3Nob3cgaW52YWxpZCBpY29uIGluIGFjdGl2ZSBicmFuY2hcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG5cbiAgICAgICAgICAgIC8vc2V0IHRoZSBmb3JtIGFzIGludmFsaWRcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1JbnZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZW1vdmUgdHJhY2sgb2YgdGhpcyBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcbiAgICAgICAgICAgIC8vdXBkYXRlIHNlYXJjaCBpbnB1dHMgdG90YWxcbiAgICAgICAgICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpIDw9IChjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4IC0gMSkpIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5zaG93U2VhcmNoSW5wdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvL3JlbW92ZSBicmFuY2ggaW5wdXQgZnJvbSBkb20gYW5kIG1lbW9yeVxuICAgIHJlbW92ZUdyb3VwSW5wdXQ6IGZ1bmN0aW9uICh0aGVfb3duZXJfaW5wdXRfcmVmLCB0aGVfZ3JvdXBfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIG93bmVyX2lucHV0X3JlZiA9IHRoZV9vd25lcl9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0X3JlZiA9IHRoZV9ncm91cF9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBncm91cF9pbnB1dF9pbmRleCA9IHV0aWxzLmdldEdyb3VwSW5wdXRDdXJyZW50SW5kZXhCeVJlZihvd25lcl9pbnB1dF9pbmRleCwgZ3JvdXBfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgIHZhciBncm91cF9pbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uZ3JvdXA7XG5cbiAgICAgICAgLy9yZW1vdmUgZWxlbWVudCBmcm9tIGdsb2JhbCBvYmplY3QgaW4gbWVtb3J5IChhbmQgc3RvcmUgdGhlIHJlbW92ZWQgZWxlbWVudCBmb3IgbGF0ZXIgdXNlKVxuICAgICAgICB2YXIgZ3JvdXBfaW5wdXQgPSBncm91cF9pbnB1dHMuc3BsaWNlKGdyb3VwX2lucHV0X2luZGV4LCAxKVswXTtcblxuICAgICAgICAvL3JlbW92ZSBwcm9wZXJ0aWVzIGRvbSBlbGVtZW50cyAocmlnaHQgc2lkZWJhcilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnZGl2LnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBncm91cF9pbnB1dF9yZWYgKyAnXCJdJykuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vcmVtb3ZlIGlucHV0IGZyb20gZG9tIGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgZ3JvdXBfaW5wdXRfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL2FmdGVyIGRlbGV0aW9uIG5vIGdyb3VwIGlucHV0IGlzIHNlbGVjdGVkLCBzbyBzaG93IG1lc3NhZ2UgYW5kIGhpZGUgY29udGV4dCBidXR0b25zXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAvL2hpZGUgYWN0aW9uIGJ1dHRvbiBmb3IgaW5wdXRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9pZiBncm91cCBpcyBlbXB0eSwgc2hvdyBtZXNzYWdlXG4gICAgICAgIGlmIChncm91cF9pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1ncm91cCcpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1ncm91cC1xdWVzdGlvbnMtbWVzc2FnZScpLnNob3coKTtcblxuICAgICAgICAgICAgLy9zaG93IGludmFsaWQgaWNvbiBpbiBhY3RpdmUgYnJhbmNoXG4gICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKTtcblxuICAgICAgICAgICAgLy9zZXQgdGhlIGZvcm0gYXMgaW52YWxpZFxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3JlbW92ZSB0cmFjayBvZiB0aGlzIGlucHV0XG4gICAgICAgIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGlmIChncm91cF9pbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGdyb3VwX2lucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuICAgICAgICAgICAgaWYgKHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCkgPD0gKGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggLSAxKSkge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLnNob3dTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZU5lc3RlZEdyb3VwSW5wdXQ6IGZ1bmN0aW9uICh0aGVfb3duZXJfaW5wdXRfYnJhbmNoX3JlZiwgdGhlX25lc3RlZF9ncm91cF9yZWYpIHtcblxuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX3JlZiA9IHRoZV9uZXN0ZWRfZ3JvdXBfcmVmO1xuICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgdmFyIG93bmVyX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIHZhciBvd25lcl9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgIHZhciBvd25lcl9icmFuY2hfaW5kZXggPSB1dGlscy5nZXRCcmFuY2hJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKG93bmVyX2lucHV0X2luZGV4LCBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2luZGV4ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKG93bmVyX2JyYW5jaCwgbmVzdGVkX2dyb3VwX3JlZik7XG4gICAgICAgIHZhciBuZXN0ZWRfZ3JvdXBfaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdFxuICAgICAgICAgICAgLmZvcm1zW2Zvcm1faW5kZXhdXG4gICAgICAgICAgICAuaW5wdXRzW293bmVyX2lucHV0X2luZGV4XVxuICAgICAgICAgICAgLmJyYW5jaFtvd25lcl9icmFuY2hfaW5kZXhdXG4gICAgICAgICAgICAuZ3JvdXA7XG5cbiAgICAgICAgLy9yZW1vdmUgZWxlbWVudCBmcm9tIGdsb2JhbCBvYmplY3QgaW4gbWVtb3J5IChhbmQgc3RvcmUgdGhlIHJlbW92ZWQgZWxlbWVudCBmb3IgbGF0ZXIgdXNlKVxuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2lucHV0ID0gbmVzdGVkX2dyb3VwX2lucHV0cy5zcGxpY2UobmVzdGVkX2dyb3VwX2luZGV4LCAxKVswXTtcblxuICAgICAgICAvL3JlbW92ZSBwcm9wZXJ0aWVzIGRvbSBlbGVtZW50cyAocmlnaHQgc2lkZWJhcilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnZGl2LnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBuZXN0ZWRfZ3JvdXBfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIG5lc3RlZF9ncm91cF9yZWYgKyAnXCJdJykuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vYWZ0ZXIgZGVsZXRpb24gbm8gZ3JvdXAgaW5wdXQgaXMgc2VsZWN0ZWQsIHNvIHNob3cgbWVzc2FnZSBhbmQgaGlkZSBjb250ZXh0IGJ1dHRvbnNcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIC8vaGlkZSBhY3Rpb24gYnV0dG9uIGZvciBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAvL2lmIGdyb3VwIGlzIGVtcHR5LCBzaG93IG1lc3NhZ2VcbiAgICAgICAgaWYgKG5lc3RlZF9ncm91cF9pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1ncm91cCcpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1ncm91cC1xdWVzdGlvbnMtbWVzc2FnZScpLnNob3coKTtcblxuICAgICAgICAgICAgLy9zaG93IGludmFsaWQgaWNvbiBpbiBhY3RpdmUgYnJhbmNoXG4gICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKTtcblxuICAgICAgICAgICAgLy9zZXQgdGhlIGZvcm0gYXMgaW52YWxpZFxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3JlbW92ZSB0cmFjayBvZiB0aGlzIGlucHV0XG4gICAgICAgIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGlmIChuZXN0ZWRfZ3JvdXBfaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSB8fCBuZXN0ZWRfZ3JvdXBfaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA8PSAoY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy90b2RvIHRoaXMgaXMgYSBiaXQgb2YgY29kZSBkdXBsaWNhdGlvbiwgdG8gYmUgcmVmYWN0b3JlZFxuICAgIHNob3dHcm91cElucHV0UHJvcGVydGllc0RvbTogZnVuY3Rpb24gKHRoZV9ncm91cF9pbnB1dF9pbmRleCkge1xuXG4gICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICB2YXIgb3duZXJfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0X2luZGV4ID0gdGhlX2dyb3VwX2lucHV0X2luZGV4O1xuICAgICAgICB2YXIgZ3JvdXBfaW5wdXQgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uZ3JvdXBbZ3JvdXBfaW5wdXRfaW5kZXhdO1xuICAgICAgICB2YXIgaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlcjtcbiAgICAgICAgdmFyIHZpZXcgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc192aWV3c1tncm91cF9pbnB1dC50eXBlXTtcblxuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuYXBwZW5kKHZpZXcpLmhpZGUoKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAvL2luaXQgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICAvL3RvZG9cbiAgICAgICAgLy9oZWxwZXJzLmluaXRJbnB1dFByb3BlcnRpZXNQYW5lbChpbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIsIGdyb3VwX2lucHV0LCBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMpO1xuICAgIH0sXG5cbiAgICAvL3RvZG8gdGhpcyBpcyBhIGJpdCBvZiBjb2RlIGR1cGxpY2F0aW9uLCB0byBiZSByZWZhY3RvcmVkXG4gICAgc2hvd05lc3RlZEdyb3VwSW5wdXRQcm9wZXJ0aWVzRG9tOiBmdW5jdGlvbiAodGhlX25lc3RlZF9ncm91cF9pbnB1dF9pbmRleCkge1xuXG5cbiAgICAgICAgY29uc29sZS5sb2coZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcyk7XG5cbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgIHZhciBicmFuY2hfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGdyb3VwX2luZGV4ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRDdXJyZW50SW5kZXhCeVJlZihicmFuY2hfaW5kZXgsIGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYpO1xuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2luZGV4ID0gdGhlX25lc3RlZF9ncm91cF9pbnB1dF9pbmRleDtcbiAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbnB1dCA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3RcbiAgICAgICAgICAgIC5mb3Jtc1tmb3JtX2luZGV4XVxuICAgICAgICAgICAgLmlucHV0c1ticmFuY2hfaW5kZXhdXG4gICAgICAgICAgICAuYnJhbmNoW2dyb3VwX2luZGV4XVxuICAgICAgICAgICAgLmdyb3VwW25lc3RlZF9ncm91cF9pbmRleF07XG5cbiAgICAgICAgdmFyIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXI7XG4gICAgICAgIHZhciB2aWV3ID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfdmlld3NbbmVzdGVkX2dyb3VwX2lucHV0LnR5cGVdO1xuXG4gICAgICAgIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5hcHBlbmQodmlldykuaGlkZSgpLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgfSxcblxuICAgIGNyZWF0ZUlucHV0VG9vbEhUTUw6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGUuY3JlYXRlSW5wdXRUb29sSFRNTChpbnB1dCk7XG4gICAgfSxcblxuICAgIGNyZWF0ZVByb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmNyZWF0ZVByb3BlcnRpZXNIVE1MKGlucHV0KTtcbiAgICB9LFxuICAgIGdldEFkdmFuY2VkVGFiQnRuSFRNTDogZnVuY3Rpb24gKHJlZiwgaXNfYWN0aXZlKSB7XG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZS5nZXRBZHZhbmNlZFRhYkJ0bkhUTUwocmVmLCBpc19hY3RpdmUpO1xuICAgIH0sXG4gICAgZ2V0SnVtcFRhYkJ0bkhUTUw6IGZ1bmN0aW9uIChyZWYsIGlzX2FjdGl2ZSkge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGUuZ2V0SnVtcFRhYkJ0bkhUTUwocmVmLCBpc19hY3RpdmUpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaW5wdXRfZmFjdG9yeTtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgcG9zc2libGVfYW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2VycycpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcblxudmFyIElucHV0TXVsdGlwbGVBbnN3ZXJzID0gZnVuY3Rpb24gKCkge1xufTtcblxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLnByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgcmV0dXJuIHRlbXBsYXRlLnByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllcyh2aWV3LCB0aGlzKTtcbn07XG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5zZXRBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhpcy5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGRpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IHNlbGVjdCBvcHRpb25bdmFsdWU9XCInICsgdGhpcy5kZWZhdWx0ICsgJ1wiXScpLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG5cbiAgICAvL3NldCAnaW5wdXRfcmVmJyBvbiAndW5pcXVlbmVzcycgb3B0aW9uXG4gICAgLy8gIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG5cbn07XG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcbiAgICAvL3NldCBkZWZhdWx0XG4gICAgdGhpcy5kZWZhdWx0ID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYucGFuZWwtYm9keSBkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBzZWxlY3Qgb3B0aW9uOnNlbGVjdGVkJylcbiAgICAgICAgLnZhbCgpO1xuXG4gICAgaWYgKHRoaXMuZGVmYXVsdCA9PT0gJ05vbmUnKSB7XG4gICAgICAgIHRoaXMuZGVmYXVsdCA9IG51bGw7XG4gICAgfVxuXG4gICAgLy9mb3IgU0VBUkNIIHR5cGUsIHNhdmUgaWYgdGhlIHNlYXJjaCBhbGxvdyBhIHNpbmdsZSBhbnN3ZXIgb3IgbXVsdGlwbGUgYW5zd2Vyc1xuICAgIGlmIChzZWxmLnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgc2VsZi50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcblxuICAgICAgICAvL3NldCBzaW5nbGUgb3IgbXVsdGlwbGUgc2VhcmNoIHR5cGVcbiAgICAgICAgc2VsZi50eXBlID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19zZWFyY2ggaW5wdXQ6Y2hlY2tlZCcpLnZhbCgpO1xuICAgIH1cblxufTtcblxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLmhpZGVQcm9wZXJ0aWVzRXJyb3JzID0gZnVuY3Rpb24gKCkge1xuICAgIGVycm9ycy5oaWRlUHJvcGVydGllc0Vycm9ycyh0aGlzLmRvbS5wcm9wZXJ0aWVzX3BhbmVsKTtcbiAgICBlcnJvcnMuaGlkZVBvc3NpYmxlQW5zd2Vyc0Vycm9ycyh0aGlzKTtcbn07XG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5hZGRQb3NzaWJsZUFuc3dlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBwb3NzaWJsZV9hbnN3ZXJzLmFkZFBvc3NpYmxlQW5zd2VyKHRoaXMpO1xufTtcblxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLnJlbW92ZVBvc3NpYmxlQW5zd2VyID0gZnVuY3Rpb24gKHRoZV9hbnN3ZXJfaW5kZXgpIHtcbiAgICBwb3NzaWJsZV9hbnN3ZXJzLnJlbW92ZVBvc3NpYmxlQW5zd2VyKHRoaXMsIHRoZV9hbnN3ZXJfaW5kZXgpO1xufTtcblxuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUuc2F2ZVBvc3NpYmxlQW5zd2VycyA9IGZ1bmN0aW9uICgpIHtcbiAgICBzYXZlLnNhdmVQb3NzaWJsZUFuc3dlcnModGhpcyk7XG59O1xuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLnNob3dQb3NzaWJsZUFuc3dlckVycm9ycyA9IGZ1bmN0aW9uICh0aGVfcG9zc2libGVfYW5zd2VyLCB0aGVfZXJyb3JfbWVzc2FnZSkge1xuICAgIGVycm9ycy5zaG93UG9zc2libGVBbnN3ZXJFcnJvcnModGhlX3Bvc3NpYmxlX2Fuc3dlciwgdGhlX2Vycm9yX21lc3NhZ2UpO1xufTtcbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5oaWRlUG9zc2libGVBbnN3ZXJzRXJyb3JzID0gZnVuY3Rpb24gKHRoZV9wb3NzaWJsZV9hbnN3ZXJzKSB7XG4gICAgZXJyb3JzLmhpZGVQb3NzaWJsZUFuc3dlcnNFcnJvcnModGhpcywgdGhlX3Bvc3NpYmxlX2Fuc3dlcnMpO1xufTtcbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQgPSBmdW5jdGlvbiAodGhlX2Fuc3dlcikge1xuICAgIC8vdmFsaWRhdGUgcG9zc2libGUgYW5zd2VyXG4gICAgcmV0dXJuIHZhbGlkYXRpb24uaXNQb3NzaWJsZUFuc3dlclZhbGlkKHRoZV9hbnN3ZXIpO1xufTtcblxuLypcbiB1cGRhdGUgdGhlIHNlbGVjdGVkIHBvc3NpYmxlIGFuc3dlcnMgZm9yIHRoZSBqdW1wcywgaW4gY2FzZSB0aGUgcG9zc2libGUgYW5zd2VycyBnb3QgY2hhbmdlZCBieSB0aGUgdXNlclxuIHRoaXMgaXMgdG8gcmVmcmVzaCB0aGUgZG9tIHdoZW4gdGhlIHVzZXIgY2hhbmdlIGEgcG9zc2libGUgYW5zd2VyIHRleHQgYW5kIHRoZW4gc3dpdGNoZXMgdG8gdGhlIGp1bXBzIHBhbmVsOlxuIGlmIGFuIG9sZCBvcHRpb24gd2FzIHNlbGVjdGVkLCB3ZSByZWZsZWN0IHRoYXQgY2hhbmdlIG9uIHRoZSBkb21cbiAqL1xuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLnVwZGF0ZUp1bXBQb3NzaWJsZUFuc3dlcnMgPSBmdW5jdGlvbiAodGhlX2p1bXBfcGFuZWwpIHtcbiAgICBwb3NzaWJsZV9hbnN3ZXJzLnVwZGF0ZUp1bXBQb3NzaWJsZUFuc3dlcnModGhpcywgdGhlX2p1bXBfcGFuZWwpO1xufTtcblxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLnVwZGF0ZVBvc3NpYmxlSW5pdGlhbEFuc3dlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcG9zc2libGVfYW5zd2Vycy51cGRhdGVQb3NzaWJsZUluaXRpYWxBbnN3ZXJzKHRoaXMpO1xufTtcblxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLmxpc3RQb3NzaWJsZUluaXRpYWxBbnN3ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgIHBvc3NpYmxlX2Fuc3dlcnMubGlzdFBvc3NpYmxlSW5pdGlhbEFuc3dlcnModGhpcyk7XG59O1xuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUuYWRkSnVtcCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIC8vc2V0IFwiQWRkIEp1bXBcIiBidXR0b24gcmVmZXJlbmNlIChzbyBpdCBpcyBhdmFpbGFibGUgd2hlbiBwbGF5aW5nIHdpdGgganVtcHMpXG4gICAgc2VsZi5kb20uYWRkX2p1bXBfYnV0dG9uID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fYWRkLWp1bXAnKTtcblxuICAgICQud2hlbihqdW1wcy5hZGRKdW1wKHNlbGYsIHRydWUpKS50aGVuKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvL2Rpc2FibGUgYWRkIGp1bXAgYnV0dG9uIGlmIHRvdGFsIG9mIGp1bXBzIGlzIGVxdWFsIHRvIHRvdGFsIG9mIHBvc3NpYmxlIGFuc3dlcnNcbiAgICAgICAgaWYgKHNlbGYuanVtcHMubGVuZ3RoID09PSBzZWxmLnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24uYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLy9vdmVycmlkZSB0aGUgZXhpc3RpbmcgbWV0aG9kLCBhcyB3ZSBuZWVkIGFuIGV4dHJhIGNoZWNrIGZvciB0aGVzZSB0eXBlcyBvZiBpbnB1dFxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLnJlbW92ZUp1bXAgPSBmdW5jdGlvbiAodGhlX3JlbW92ZV9idG4pIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIC8vc2V0IFwiQWRkIEp1bXBcIiBidXR0b24gcmVmZXJlbmNlIChzbyBpdCBpcyBhdmFpbGFibGUgd2hlbiBwbGF5aW5nIHdpdGgganVtcHMpXG4gICAgc2VsZi5kb20uYWRkX2p1bXBfYnV0dG9uID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fYWRkLWp1bXAnKTtcblxuICAgIGp1bXBzLnJlbW92ZUp1bXAoc2VsZiwgdGhlX3JlbW92ZV9idG4pO1xuXG4gICAgLy9lbmFibGUgYnV0dG9uIGlmIHdlIHJlbW92ZWQgbGFzdCBqdW1wXG4gICAgaWYgKHNlbGYuanVtcHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIC8vZW5hYmxlIGFkZCBqdW1wIGJ1dHRvblxuICAgICAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24uYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL2VuYWJsZSBidXR0b24gaWYgd2UgY2FuIGFkZCBqdW1wc1xuICAgICAgICBpZiAoc2VsZi5qdW1wcy5sZW5ndGggPCBzZWxmLnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24uYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IElucHV0TXVsdGlwbGVBbnN3ZXJzO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vL2lucHV0IGJhc2UgcHJvcGVydGllc1xudmFyIGlucHV0c19wcm9wZXJ0aWVzID0ge1xuXG4gICAgLy90b3AgbGV2ZWwsIHRvIGJlIGV4cG9ydGVkIHdoZW4gc2F2aW5nIHByb2plY3RcbiAgIC8vIGluZGV4OiBudWxsLFxuICAgIHJlZjogbnVsbCxcbiAgICB0eXBlOiAnJyxcbiAgICBxdWVzdGlvbjogJycsXG4gICAgaXNfdGl0bGU6IGZhbHNlLFxuICAgIGlzX3JlcXVpcmVkOiBmYWxzZSxcbiAgICB1bmlxdWVuZXNzOiAnbm9uZScsXG4gICAgcmVnZXg6IG51bGwsXG4gICAgZGVmYXVsdDogbnVsbCxcbiAgICB2ZXJpZnk6IGZhbHNlLFxuICAgIG1heDogbnVsbCxcbiAgICBtaW46IG51bGwsXG4gICAgZGF0ZXRpbWVfZm9ybWF0OiBudWxsLFxuICAgIHNldF90b19jdXJyZW50X2RhdGV0aW1lOiBmYWxzZSxcbiAgICBwb3NzaWJsZV9hbnN3ZXJzOiBbXSxcbiAgICBqdW1wczogW10sXG4gICAgYnJhbmNoOiBbXSxcbiAgICBncm91cDogW11cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvL3RoaXMgcHJvcGVydHkgaXMgbm90IGRlY2xhcmVkIGhlcmUgYW55bW9yZSBhcyB3aXRoIGpxdWVyeSB0aGUgZG9tIGlzIGNhY2hlZCBhbmQgc3RheXMgdGhlIHNhbWUgcGVyIGVhY2ggb2JqZWN0LFxuICAgIC8vc28gSSB3aWxsIGFkZCB0aGVtIGxhdGVyIGFmdGVyIHRoZSBvYmplY3QgaXMgaW5zdGFudGlhdGVkXG4gICAgLy8vKiBET00gcHJvcGVydGllcyovXG4gICAgLy9kb206IHtcbiAgICAvLyAgICBpc192YWxpZDogZmFsc2UsIC8vZmFsc2UgYnkgZGVmYXVsdCBhcyB3ZSBzZG8gbm90IGhhdmUgYSBxdWVzdGlvbiB0ZXh0IGFmdGVyIGRyYWcgYW5kIGRyb3BcbiAgICAvLyAgICBhZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXI6IG51bGwsXG4gICAgLy8gICAgYWRkX2p1bXBfYnV0dG9uOiBudWxsLFxuICAgIC8vICAgIHByb3BlcnRpZXNfcGFuZWw6bnVsbFxuICAgIC8vfVxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaW5wdXRzX3Byb3BlcnRpZXM7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcblxuXG52YXIgSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuICAgIC8vb3ZlcnJpZGUgaW4gc3BlY2lmaWMgaW5wdXQgdHlwZVxufTtcblxuSW5wdXQucHJvdG90eXBlLmlzUXVlc3Rpb25UZXh0VmFsaWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy92YWxpZGF0ZSBxdWVzdGlvbiB0ZXh0XG4gICAgcmV0dXJuIHZhbGlkYXRpb24uaXNRdWVzdGlvblRleHRWYWxpZCh0aGlzKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5oaWRlUXVlc3Rpb25FcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5oaWRlUHJvcGVydGllc0Vycm9ycygpO1xufTtcbklucHV0LnByb3RvdHlwZS5zaG93UXVlc3Rpb25FcnJvcnMgPSBmdW5jdGlvbiAodGhlX2Vycm9yX21lc3NhZ2UpIHtcbiAgICB0aGlzLnNob3dQcm9wZXJ0aWVzRXJyb3JzKHRoZV9lcnJvcl9tZXNzYWdlKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5pc0luaXRpYWxBbnN3ZXJWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL3ZhbGlkYXRlIGluaXRpYWwgYW5zd2VyXG4gICAgcmV0dXJuIHZhbGlkYXRpb24uaXNJbml0aWFsQW5zd2VyVmFsaWQodGhpcy50eXBlLCB0aGlzLmRlZmF1bHQsIHRoaXMucmVnZXgpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLmlzSnVtcFZhbGlkID0gZnVuY3Rpb24gKHRoZV9qdW1wX3Byb3BlcnRpZXMpIHtcbiAgICAvL3ZhbGlkYXRlIGluaXRpYWwgYW5zd2VyXG4gICAgcmV0dXJuIHZhbGlkYXRpb24uaXNKdW1wVmFsaWQodGhlX2p1bXBfcHJvcGVydGllcywgdGhpcyk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuc2F2ZVByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2F2ZS5zYXZlUHJvcGVydGllcyh0aGlzKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuICAgIHNhdmUuc2F2ZUFkdmFuY2VkUHJvcGVydGllcyh0aGlzKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5zYXZlSnVtcHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2F2ZS5zYXZlSnVtcHModGhpcyk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuc2hvd1Byb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAodGhlX2Vycm9yX21lc3NhZ2UpIHtcbiAgICBlcnJvcnMuc2hvd1F1ZXN0aW9uVGV4dEVycm9ycyh0aGlzLmRvbS5wcm9wZXJ0aWVzX3BhbmVsLCB0aGVfZXJyb3JfbWVzc2FnZSk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuaGlkZVByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgZXJyb3JzLmhpZGVQcm9wZXJ0aWVzRXJyb3JzKHRoaXMuZG9tLnByb3BlcnRpZXNfcGFuZWwpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLnNob3dBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAodGhlX2ludmFsaWRfcHJvcGVydHksIHRoZV9lcnJvcl9tZXNzYWdlKSB7XG4gICAgZXJyb3JzLnNob3dTaW5nbGVBZHZhbmNlZFByb3BlcnR5RXJyb3IodGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLCB0aGVfaW52YWxpZF9wcm9wZXJ0eSwgdGhlX2Vycm9yX21lc3NhZ2UpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy9vdmVycmlkZSBpbiBzcGVjaWZpYyBpbnB1dCB0eXBlXG59O1xuXG5JbnB1dC5wcm90b3R5cGUuYWRkSnVtcCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIC8vc2V0IFwiQWRkIEp1bXBcIiBidXR0b24gcmVmZXJlbmNlIChzbyBpdCBpcyBhdmFpbGFibGUgd2hlbiBwbGF5aW5nIHdpdGgganVtcHMpXG4gICAgc2VsZi5kb20uYWRkX2p1bXBfYnV0dG9uID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fYWRkLWp1bXAnKTtcblxuICAgICQud2hlbihqdW1wcy5hZGRKdW1wKHRoaXMpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9kaXNhYmxlIGFkZCBqdW1wIGJ1dHRvbiBhcyB0aGlzIGlucHV0IHR5cGUgb25seSBhbGxvd3MgdG8gc2V0IGEgc2luZ2xlIGp1bXBcbiAgICAgICAgc2VsZi5kb20uYWRkX2p1bXBfYnV0dG9uLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgfSk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUucmVtb3ZlSnVtcCA9IGZ1bmN0aW9uICh0aGVfcmVtb3ZlX2J0bikge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5kb20uYWRkX2p1bXBfYnV0dG9uID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fYWRkLWp1bXAnKTtcblxuICAgIGp1bXBzLnJlbW92ZUp1bXAodGhpcywgdGhlX3JlbW92ZV9idG4pO1xuXG4gICAgaWYgKHRoaXMuanVtcHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIC8vZW5hYmxlIGFkZCBqdW1wIGJ1dHRvblxuICAgICAgICB0aGlzLmRvbS5hZGRfanVtcF9idXR0b24uYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgfVxufTtcblxuSW5wdXQucHJvdG90eXBlLnNob3dTaW5nbGVKdW1wRXJyb3JzID0gZnVuY3Rpb24gKHRoZV9qdW1wX2l0ZW0sIHRoZV9qdW1wX3Byb3BlcnRpZXMpIHtcbiAgICBlcnJvcnMuc2hvd1NpbmdsZUp1bXBFcnJvcnModGhlX2p1bXBfaXRlbSwgdGhlX2p1bXBfcHJvcGVydGllcyk7XG59O1xuSW5wdXQucHJvdG90eXBlLmhpZGVKdW1wc0Vycm9ycyA9IGZ1bmN0aW9uICh0aGVfanVtcHNfbGlzdCkge1xuICAgIGVycm9ycy5oaWRlSnVtcHNFcnJvcnModGhlX2p1bXBzX2xpc3QpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbnB1dDtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciB2YWxpZF9kYXRlX2Zvcm1hdHMgPSBbXG4gICAgY29uc3RzLkRBVEVfRk9STUFUXzEsXG4gICAgY29uc3RzLkRBVEVfRk9STUFUXzIsXG4gICAgY29uc3RzLkRBVEVfRk9STUFUXzMsXG4gICAgY29uc3RzLkRBVEVfRk9STUFUXzQsXG4gICAgY29uc3RzLkRBVEVfRk9STUFUXzVcbl07XG5cbnZhciB2YWxpZF90aW1lX2Zvcm1hdHMgPSBbXG4gICAgY29uc3RzLlRJTUVfRk9STUFUXzEsXG4gICAgY29uc3RzLlRJTUVfRk9STUFUXzIsXG4gICAgY29uc3RzLlRJTUVfRk9STUFUXzMsXG4gICAgY29uc3RzLlRJTUVfRk9STUFUXzQsXG4gICAgY29uc3RzLlRJTUVfRk9STUFUXzVcbl07XG5cbnZhciBpbXBvcnRfZm9ybV92YWxpZGF0aW9uID0ge1xuXG4gICAgaGFzVmFsaWRGb3JtU3RydWN0dXJlOiBmdW5jdGlvbiAoZm9ybSkge1xuXG4gICAgICAgIHZhciB2YWxpZEZvcm1TdHJ1Y3R1cmUgPSB7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdmb3JtJyxcbiAgICAgICAgICAgICAgICBmb3JtOiB7XG4gICAgICAgICAgICAgICAgICAgIHJlZjogJycsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBzbHVnOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2hpZXJhcmNoeScsXG4gICAgICAgICAgICAgICAgICAgIGlucHV0czogW11cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9jb21wYXJlIGEgdmFsaWQgb2JqZWN0IGFnYWluc3QgdGhlIGltcG9ydGVkIGZvcm0gb2JqZWN0IGlmIHRoZXkgaGF2ZSB0aGUgc2FtZSBrZXlzXG4gICAgICAgIGlmICghdXRpbHMuaGFzU2FtZVByb3BzKHZhbGlkRm9ybVN0cnVjdHVyZSwgZm9ybSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZGF0YSB0eXBlIG11c3QgYmUgZm9ybVxuICAgICAgICBpZiAoZm9ybS5kYXRhLnR5cGUgIT09ICdmb3JtJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9mb3JtIHR5cGUgbXVzdCBiZSBoaWVyYXJjaHlcbiAgICAgICAgaWYgKGZvcm0uZGF0YS5mb3JtLnR5cGUgIT09ICdoaWVyYXJjaHknKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvL3JlZiwgbmFtZSwgc2x1ZyBhbmQgaW5wdXRzIHByb3BzIGFyZSBub3QgY29uc2lkZXJlZCBoZXJlXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICBhcmVKdW1wc1ZhbGlkOiBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgICAgICB2YXIganVtcHMgPSBpbnB1dC5qdW1wcztcbiAgICAgICAgdmFyIGFyZV92YWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzID0gaW5wdXQucG9zc2libGVfYW5zd2VycztcbiAgICAgICAgdmFyIHZhbGlkSnVtcFN0cnVjdHVyZSA9IHtcbiAgICAgICAgICAgIHRvOiAnJyxcbiAgICAgICAgICAgIHdoZW46ICcnLFxuICAgICAgICAgICAgYW5zd2VyX3JlZjogJydcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYW5zd2VyX3JlZl9yZWdleCA9IG5ldyBSZWdFeHAoY29uc3RzLlJFR0VYLnBvc3NpYmxlX2Fuc3dlcl9yZWYpO1xuXG4gICAgICAgIGlmICghJC5pc0FycmF5KGp1bXBzKSkge1xuICAgICAgICAgICAgYXJlX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAkKGp1bXBzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwganVtcCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGFuc3dlcl9yZWZfZm91bmQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vdmFsaWRhdGUgc3RydWN0dXJlXG4gICAgICAgICAgICAgICAgaWYgKCF1dGlscy5oYXNTYW1lUHJvcHModmFsaWRKdW1wU3RydWN0dXJlLCBqdW1wKSkge1xuICAgICAgICAgICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vaWYgYW5zd2VyX3JlZiBpcyBpbiBpbnZhbGlkIGZvcm1hdCwgYmFpbCBvdXQgKGNhbiBiZSBudWxsLCB3ZSBjYXRjaCB0aGF0IGxhdGVyKVxuICAgICAgICAgICAgICAgIGlmIChqdW1wLmFuc3dlcl9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhbnN3ZXJfcmVmX3JlZ2V4LnRlc3QoanVtcC5hbnN3ZXJfcmVmKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJlX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3ZhbGlkYXRlIGp1bXBzIHByb3BlcnRpZXMgdmFsdWVzXG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG11bHRpcGxlIGNob2ljZSBpbnB1dFxuICAgICAgICAgICAgICAgICAgICAvL2p1bXAgXCJ0b1wiIHZhbHVlIG11c3QgYmUgYW4gZXhpc3RpbmcgXCJmb3J3YXJkXCIgaW5wdXRfcmVmXG4gICAgICAgICAgICAgICAgICAgIC8vdG9kbyBuZWVkIG5leHQgaW5wdXRzXG5cbiAgICAgICAgICAgICAgICAgICAgLy9qdW1wIFwidG9cIiBtdXN0IGV4aXN0IGluIHBvc3NpYmxlIGFuc3dlcnMgKGl0IGlzIHRoZSBhbnN3ZXJfcmVmKVxuICAgICAgICAgICAgICAgICAgICAvLyBvbmx5IGlmIFwid2hlblwiIGlzIG5vdCBlaXRoZXIgQUxMIG9yIE5PX0FOU1dFUl9HSVZFTlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShqdW1wLndoZW4gPT09ICdBTEwnIHx8IGp1bXAud2hlbiA9PT0gJ05PX0FOU1dFUl9HSVZFTicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanVtcC5hbnN3ZXJfcmVmID09PSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmX2ZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbnN3ZXJfcmVmX2ZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJlX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3NpbmdsZSBxdWVzdGlvbiwganVtcCBcIndoZW5cIiBtdXN0IGJlIHNldCB0byBBTExcbiAgICAgICAgICAgICAgICAgICAgaWYgKGp1bXAud2hlbiAhPT0gJ0FMTCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZV92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhbiBlbXB0eSAndG8nIC0gZXJyb3JcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGFuIGVtcHR5ICd3aGVuJyAtIGVycm9yXG4gICAgICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhbiBlbXB0eSAnYW5zd2VyX3JlZicgYW5kICd3aGVuJyBpcyBub3QgJ0FMTCcgb3IgJ05PX0FOU1dFUl9HSVZFTicgLSBlcnJvclxuICAgICAgICAgICAgICAgIGlmICghanVtcC50byB8fCAhanVtcC53aGVuIHx8XG4gICAgICAgICAgICAgICAgICAgICghanVtcC5hbnN3ZXJfcmVmICYmICEoanVtcC53aGVuID09PSAnQUxMJyB8fCBqdW1wLndoZW4gPT09ICdOT19BTlNXRVJfR0lWRU4nKSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3ZhbGlkYXRlIFwid2hlblwiIHByb3AsIG11c3QgYmUgb25lIG9mIHRoZSBqdW1wIGNvbmRpdGlvbnNcbiAgICAgICAgICAgICAgICB2YXIgaXNWYWxpZFdoZW5Qcm9wZXJ0eSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICQoY29uc3RzLkpVTVBfQ09ORElUSU9OUykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGNvbmRpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uLmtleSA9PT0ganVtcC53aGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkV2hlblByb3BlcnR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZFdoZW5Qcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXJlX3ZhbGlkO1xuICAgIH0sXG5cbiAgICBhcmVKdW1wc0Rlc3RpbmF0aW9uc1ZhbGlkOiBmdW5jdGlvbiAoaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIGFsbF9qdW1wc192YWxpZCA9IHRydWU7XG5cbiAgICAgICAgJChpbnB1dHMpLmVhY2goZnVuY3Rpb24gKGlucHV0SW5kZXgsIGlucHV0KSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IHZhbGlkIGp1bXAgZGVzdGluYXRpb25zXG4gICAgICAgICAgICB2YXIganVtcF9kZXN0aW5hdGlvbnMgPSB1dGlscy5nZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zQXNLZXlzKGlucHV0SW5kZXgsIGlucHV0LCBpbnB1dHMsIGZhbHNlKTtcblxuICAgICAgICAgICAgLy9leHRyYSB2YWxpZGF0aW9uIGZvciBqdW1wcywgY2hlY2sgaWYgdGhlIGRlc3RpbmF0aW9uIHN0aWxsIGV4aXN0cyBhbmQgaXQgaXMgdmFsaWRcbiAgICAgICAgICAgICQoaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGp1bXBJbmRleCwganVtcCkge1xuICAgICAgICAgICAgICAgIC8vZG9lcyB0aGUganVtcCBcInRvXCIgcHJvcGVydHkgcmVmZXJlbmNlIGEgdmFsaWQgZGVzdGluYXRpb24gaW5wdXQ/XG4gICAgICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1tqdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgICAgICAvL2ludmFsaWQgZGVzdGluYXRpb24gZm91bmRcbiAgICAgICAgICAgICAgICAgICAgYWxsX2p1bXBzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vdmFsaWRhdGUgYnJhbmNoIGp1bXBzXG4gICAgICAgICAgICAkKGlucHV0LmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoYnJhbmNoSW5wdXRJbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoYnJhbmNoSW5wdXRJbmRleCwgYnJhbmNoX2lucHV0LCBpbnB1dC5icmFuY2gsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLy9leHRyYSB2YWxpZGF0aW9uIGZvciBqdW1wcywgY2hlY2sgaWYgdGhlIGRlc3RpbmF0aW9uIHN0aWxsIGV4aXN0cyBhbmQgaXQgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbiAoYnJhbmNoSnVtcEluZGV4LCBicmFuY2hKdW1wKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZG9lcyB0aGUganVtcCBcInRvXCIgcHJvcGVydHkgcmVmZXJlbmNlIGEgdmFsaWQgZGVzdGluYXRpb24gaW5wdXQ/XG4gICAgICAgICAgICAgICAgICAgIGlmICghanVtcF9kZXN0aW5hdGlvbnNbYnJhbmNoSnVtcC50b10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxsX2p1bXBzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYWxsX2p1bXBzX3ZhbGlkO1xuICAgIH0sXG5cbiAgICBhcmVQb3NzaWJsZUFuc3dlcnNWYWxpZDogZnVuY3Rpb24gKHBvc3NpYmxlX2Fuc3dlcnMsIGlucHV0X3R5cGUpIHtcblxuICAgICAgICB2YXIgYW5zd2VyX3JlZl9yZWdleCA9IG5ldyBSZWdFeHAoY29uc3RzLlJFR0VYLnBvc3NpYmxlX2Fuc3dlcl9yZWYpO1xuICAgICAgICB2YXIgYW5zd2VyX3JlZnMgPSBbXTtcbiAgICAgICAgdmFyIHZhbGlkUG9zc2libGVBbnN3ZXJTdHJ1Y3R1cmUgPSB7XG4gICAgICAgICAgICBhbnN3ZXI6ICcnLFxuICAgICAgICAgICAgYW5zd2VyX3JlZjogJycvL3RoaXMgbXVzdCBiZSB1bmlxdWVcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoISQuaXNBcnJheShwb3NzaWJsZV9hbnN3ZXJzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9jaGVjayBwb3NzaWJsZSBhbnN3ZXIgdG90YWwgaXMgd2l0aGluIGxpbWl0c1xuICAgICAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID4gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heCkge1xuICAgICAgICAgICAgICAgIC8vaXMgdGhpcyBhIHNlYXJjaCB0eXBlP1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUgfHwgaW5wdXRfdHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL2xpbWl0IGlzIGhpZ2hlciBmb3Igc2VhcmNoIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID4gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heF9zZWFyY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2F0IGxlYXN0IDEgcG9zc2libGUgYW5zd2VyXG4gICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2Vycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vY2hlY2sgcG9zc2libGUgYW5zd2VyIHN0cnVjdHVyZVxuICAgICAgICAgICAgdmFyIGFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgJChwb3NzaWJsZV9hbnN3ZXJzKS5lYWNoKGZ1bmN0aW9uIChrZXksIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgICAgICAgICAgYW5zd2VyX3JlZnMucHVzaChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZik7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmICE9PSAnc3RyaW5nJyB8fCB0eXBlb2YgcG9zc2libGVfYW5zd2VyLmFuc3dlciAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcl92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBhbnN3ZXJfcmVmIGxlbmd0aFxuICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZi5sZW5ndGggIT09IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2VyX3JlZl9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcl92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBhbnN3ZXJfcmVmIHRvIGJlIGhleCBjaGFyYWN0ZXJzXG4gICAgICAgICAgICAgICAgaWYgKCFhbnN3ZXJfcmVmX3JlZ2V4LnRlc3QocG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWYpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgYW5zd2VyIG1heCBsZW5ndGhcbiAgICAgICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2VyLmFuc3dlci5sZW5ndGggPT09IDAgfHwgcG9zc2libGVfYW5zd2VyLmFuc3dlci5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcl9tYXhfbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcG9zc2libGVfYW5zd2VyIGNhbm5vdCBiZSBlbXB0eVxuICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICBhcmVfcG9zc2libGVfYW5zd2VyX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3N0cmlwIGh0bWwgdGFncyBmcm9tIHBvc3NpYmxlIGFuc3dlcnMgYW5zd2VyIHByb3BcbiAgICAgICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlci5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcblxuICAgICAgICAgICAgICAgIGlmICghdXRpbHMuaGFzU2FtZVByb3BzKHZhbGlkUG9zc2libGVBbnN3ZXJTdHJ1Y3R1cmUsIHBvc3NpYmxlX2Fuc3dlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcl92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8vL2NoZWNrIGZvciBhbnN3ZXJfcmVmIHVuaXF1ZW5lc3NcbiAgICAgICAgICAgICAgICAvLy8vbm90ZTogdGhpcyBoYXMgYmFkIHBlcmZvcm1hbmNlIHdpdGggYmlnIGFycmF5c1xuICAgICAgICAgICAgICAgIC8vdmFyIGhhc0R1cGxpY2F0ZUFuc3dlclJlZiA9IGFuc3dlcl9yZWZzLnNvbWUoZnVuY3Rpb24gKHJlZiwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICByZXR1cm4gYW5zd2VyX3JlZnMuaW5kZXhPZihyZWYpICE9PSBpbmRleDtcbiAgICAgICAgICAgICAgICAvL30pO1xuICAgICAgICAgICAgICAgIHZhciBzZWVuID0ge307IC8vIENyZWF0ZSBhbiBvYmplY3QgdG8ga2VlcCB0cmFjayBvZiBlbmNvdW50ZXJlZCBhbnN3ZXJfcmVmc1xuICAgICAgICAgICAgICAgIHZhciBoYXNEdXBsaWNhdGVBbnN3ZXJSZWYgPSBwb3NzaWJsZV9hbnN3ZXJzLnNvbWUoZnVuY3Rpb24gKHBvc3NpYmxlX2Fuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vlbltwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBJZiBpdCdzIGFscmVhZHkgaW4gJ3NlZW4nLCB3ZSBoYXZlIGEgZHVwbGljYXRlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWVuW3Bvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmXSA9IHRydWU7IC8vIE1hcmsgaXQgYXMgc2VlblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaGFzRHVwbGljYXRlQW5zd2VyUmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIWFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuXG4gICAgaXNWYWxpZElucHV0OiBmdW5jdGlvbiAoZm9ybV9yZWYsIGlucHV0LCBpc19icmFuY2gsIGlzX2dyb3VwKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgdmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgaW5wdXRfcmVmX3JlZ2V4ID0gbmV3IFJlZ0V4cChjb25zdHMuUkVHRVguaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIHJlYWRtZSA9ICcnO1xuXG4gICAgICAgIHZhciB2YWxpZElucHV0U3RydWN0dXJlID0ge1xuICAgICAgICAgICAgcmVmOiAnJyxcbiAgICAgICAgICAgIHR5cGU6ICcnLFxuICAgICAgICAgICAgcXVlc3Rpb246ICcnLFxuICAgICAgICAgICAgaXNfdGl0bGU6IHRydWUsXG4gICAgICAgICAgICBpc19yZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICB1bmlxdWVuZXNzOiAnJyxcbiAgICAgICAgICAgIHJlZ2V4OiBudWxsLFxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHZlcmlmeTogZmFsc2UsXG4gICAgICAgICAgICBtYXg6IG51bGwsXG4gICAgICAgICAgICBtaW46IG51bGwsXG4gICAgICAgICAgICBkYXRldGltZV9mb3JtYXQ6IG51bGwsXG4gICAgICAgICAgICBzZXRfdG9fY3VycmVudF9kYXRldGltZTogZmFsc2UsXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzOiBbXSxcbiAgICAgICAgICAgIGp1bXBzOiBbXSxcbiAgICAgICAgICAgIGJyYW5jaDogW10sXG4gICAgICAgICAgICBncm91cDogW11cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYWNjZXB0ZWRfdHlwZXMgPSBbXG4gICAgICAgICAgICBjb25zdHMuVEVYVF9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLlRFWFRBUkVBX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuSU5URUdFUl9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkRFQ0lNQUxfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5EQVRFX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuVElNRV9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLlJBRElPX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuQ0hFQ0tCT1hfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5EUk9QRE9XTl9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkJBUkNPREVfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5MT0NBVElPTl9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkFVRElPX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuVklERU9fVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5QSE9UT19UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkJSQU5DSF9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkdST1VQX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuUkVBRE1FX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuUEhPTkVfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEVcbiAgICAgICAgXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgaW5wdXQgc3RydWN0dXJlXG4gICAgICAgICAqL1xuXG4gICAgICAgIGlmICghdXRpbHMuaGFzU2FtZVByb3BzKHZhbGlkSW5wdXRTdHJ1Y3R1cmUsIGlucHV0KSkge1xuICAgICAgICAgICAgLy9pdCBtZWFucyB0aGUgaW5wdXQgc3RydWN0dXJlIGlzIGludmFsaWRcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSByZWZcbiAgICAgICAgICovXG4gICAgICAgIGlmIChpbnB1dC5yZWYgJiYgdHlwZW9mIGlucHV0LnJlZiAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICBpZiAoIWlucHV0LnJlZi5zdGFydHNXaXRoKGZvcm1fcmVmKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vY2hlY2sgcmVmIHN0cnVjdHVyZVxuICAgICAgICAgICAgaWYgKCFpbnB1dF9yZWZfcmVnZXgudGVzdChpbnB1dC5yZWYpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtdXN0IGhhdmUgMyBjb21wb25lbnRzXG4gICAgICAgICAgICBpZiAoaW5wdXQucmVmLnNwbGl0KCdfJykubGVuZ3RoICE9PSAzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy92YWxpZGF0ZSByZWYgYWdhaW5zdCByZWdleFxuICAgICAgICAvLyh0b2RvKVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSB0eXBlXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGFjY2VwdGVkX3R5cGVzKSA8IDAgfHwgdHlwZW9mIGlucHV0LnR5cGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgcXVlc3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgIC8vcmVhZG1lIHR5cGUgaXMgdXAgdG8gMTAwMCBjaGFycywgaHRtbCBpcyBhbGxvd2VkIChzZXJ2ZXIgY2F0Y2hlcyB3YXMgaXQgaXMgbm90KVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC5xdWVzdGlvbiAhPT0gJ3N0cmluZycgfHwgaW5wdXQucXVlc3Rpb24gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2ZpcnN0IGNvbnZlcnQgaHRtbCBlbnRpdGllcyB0byB0YWdzXG4gICAgICAgICAgICByZWFkbWUgPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgIC8vdGhlbiByZW1vdmUgYWxsIHRhZ3NcbiAgICAgICAgICAgIHJlYWRtZSA9IHJlYWRtZS5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcblxuICAgICAgICAgICAgLy9ub3cgY2hlY2sgdGhlIGxlbmdodCBvZiB0aGUgcmVtYWluaW5nIHB1cmUgdGV4dCA7KVxuICAgICAgICAgICAgaWYgKHJlYWRtZS5sZW5ndGggPiBjb25zdHMuTElNSVRTLnJlYWRtZV9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2FueSBvdGhlciBxdWVzdGlvblxuICAgICAgICAgICAgaWYgKGlucHV0LnF1ZXN0aW9uLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucXVlc3Rpb25fbGVuZ3RoIHx8IHR5cGVvZiBpbnB1dC5xdWVzdGlvbiAhPT0gJ3N0cmluZycgfHwgaW5wdXQucXVlc3Rpb24gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5wdXQucXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFZhbGlkYXRlIGlzX3RpdGxlXG4gICAgICAgICAqL1xuXG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXQuaXNfdGl0bGUgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqICBWYWxpZGF0ZSBpc19yZXF1aXJlZFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC5pc19yZXF1aXJlZCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2NoZWNrIGlmIHdlIGNhbiBoYXZlIHJlcXVpcmVkIHNldCB0byB0cnVlXG4gICAgICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5SRVFVSVJFRF9BTExPV0VEX1RZUEVTKSA8IDAgJiYgaW5wdXQuaXNfcmVxdWlyZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgdW5pcXVlbmVzc1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC50eXBlLCBjb25zdHMuVU5JUVVFTkVTU19BTExPV0VEX1RZUEVTKSA8IDApIHtcbiAgICAgICAgICAgIC8vdW5pcXVlc3MgbXVzdCBiZSBcIm5vbmVcIlxuICAgICAgICAgICAgaWYgKGlucHV0LnVuaXF1ZW5lc3MgIT09IGNvbnN0cy5VTklRVUVTU19OT05FKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGlzX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIGlmICghKGlucHV0LnVuaXF1ZW5lc3MgPT09IGNvbnN0cy5VTklRVUVTU19OT05FIHx8IGlucHV0LnVuaXF1ZW5lc3MgPT0gY29uc3RzLlVOSVFVRVNTX0ZPUk0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIShpbnB1dC51bmlxdWVuZXNzID09PSBjb25zdHMuVU5JUVVFU1NfTk9ORSB8fCBpbnB1dC51bmlxdWVuZXNzID09PSBjb25zdHMuVU5JUVVFU1NfRk9STSB8fCBpbnB1dC51bmlxdWVuZXNzID09IGNvbnN0cy5VTklRVUVTU19ISUVSQVJDSFkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgcmVnZXggKGNhbiBiZSBudWxsKVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0LnJlZ2V4ICE9PSBudWxsICYmIGlucHV0LnJlZ2V4ICE9PSAnJykge1xuICAgICAgICAgICAgaWYgKGlucHV0LnJlZ2V4Lmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucmVnZXhfbGVuZ3RoIHx8IHR5cGVvZiBpbnB1dC5yZWdleCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2NoZWNrIGlmIGEgcmVnZXggaXMgYWxsb3dlZCBmb3IgdGhpcyBpbnB1dCB0eXBlP1xuICAgICAgICAgICAgLy90b2RvXG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSBkZWZhdWx0IGFuc3dlclxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0LmRlZmF1bHQgIT09IG51bGwgJiYgaW5wdXQuZGVmYXVsdCAhPT0gJycpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5kZWZhdWx0Lmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMuZGVmYXVsdF9hbnN3ZXJfbGVuZ3RoIHx8IHR5cGVvZiBpbnB1dC5kZWZhdWx0ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9tdWx0aXBsZSBhbnN3ZXJzIHR5cGU/XG4gICAgICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoYXQgdGhlIGRlZmF1bHQgYW5zd2VyIChpZiBzZXQpIGlzIG9uZSBvZiB0aGUgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICQoaW5wdXQucG9zc2libGVfYW5zd2VycykuZWFjaChmdW5jdGlvbiAoa2V5LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmID09PSBpbnB1dC5kZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7Ly9leGl0IHRoZSBsb29wXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vdmFsaWQgZGVmYXVsdCBhbnN3ZXIsIHN0cmlwIGh0bWwgdGFnc1xuICAgICAgICAgICAgICAgIGlucHV0LmRlZmF1bHQgPSBpbnB1dC5kZWZhdWx0LnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFZhbGlkYXRlIHZlcmlmeVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC52ZXJpZnkgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogdmFsaWRhdGUgbWF4IGFuZCBtaW4gKGZvciBudW1lcmljIHR5cGVzKVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5JTlRFR0VSX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkRFQ0lNQUxfVFlQRSkge1xuICAgICAgICAgICAgLy9jaGVjayBtaW4sIGlmIGl0IGlzIHNldCBtdXN0IGJlIG51bWVyaWMuIGNhbiBiZSBudWxsXG4gICAgICAgICAgICBpZiAoaW5wdXQubWluKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLklOVEVHRVJfVFlQRSAmJiAhdXRpbHMuaXNJbnRlZ2VyKHBhcnNlSW50KGlucHV0Lm1pbikpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkRFQ0lNQUxfVFlQRSAmJiAhJC5pc051bWVyaWMoaW5wdXQubWluKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0Lm1pbi50b1N0cmluZygpLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMubWluX3ZhbHVlX2xlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vY2hlY2sgbWluLCBpZiBpdCBpcyBzZXQgbXVzdCBiZSBudW1lcmljLiBjYW4gYmUgbnVsbFxuICAgICAgICAgICAgaWYgKGlucHV0Lm1heCkge1xuXG4gICAgICAgICAgICAgICAgLy9iYWlsIGlmIG5vdCBpbnRlZ2VyIGZvciBpbnRlZ2VyIHR5cGVcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLklOVEVHRVJfVFlQRSAmJiAhdXRpbHMuaXNJbnRlZ2VyKHBhcnNlSW50KGlucHV0Lm1heCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2JhaWwgaWYgbm90IG51bWVyaWMgZm9yIGRlY2ltYWwgdHlwZVxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuREVDSU1BTF9UWVBFICYmICEkLmlzTnVtZXJpYyhpbnB1dC5tYXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQubWF4LnRvU3RyaW5nKCkubGVuZ3RoID4gY29uc3RzLkxJTUlUUy5tYXhfdmFsdWVfbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgdGhleSBhcmUgYm90aCBzZXQsIGNoZWNrIG1pbiA8IG1heFxuICAgICAgICAgICAgaWYgKGlucHV0Lm1pbiAmJiBpbnB1dC5tYXgpIHtcblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuSU5URUdFUl9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChpbnB1dC5taW4sIDEwKSA+PSBwYXJzZUludChpbnB1dC5tYXgsIDEwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5ERUNJTUFMX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoaW5wdXQubWluLCAxMCkgPj0gcGFyc2VGbG9hdChpbnB1dC5tYXgsIDEwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFZhbGlkYXRlIGRhdGUgZm9ybWF0XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8vZGF0ZVxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkRBVEVfVFlQRSkge1xuICAgICAgICAgICAgaWYgKGlucHV0LmRhdGV0aW1lX2Zvcm1hdCkge1xuICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoaW5wdXQuZGF0ZXRpbWVfZm9ybWF0LCB2YWxpZF9kYXRlX2Zvcm1hdHMpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAvL2Zvcm1hdCBub3QgYWxsb3dlZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy90aW1lXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuVElNRV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQuZGF0ZXRpbWVfZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC5kYXRldGltZV9mb3JtYXQsIHZhbGlkX3RpbWVfZm9ybWF0cykgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZm9ybWF0IG5vdCBhbGxvd2VkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgc2V0X3RvX2N1cnJlbnRfZGF0ZXRpbWVcbiAgICAgICAgICovXG4gICAgICAgIGlmIChpbnB1dC5zZXRfdG9fY3VycmVudF9kYXRldGltZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC5zZXRfdG9fY3VycmVudF9kYXRldGltZSAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2l0IGNhbiBiZSB0cnVlIG9ubHkgZm9yIGRhdGUgYW5kIHRpbWUgaW5wdXQgdHlwZXNcbiAgICAgICAgICAgIGlmIChpbnB1dC5zZXRfdG9fY3VycmVudF9kYXRldGltZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGlmICghKGlucHV0LnR5cGUgPT09IGNvbnN0cy5EQVRFX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlRJTUVfVFlQRSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgICAgIGlmICghc2VsZi5hcmVQb3NzaWJsZUFuc3dlcnNWYWxpZChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLCBpbnB1dC50eXBlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNfYnJhbmNoICYmICFpc19ncm91cCkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBWYWxpZGF0ZSBqdW1wc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoIXNlbGYuYXJlSnVtcHNWYWxpZChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLy90b3AgbGV2ZWwgaW5wdXQsIHZhbGlkYXRlIGJyYW5jaCBhbmQgZ3JvdXAgcmVjdXJzaXZlbHlcblxuICAgICAgICAgICAgLy9icmFuY2hcbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoaW5wdXQuYnJhbmNoKSkge1xuICAgICAgICAgICAgICAgICQoaW5wdXQuYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYnJhbmNoX2lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXNWYWxpZElucHV0KGZvcm1fcmVmLCBicmFuY2hfaW5wdXQsIHRydWUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9ncm91cFxuICAgICAgICAgICAgaWYgKCQuaXNBcnJheShpbnB1dC5ncm91cCkpIHtcbiAgICAgICAgICAgICAgICAkKGlucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pc1ZhbGlkSW5wdXQoZm9ybV9yZWYsIGdyb3VwX2lucHV0LCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgaWYgKGlzX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIC8vYnJhbmNoIGluIGJyYW5jaCBpcyBub3QgYWxsb3dlZFxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5icmFuY2gubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogVmFsaWRhdGUganVtcHNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuYXJlSnVtcHNWYWxpZChpbnB1dC5icmFuY2gpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpc19ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vZ3JvdXAgaW4gZ3JvdXAgaXMgbm90IGFsbG93ZWRcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuZ3JvdXAubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9qdW1wcyBpbiBncm91cCBhcmUgbm90IGFsbG93ZWRcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuanVtcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxpZDtcbiAgICB9XG5cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBpbXBvcnRfZm9ybV92YWxpZGF0aW9uO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBsb2FkX2NoaWxkX2Zvcm1fY29udGFpbmVycyA9IHJlcXVpcmUoJ2xvYWRlcnMvbG9hZC1jaGlsZC1mb3JtLWNvbnRhaW5lcnMnKTtcblxudmFyIHVpID0ge1xuXG4gICAgbmF2YmFyOiB7XG5cbiAgICAgICAgdG9nZ2xlVW5kb0J0bjogZnVuY3Rpb24gKHN0YXR1cykge1xuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSBjb25zdHMuQlROX0RJU0FCTEVEKSB7XG4gICAgICAgICAgICAgICAgLy90b2dnbGUgYnV0dG9uXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnVuZG9fYnRuXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSBjb25zdHMuQlROX0VOQUJMRUQpIHtcbiAgICAgICAgICAgICAgICAvL3RvZ2dsZSBidXR0b25cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20udW5kb19idG5cbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHRvZ2dsZVNhdmVQcm9qZWN0QnRuOiBmdW5jdGlvbiAoc3RhdHVzKSB7XG5cbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IGNvbnN0cy5CVE5fRElTQUJMRUQpIHtcbiAgICAgICAgICAgICAgICAvL3RvZ2dsZSBidXR0b25cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0blxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSBjb25zdHMuQlROX0VOQUJMRUQpIHtcbiAgICAgICAgICAgICAgICAvL3RvZ2dsZSBidXR0b25cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0blxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vdG9nZ2xlIGljb25cbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IGNvbnN0cy5CVE5fRU5BQkxFRCkge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyXG4gICAgICAgICAgICAgICAgICAgIC5kb20uc2F2ZV9wcm9qZWN0X2J0blxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLnByb2plY3Qtc3RhdGUnKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ZhLXdhcm5pbmcnKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2ZhLWNoZWNrJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlclxuICAgICAgICAgICAgICAgICAgICAuZG9tLnNhdmVfcHJvamVjdF9idG5cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5wcm9qZWN0LXN0YXRlJylcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCdmYS13YXJuaW5nJylcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdmYS1jaGVjaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBmb3Jtc190YWJzOiB7XG5cbiAgICAgICAgaW5qZWN0UmVmSW50b0Zvcm1UYWI6IGZ1bmN0aW9uIChyZWYpIHtcblxuICAgICAgICAgICAgdmFyIHRhYl9idXR0b24gPSAkKCcubWFpbiAubWFpbl9fdGFicyBsaScpLmZpcnN0KCk7XG4gICAgICAgICAgICB2YXIgdGFiX3BhbmVsID0gJCgnLm1haW4gLm1haW5fX3RhYnMtY29udGVudCAubWFpbl9fdGFicy1jb250ZW50LXRhYnBhbmVsJykuZmlyc3QoKTtcblxuICAgICAgICAgICAgLy9pbmplY3QgcmVmIG9mIHRoZSBmaXJzdCBmb3JtIHRvIHRoZSBmaXN0IHRhYi90YWIgY29udGVudCwgYXMgaXQgaXMgc2hvd24gYnkgZGVmYXVsdFxuICAgICAgICAgICAgdGFiX2J1dHRvbi5maW5kKCdhJykuYXR0cignaHJlZicsICcjJyArIHJlZiArICctdGFicGFuZWwnKTtcbiAgICAgICAgICAgIHRhYl9wYW5lbC5maXJzdCgpLmF0dHIoJ2lkJywgcmVmICsgJy10YWJwYW5lbCcpO1xuICAgICAgICAgICAgdGFiX3BhbmVsLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbicpLmF0dHIoJ2lkJywgcmVmICsgJy1pbnB1dHMtY29sbGVjdGlvbicpO1xuICAgICAgICAgICAgdGFiX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzJykuYXR0cignaWQnLCByZWYgKyAnLWlucHV0LXByb3BlcnRpZXMnKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHRvZ2dsZUZvcm1UYWJzQnV0dG9uczogZnVuY3Rpb24gKG9wdGlvbikge1xuXG4gICAgICAgICAgICBpZiAob3B0aW9uLmVuYWJsZSkge1xuICAgICAgICAgICAgICAgIC8vZW5hYmxlIGZvcm0gdGFiIGJ1dHRvbnNcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCdsaScpXG4gICAgICAgICAgICAgICAgICAgIC5ub3QoJy5tYWluX190YWJzLWJ0bnMnKVxuICAgICAgICAgICAgICAgICAgICAuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoaXRlbSkucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkIGRpc2FibGVkLXRhYicpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vZGlzYWJsZSBmb3JtIHRhYiBidXR0b25zXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAubm90KCcubWFpbl9fdGFicy1idG5zJylcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKGl0ZW0pLmFkZENsYXNzKCdkaXNhYmxlZCBkaXNhYmxlZC10YWInKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0Rmlyc3RGb3JtVGFiTmFtZTogZnVuY3Rpb24gKHRoZV9mb3JtX25hbWUpIHtcblxuICAgICAgICAgICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnNcbiAgICAgICAgICAgICAgICAuZmluZCgnLmFjdGl2ZSBhW2RhdGEtZm9ybS1pbmRleD1cIjBcIl0nKVxuICAgICAgICAgICAgICAgIC50ZXh0KHRoZV9mb3JtX25hbWUudHJ1bmMoY29uc3RzLlRBQl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUIC0gKGZvcm1zLmxlbmd0aCAqIDIpKSlcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCcmbmJzcDs8aSBjbGFzcz1cImZvcm0tc3RhdGUgZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIj48L2k+Jyk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvL2lmIHRoZSBmb3JtIGlzIHZhbGlkIHNob3cgYSBncmVlbiBjaGVjayBvbiBpdHMgdGFiIGJ1dHRvblxuICAgICAgICBzaG93Rm9ybVZhbGlkSWNvbjogZnVuY3Rpb24gKHRoZV9mb3JtX2luZGV4KSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic1xuICAgICAgICAgICAgICAgIC5maW5kKCdsaSBhW2RhdGEtZm9ybS1pbmRleD0nICsgdGhlX2Zvcm1faW5kZXggKyAnXSBpLmZvcm0tc3RhdGUnKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUnKS5hZGRDbGFzcygnZmEtY2hlY2snKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvL2lmIHRoZSBmb3JtIGlzIE5PVCB2YWxpZCBzaG93IGEgd2FybmluZyBpY29uIG9uIGl0cyB0YWIgYnV0dG9uXG4gICAgICAgIHNob3dGb3JtSW52YWxpZEljb246IGZ1bmN0aW9uICh0aGVfZm9ybV9pbmRleCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnNcbiAgICAgICAgICAgICAgICAuZmluZCgnbGkgYVtkYXRhLWZvcm0taW5kZXg9JyArIHRoZV9mb3JtX2luZGV4ICsgJ10gaS5mb3JtLXN0YXRlJylcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ZhLWNoZWNrJykuYWRkQ2xhc3MoJ2ZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9yZXR1cm4gdGhlIG1hcmt1cCBmb3IgYSBmb3JtIHRhYiBidXR0b24sIHNob3dpbmcgZm9ybSBuYW1lXG4gICAgICAgIGdldEZvcm1UYWJCdXR0b25IVE1MOiBmdW5jdGlvbiAoZm9ybSkge1xuXG4gICAgICAgICAgICB2YXIgaHRtbCA9ICcnO1xuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG4gICAgICAgICAgICBodG1sICs9ICc8bGkgcm9sZT1cInByZXNlbnRhdGlvblwiIGNsYXNzPVwibWFpbl9fdGFic19fZm9ybS1idG5cIj4nO1xuICAgICAgICAgICAgaHRtbCArPSAnPGEgaHJlZj1cIiMnICsgZm9ybS5yZWYgKyAnLXRhYnBhbmVsXCIgcm9sZT1cInRhYlwiIGRhdGEtdG9nZ2xlPVwidGFiXCIgZGF0YS1mb3JtLWluZGV4PVwiJyArIGZvcm1faW5kZXggKyAnXCI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gZm9ybS5uYW1lLnRydW5jKGNvbnN0cy5UQUJfRk9STV9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCAtIChmb3Jtcy5sZW5ndGggKiAyKSk7XG4gICAgICAgICAgICBodG1sICs9ICcmbmJzcDs8aSBjbGFzcz1cImZvcm0tc3RhdGUgZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIj48L2k+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvYT4nO1xuICAgICAgICAgICAgaHRtbCArPSAnPC9saT4nO1xuXG4gICAgICAgICAgICByZXR1cm4gaHRtbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvL2dldCBtYXJrdXAgZm9yIGEgZm9ybSB0YWIgY29udGVudCAoaW5wdXQgY29sbGVjdGlvbiArIGlucHV0IHByb3BlcnRpZXMpXG4gICAgICAgIGdldEZvcm1UYWJDb250ZW50SFRNTDogZnVuY3Rpb24gKGZvcm0pIHtcblxuICAgICAgICAgICAgdmFyIGh0bWwgPSAnJztcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcblxuICAgICAgICAgICAgJC53aGVuKGxvYWRfY2hpbGRfZm9ybV9jb250YWluZXJzKCkpLnRoZW4oZnVuY3Rpb24gKHZpZXdzKSB7XG5cbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IHJvbGU9XCJ0YWJwYW5lbFwiIGNsYXNzPVwibWFpbl9fdGFicy1jb250ZW50LXRhYnBhbmVsIHRhYi1wYW5lIGZhZGUgaW4gYWN0aXZlXCIgaWQ9XCInICsgZm9ybS5yZWYgKyAnLXRhYnBhbmVsXCI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGlkPVwiJyArIGZvcm0ucmVmICsgJy1pbnB1dHMtY29sbGVjdGlvblwiIGNsYXNzPVwiaW5wdXRzLWNvbGxlY3Rpb24gY29sLW1kLTZcIj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gdmlld3MuaW5wdXRzX2NvbGxlY3Rpb247XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGlkPVwiJyArIGZvcm0ucmVmICsgJy1pbnB1dC1wcm9wZXJ0aWVzXCIgY2xhc3M9XCJpbnB1dC1wcm9wZXJ0aWVzIGNvbC1tZC02XCI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9IHZpZXdzLmlucHV0c19wcm9wZXJ0aWVzO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcblxuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaHRtbCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZXNpemVGb3JtVGFiczogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2xpOmx0KCcgKyBmb3Jtcy5sZW5ndGggKyAnKScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBmb3JtX2J0bikge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9ICQoZm9ybV9idG4pLmZpbmQoJ2EgaScpLmhhc0NsYXNzKCdmYS1jaGVjaycpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnRuID0gJChmb3JtX2J0bikuZmluZCgnYScpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsaWRfaWNvbl9odG1sID0gJyZuYnNwOzxpIGNsYXNzPVwiZm9ybS1zdGF0ZSBmYSBmYS1jaGVja1wiPjwvaT4nO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW52YWxpZF9pY29uX2h0bWwgPSAnJm5ic3A7PGkgY2xhc3M9XCJmb3JtLXN0YXRlIGZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlXCI+PC9pPic7XG5cbiAgICAgICAgICAgICAgICAgICAgYnRuLnRleHQoZm9ybXNbaW5kZXhdLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC50cnVuYyhjb25zdHMuVEFCX0ZPUk1fTkFNRV9NQVhfRElTUExBWV9MRU5HSFQgLSAoZm9ybXMubGVuZ3RoICogMikpKTtcbiAgICAgICAgICAgICAgICAgICAgYnRuLmFwcGVuZChzdGF0ZSA/IHZhbGlkX2ljb25faHRtbCA6IGludmFsaWRfaWNvbl9odG1sKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgaW5wdXRzX2NvbGxlY3Rpb246IHtcblxuICAgICAgICAvL3Nob3cvaGlkZSB0aGUgdGl0bGUgbm90IHNldCB3YXJuaW5nIG1lc3NhZ2VcbiAgICAgICAgdG9nZ2xlVGl0bGVXYXJuaW5nOiBmdW5jdGlvbiAoY291bnQsIGlzX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAvL2ZpbmQgd2FybmluZyBmb3IgZWl0aGVyIHRoZSBhY3RpdmUgZm9ybSBvciB0aGUgYWN0aXZlIGJyYW5jaFxuICAgICAgICAgICAgdmFyIGVsZW1lbnRfdG9fZmluZCA9IGlzX2JyYW5jaCA/ICcuYWN0aXZlLWJyYW5jaCAubm8tYnJhbmNoLXRpdGxlLXNldCcgOiAnLm5vLWZvcm0tdGl0bGUtc2V0JztcblxuICAgICAgICAgICAgaWYgKGNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy9zaG93XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoZWxlbWVudF90b19maW5kKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzdcbiAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9oaWRlXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoZWxlbWVudF90b19maW5kKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAwXG4gICAgICAgICAgICAgICAgfSwgY29uc3RzLkFOSU1BVElPTl9GQVNULCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGdldElucHV0U3RhdGVJY29uc0hUTUw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgdmFyIGh0bWwgPSAnJztcbiAgICAgICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwicXVlc3Rpb24tc3RhdGUgZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtMnggZmEtZncgcHVsbC1yaWdodFwiPjwvaT4nO1xuICAgICAgICAgICAgaHRtbCArPSAnPGkgY2xhc3M9XCJqdW1wLXN0YXRlIGZhIGZhLWFycm93LWNpcmNsZS1vLWRvd24gZmEtMnggZmEtZncgcHVsbC1yaWdodCBpbnZpc2libGVcIj48L2k+JztcblxuICAgICAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd0lucHV0VmFsaWRJY29uOiBmdW5jdGlvbiAodGhlX3JlZikge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGVfcmVmICsgJ1wiXSBpLnF1ZXN0aW9uLXN0YXRlJylcbiAgICAgICAgICAgICAgICAuZmlyc3QoKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUnKS5hZGRDbGFzcygnZmEtY2hlY2snKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93SW5wdXRJbnZhbGlkSWNvbjogZnVuY3Rpb24gKHRoZV9yZWYpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgdGhlX3JlZiArICdcIl0gaS5xdWVzdGlvbi1zdGF0ZScpXG4gICAgICAgICAgICAgICAgLmZpcnN0KClcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ZhLWNoZWNrJykuYWRkQ2xhc3MoJ2ZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3OiBmdW5jdGlvbiAodGhlX3JlZiwgdGhlX3F1ZXN0aW9uKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoZV9yZWYgKyAnXCJdID4gLmlucHV0LWlubmVyID4gLnF1ZXN0aW9uLXByZXZpZXcnKVxuICAgICAgICAgICAgICAgIC50ZXh0KHRoZV9xdWVzdGlvbi50cnVuYyg1MCkpO1xuICAgICAgICB9LFxuICAgICAgICB0b2dnbGVGb3JtQWN0aW9uQnV0dG9uczogZnVuY3Rpb24gKHRoZV9zdGF0ZSkge1xuICAgICAgICAgICAgdmFyIGJ1dHRvbnMgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmJ0bicpO1xuXG4gICAgICAgICAgICBpZiAodGhlX3N0YXRlKSB7XG4gICAgICAgICAgICAgICAgYnV0dG9ucy5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKS5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBidXR0b25zLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSkuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnZXRFbXB0eUNvbGxlY3Rpb25Tb3J0YWJsZUhUTUw6IGZ1bmN0aW9uICh0eXBlKSB7XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gJyc7XG5cbiAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCInICsgdHlwZSArICctc29ydGFibGUgaGlkZGVuXCI+JztcbiAgICAgICAgICAgIC8vbm8gdGl0bGUgc2V0IHdhcm5pbmcgKG9ubHkgZm9yIGJyYW5jaCB0eXBlKVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSkge1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJ3YXJuaW5nLXdlbGwgbm8tYnJhbmNoLXRpdGxlLXNldCBoaWRkZW5cIj5ObyB0aXRsZSBzZXQgZm9yIHRoaXMgYnJhbmNoIHlldCAnO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwiZmEgZmEtcXVlc3Rpb24tY2lyY2xlIGZhLTJ4IGZhLWZ3XCIgZGF0YS10b2dnbGU9XCJtb2RhbFwiIGRhdGEtdGFyZ2V0PVwiI2luZm8tdGl0bGVcIj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvaT4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL25vIGlucHV0cyB5ZXQgbWVzc2FnZVxuICAgICAgICAgICAgaHRtbCArPSAnPHNwYW4gY2xhc3M9XCJpbnB1dC1wcm9wZXJ0aWVzX19uby0nICsgdHlwZSArICctcXVlc3Rpb25zLW1lc3NhZ2VcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gdHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFID8gbWVzc2FnZXMubGFiZWxzLkFERF9CUkFOQ0hfSU5QVVRTX0hFUkUgOiBtZXNzYWdlcy5sYWJlbHMuQUREX0dST1VQX0lOUFVUU19IRVJFO1xuICAgICAgICAgICAgaHRtbCArPSAnPC9zcGFuPic7XG4gICAgICAgICAgICBodG1sICs9ICd7eycgKyB0eXBlICsgJy1pbnB1dHN9fSc7XG4gICAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xuXG4gICAgICAgICAgICByZXR1cm4gaHRtbDtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgaW5wdXRfdG9vbHM6IHtcblxuICAgICAgICBlbmFibGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJ3VsI2lucHV0cy10b29scy1saXN0IGxpIGRpdi5pbnB1dCcpXG4gICAgICAgICAgICAgICAgLmRyYWdnYWJsZSgnZW5hYmxlJylcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2RyYWdnaW5nLWRpc2FibGVkJyk7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vZGlzYWJsZSBkcmFnZ2FibGVcbiAgICAgICAgICAgICQoJ3VsI2lucHV0cy10b29scy1saXN0IGxpIGRpdi5pbnB1dCcpXG4gICAgICAgICAgICAgICAgLmRyYWdnYWJsZSgnZGlzYWJsZScpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdkcmFnZ2luZy1kaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAvL3Nob3cgdG9hc3QgbWF4IG51bWJlciBvZiBpbnB1dCBoaXRcbiAgICAgICAgICAgIC8vdG9kb1xuICAgICAgICB9LFxuICAgICAgICBoaWRlU2VhcmNoSW5wdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LXNlYXJjaCcpLmhpZGUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2hvd1NlYXJjaElucHV0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1zZWFyY2gnKS5zaG93KCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGlucHV0X3Byb3BlcnRpZXNfcGFuZWw6IHtcblxuICAgICAgICB0b2dnbGVBZGRBbnN3ZXJCdG46IGZ1bmN0aW9uIChpc19kaXNhYmxlZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSB1dGlscy5nZXRBY3RpdmVJbnB1dCgpO1xuICAgICAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb21cbiAgICAgICAgICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuXG4gICAgICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19hZGQtYW5zd2VyJylcbiAgICAgICAgICAgICAgICAuYXR0cignZGlzYWJsZWQnLCBpc19kaXNhYmxlZCk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZXRVbmlxdWVuZXNzUHJvcGVydHk6IGZ1bmN0aW9uICh0aGVfZm9ybV9pbmRleCwgdGhlX2lucHV0KSB7XG5cbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gdGhlX2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG5cbiAgICAgICAgICAgIGlmIChmb3JtX2luZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdW5pcXVlbmVzcyBpbnB1dCcpXG4gICAgICAgICAgICAgICAgICAgIC5wcm9wKCdjaGVja2VkJywgaW5wdXQudW5pcXVlc3MgIT09IGNvbnN0cy5VTklRVUVTU19OT05FKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoaW5wdXQudW5pcXVlbmVzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLlVOSVFVRVNTX0ZPUk06XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX191bmlxdWVuZXNzIGlucHV0LnVuaXF1ZW5lc3MtZm9ybScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5VTklRVUVTU19ISUVSQVJDSFk6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX191bmlxdWVuZXNzIGlucHV0LnVuaXF1ZW5lc3MtaGllcmFyY2h5JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dJbnB1dFF1ZXN0aW9uUHJldmlldzogZnVuY3Rpb24gKHF1ZXN0aW9uKSB7XG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5wYW5lbCAucGFuZWwtaGVhZGluZyAuaW5wdXQtcHJvcGVydGllc19faGVhZGVyIC5xdWVzdGlvbi1wcmV2aWV3JylcbiAgICAgICAgICAgICAgICAudGV4dChxdWVzdGlvbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdG9nZ2xlSnVtcFRhYjogZnVuY3Rpb24gKHRoZV9yZWYsIHRoZV9zdGF0ZSkge1xuXG4gICAgICAgICAgICB2YXIganVtcF90YWIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhlX3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicycpXG4gICAgICAgICAgICAgICAgLmNoaWxkcmVuKClcbiAgICAgICAgICAgICAgICAuZXEoMik7XG5cbiAgICAgICAgICAgIC8vdHJ1ZSBlbmFibGUsIGZhbHNlIGRpc2FibGVcbiAgICAgICAgICAgIGlmICh0aGVfc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBqdW1wX3RhYi5yZW1vdmVDbGFzcygnZGlzYWJsZWQgZGlzYWJsZWQtdGFiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBqdW1wX3RhYi5hZGRDbGFzcygnZGlzYWJsZWQgZGlzYWJsZWQtdGFiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd0p1bXBUYWJFcnJvcjogZnVuY3Rpb24gKGp1bXBfZG9tX29iamVjdCkge1xuXG4gICAgICAgICAgICAvL3Nob3cgJyEnIG9uIGFmZmVjdGVkIHRhYiwgaW4gdGhpcyBjYXNlIHRoZSBqdW1wIHByb3BlcnRpZXMgdGFiICh0aGlyZClcbiAgICAgICAgICAgIGp1bXBfZG9tX29iamVjdFxuICAgICAgICAgICAgICAgIC5wYXJlbnRzKClcbiAgICAgICAgICAgICAgICAuZXEoNSlcbiAgICAgICAgICAgICAgICAuZmluZCgnLm5hdi10YWJzJylcbiAgICAgICAgICAgICAgICAuZmluZCgnaS5qdW1wcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdpbnZpc2libGUnKVxuICAgICAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgICAgICAuZmFkZUluKDMwMCk7XG5cbiAgICAgICAgICAgIC8vc2V0IGp1bXAgcHJvcGVydGllcyB0YWIgdGV4dCB0byByZWRcbiAgICAgICAgICAgIGp1bXBfZG9tX29iamVjdFxuICAgICAgICAgICAgICAgIC5wYXJlbnRzKClcbiAgICAgICAgICAgICAgICAuZXEoNSlcbiAgICAgICAgICAgICAgICAuZmluZCgnLm5hdi10YWJzJylcbiAgICAgICAgICAgICAgICAuZmluZCgnaS5qdW1wcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBoaWRlSnVtcFRhYkVycm9yOiBmdW5jdGlvbiAoanVtcF9kb21fb2JqZWN0KSB7XG5cbiAgICAgICAgICAgIC8vc2hvdyAnIScgb24gYWZmZWN0ZWQgdGFiLCBpbiB0aGlzIGNhc2UgdGhlIGp1bXAgcHJvcGVydGllcyB0YWIgKHRoaXJkKVxuICAgICAgICAgICAganVtcF9kb21fb2JqZWN0XG4gICAgICAgICAgICAgICAgLnBhcmVudHMoKVxuICAgICAgICAgICAgICAgIC5lcSg1KVxuICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMnKVxuICAgICAgICAgICAgICAgIC5maW5kKCdpLmp1bXBzLWVycm9yJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2ludmlzaWJsZScpO1xuXG5cbiAgICAgICAgICAgIC8vc2V0IGp1bXAgcHJvcGVydGllcyB0YWIgdGV4dCB0byByZWRcbiAgICAgICAgICAgIGp1bXBfZG9tX29iamVjdFxuICAgICAgICAgICAgICAgIC5wYXJlbnRzKClcbiAgICAgICAgICAgICAgICAuZXEoNSlcbiAgICAgICAgICAgICAgICAuZmluZCgnLm5hdi10YWJzJylcbiAgICAgICAgICAgICAgICAuZmluZCgnaS5qdW1wcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICB0b2dnbGVUaXRsZUNoZWNrYm94OiBmdW5jdGlvbiAoc3RhdGUsIHJlZikge1xuXG4gICAgICAgICAgICB2YXIgdGl0bGVfY29udHJvbCA9IGZvcm1idWlsZGVyLmRvbVxuICAgICAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyByZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3RpdGxlLWZsYWcnKTtcblxuICAgICAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkRJU0FCTEVEX1NUQVRFOlxuICAgICAgICAgICAgICAgICAgICB0aXRsZV9jb250cm9sLmZpbmQoJ2xhYmVsJykuYWRkQ2xhc3MoJ2Rpc2FibGVkLWNoZWNrYm94Jyk7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlX2NvbnRyb2wuZmluZCgnaW5wdXQnKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpLmFkZENsYXNzKCdkaXNhYmxlZC1jaGVja2JveCcpO1xuICAgICAgICAgICAgICAgICAgICB0aXRsZV9jb250cm9sLmZpbmQoJ3NwYW4udGl0bGUtbGFiZWwnKS50ZXh0KGNvbnN0cy5NQVhfVElUTEVfTElNSVRfUkVBQ0hFRCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkVOQUJMRURfU1RBVEU6XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlX2NvbnRyb2wuZmluZCgnbGFiZWwnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQtY2hlY2tib3gnKTtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVfY29udHJvbC5maW5kKCdpbnB1dCcpLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZC1jaGVja2JveCcpO1xuICAgICAgICAgICAgICAgICAgICB0aXRsZV9jb250cm9sLmZpbmQoJ3NwYW4udGl0bGUtbGFiZWwnKS50ZXh0KGNvbnN0cy5VU0VfQU5TV0VSX0FTX1RJVExFKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRvZ2dsZUNvcHlJbnB1dEJ1dHRvbjogZnVuY3Rpb24gKHJlZiwgc3RhdGUpIHtcblxuICAgICAgICAgICAgdmFyIGNvcHlfYnRuID0gZm9ybWJ1aWxkZXIuZG9tXG4gICAgICAgICAgICAgICAgLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2J1dHRvbnMtLWNvcHktaW5wdXQnKTtcblxuICAgICAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkJUTl9ESVNBQkxFRDpcbiAgICAgICAgICAgICAgICAgICAgY29weV9idG4uYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuQlROX0VOQUJMRUQ6XG4gICAgICAgICAgICAgICAgICAgIGNvcHlfYnRuLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgZ3JvdXA6IHtcblxuICAgICAgICB0b2dnbGVFZGl0R3JvdXBCdXR0b246IGZ1bmN0aW9uICh0aGVfcmVmLCB0aGVfc3RhdGUpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGVfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19iYXNpYy1wcm9wZXJ0aWVzJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2VkaXQtZ3JvdXAnKS5hdHRyKCdkaXNhYmxlZCcsICF0aGVfc3RhdGUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhpZGVHcm91cElucHV0c0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsKSB7XG4gICAgICAgICAgICAvL3Nob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgdGhlX3Byb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yLS1ncm91cC1lcnJvcicpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgIC50ZXh0KCcmbmJzcDsnKTtcbiAgICAgICAgfVxuXG4gICAgfSxcbiAgICBicmFuY2g6IHtcblxuICAgICAgICB0b2dnbGVFZGl0QnJhbmNoQnV0dG9uOiBmdW5jdGlvbiAodGhlX3JlZiwgdGhlX3N0YXRlKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhlX3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYmFzaWMtcHJvcGVydGllcycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lZGl0LWJyYW5jaCcpLmF0dHIoJ2Rpc2FibGVkJywgIXRoZV9zdGF0ZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGlkZUJyYW5jaElucHV0c0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsKSB7XG4gICAgICAgICAgICAvL3Nob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgdGhlX3Byb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yLS1icmFuY2gtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAudGV4dCgnJm5ic3A7Jyk7XG4gICAgICAgIH0sXG4gICAgICAgIHNob3dCcmFuY2hJbnB1dFByb3BlcnRpZXNEb206IGZ1bmN0aW9uICh0aGVfYnJhbmNoX2lucHV0X2luZGV4KSB7XG5cbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9pbmRleCA9IHRoZV9icmFuY2hfaW5wdXRfaW5kZXg7XG4gICAgICAgICAgICB2YXIgYnJhbmNoX2lucHV0ID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5pbnB1dHNbb3duZXJfaW5wdXRfaW5kZXhdLmJyYW5jaFticmFuY2hfaW5wdXRfaW5kZXhdO1xuICAgICAgICAgICAgdmFyIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXI7XG4gICAgICAgICAgICB2YXIgdmlldyA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzW2JyYW5jaF9pbnB1dC50eXBlXTtcblxuXG4gICAgICAgICAgICAvL3RvZG8gdXBkYXRlIHZpZXcgdGVtcGxhdGUgd2l0aCByZWYgYW5kIHN0dWZmXG4gICAgICAgICAgICAvL2luaXQgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICAgICAgLy8gaGVscGVycy5pbml0SW5wdXRQcm9wZXJ0aWVzUGFuZWwoaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLCBicmFuY2hfaW5wdXQsIGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscyk7XG5cblxuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmFwcGVuZCh2aWV3KS5oaWRlKCkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cblxuICAgICAgICAgICAgLy8vL3RvZG8gbW92ZSB0aGlzIGluIG1vdXNlZG93bj9cbiAgICAgICAgICAgIC8vLy9mb3IgZ3JvdXAgbmVzdGVkIGluIGEgYnJhbmNoLCBlbmFibGUga2V5dXAgdG8gY2hlY2sgZm9yIHZhbGlkYXRpb24gb2YgaGVhZGVyIHRleHRcbiAgICAgICAgICAgIC8vaWYgKGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgLy8gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub2ZmKCdrZXl1cCcpLm9uKCdrZXl1cCcsICdpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2spO1xuICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAvL2Vsc2Uge1xuICAgICAgICAgICAgLy8gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub2ZmKCdrZXl1cCcpO1xuICAgICAgICAgICAgLy99XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHVpO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG52YXIgdXRpbHMgPSB7XG5cbiAgICAvL2Zyb20gTUROXG4gICAgSlNPTlBvbHlmaWxsOiB7XG4gICAgICAgIHBhcnNlOiBmdW5jdGlvbiAoc0pTT04pIHtcbiAgICAgICAgICAgIHJldHVybiBldmFsKCcoJyArIHNKU09OICsgJyknKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3RyaW5naWZ5OiAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgICAgICAgICAgIHZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKGEpID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlc2NNYXAgPSB7XG4gICAgICAgICAgICAgICAgJ1wiJzogJ1xcXFxcIicsXG4gICAgICAgICAgICAgICAgJ1xcXFwnOiAnXFxcXFxcXFwnLFxuICAgICAgICAgICAgICAgICdcXGInOiAnXFxcXGInLFxuICAgICAgICAgICAgICAgICdcXGYnOiAnXFxcXGYnLFxuICAgICAgICAgICAgICAgICdcXG4nOiAnXFxcXG4nLFxuICAgICAgICAgICAgICAgICdcXHInOiAnXFxcXHInLFxuICAgICAgICAgICAgICAgICdcXHQnOiAnXFxcXHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGVzY0Z1bmMgPSBmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlc2NNYXBbbV0gfHwgJ1xcXFx1JyArIChtLmNoYXJDb2RlQXQoMCkgKyAweDEwMDAwKS50b1N0cmluZygxNikuc3Vic3RyKDEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlc2NSRSA9IC9bXFxcXFwiXFx1MDAwMC1cXHUwMDFGXFx1MjAyOFxcdTIwMjldL2c7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gc3RyaW5naWZ5KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdudWxsJztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnbnVsbCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZS50b0pTT04gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmdpZnkodmFsdWUudG9KU09OKCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gJ1snO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gKGkgPyAnLCAnIDogJycpICsgc3RyaW5naWZ5KHZhbHVlW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMgKyAnXSc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLmhhc093blByb3BlcnR5KGspKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAucHVzaChzdHJpbmdpZnkoaykgKyAnOiAnICsgc3RyaW5naWZ5KHZhbHVlW2tdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3snICsgdG1wLmpvaW4oJywgJykgKyAnfSc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICdcIicgKyB2YWx1ZS50b1N0cmluZygpLnJlcGxhY2UoZXNjUkUsIGVzY0Z1bmMpICsgJ1wiJztcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKClcbiAgICB9LFxuICAgIC8vaHR0cHM6Ly9nb28uZ2wveDRqY1NcbiAgICBpc1NhZmFyaTogT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHdpbmRvdy5IVE1MRWxlbWVudCkuaW5kZXhPZignQ29uc3RydWN0b3InKSA+IDAgfHwgKGZ1bmN0aW9uIChwKSB7XG4gICAgICAgIHJldHVybiBwLnRvU3RyaW5nKCkgPT09ICdbb2JqZWN0IFNhZmFyaVJlbW90ZU5vdGlmaWNhdGlvbl0nO1xuICAgIH0pKCF3aW5kb3cuc2FmYXJpIHx8IHNhZmFyaS5wdXNoTm90aWZpY2F0aW9uKSxcblxuICAgIGdldENvbnRhaW5lcnNQYXRoOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBjb25zdHMuVklFV1NfUEFUSCArICdjb250YWluZXJzLyc7XG4gICAgfSxcblxuICAgIGdldFByb3BlcnRpZXNQYXRoOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBjb25zdHMuVklFV1NfUEFUSCArICdwcm9wZXJ0aWVzLyc7XG4gICAgfSxcblxuICAgIGdldFBhcnRpYWxzUGF0aDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gY29uc3RzLlZJRVdTX1BBVEggKyAncGFydGlhbHMvJztcbiAgICB9LFxuXG4gICAgLy9nbyBiYWNrIHRvIHByb2plY3QgZGV0YWlscyBwYWdlICh3aGVuIGluc2lkZSBFcGljb2xsZWN0NSBMYXJhdmVsKVxuICAgIGdvQmFjazogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgIC8vYm90aCBodHRwIGFuZCBodHRwc1xuICAgICAgICB2YXIgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7XG4gICAgICAgIHZhciBwYXJ0cyA9IGhyZWYucmVwbGFjZShwcm90b2NvbCArICcvLycsICcnKS5zcGxpdCgnLycpO1xuICAgICAgICB2YXIgbGFzdCA9IHBhcnRzLnBvcCgpO1xuICAgICAgICB2YXIgYmFja19ocmVmID0gcGFydHMuam9pbignLycpO1xuXG4gICAgICAgIC8vc3RhbmRhbG9uZSBtb2RlIGZvciB0ZXN0aW5nIGZyb20gbG9jYWxob3N0P1xuICAgICAgICBpZiAobGFzdC5pbmRleE9mKCdmb3JtYnVpbGRlcicpICE9PSAtMSkge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UocHJvdG9jb2wgKyAnLy8nICsgYmFja19ocmVmKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvL3Byb2plY3RfcmVmIGlzIGRlZmluZWQgb24gdGhlIHNlcnZlciwgYW5kIGl0IGlzIHVuaXF1ZSBzZXJ2ZXIgd2lzZVxuICAgIHNldFByb2plY3RVUkw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgZG9tYWluO1xuICAgICAgICB2YXIgcGF0aDtcbiAgICAgICAgdmFyIHNsdWc7XG4gICAgICAgIHZhciBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgIHZhciBwcm90b2NvbCA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgdmFyIHBhcnRzID0gaHJlZi5yZXBsYWNlKHByb3RvY29sICsgJy8vJywgJycpLnNwbGl0KCcvJyk7XG4gICAgICAgIHZhciBzdWJwYXRoO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdwYXJ0c1swXScsIHBhcnRzWzBdKTtcblxuICAgICAgICAvL3N0YW5kYWxvbmUgbW9kZSBmb3IgdGVzdGluZyBmcm9tIGxvY2FsaG9zdD9cbiAgICAgICAgaWYgKHBhcnRzWzBdLmluZGV4T2YoJ2xvY2FsaG9zdCcpICE9PSAtMSB8fCBwYXJ0c1swXS5pbmRleE9mKCduZ3JvaycpKSB7XG5cbiAgICAgICAgICAgIC8vaXMgc3RhbmRhbG9uZSBmb3JtYnVpbGRlcj9cbiAgICAgICAgICAgIGlmIChwYXJ0cy5pbmRleE9mKCdlcGljb2xsZWN0NS1mb3JtYnVpbGRlcicpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGJ1aWxkTG9jYWxQYXRoKCk7Ly90ZXN0aW5nIGxvY2FsbHksIGNvcHlpbmcgdGhlIGpzb24gaW50byBwcm9qZWN0Lmpzb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vaXQgaXMgYSBsb2NhbCBpbnN0YWxsYXRpb24gb2YgTGFyYXZlbFxuICAgICAgICAgICAgICAgIGJ1aWxkTGFyYXZlbFBhdGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vbGFyYXZlbCBzZXJ2ZXJcbiAgICAgICAgICAgIGJ1aWxkTGFyYXZlbFBhdGgoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbnN0cy5QUk9KRUNUX1VSTCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBidWlsZExhcmF2ZWxQYXRoKCkge1xuXG4gICAgICAgICAgICBzbHVnID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMl07XG4gICAgICAgICAgICBwYXJ0cy5zcGxpY2UocGFydHMubGVuZ3RoIC0gMywgMyk7XG4gICAgICAgICAgICBkb21haW4gPSBwcm90b2NvbCArICcvLycgKyBwYXJ0cy5qb2luKCcvJykgKyAnLyc7XG5cbiAgICAgICAgICAgIHBhdGggPSBjb25zdHMuQVBJX1BST0RVQ1RJT05fUEFUSDtcbiAgICAgICAgICAgIGNvbnN0cy5QUk9KRUNUX1VSTCA9IGRvbWFpbiArIHBhdGggKyBzbHVnO1xuXG4gICAgICAgICAgICAvL2RvIHRoaXMgZm9yIExhcmF2ZWwgaW50ZWdyYXRpb25cbiAgICAgICAgICAgIC8vcmVtb3ZlIGRvbWFpbiAoZmlyc3QgZWxlbWVudClcbiAgICAgICAgICAgIHBhcnRzLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHN1YnBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgY29uc3RzLlZJRVdTX1BBVEggPSAnLycgKyBzdWJwYXRoICsgJy8nICsgY29uc3RzLlZJRVdTX1BBVEg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdHMuVklFV1NfUEFUSCA9ICcvJyArIGNvbnN0cy5WSUVXU19QQVRIO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRMb2NhbFBhdGgoKSB7XG4gICAgICAgICAgICBjb25zdHMuUFJPSkVDVF9VUkwgPSBjb25zdHMuQVBJX0RFVkVMT1BNRU5UX0dFVF9QQVRIICsgY29uc3RzLkFQSV9ERVZFTE9QTUVOVF9QUk9KRUNUO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNldFByb2plY3RMb2dvVXJsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdocmVmID0+JyArIHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgdmFyIGRvbWFpbjtcbiAgICAgICAgdmFyIHBhdGg7XG4gICAgICAgIHZhciBzbHVnO1xuICAgICAgICB2YXIgaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICB2YXIgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7XG4gICAgICAgIHZhciBwYXJ0cyA9IGhyZWYucmVwbGFjZShwcm90b2NvbCArICcvLycsICcnKS5zcGxpdCgnLycpO1xuXG4gICAgICAgIHNsdWcgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAyXTtcbiAgICAgICAgcGFydHMuc3BsaWNlKHBhcnRzLmxlbmd0aCAtIDMsIDMpO1xuICAgICAgICBkb21haW4gPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyAnLy8nICsgcGFydHMuam9pbignLycpICsgJy8nO1xuXG4gICAgICAgIHBhdGggPSBjb25zdHMuQVBJX01FRElBX1BBVEg7XG4gICAgICAgIGNvbnN0cy5QUk9KRUNUX0xPR09fVVJMID0gZG9tYWluICsgcGF0aCArIHNsdWcgKyBjb25zdHMuQVBJX1BST0pFQ1RfTE9HT19RVUVSWV9TVFJJTkc7XG5cblxuICAgICAgICBjb25zb2xlLmxvZyhjb25zdHMuUFJPSkVDVF9MT0dPX1VSTCk7XG4gICAgfSxcblxuICAgIC8vd2UgZ2VuZXJhdGUgdGhlIHJlZnMgYXBwZW5kaW5nIGEgdW5pcWlkIHBlciBlYWNoIGxldmVsXG4gICAgLy9mb3JtIC0gaW5wdXQgLSBicmFuY2hfaW5wdXQgLSBncm91cF9pbnB1dFxuICAgIGdlbmVyYXRlRm9ybVJlZjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5yZWYgKyAnXycgKyB0aGlzLmdlbmVyYXRlVW5pcUlEKCk7XG4gICAgfSxcblxuICAgIC8vaW5wdXQgcmVmIGNvbnNpc3RzIG9mIGZvcm1fcmVmICsgaW5wdXRfcmVmXG4gICAgZ2VuZXJhdGVJbnB1dFJlZjogZnVuY3Rpb24gKGZvcm1fcmVmKSB7XG4gICAgICAgIHJldHVybiBmb3JtX3JlZiArICdfJyArIHRoaXMuZ2VuZXJhdGVVbmlxSUQoKTtcbiAgICB9LFxuXG4gICAgZ2VuZXJhdGVJbnB1dENvcHlSZWY6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgcmVmO1xuICAgICAgICAvL3RvcCBsZXZlbCBpbnB1dD9cbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiAhZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgcmVmID0gdXRpbHMuZ2VuZXJhdGVJbnB1dFJlZihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9nZW5lcmF0ZSBuZXN0ZWQgZ3JvdXAgaW5wdXQgcmVmIChwYXNzaW5nIGFjdGl2ZSBicmFuY2ggaW5wdXQgcmVmKVxuICAgICAgICAgICAgcmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgICAgICAvL2dlbmVyYXRlZCBicmFuY2ggaW5wdXQgcmVmXG4gICAgICAgICAgICAgICAgcmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vZ2VuZXJhdGUgZ3JvdXAgcmVmXG4gICAgICAgICAgICAgICAgcmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWY7XG4gICAgfSxcblxuICAgIC8vZm9yIGJyYW5jaCBhbmQgZ3JvdXBzLCB3ZSBhcHBlbmQgdGhlIHVuaXF1ZSBJRCB0byB0aGUgaW5wdXQgKG5lc3RpbmcgYSBsZXZlbCBtb3JlKVxuICAgIC8vYSBuZXN0ZWQgZ3JvdXAgd2lsbCBiZSAyIGxldmVscyBuZXN0ZWRcbiAgICBnZW5lcmF0ZUJyYW5jaEdyb3VwSW5wdXRSZWY6IGZ1bmN0aW9uIChpbnB1dF9yZWYpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0X3JlZiArICdfJyArIHRoaXMuZ2VuZXJhdGVVbmlxSUQoKTtcbiAgICB9LFxuICAgIGdlbmVyYXRlTmVzdGVkR3JvdXBJbnB1dFJlZjogZnVuY3Rpb24gKGdyb3VwX3JlZikge1xuICAgICAgICByZXR1cm4gZ3JvdXBfcmVmICsgJ18nICsgdGhpcy5nZW5lcmF0ZVVuaXFJRCgpO1xuICAgIH0sXG4gICAgLy9nZW5lcmF0ZSBQSFAgdHlwZSB1bmlxaWQgdG8gYmUgYXBwZW5kZWQgdG8gZm9ybSwgaW5wdXRzLCBicmFuY2ggYW5kIGdyb3Vwc1xuICAgIGdlbmVyYXRlVW5pcUlEOiBmdW5jdGlvbiAocHJlZml4LCBtb3JlX2VudHJvcHkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcmVmaXggPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBwcmVmaXggPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciByZXRJZDtcbiAgICAgICAgdmFyIGZvcm1hdFNlZWQgPSBmdW5jdGlvbiAoc2VlZCwgcmVxV2lkdGgpIHtcbiAgICAgICAgICAgIHNlZWQgPSBwYXJzZUludChzZWVkLCAxMClcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoMTYpOyAvLyB0byBoZXggc3RyXG4gICAgICAgICAgICBpZiAocmVxV2lkdGggPCBzZWVkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIHNvIGxvbmcgd2Ugc3BsaXRcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VlZC5zbGljZShzZWVkLmxlbmd0aCAtIHJlcVdpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXFXaWR0aCA+IHNlZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gc28gc2hvcnQgd2UgcGFkXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5KDEgKyAocmVxV2lkdGggLSBzZWVkLmxlbmd0aCkpXG4gICAgICAgICAgICAgICAgICAgIC5qb2luKCcwJykgKyBzZWVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNlZWQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQkVHSU4gUkVEVU5EQU5UXG4gICAgICAgIGlmICghdGhpcy5waHBfanMpIHtcbiAgICAgICAgICAgIHRoaXMucGhwX2pzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgLy8gRU5EIFJFRFVOREFOVFxuICAgICAgICBpZiAoIXRoaXMucGhwX2pzLnVuaXFpZFNlZWQpIHtcbiAgICAgICAgICAgIC8vIGluaXQgc2VlZCB3aXRoIGJpZyByYW5kb20gaW50XG4gICAgICAgICAgICB0aGlzLnBocF9qcy51bmlxaWRTZWVkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMHg3NWJjZDE1KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBocF9qcy51bmlxaWRTZWVkKys7XG5cbiAgICAgICAgLy8gc3RhcnQgd2l0aCBwcmVmaXgsIGFkZCBjdXJyZW50IG1pbGxpc2Vjb25kcyBoZXggc3RyaW5nXG4gICAgICAgIHJldElkID0gcHJlZml4O1xuICAgICAgICByZXRJZCArPSBmb3JtYXRTZWVkKHBhcnNlSW50KG5ldyBEYXRlKClcbiAgICAgICAgICAgIC5nZXRUaW1lKCkgLyAxMDAwLCAxMCksIDgpO1xuICAgICAgICAvLyBhZGQgc2VlZCBoZXggc3RyaW5nXG4gICAgICAgIHJldElkICs9IGZvcm1hdFNlZWQodGhpcy5waHBfanMudW5pcWlkU2VlZCwgNSk7XG4gICAgICAgIGlmIChtb3JlX2VudHJvcHkpIHtcbiAgICAgICAgICAgIC8vIGZvciBtb3JlIGVudHJvcHkgd2UgYWRkIGEgZmxvYXQgbG93ZXIgdG8gMTBcbiAgICAgICAgICAgIHJldElkICs9IChNYXRoLnJhbmRvbSgpICogMTApXG4gICAgICAgICAgICAgICAgLnRvRml4ZWQoOClcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXRJZDtcbiAgICB9LFxuXG4gICAgLy9maW5kIGR1cGxpY2F0ZXMgaW4gYXJyYXlcbiAgICBoYXNEdXBsaWNhdGVzOiBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIHZhbHVlc1NvRmFyID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2ldO1xuICAgICAgICAgICAgaWYgKHZhbHVlc1NvRmFyLmluZGV4T2YodmFsdWUpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVzU29GYXIucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG5cbiAgICBnZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmOiBmdW5jdGlvbiAodGhlX3JlZikge1xuXG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIGlMZW5ndGggPSBpbnB1dHMubGVuZ3RoO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBpTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpbnB1dHNbaV0ucmVmID09PSB0aGVfcmVmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2V0QnJhbmNoSW5wdXRDdXJyZW50SW5kZXhCeVJlZjogZnVuY3Rpb24gKHRoZV9vd25lcl9pbnB1dF9pbmRleCwgdGhlX2JyYW5jaF9pbnB1dF9yZWYpIHtcblxuICAgICAgICB2YXIgYnJhbmNoX2lucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHNbdGhlX293bmVyX2lucHV0X2luZGV4XS5icmFuY2g7XG4gICAgICAgIHZhciBmb3VuZCA9IC0xO1xuXG4gICAgICAgICQoYnJhbmNoX2lucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC5yZWYgPT09IHRoZV9icmFuY2hfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgZm91bmQgPSBpbmRleDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfSxcblxuICAgIGdldEdyb3VwSW5wdXRDdXJyZW50SW5kZXhCeVJlZjogZnVuY3Rpb24gKHRoZV9vd25lcl9pbnB1dF9pbmRleCwgdGhlX2dyb3VwX2lucHV0X3JlZikge1xuXG4gICAgICAgIHZhciBncm91cF9pbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzW3RoZV9vd25lcl9pbnB1dF9pbmRleF0uZ3JvdXA7XG4gICAgICAgIHZhciBmb3VuZCA9IC0xO1xuXG4gICAgICAgICQoZ3JvdXBfaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYnJhbmNoX2lucHV0KSB7XG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0LnJlZiA9PT0gdGhlX2dyb3VwX2lucHV0X3JlZikge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG5cbiAgICBnZXRJbnB1dE9iamVjdEJ5UmVmOiBmdW5jdGlvbiAodGhlX3JlZikge1xuXG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIGlMZW5ndGggPSBpbnB1dHMubGVuZ3RoO1xuXG4gICAgICAgIGlmICh0aGVfcmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBpTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpbnB1dHNbaV0ucmVmID09PSB0aGVfcmVmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0c1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmOiBmdW5jdGlvbiAodGhlX3JlZikge1xuXG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICB2YXIgb3duZXJfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgLyoqIGltcDpcbiAgICAgICAgICogQWZ0ZXIgYSBicmFuY2ggaW5wdXQgaXMgY29waWVkIHdoZW4gZWRpdGluZyBhIGJyYW5jaCwgd2UgY2hlY2sgdGhlIGZvcm1idWlsZGVyIGN1cnJlbnQgcmVmXG4gICAgICAgICAqIElmIHRoZSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiBpcyBub3QgcmVmZXJlbmNpbmcgdGhlIGJyYW5jaFxuICAgICAgICAgKiBidXRoIHRoZSBpbm5lciBicmFuY2ggaW5wdXQgd2UgcmVzZXQgaXQgdG8gcmVmZXJlbmNlIHRoZSBhY3RpdmUgYnJhbmNoXG4gICAgICAgICAqL1xuICAgICAgICAvL0hBQ0s6IFxuICAgICAgICBpZiAob3duZXJfaW5wdXRfaW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgb3duZXJfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZlxuICAgICAgICB9XG4gICAgICAgIC8vZW5kIEhBQ0s6XG4gICAgICAgIHZhciBicmFuY2hfaW5wdXRzID0gaW5wdXRzW293bmVyX2lucHV0X2luZGV4XS5icmFuY2g7XG4gICAgICAgIHZhciBmb3VuZDtcblxuICAgICAgICBpZiAodGhlX3JlZiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAkKGJyYW5jaF9pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5yZWYgPT09IHRoZV9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBpbnB1dDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG5cbiAgICBnZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWY6IGZ1bmN0aW9uICh0aGVfb3duZXJfYnJhbmNoLCB0aGVfY3VycmVudF9uZXN0ZWRfZ3JvdXBfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIHJlZiA9IHRoZV9jdXJyZW50X25lc3RlZF9ncm91cF9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9icmFuY2ggPSB0aGVfb3duZXJfYnJhbmNoO1xuICAgICAgICB2YXIgb3duZXJfZ3JvdXBfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZjtcblxuICAgICAgICB2YXIgZm91bmQ7XG5cbiAgICAgICAgJChvd25lcl9icmFuY2guYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IHRoZSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXQucmVmID09PSBvd25lcl9ncm91cF9yZWYpIHtcblxuICAgICAgICAgICAgICAgIC8vZm9yIGVhY2ggbmVzdGVkIGdyb3VwIGlucHV0cywgbG9vayBmb3IgdGhlIG9uZSB3ZSBhcmUgbG9va2luZyBmb3JcbiAgICAgICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIG5lc3RlZF9ncm91cF9pbnB1dCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXN0ZWRfZ3JvdXBfaW5wdXQucmVmID09PSByZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gbmVzdGVkX2dyb3VwX2lucHV0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuXG4gICAgZ2V0TmVzdGVkR3JvdXBJbnB1dEN1cnJlbnRJbmRleEJ5UmVmOiBmdW5jdGlvbiAodGhlX293bmVyX2JyYW5jaCwgdGhlX2N1cnJlbnRfbmVzdGVkX2dyb3VwX2lucHV0X3JlZikge1xuXG4gICAgICAgIHZhciByZWYgPSB0aGVfY3VycmVudF9uZXN0ZWRfZ3JvdXBfaW5wdXRfcmVmO1xuICAgICAgICB2YXIgb3duZXJfYnJhbmNoID0gdGhlX293bmVyX2JyYW5jaDtcbiAgICAgICAgdmFyIG93bmVyX2dyb3VwX3JlZiA9IGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWY7XG5cbiAgICAgICAgdmFyIGZvdW5kO1xuXG4gICAgICAgICQob3duZXJfYnJhbmNoLmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuXG4gICAgICAgICAgICAvL2dldCB0aGUgbmVzdGVkIGdyb3VwXG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0LnJlZiA9PT0gb3duZXJfZ3JvdXBfcmVmKSB7XG5cbiAgICAgICAgICAgICAgICAvL2ZvciBlYWNoIG5lc3RlZCBncm91cCBpbnB1dHMsIGxvb2sgZm9yIHRoZSBvbmUgd2UgYXJlIGxvb2tpbmcgZm9yXG4gICAgICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGdyb3VwX2luZGV4LCBuZXN0ZWRfZ3JvdXBfaW5wdXQpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobmVzdGVkX2dyb3VwX2lucHV0LnJlZiA9PT0gcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IGdyb3VwX2luZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuXG4gICAgZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmOiBmdW5jdGlvbiAodGhlX3JlZikge1xuXG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICB2YXIgb3duZXJfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0cyA9IGlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uZ3JvdXA7XG4gICAgICAgIHZhciBmb3VuZDtcblxuICAgICAgICBpZiAodGhlX3JlZiAhPT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICQoZ3JvdXBfaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQucmVmID09PSB0aGVfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gaW5wdXQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuXG4gICAgZ2V0TmVzdGVkR3JvdXBPYmplY3RCeVJlZjogZnVuY3Rpb24gKG93bmVyX2JyYW5jaCwgbmVzdGVkX2dyb3VwX3JlZikge1xuXG4gICAgICAgIHZhciBmb3VuZDtcblxuICAgICAgICAkKG93bmVyX2JyYW5jaC5icmFuY2gpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBicmFuY2hfaW5wdXQpIHtcblxuICAgICAgICAgICAgLy9nZXQgdGhlIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC5yZWYgPT09IG5lc3RlZF9ncm91cF9yZWYpIHtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IGJyYW5jaF9pbnB1dDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuXG4gICAgLy9wYXNzaW5nIGluIGEgYnJhbmNoIGlucHV0IHJlZiwgcmVtb3ZpbmcgdGhlIGxhc3QgYF91bmlxaWRgIHdlIGhhdmUgdGhlIGlucHV0IHJlZiB0aGF0IGJyYW5jaCBiZWxvbmcgdG9cbiAgICBnZXRCcmFuY2hPd25lcklucHV0UmVmOiBmdW5jdGlvbiAodGhlX2JyYW5jaF9pbnB1dF9yZWYpIHtcblxuICAgICAgICB2YXIgcGFydHMgPSB0aGVfYnJhbmNoX2lucHV0X3JlZi5zcGxpdCgnXycpO1xuXG4gICAgICAgIHBhcnRzLnBvcCgpO1xuXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCdfJyk7XG4gICAgfSxcblxuICAgIC8vcGFzc2luZyBpbiBhIGdyb3VwIGlucHV0IHJlZiwgcmVtb3ZpbmcgdGhlIGxhc3QgYF91bmlxaWRgIHdlIGhhdmUgdGhlIGlucHV0IHJlZiB0aGF0IGdyb3VwIGJlbG9uZyB0b1xuICAgIGdldEdyb3VwT3duZXJJbnB1dFJlZjogZnVuY3Rpb24gKHRoZV9ncm91cF9pbnB1dF9yZWYpIHtcblxuICAgICAgICB2YXIgcGFydHMgPSB0aGVfZ3JvdXBfaW5wdXRfcmVmLnNwbGl0KCdfJyk7XG5cbiAgICAgICAgcGFydHMucG9wKCk7XG5cbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJ18nKTtcbiAgICB9LFxuXG4gICAgZ2V0SW5wdXRUb29sSWNvbjogZnVuY3Rpb24gKHRoZV90eXBlKSB7XG5cbiAgICAgICAgdmFyIGljb247XG5cbiAgICAgICAgc3dpdGNoICh0aGVfdHlwZSkge1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQVVESU9fVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkFVRElPX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkJBUkNPREVfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkJBUkNPREVfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQlJBTkNIX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5CUkFOQ0hfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQ0hFQ0tCT1hfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkNIRUNLQk9YX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkRBVEVfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkRBVEVfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuRFJPUERPV05fVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkRST1BET1dOX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkdST1VQX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5HUk9VUF9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5MT0NBVElPTl9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuTE9DQVRJT05fVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuSU5URUdFUl9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuTlVNRVJJQ19UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5ERUNJTUFMX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5OVU1FUklDX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlBIT05FX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5QSE9ORV9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QSE9UT19UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuUEhPVE9fVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUkFESU9fVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlJBRElPX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlJFQURNRV9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuUkVBRE1FX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlRFWFRfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlRFWFRfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVEVYVEFSRUFfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlRFWFRBUkVBX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlRJTUVfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlRJTUVfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVklERU9fVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlZJREVPX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpY29uO1xuICAgIH0sXG5cbiAgICBzbHVnaWZ5OiBmdW5jdGlvbiAodGV4dCkge1xuXG4gICAgICAgIHZhciB0cmltbWVkID0gJC50cmltKHRleHQpO1xuICAgICAgICB2YXIgJHNsdWcgPSB0cmltbWVkLnJlcGxhY2UoL1teYS16MC05LV0vZ2ksICctJykucmVwbGFjZSgvLSsvZywgJy0nKS5yZXBsYWNlKC9eLXwtJC9nLCAnJyk7XG4gICAgICAgIHJldHVybiAkc2x1Zy50b0xvd2VyQ2FzZSgpO1xuICAgIH0sXG5cbiAgICAvL2dldCB0b3RhbCBpbnB1dHMgZG93bm8gdG8gYWwgbGV2ZWxzOiBjb3VudGluZyBhbHNvIG5lc3RlZCBicmFuY2ggaW5wdXRzIGFuZCBncm91cCBpbnB1dHNcbiAgICBnZXRJbnB1dHNUb3RhbDogZnVuY3Rpb24gKGlucHV0cykge1xuXG4gICAgICAgIHZhciB0b3RhbCA9IDA7XG5cbiAgICAgICAgdG90YWwgKz0gaW5wdXRzLmxlbmd0aDtcblxuICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICB0b3RhbCArPSBpbnB1dC5ncm91cC5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgdG90YWwgKz0gaW5wdXQuYnJhbmNoLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIC8vdG9kbyBjb3VudCBuZXN0ZWQgZ3JvdXAgaW5wdXRzIVxuICAgICAgICAgICAgICAgIC8vdG9kb1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRvdGFsO1xuICAgIH0sXG4gICAgLy9nZXQgdG90YWwgaW5wdXRzIGRvd24gdG8gYWxsIGxldmVsczogY291bnRpbmcgYWxzbyBuZXN0ZWQgYnJhbmNoIGlucHV0cyBhbmQgZ3JvdXAgaW5wdXRzXG4gICAgZ2V0U2VhcmNoSW5wdXRzVG90YWw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgdG90YWwgPSAwO1xuICAgICAgICB2YXIgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG4gICAgICAgICQoZm9ybXMpLmVhY2goZnVuY3Rpb24gKGZvcm1JbmRleCwgZm9ybSkge1xuXG4gICAgICAgICAgICAkKGZvcm0uaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbnB1dEluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgICAgIC8vY291bnQgYWxsIHNlYXJjaCBpbnB1dCB0eXBlc1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL2NvdW50IGFsbCBzZWFyY2ggaW5wdXQgdHlwZXMgb2YgYSBncm91cFxuICAgICAgICAgICAgICAgICAgICAkKGlucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChncm91cEluZGV4LCBncm91cElucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBJbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUgfHwgZ3JvdXBJbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL2NvdW50IGFsbCBzZWFyY2ggaW5wdXQgdHlwZXMgb2YgYSBicmFuY2hcbiAgICAgICAgICAgICAgICAgICAgJChpbnB1dC5icmFuY2gpLmVhY2goZnVuY3Rpb24gKGJyYW5jaEluZGV4LCBicmFuY2hJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJyYW5jaElucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSB8fCBicmFuY2hJbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vbmVzdGVkIGdyb3VwP1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJyYW5jaElucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChicmFuY2hJbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoZ3JvdXBJbmRleCwgZ3JvdXBJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBJbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUgfHwgZ3JvdXBJbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgfSxcbiAgICAvL2p1bXAgZGVzdGluYXRpb25zOiBjYW5ub3QganVtcCBvbiB0aGUgbmV4dCBvbmUsIGJ1dCBhbHdheXMgbmV4dCArIDFcbiAgICBnZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zOiBmdW5jdGlvbiAoaW5wdXQsIGlucHV0cykge1xuXG4gICAgICAgIHZhciBjdXJyZW50X2lucHV0X2luZGV4O1xuICAgICAgICB2YXIgb3duZXJfaW5wdXRfaW5kZXg7XG4gICAgICAgIHZhciBkZXN0aW5hdGlvbnMgPSBbXTtcbiAgICAgICAgdmFyIGF2YWlsYWJsZV9pbnB1dHM7XG5cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGN1cnJlbnRfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRCcmFuY2hJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKG93bmVyX2lucHV0X2luZGV4LCBpbnB1dC5yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY3VycmVudF9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoaW5wdXQucmVmKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF2YWlsYWJsZV9pbnB1dHMgPSBpbnB1dHMuc2xpY2UoY3VycmVudF9pbnB1dF9pbmRleCArIDIpO1xuXG4gICAgICAgICQoYXZhaWxhYmxlX2lucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICBkZXN0aW5hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgcmVmOiBpbnB1dC5yZWYsXG4gICAgICAgICAgICAgICAgcXVlc3Rpb246IGlucHV0LnF1ZXN0aW9uLFxuICAgICAgICAgICAgICAgIHR5cGU6IGlucHV0LnR5cGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2FkZCBcIkVuZCBvZiBmb3JtXCIgYXMgYW4gYXZhaWxhYmxlIGRlc3RpbmF0aW9uXG4gICAgICAgIGRlc3RpbmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIHJlZjogY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGLFxuICAgICAgICAgICAgcXVlc3Rpb246IGNvbnN0cy5KVU1QX1RPX0VORF9PRl9GT1JNX0xBQkVMLFxuICAgICAgICAgICAgdHlwZTogbnVsbFxuICAgICAgICB9KTtcblxuXG4gICAgICAgIHJldHVybiBkZXN0aW5hdGlvbnM7XG4gICAgfSxcblxuICAgIC8vanVtcCBkZXN0aW5hdGlvbnMgb2JqZWN0OiBmb3IgcXVpY2tlciBsb29rIHVwcywgdGhpcyBpcyBmb3IgZXh0cmEgdmFsaWRhdGlvbiBvbiBcInNhdmVcIlxuICAgIGdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXM6IGZ1bmN0aW9uIChjdXJyZW50X2lucHV0X2luZGV4LCBpbnB1dCwgaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIGRlc3RpbmF0aW9ucyA9IHt9O1xuICAgICAgICB2YXIgYXZhaWxhYmxlX2lucHV0cztcblxuICAgICAgICBhdmFpbGFibGVfaW5wdXRzID0gaW5wdXRzLnNsaWNlKGN1cnJlbnRfaW5wdXRfaW5kZXggKyAyKTtcblxuICAgICAgICAvL2ZpbGwgd2l0aCBhdmFpbGFibGUgaW5wdXRzIHJlZnMgYXMga2V5c1xuICAgICAgICAkKGF2YWlsYWJsZV9pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgZGVzdGluYXRpb25zW2lucHV0LnJlZl0gPSAxO1xuICAgICAgICB9KTtcbiAgICAgICAgLy9hZGQgXCJFbmQgb2YgZm9ybVwiIGFzIGFuIGF2YWlsYWJsZSBkZXN0aW5hdGlvblxuICAgICAgICBkZXN0aW5hdGlvbnNbY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGXSA9IDE7XG5cbiAgICAgICAgcmV0dXJuIGRlc3RpbmF0aW9ucztcbiAgICB9LFxuXG4gICAgLy9yZXR1cm4gdHJ1ZSB3aGVuIHRoZSB2YWx1ZSBpcyBsZXNzIG9yIGVxdWFsIHRvIG1heCB0aXRsZVxuICAgIGlzTWF4VGl0bGVMaW1pdFJlYWNoZWQ6IGZ1bmN0aW9uIChpbnB1dHMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGl0bGVDb3VudChpbnB1dHMpID49IGNvbnN0cy5MSU1JVFMudGl0bGVzX21heDtcbiAgICB9LFxuICAgIC8vcmV0dXJuIHRydWUgd2hlbiB0aGUgdmFsdWUgZXhjZWVkcyBtYXggdGl0bGVcbiAgICBpc01heFRpdGxlTGltaXRFeGNlZWRlZDogZnVuY3Rpb24gKGlucHV0cykge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUaXRsZUNvdW50KGlucHV0cykgPiBjb25zdHMuTElNSVRTLnRpdGxlc19tYXg7XG4gICAgfSxcblxuICAgIGdldFRpdGxlQ291bnQ6IGZ1bmN0aW9uIChpbnB1dHMpIHtcblxuICAgICAgICB2YXIgY291bnQgPSAwO1xuXG4gICAgICAgICQoaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5pc190aXRsZSkge1xuICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2xvb3AgYWxsIGdyb3VwIGlucHV0cyBhcyB0aGV5IGNvdW50IHRvd2FyZHMgdGhlIGxpbWl0XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAkKGlucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwX2lucHV0LmlzX3RpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgfSxcbiAgICAvL2Zyb20gaHR0cDovL2dvby5nbC9EN0Z4RzBcbiAgICAvLyAgLy9jb252ZXJ0IGh0bWwgdGFncyB0byBodG1sIGVudGl0aWVzXG4gICAgZW5jb2RlSHRtbDogZnVuY3Rpb24gKHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1smPD5cIiddL2csIGZ1bmN0aW9uICgkMCkge1xuICAgICAgICAgICAgLyoganNoaW50IGlnbm9yZTpzdGFydCAqL1xuICAgICAgICAgICAgLy8ganNjczpkaXNhYmxlXG4gICAgICAgICAgICByZXR1cm4gXCImXCIgKyB7XG4gICAgICAgICAgICAgICAgXCImXCI6IFwiYW1wXCIsXG4gICAgICAgICAgICAgICAgXCI8XCI6IFwibHRcIixcbiAgICAgICAgICAgICAgICBcIj5cIjogXCJndFwiLFxuICAgICAgICAgICAgICAgICdcIic6IFwicXVvdFwiLFxuICAgICAgICAgICAgICAgIFwiJ1wiOiBcIiMzOVwiXG4gICAgICAgICAgICB9WyQwXSArIFwiO1wiO1xuICAgICAgICAgICAgLyoganNoaW50IGlnbm9yZTplbmQgKi9cbiAgICAgICAgICAgIC8vIGpzY3M6ZW5hYmxlXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvL2Zyb20gaHR0cDovL2dvby5nbC9odENyb1VcbiAgICBkZWNvZGVIdG1sOiBmdW5jdGlvbiAoaHRtbCkge1xuICAgICAgICB2YXIgdHh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcbiAgICAgICAgdHh0LmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHJldHVybiB0eHQudmFsdWU7XG4gICAgfSxcblxuICAgIGdldFBvc3NpYmxlQW5zd2VyTGFiZWw6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgbGFiZWwgPSAnJztcbiAgICAgICAgJChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzKS5lYWNoKGZ1bmN0aW9uIChhbnN3ZXJfaW5kZXgsIGFuc3dlcikge1xuICAgICAgICAgICAgaWYgKGFuc3dlci5hbnN3ZXJfcmVmID09PSBpbnB1dC5kZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgbGFiZWwgPSBhbnN3ZXIuYW5zd2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHZhbGlkU291cmNlOiB0aGUgdmFsaWQgb2JqIHN0cnVjdHVyZVxuICAgICAqIEBwYXJhbSB3YW5uYUJlOiB0aGUgb2JqIHN0cnVjdHVyZSB0byB2YWxpZGF0ZVxuICAgICAqIEBwYXJhbSBzdHJpY3Q6IHdoZXRoZXIgdGhlIHR5cGUgbXVzdCBiZSB0aGUgc2FtZVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqIENvbXBhcmUgcHJvcGVydGllcyBvZiBvYmplY3RzIChvbmx5IGtleXM6IHdhbm5hQmUgbXVzdCBoYXZlIHRoZSBzYW1lIGtleXMsIGluIGFueSBvcmRlci4gVmFsdWVzIGRvbid0IG1hdHRlciwgdGhleSBhcmUgY2hlY2sgc2VwYXJhdGVseSlcbiAgICAgKiB3ZSBkbyBjaGVjayBmb3IgdGhlIHNhbWUgbmVzdGVkIHByb3BlcnRpZXMgd2hlbiBhbiBvYmplY3Qge30gYnV0IGFycmF5cyBtdXN0IGJlIGFycmF5cyBbXVxuICAgICAqL1xuICAgIGhhc1NhbWVQcm9wczogZnVuY3Rpb24gKHZhbGlkU291cmNlLCB3YW5uYUJlLCBzdHJpY3QpIHtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLy9mYWxzZSB3aGVuIHdhbm5hYmUgcHJvcGVydHkgaXMgYW4gYXJyYXkgYnV0IHZhbGlkU291cmNlIGlzIG5vdFxuICAgICAgICBpZiAodHlwZW9mIHZhbGlkU291cmNlID09PSAnb2JqZWN0JyAmJiBBcnJheS5pc0FycmF5KHdhbm5hQmUpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NoZWNrIGZvciB3YW5uYUJlIG92ZXJsYXBwaW5nIHByb3BzXG4gICAgICAgIGlmICghT2JqZWN0LmtleXMod2FubmFCZSkuZXZlcnkoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbGlkU291cmNlLmhhc093blByb3BlcnR5KGtleSk7XG4gICAgICAgIH0pKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnd2FubmFCZSBoYXMgZXh0cmEga2V5cycpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NoZWNrIGV2ZXJ5IGtleSBmb3IgYmVpbmcgc2FtZVxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModmFsaWRTb3VyY2UpLmV2ZXJ5KGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIC8vaWYgb2JqZWN0XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbGlkU291cmNlW2tleV0gPT09ICdvYmplY3QnICYmIHR5cGVvZiB3YW5uYUJlW2tleV0gPT09ICdvYmplY3QnICYmIHZhbGlkU291cmNlW2tleV0gIT09IG51bGwgJiYgd2FubmFCZVtrZXldICE9PSBudWxsKSB7XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGFycmF5IGlzIGFycmF5XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsaWRTb3VyY2Vba2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbXVzdCBiZSBhcnJheSBrZXk6ICcgKyBrZXkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh3YW5uYUJlW2tleV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vcmVjdXJzaXZlbHkgY2hlY2sgbmVzdGVkIG9iamVjdFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5oYXNTYW1lUHJvcHModmFsaWRTb3VyY2Vba2V5XSwgd2FubmFCZVtrZXldKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9jaGVjayBldmVyeSBrZXkgaXMgcHJlc2VudCBpbiB0aGUgd2FubmEgYmUgb2JqZWN0XG4gICAgICAgICAgICAgICAgaWYgKHdhbm5hQmVba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd3YW5uYUJlIGRvZXMgbm90IGhhdmUga2V5OicgKyBrZXkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIHRoZSB0eXBlIG9mIHZhbHVlIGlzIHRoZSBzYW1lIChub3QgdGhlIGFjdHVhbCB2YWx1ZSwgd2hpY2ggY2FuIGJlIGRpZmZlcmVudClcbiAgICAgICAgICAgICAgICBpZiAoc3RyaWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsaWRTb3VyY2Vba2V5XSAhPT0gdHlwZW9mIHdhbm5hQmVba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnd2FubmFCZSB0eXBlIGlzIHdyb25nIGZvciBrZXk6ICcgKyBrZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvL2Zyb20gTUROIGh0dHBzOi8vZ29vLmdsL3ZPaHp0YVxuICAgIGlzSW50ZWdlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmXG4gICAgICAgICAgICBpc0Zpbml0ZSh2YWx1ZSkgJiZcbiAgICAgICAgICAgIE1hdGguZmxvb3IodmFsdWUpID09PSB2YWx1ZTtcbiAgICB9LFxuXG4gICAgZ2V0QWN0aXZlSW5wdXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBpbnB1dDtcbiAgICAgICAgdmFyIGN1cnJlbnRfYnJhbmNoO1xuICAgICAgICB2YXIgY3VycmVudF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcblxuICAgICAgICAvL2dldCBjdXJyZW50IGlucHV0IG9iamVjdCBiYXNlZCBvbiBlZGl0aW5nIHN0YXRlOlxuXG4gICAgICAgIC8vbmVzdGVkIGdyb3VwP1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9nZXQgbmVzdGVkIGdyb3VwIGlucHV0XG4gICAgICAgICAgICBjdXJyZW50X2JyYW5jaCA9IHNlbGYuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgaW5wdXQgPSBzZWxmLmdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZihjdXJyZW50X2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9icmFuY2ggaW5wdXRcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmICFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL2dldCBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgIGlucHV0ID0gc2VsZi5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dyb3VwIGlucHV0P1xuICAgICAgICBpZiAoIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vZ2V0IGdyb3VwIGlucHV0XG4gICAgICAgICAgICBpbnB1dCA9IHNlbGYuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdG9wIGxldmVsIGlucHV0P1xuICAgICAgICBpZiAoIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmICFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL2dldCBpbnB1dFxuICAgICAgICAgICAgaW5wdXQgPSBzZWxmLmdldElucHV0T2JqZWN0QnlSZWYoY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH0sXG4gICAgLy8vIFJlcGxhY2VzIGNvbW1vbmx5LXVzZWQgV2luZG93cyAxMjUyIGVuY29kZWQgY2hhcnMgdGhhdCBkbyBub3QgZXhpc3QgaW4gQVNDSUkgb3IgSVNPLTg4NTktMSB3aXRoIElTTy04ODU5LTEgY29nbmF0ZXMuXG4gICAgcmVwbGFjZVdvcmRDaGFyczogZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgdmFyIHMgPSB0ZXh0O1xuICAgICAgICAvLyBzbWFydCBzaW5nbGUgcXVvdGVzIGFuZCBhcG9zdHJvcGhlXG4gICAgICAgIHMgPSBzLnJlcGxhY2UoL1tcXHUyMDE4XFx1MjAxOVxcdTIwMUFdL2csIFwiXFwnXCIpO1xuICAgICAgICAvLyBzbWFydCBkb3VibGUgcXVvdGVzXG4gICAgICAgIHMgPSBzLnJlcGxhY2UoL1tcXHUyMDFDXFx1MjAxRFxcdTIwMUVdL2csICdcXFwiJyk7XG4gICAgICAgIC8vIGVsbGlwc2lzXG4gICAgICAgIHMgPSBzLnJlcGxhY2UoL1xcdTIwMjYvZywgJy4uLicpO1xuICAgICAgICAvLyBkYXNoZXNcbiAgICAgICAgcyA9IHMucmVwbGFjZSgvW1xcdTIwMTNcXHUyMDE0XS9nLCAnLScpO1xuICAgICAgICAvLyBjaXJjdW1mbGV4XG4gICAgICAgIHMgPSBzLnJlcGxhY2UoL1xcdTAyQzYvZywgJ14nKTtcbiAgICAgICAgLy8gb3BlbiBhbmdsZSBicmFja2V0XG4gICAgICAgIHMgPSBzLnJlcGxhY2UoL1xcdTIwMzkvZywgJyAnKTtcbiAgICAgICAgLy8gY2xvc2UgYW5nbGUgYnJhY2tldFxuICAgICAgICBzID0gcy5yZXBsYWNlKC9cXHUyMDNBL2csICcgJyk7XG4gICAgICAgIC8vIHNwYWNlc1xuICAgICAgICBzID0gcy5yZXBsYWNlKC9bXFx1MDJEQ1xcdTAwQTBdL2csICcgJyk7XG5cbiAgICAgICAgLy9yZW1vdmUgaW52YWxpZCBjaGFyc1xuICAgICAgICBzID0gcy5yZXBsYWNlKC9cXHVGRkZEL2csICcgJyk7XG5cbiAgICAgICAgcmV0dXJuIHM7XG4gICAgfSxcblxuICAgIGdldEN1cnJlbnRseVNlbGVjdGVkSW5wdXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBpbnB1dCA9IHNlbGYuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIHZhciBvd25lcl9icmFuY2g7XG5cbiAgICAgICAgLy9jaGVjayB3aGV0aGVyIHdlIGFyZSB2YWxpZGF0aW4gYSBuZXN0ZWQgaW5wdXQgaS5lLiBCT1RIIGJyYW5jaCBBTkQgZ3JvdXAgZWRpdCBmbGFncyBhcmUgdHJ1ZVxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9nZXQgbmVzdGVkIGdyb3VwIGlucHV0XG4gICAgICAgICAgICBvd25lcl9icmFuY2ggPSBzZWxmLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gc2VsZi5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYob3duZXJfYnJhbmNoLCBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgICAgICAvL2dldCBzZWxlY3RlZCBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgICAgICBpbnB1dCA9IHNlbGYuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vZ2V0IHNlbGVjdGVkIGdyb3VwIGlucHV0XG4gICAgICAgICAgICAgICAgaW5wdXQgPSBzZWxmLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfSxcbiAgICAvL2h0dHA6Ly9sb2N1dHVzLmlvL3BocC9zdHJpbmdzL3N0cmlwX3RhZ3MvXG4gICAgc3RyaXBUYWdzOiBmdW5jdGlvbiAoaW5wdXQsIGFsbG93ZWQpIHtcbiAgICAgICAgYWxsb3dlZCA9ICgoKGFsbG93ZWQgfHwgJycpICsgJycpLnRvTG93ZXJDYXNlKCkubWF0Y2goLzxbYS16XVthLXowLTldKj4vZykgfHwgW10pLmpvaW4oJycpO1xuICAgICAgICB2YXIgdGFncyA9IC88XFwvPyhbYS16XVthLXowLTldKilcXGJbXj5dKj4vZ2k7XG4gICAgICAgIHZhciBjb21tZW50c0FuZFBocFRhZ3MgPSAvPCEtLVtcXHNcXFNdKj8tLT58PFxcPyg/OnBocCk/W1xcc1xcU10qP1xcPz4vZ2k7XG4gICAgICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKGNvbW1lbnRzQW5kUGhwVGFncywgJycpLnJlcGxhY2UodGFncywgZnVuY3Rpb24gKCQwLCAkMSkge1xuICAgICAgICAgICAgcmV0dXJuIGFsbG93ZWQuaW5kZXhPZignPCcgKyAkMS50b0xvd2VyQ2FzZSgpICsgJz4nKSA+IC0xID8gJDAgOiAnJ1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgLy9yZXBsYWNlIGFsbCBvY2N1cmVuY2VzIG9mICduZWVkbGUnIGluIHN0cmluZ1xuICAgIHJlcGxhY2VBbGxPY2N1cnJlbmNlczogZnVuY3Rpb24gKHN0cmluZywgbmVlZGxlLCByZXBsYWNlbWVudCkge1xuICAgICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UobmV3IFJlZ0V4cChuZWVkbGUsICdnJyksIHJlcGxhY2VtZW50KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmFuZG9taXplIGFycmF5IGVsZW1lbnQgb3JkZXIgaW4tcGxhY2UuXG4gICAgICogVXNpbmcgRHVyc3RlbmZlbGQgc2h1ZmZsZSBhbGdvcml0aG0uXG4gICAgICovXG4gICAgc2h1ZmZsZUFycmF5OiBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFycmF5Lmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IGFycmF5W2ldO1xuICAgICAgICAgICAgYXJyYXlbaV0gPSBhcnJheVtqXTtcbiAgICAgICAgICAgIGFycmF5W2pdID0gdGVtcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlscztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIEF1ZGlvSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGRlZmF1bHQgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLkFVRElPX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5BdWRpb0lucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxubW9kdWxlLmV4cG9ydHMgPSBBdWRpb0lucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgQmFyY29kZUlucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgIC8vIHRoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5CQVJDT0RFX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5CYXJjb2RlSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG4vKlxuIE92ZXJyaWRlc1xuICovXG5cbkJhcmNvZGVJbnB1dC5wcm90b3R5cGUuc2V0QWR2YW5jZWRJbnB1dFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIgPSBmb3JtYnVpbGRlclxuICAgICAgICAuZG9tXG4gICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhpcy5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAvL3NldCAgJ2RlZmF1bHQnIG9wdGlvblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBpbnB1dCcpLnZhbCh0aGlzLmRlZmF1bHQpO1xuXG4gICAgLy9zZXQgJ3JlZ2V4JyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0JykudmFsKHRoaXMucmVnZXgpO1xuXG4gICAgLy9zZXQgJ2lucHV0X3JlZicgb24gJ2RvdWJsZSBlbnRyeSB2ZXJpZmljYXRpb24nIG9wdGlvblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZG91YmxlLWVudHJ5IGlucHV0JykucHJvcCgnY2hlY2tlZCcsIHRoaXMudmVyaWZ5KTtcblxuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG59O1xuXG5CYXJjb2RlSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvL3Jlc2V0IHZhbGlkYXRpb24gZG9tIGZlZWRiYWNrIChoaWRlIGFsbCBlcnJvcnMgZnJvbSBkb20pXG4gICAgdmFyIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvciA9IFtcbiAgICAgICAgY29uc3RzLkRFRkFVTFRfUFJPUEVSVFlcbiAgICBdO1xuICAgIGVycm9ycy5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKHRoaXMsIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvcik7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJhcmNvZGVJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGJyYW5jaF9zb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2JyYW5jaC1zb3J0YWJsZScpO1xudmFyIGlucHV0X2NvbGxlY3Rpb25fYnJhbmNoX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tYnJhbmNoLXNvcnRhYmxlLW1vdXNlZG93bi1jYWxsYmFjaycpO1xudmFyIGlucHV0X2NvbGxlY3Rpb25fc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2snKTtcblxudmFyIEJyYW5jaElucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5CUkFOQ0hfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcbkJyYW5jaElucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuQnJhbmNoSW5wdXQucHJvdG90eXBlLmlzSGVhZGVyVGV4dFZhbGlkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmlzUXVlc3Rpb25UZXh0VmFsaWQoKTtcbn07XG5cblxuLy90b2dnbGUgZWRpdCBicmFuY2ggYnV0dG9uXG5CcmFuY2hJbnB1dC5wcm90b3R5cGUudG9nZ2xlRWRpdEJ1dHRvbiA9IGZ1bmN0aW9uICh0aGVfc3RhdGUpIHtcbiAgICB1aS5icmFuY2gudG9nZ2xlRWRpdEJyYW5jaEJ1dHRvbih0aGlzLnJlZiwgdGhlX3N0YXRlKTtcbn07XG5cbkJyYW5jaElucHV0LnByb3RvdHlwZS5lbnRlckJyYW5jaFNvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2ggPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKTtcbiAgICB2YXIgYWN0aXZlX2JyYW5jaF9pbm5lciA9IGFjdGl2ZV9icmFuY2guZmluZCgnID4gLmlucHV0LWlubmVyJyk7XG4gICAgdmFyIGJyYW5jaF9ob2xkZXJfaHRtbCA9IHVpLmlucHV0c19jb2xsZWN0aW9uLmdldEVtcHR5Q29sbGVjdGlvblNvcnRhYmxlSFRNTChjb25zdHMuQlJBTkNIX1RZUEUpO1xuICAgIHZhciBicmFuY2hfaW5wdXRzID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihzZWxmLnJlZikuYnJhbmNoO1xuICAgIHZhciBleGl0X2J0bl9odG1sID0gJyc7XG4gICAgZXhpdF9idG5faHRtbCArPSAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRlZmF1bHQgZXhpdC1icmFuY2gtZWRpdGluZ1wiPic7XG4gICAgZXhpdF9idG5faHRtbCArPSAnPGkgY2xhc3M9XCJmYSBmYS0yeCBmYS1mdyBmYS1jaGV2cm9uLWxlZnQgXCI+PC9pPic7XG4gICAgZXhpdF9idG5faHRtbCArPSBtZXNzYWdlcy5sYWJlbHMuRVhJVF9FRElUSU5HO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gJzwvYnV0dG9uPic7XG5cbiAgICAvL3Jlc2V0IGJyYW5jaCBvYmplY3QsIGFzIHdlIGNhY2hlIHByb3BlcnRpZXMgb2YgdGhlIGN1cnJlbnQgZW5hYmxlZCBicmFuY2ggb25seVxuICAgIGZvcm1idWlsZGVyLmJyYW5jaCA9IHt9O1xuXG4gICAgLy9zZXQgZHJhZ2dhYmxlIHRvIHdvcmsgd2l0aCBlbmFibGVkIGJyYW5jaCBvbmx5XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZHJhZ2dhYmxlKCdvcHRpb24nLCAnY29ubmVjdFRvU29ydGFibGUnLCAnLmJyYW5jaC1zb3J0YWJsZScpO1xuXG4gICAgLy9zZXQgdXNlZnVsIGZsYWdzXG4gICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggPSB0cnVlO1xuICAgIGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZiA9IHNlbGYucmVmO1xuICAgIGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX2hlYWRlciA9IHNlbGYucXVlc3Rpb247XG5cbiAgICBhY3RpdmVfYnJhbmNoLm9mZigpLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9icmFuY2hfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrKTtcblxuICAgIC8vIGlmIGl0IGlzIGEgYnJhbmQgbmV3IGJyYW5jaCwgYXBwZW5kIHNvcnRhYmxlIG1hcmt1cCBhbmQgc2hvdyBoZWxwIG1lc3NhZ2VcbiAgICBpZiAoYWN0aXZlX2JyYW5jaC5maW5kKCcuYnJhbmNoLXNvcnRhYmxlJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGJyYW5jaF9ob2xkZXJfaHRtbCA9IGJyYW5jaF9ob2xkZXJfaHRtbC5yZXBsYWNlKCd7e2JyYW5jaC1pbnB1dHN9fScsICcnKTtcbiAgICAgICAgYWN0aXZlX2JyYW5jaC5hcHBlbmQoYnJhbmNoX2hvbGRlcl9odG1sKTtcbiAgICAgICAgYWN0aXZlX2JyYW5jaC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tYnJhbmNoLXF1ZXN0aW9ucy1tZXNzYWdlJykuc2hvdygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPT09IGNvbnN0cy5SRU5ERVJfQUNUSU9OX1VORE8gJiYgYWN0aXZlX2JyYW5jaC5maW5kKCcuYnJhbmNoLXNvcnRhYmxlID4gZGl2JykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBhY3RpdmVfYnJhbmNoLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1ncm91cC1xdWVzdGlvbnMtbWVzc2FnZScpLnNob3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vZW5hYmxlIGJyYW5jaCBzb3J0YWJsZVxuICAgIGFjdGl2ZV9icmFuY2guZmluZCgnLmJyYW5jaC1zb3J0YWJsZScpLnNvcnRhYmxlKGJyYW5jaF9zb3J0YWJsZSkuZGlzYWJsZVNlbGVjdGlvbigpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgIC8vcmVtb3ZlIGFueSBwcmV2aW91c2x5IHNlbGVjdGVkIGJyYW5jaCBpbnB1dFxuICAgIGFjdGl2ZV9icmFuY2guZmluZCgnLmJyYW5jaC1zb3J0YWJsZScpLmZpbmQoJy5pbnB1dC5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3Nob3cgZXhpdCBlZGl0aW5nIGJ1dHRvblxuICAgIGFjdGl2ZV9icmFuY2guYWRkQ2xhc3MoJ2FjdGl2ZS1icmFuY2gnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3JlbW92ZSBmaXJzdCB0d28gZWxlbWVudHNcbiAgICBhY3RpdmVfYnJhbmNoX2lubmVyLmZpbmQoJy5mYS1jbG9uZScpLnJlbW92ZSgpO1xuICAgIGFjdGl2ZV9icmFuY2hfaW5uZXIuZmluZCgnPiAucXVlc3Rpb24tcHJldmlldycpLnJlbW92ZSgpO1xuXG4gICAgLy9hcHBlbmQgZXhpdCBidXR0b25cbiAgICBhY3RpdmVfYnJhbmNoX2lubmVyLnByZXBlbmQoZXhpdF9idG5faHRtbCk7XG5cbiAgICAvL2Rpc2FibGUgZm9ybSB0YWIgYnV0dG9uc1xuICAgIHVpLmZvcm1zX3RhYnMudG9nZ2xlRm9ybVRhYnNCdXR0b25zKHtlbmFibGU6IGZhbHNlfSk7XG5cbiAgICAvL3ByZXBhcmUgdWkgZm9yIGVkaXRpbmcgYnJhbmNoXG4gICAgc2VsZi5zaG93RWRpdEJyYW5jaFVJKCk7XG5cbiAgICBhY3RpdmVfYnJhbmNoXG4gICAgICAgIC5maW5kKCcuZXhpdC1icmFuY2gtZWRpdGluZycpXG4gICAgICAgIC5vbmUoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5leGl0QnJhbmNoU29ydGFibGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAvKlxuICAgICBjaGFuZ2UgYmluZGluZyB3aGVuIGVkaXRpbmcgYSBicmFuY2gsIGFzIHdlIHdhbnQgdG8gaW5jZXJjZXB0IG9ubHkgYSBtb3VzZWRvd24gdG8gdGhlIGV4aXQgYnV0dG9uIG9uIHRoZSBhY3RpdmUgYnJhbmNoIGlucHV0XG4gICAgICovXG4gICAgLy9kZXN0cm95IHNvcnRhYmxlIG9ubHkgaWYgaXQgaXMgc2V0IGFscmVhZHkgKHNlZSBodHRwOi8vZ29vLmdsL3JpTjRZaylcbiAgICBpZiAoZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmRhdGEoJ3VpLXNvcnRhYmxlJykpIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLnNvcnRhYmxlKCdkZXN0cm95Jyk7Ly9SZW1vdmUgdGhlIHBsdWdpbiBmdW5jdGlvbmFsaXR5XG4gICAgfVxuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9mZignbW91c2Vkb3duJykub24oJ21vdXNlZG93bicsICcuZmEtY2hldnJvbi1sZWZ0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuXG4gICAgLy9oaWRlIGZvcm0gdGl0bGUgd2FybmluZyByZWdhcmRsZXNzIChwYXNzaW5nIDEpPT4gdGhpcyBpcyBmb3IgdGhlIGZvcm0gd2hpY2ggb3ducyB0aGUgYnJhbmNoXG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDEsIGZhbHNlKTtcblxuICAgIC8vc2hvdy9oaWRlIHdhcm5pbmcgZm9yIHRoZSBicmFuY2hcbiAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcodXRpbHMuZ2V0VGl0bGVDb3VudChicmFuY2hfaW5wdXRzKSwgdHJ1ZSk7XG5cbiAgICAvL3B1c2ggc3RhdGUgdG8gZW5hYmxlIHVuZG9pbmcgdGhlIGFjdGlvbiAoYWRkaW5nL2RyYWdnaW5nIGlucHV0KVxuICAgIHVuZG8ucHVzaFN0YXRlKCk7XG59O1xuXG5CcmFuY2hJbnB1dC5wcm90b3R5cGUuZXhpdEJyYW5jaFNvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3NvcnRhYmxlJyk7XG4gICAgdmFyIGN1cnJlbnRfZm9ybV9uYW1lID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLm5hbWU7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2ggPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmlucHV0LmFjdGl2ZS1icmFuY2gnKTtcbiAgICB2YXIgYWN0aXZlX2JyYW5jaF9pbnB1dF9zb3J0YWJsZSA9IGFjdGl2ZV9icmFuY2guZmluZCgnLmJyYW5jaC1zb3J0YWJsZScpO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoX2lubmVyID0gYWN0aXZlX2JyYW5jaC5maW5kKCcgPiAuaW5wdXQtaW5uZXInKTtcbiAgICB2YXIgYWN0aXZlX2JyYW5jaF9pbnB1dDtcbiAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cztcblxuICAgIGlmIChmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpIHtcbiAgICAgICAgYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgLy92YWxpZGF0ZSBsYXN0IGFjdGl2ZSBncm91cCBpbnB1dCBhbmQgdXBkYXRlIGRvbSBhY2NvcmRpbmdseVxuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9icmFuY2hfaW5wdXQsIGZhbHNlKTtcbiAgICB9XG5cbiAgICBhY3RpdmVfYnJhbmNoLnJlbW92ZUNsYXNzKCdhY3RpdmUtYnJhbmNoJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG5cbiAgICAvL3JlbW92ZSBleGl0IGJ1dHRvblxuICAgIGFjdGl2ZV9icmFuY2hfaW5uZXIuZmluZCgnLmV4aXQtYnJhbmNoLWVkaXRpbmcnKS5yZW1vdmUoKTtcblxuICAgIC8vcmVzdG9yZSBxdWVzdGlvbiBpbiBpbnB1dCBjb2xsZWN0aW9uXG4gICAgYWN0aXZlX2JyYW5jaF9pbm5lci5wcmVwZW5kKCc8c3BhbiBjbGFzcz1cInF1ZXN0aW9uLXByZXZpZXdcIj4nICsgc2VsZi5xdWVzdGlvbiArICc8L3NwYW4+Jyk7XG4gICAgYWN0aXZlX2JyYW5jaF9pbm5lci5wcmVwZW5kKCc8aSBjbGFzcz1cImZhIGZhLTJ4IGZhLWZ3IGZhLWNsb25lXCI+PC9pPicpO1xuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5pbnB1dCcpLm5vdCgnLmFjdGl2ZScpLnNsaWRlRG93bihjb25zdHMuQU5JTUFUSU9OX05PUk1BTCk7XG5cbiAgICAvL3VwZGF0ZSBwYW5lbCBoZWFkZXJcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VkaXQtc3RhdGUnKS50ZXh0KG1lc3NhZ2VzLmxhYmVscy5FRElUSU5HX0ZPUk0pO1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWxlbWVudC1uYW1lJykudGV4dChjdXJyZW50X2Zvcm1fbmFtZS50cnVuYyhjb25zdHMuSU5QVVRTX0NPTExFQ1RJT05fQlJBTkNIX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG5cbiAgICAvL3Nob3cgZm9ybSBhY3Rpb24gYnV0dG9ucyBpbiBwYW5lbCBoZWFkaW5nXG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlRm9ybUFjdGlvbkJ1dHRvbnModHJ1ZSk7XG5cbiAgICAvL2VuYWJsZSBqdW1wcyB0YWJcbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUp1bXBUYWIoc2VsZi5yZWYsIHRydWUpO1xuXG4gICAgc2VsZi50b2dnbGVFZGl0QnV0dG9uKHRydWUpO1xuXG4gICAgLy9zZXQgZHJhZ2dhYmxlIHRvIHdvcmsgd2l0aCBtYWluIHNvcnRhYmxlXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZHJhZ2dhYmxlKCdvcHRpb24nLCAnY29ubmVjdFRvU29ydGFibGUnLCAnLnNvcnRhYmxlJyk7XG5cbiAgICBhY3RpdmVfYnJhbmNoX2lucHV0X3NvcnRhYmxlLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuICAgIC8qXG4gICAgIHJlc3RvcmUgcGFyZW50IGJpbmRpbmcgYWZ0ZXIgZXhpdGluZyBicmFuY2ggZWRpdGluZ1xuICAgICAqL1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5vZmYoJ21vdXNlZG93bicpLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuXG5cbiAgICAvL3JlLWJpbmQgc29ydGFibGUgcGx1Z2luXG4gICAgc29ydGFibGUoKTtcblxuICAgIHNlbGYudmFsaWRhdGVCcmFuY2hJbnB1dHMoKTtcblxuICAgIC8vdG9kbzogaGlkZSBjdXJyZW50IGlucHV0IGFuZCBzaG93IGJyYW5jaFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLmhpZGUoKTtcblxuICAgIC8vaGlkZSBwcmV2aW91c2x5IHNlbGVjdGVkIGJyYW5jaCBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmICsgJ1wiXScpLmhpZGUoKTtcblxuICAgIC8vc2hvdyBicmFuY2ggaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZiArICdcIl0nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vZW5hYmxlIGJyYW5jaCBpbnB1dCB0b29scyBpbiBsZWZ0IHNpZGViYXIsIGFzIHdlIGNhbm5vdCBoYXZlIGEgYnJhbmNoIHdpdGhpbmcgYSBicmFuY2hcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1icmFuY2gnKS5zaG93KCk7XG5cbiAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCA9IGZhbHNlO1xuICAgIGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcblxuICAgIC8vZW5hYmxlIGZvcm0gdGFiIGJ1dHRvbnNcbiAgICB1aS5mb3Jtc190YWJzLnRvZ2dsZUZvcm1UYWJzQnV0dG9ucyh7ZW5hYmxlOiB0cnVlfSk7XG5cbiAgICAvL3Nob3cgYWN0aW9uIGJ1dHRvbnMgZm9yIG93bmVyIGlucHV0XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vc2hvdyB0aXRsZSB3YXJuaW5nIGlmIG5vIHRpdGxlIHNldFxuICAgIC8vdG9kbyBpcyB0aGlzIG5lZWRlZD9cbiAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcodXRpbHMuZ2V0VGl0bGVDb3VudChpbnB1dHMpLCBmYWxzZSk7XG59O1xuXG5cbkJyYW5jaElucHV0LnByb3RvdHlwZS5zaG93RWRpdEJyYW5jaFVJID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy9oaWRlIGZpcnN0IGxldmVsIGlucHV0cyBmcm9tIHRoZSBpbnB1dCBjb2xsZWN0aW9uXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJyA+IC5pbnB1dCcpLm5vdCgnLmFjdGl2ZS1icmFuY2gnKS5zbGlkZVVwKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuICAgIC8vdXBkYXRlIHBhbmVsIGhlYWRlclxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWRpdC1zdGF0ZScpLnRleHQobWVzc2FnZXMubGFiZWxzLkVESVRJTkdfQlJBTkNIKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoc2VsZi5xdWVzdGlvbi50cnVuYyhjb25zdHMuSU5QVVRTX0NPTExFQ1RJT05fQlJBTkNIX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG5cbiAgICAvL2Rpc2FibGUgZm9ybSBhY3Rpb24gYnV0dG9ucyBpbiBwYW5lbCBoZWFkaW5nXG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlRm9ybUFjdGlvbkJ1dHRvbnMoZmFsc2UpO1xuXG4gICAgLy9kaXNhYmxlIGp1bXBzIHRhYiAvL3RvZG8gaXMgdGhpcyBuZWVkZWQ/XG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVKdW1wVGFiKHNlbGYucmVmLCBmYWxzZSk7XG5cbiAgICAvL2hpZGUgb3duZXIgYnJhbmNoIGlucHV0IHBhbmVsIGFuZCBzaG93ICdubyBicmFuY2ggaW5wdXRzIHNlbGVjdGVkJyBieSBkZWZhdWx0XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKS5oaWRlKCk7XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKS5zaG93KCk7XG5cbiAgICAvL2hpZGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbCBhY3Rpb24gYnV0dG9ucyB1bnRpbCBhIGJyYW5jaCBpbnB1dCBnZXRzIHNlbGVjdGVkXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cblxuICAgIC8vZGlzYWJsZSBicmFuY2ggaW5wdXQgdG9vbHMgaW4gbGVmdCBzaWRlYmFyLCBhcyB3ZSBjYW5ub3QgaGF2ZSBhIGJyYW5jaCB3aXRoaW5nIGEgYnJhbmNoXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZmlsdGVyKCcuaW5wdXQtYnJhbmNoJykuaGlkZSgpO1xuXG59O1xuXG5CcmFuY2hJbnB1dC5wcm90b3R5cGUudmFsaWRhdGVCcmFuY2hJbnB1dHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGJyYW5jaF9pbnB1dHNfdmFsaWRhdGlvbiA9IHZhbGlkYXRpb24udmFsaWRhdGVCcmFuY2hJbnB1dHMoc2VsZik7XG5cbiAgICBzZWxmLmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHNlbGYucmVmICsgJ1wiXScpO1xuXG4gICAgaWYgKCFicmFuY2hfaW5wdXRzX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXQgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICBlcnJvcnMuc2hvd0JyYW5jaElucHV0c0Vycm9ycyhzZWxmLmRvbS5wcm9wZXJ0aWVzX3BhbmVsLCBicmFuY2hfaW5wdXRzX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIC8vc2V0IGVsZW1lbnQgYXMgaW52YWxpZFxuICAgICAgICBzZWxmLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9zZXQgZWxlbWVudCBhcyB2YWxpZFxuICAgICAgICBzZWxmLmRvbS5pc192YWxpZCA9IHRydWU7XG4gICAgICAgIGVycm9ycy5oaWRlQnJhbmNoSW5wdXRzRXJyb3JzKHNlbGYuZG9tLnByb3BlcnRpZXNfcGFuZWwpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQnJhbmNoSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSByZXF1aXJlKCdhY3Rpb25zL3Bvc3NpYmxlLWFuc3dlcnMnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIElucHV0TXVsdGlwbGVBbnN3ZXJzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1tdWx0aXBsZS1hbnN3ZXJzLXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJy4uL2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgQ2hlY2tib3hJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuQ0hFQ0tCT1hfVFlQRTtcblxuICAgIC8vc2V0IGEgZGVmYXVsdCBhbnN3ZXIgb24gbmV3bHkgY3JlYXRlZCBkcm9wZG93bnMgaW5wdXRzXG4gICAgdGhpcy5wb3NzaWJsZV9hbnN3ZXJzID0gW3tcbiAgICAgICAgYW5zd2VyOiAnSSBhbSBhIHBsYWNlaG9sZGVyIGFuc3dlcicsXG4gICAgICAgIGFuc3dlcl9yZWY6IHV0aWxzLmdlbmVyYXRlVW5pcUlEKClcbiAgICB9XTtcblxuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcblxuICAgIC8vcGFnaW5hdGlvbiBkZWZhdWx0c1xuICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvblt0aGlzLnJlZl0gPSB7fTtcbiAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bdGhpcy5yZWZdLnBhZ2UgPSAxO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0IGFuZCBtdWx0aXBsZSBhbnN3ZXIgb2JqZWN0XG5DaGVja2JveElucHV0LnByb3RvdHlwZSA9ICQuZXh0ZW5kKHt9LCBJbnB1dC5wcm90b3R5cGUsIElucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2hlY2tib3hJbnB1dDtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCcuLi9jb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJy4uL2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgRGF0ZUlucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuREFURV9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuRGF0ZUlucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuLypcbiBPdmVycmlkZXNcbiAqL1xuXG5EYXRlSW5wdXQucHJvdG90eXBlLnNldEFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCB0byBjdXJyZW50IGRhdGV0aW1lP1xuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQtdG8tY3VycmVudCBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnNldF90b19jdXJyZW50X2RhdGV0aW1lKTtcblxuICAgIC8vc2V0IGRhdGV0aW1lIGZvcm1hdFxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RhdGVmb3JtYXQgaW5wdXRbbmFtZT1cImRhdGVmb3JtYXRSYWRpb1wiXVt2YWx1ZT1cIicgKyB0aGlzLmRhdGV0aW1lX2Zvcm1hdCArICdcIl0nKVxuICAgICAgICAucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuXG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zZXRVbmlxdWVuZXNzUHJvcGVydHkoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LCB0aGlzKTtcbn07XG5cblxuRGF0ZUlucHV0LnByb3RvdHlwZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCB0byBjdXJyZW50IGRhdGV0aW1lP1xuICAgIHRoaXMuc2V0X3RvX2N1cnJlbnRfZGF0ZXRpbWUgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0LXRvLWN1cnJlbnQgaW5wdXQnKVxuICAgICAgICAuaXMoJzpjaGVja2VkJyk7XG5cbiAgICAvL3NldCBkYXRldGltZSBmb3JtYXRcbiAgICB0aGlzLmRhdGV0aW1lX2Zvcm1hdCA9IHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RhdGVmb3JtYXQgaW5wdXRbbmFtZT1cImRhdGVmb3JtYXRSYWRpb1wiXTpjaGVja2VkJylcbiAgICAgICAgLnZhbCgpO1xuXG4gICAgLy9zYXZlIHVuaXF1ZW5lc3NcbiAgICBzYXZlLnNhdmVVbmlxdWVuZXNzKHRoaXMpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBEYXRlSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnLi4vY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgSW5wdXRNdWx0aXBsZUFuc3dlcnMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LW11bHRpcGxlLWFuc3dlcnMtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnLi4vY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBEcm9wZG93bklucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBkZWZhdWx0IHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5EUk9QRE9XTl9UWVBFO1xuXG4gICAgLy9zZXQgYSBkZWZhdWx0IGFuc3dlciBvbiBuZXdseSBjcmVhdGVkIGRyb3Bkb3ducyBpbnB1dHNcbiAgICB0aGlzLnBvc3NpYmxlX2Fuc3dlcnMgPSBbe1xuICAgICAgICBhbnN3ZXI6ICdJIGFtIGEgcGxhY2Vob2xkZXIgYW5zd2VyJyxcbiAgICAgICAgYW5zd2VyX3JlZjogdXRpbHMuZ2VuZXJhdGVVbmlxSUQoKVxuICAgIH1dO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcblxuICAgIC8vcGFnaW5hdGlvbiBkZWZhdWx0c1xuICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvblt0aGlzLnJlZl0gPSB7fTtcbiAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bdGhpcy5yZWZdLnBhZ2UgPSAxO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0IGFuZCBtdWx0aXBsZSBhbnN3ZXIgb2JqZWN0XG5Ecm9wZG93bklucHV0LnByb3RvdHlwZSA9ICQuZXh0ZW5kKHt9LCBJbnB1dC5wcm90b3R5cGUsIElucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZSk7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBEcm9wZG93bklucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgZ3JvdXBfc29ydGFibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ncm91cC1zb3J0YWJsZScpO1xudmFyIGlucHV0X2NvbGxlY3Rpb25fYnJhbmNoX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tYnJhbmNoLXNvcnRhYmxlLW1vdXNlZG93bi1jYWxsYmFjaycpO1xudmFyIGlucHV0X2NvbGxlY3Rpb25fZ3JvdXBfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1ncm91cC1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX25lc3RlZF9ncm91cF9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1jb2xsZWN0aW9uLW5lc3RlZC1ncm91cC1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG5cbnZhciBHcm91cElucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5HUk9VUF9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuR3JvdXBJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbkdyb3VwSW5wdXQucHJvdG90eXBlLmlzSGVhZGVyVGV4dFZhbGlkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmlzUXVlc3Rpb25UZXh0VmFsaWQoKTtcbn07XG5cbi8vdG9nZ2xlIGVkaXQgYnJhbmNoIGJ1dHRvblxuR3JvdXBJbnB1dC5wcm90b3R5cGUudG9nZ2xlRWRpdEJ1dHRvbiA9IGZ1bmN0aW9uICh0aGVfc3RhdGUpIHtcbiAgICB1aS5ncm91cC50b2dnbGVFZGl0R3JvdXBCdXR0b24odGhpcy5yZWYsIHRoZV9zdGF0ZSk7XG59O1xuXG5Hcm91cElucHV0LnByb3RvdHlwZS5lbnRlckdyb3VwU29ydGFibGUgPSBmdW5jdGlvbiAoaXNfbmVzdGVkKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbiAgICB2YXIgYWN0aXZlX2dyb3VwID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJyk7XG4gICAgdmFyIGFjdGl2ZV9ncm91cF9pbm5lciA9IGFjdGl2ZV9ncm91cC5maW5kKCcgPiAuaW5wdXQtaW5uZXInKTtcbiAgICB2YXIgZ3JvdXBfaG9sZGVyX2h0bWwgPSB1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRFbXB0eUNvbGxlY3Rpb25Tb3J0YWJsZUhUTUwoY29uc3RzLkdST1VQX1RZUEUpO1xuICAgIHZhciBleGl0X2J0bl9odG1sID0gJyc7XG4gICAgdmFyIGV4aXRfYnV0dG9uX2NsYXNzID0gaXNfbmVzdGVkID8gJ2V4aXQtbmVzdGVkLWdyb3VwLWVkaXRpbmcnIDogJ2V4aXQtZ3JvdXAtZWRpdGluZyc7XG4gICAgZXhpdF9idG5faHRtbCArPSAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRlZmF1bHQgJyArIGV4aXRfYnV0dG9uX2NsYXNzICsgJ1wiPic7XG4gICAgZXhpdF9idG5faHRtbCArPSAnPGkgY2xhc3M9XCJmYSBmYS0yeCBmYS1mdyBmYS1jaGV2cm9uLWxlZnQgXCI+PC9pPic7XG4gICAgZXhpdF9idG5faHRtbCArPSBtZXNzYWdlcy5sYWJlbHMuRVhJVF9FRElUSU5HO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gJzwvYnV0dG9uPic7XG5cblxuICAgIC8vZGlzYWJsZSBqdW1wcyB0YWIgd2hlbiBlZGl0aW5nIGEgZ3JvdXBcbiAgICAkKCcuanVtcC10YWInKS5hZGRDbGFzcygnZGlzYWJsZWQgZGlzYWJsZWQtdGFiJyk7XG5cbiAgICAvL3Jlc2V0IGdyb3VwIG9iamVjdCwgYXMgd2UgY2FjaGUgcHJvcGVydGllcyBvZiB0aGUgY3VycmVudCBlbmFibGVkIGdyb3VwIG9ubHlcbiAgICBmb3JtYnVpbGRlci5ncm91cCA9IHt9O1xuXG4gICAgLy9zZXQgZHJhZ2dhYmxlIHRvIHdvcmsgd2l0aCBlbmFibGVkIGdyb3VwIG9ubHlcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5kcmFnZ2FibGUoJ29wdGlvbicsICdjb25uZWN0VG9Tb3J0YWJsZScsICcuZ3JvdXAtc29ydGFibGUnKTtcblxuICAgIC8vc2V0IHVzZWZ1bCBmbGFnc1xuICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXAgPSB0cnVlO1xuICAgIGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYgPSBzZWxmLnJlZjtcblxuICAgIGlmIChpc19uZXN0ZWQpIHtcbiAgICAgICAgYWN0aXZlX2dyb3VwLm9mZigpLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9uZXN0ZWRfZ3JvdXBfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhY3RpdmVfZ3JvdXAub2ZmKCkub24oJ21vdXNlZG93bicsICdkaXYuaW5wdXQnLCBpbnB1dF9jb2xsZWN0aW9uX2dyb3VwX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayk7XG4gICAgfVxuXG4gICAgLy9pZiBpdCBpcyBhIGJyYW5kIG5ldyBncm91cCwgYXBwZW5kIHNvcnRhYmxlIG1hcmt1cFxuICAgIGlmIChhY3RpdmVfZ3JvdXAuZmluZCgnLmdyb3VwLXNvcnRhYmxlJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGdyb3VwX2hvbGRlcl9odG1sID0gZ3JvdXBfaG9sZGVyX2h0bWwucmVwbGFjZSgne3tncm91cC1pbnB1dHN9fScsICcnKTtcbiAgICAgICAgYWN0aXZlX2dyb3VwLmFwcGVuZChncm91cF9ob2xkZXJfaHRtbCk7XG4gICAgICAgIGFjdGl2ZV9ncm91cC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tZ3JvdXAtcXVlc3Rpb25zLW1lc3NhZ2UnKS5zaG93KCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9PT0gY29uc3RzLlJFTkRFUl9BQ1RJT05fVU5ETyAmJiBhY3RpdmVfZ3JvdXAuZmluZCgnLmdyb3VwLXNvcnRhYmxlID4gZGl2JykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBhY3RpdmVfZ3JvdXAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWdyb3VwLXF1ZXN0aW9ucy1tZXNzYWdlJykuc2hvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9lbmFibGUgZ3JvdXAgc29ydGFibGVcbiAgICBhY3RpdmVfZ3JvdXAuZmluZCgnLmdyb3VwLXNvcnRhYmxlJykuc29ydGFibGUoZ3JvdXBfc29ydGFibGUpLmRpc2FibGVTZWxlY3Rpb24oKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAvL3JlbW92ZSBhbnkgcHJldmlvdXNseSBzZWxlY3RlZCBncm91cCBpbnB1dFxuICAgIGFjdGl2ZV9ncm91cC5maW5kKCcuZ3JvdXAtc29ydGFibGUnKS5maW5kKCcuaW5wdXQuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy9zaG93IGV4aXQgZWRpdGluZyBidXR0b25cbiAgICBhY3RpdmVfZ3JvdXAuYWRkQ2xhc3MoJ2FjdGl2ZS1ncm91cCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgIC8vcmVtb3ZlIGZpcnN0IHR3byBlbGVtZW50c1xuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5maW5kKCcuZmEtYWxpZ24tanVzdGlmeScpLnJlbW92ZSgpO1xuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5maW5kKCc+IC5xdWVzdGlvbi1wcmV2aWV3JykucmVtb3ZlKCk7XG5cbiAgICAvL2FwcGVuZCBleGl0IGJ1dHRvblxuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5wcmVwZW5kKGV4aXRfYnRuX2h0bWwpO1xuXG4gICAgLy9kaXNhYmxlIGZvcm0gdGFiIGJ1dHRvbnNcbiAgICB1aS5mb3Jtc190YWJzLnRvZ2dsZUZvcm1UYWJzQnV0dG9ucyh7XG4gICAgICAgIGVuYWJsZTogZmFsc2VcbiAgICB9KTtcblxuICAgIC8vcHJlcGFyZSB1aSBmb3IgZWRpdGluZyBncm91cFxuICAgIGlmIChpc19uZXN0ZWQpIHtcbiAgICAgICAgc2VsZi5zaG93RWRpdE5lc3RlZEdyb3VwVUkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLnNob3dFZGl0R3JvdXBVSSgpO1xuICAgIH1cblxuICAgIGFjdGl2ZV9ncm91cFxuICAgICAgICAuZmluZCgnLicgKyBleGl0X2J1dHRvbl9jbGFzcylcbiAgICAgICAgLm9uZSgnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoaXNfbmVzdGVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5leGl0TmVzdGVkR3JvdXBTb3J0YWJsZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLmV4aXRHcm91cFNvcnRhYmxlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgLypcbiAgICAgY2hhbmdlIGJpbmRpbmcgd2hlbiBlZGl0aW5nIGEgZ3JvdXAsIGFzIHdlIHdhbnQgdG8gaW5jZXJjZXB0IG9ubHkgYSBtb3VzZWRvd24gdG8gdGhlIGV4aXQgYnV0dG9uIG9uIHRoZSBhY3RpdmUgZ3JvdXAgaW5wdXRcbiAgICAgKi9cbiAgICAvL2Rlc3Ryb3kgdG9wIHBhcmVudCBzb3J0YWJsZVxuICAgIGNvbnNvbGUubG9nKCdncm91cC5qcyBjYWxscyBkZXN0cm95Jyk7XG5cbiAgICAvKioqKioqKiogTkVFREVEIEJVRyAqKioqKioqKiovXG4gICAgLyogVGhlIGNhbGwgdG8gJ2Rlc3Ryb3knIHdpbGwgdHJpZ2dlciBhbiBlcnJvciB0aGUgZmlyc3QgdGltZSwgYnV0IGlmIGl0IGRvZXMgbm90IChjYXRjaGluZyB0aGUgZXJyb3Igb3IgdXNpbmcgdGhlIGNvbW1lbnRlZCAnaWYgZWxzZScgc3RhdGVtZW50KVxuICAgICAqICB3aGVuIGV4aXRpbmcgdGhlIGdyb3VwIHRoZSBwYXJlbnQgc29ydGFibGUgd2lsbCBub3Qgd29yayBhbnltb3JlLCB3aGV0aGVyIGlzIGEgdG9wIGxldmVsIHNvcnRhYmxlIG9yIGEgYnJhbmNoIHNvcnRhYmxlLlxuICAgICAqICB0b2RvIGxvb2sgaW50byBpdFxuICAgICAqXG4gICAgICogKi9cbiAgICBpZiAoZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9PT0gY29uc3RzLlJFTkRFUl9BQ1RJT05fRE8pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5zb3J0YWJsZSgnZGVzdHJveScpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NvcnRhYmxlIGRlc3Ryb3kgZXJyb3IgdGhyb3duIGFuZCBjYXVnaHQgKFRISVMgSVMgTkVFREVEISknKVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKioqKioqKiBFTkQgTkVFREVEIEJVRyAqKioqKioqKiovXG5cbiAgICAvLyBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1icmFuY2guaGlkZGVuLWFjdGl2ZS1icmFuY2ggLmJyYW5jaC1zb3J0YWJsZScpLnNvcnRhYmxlKCdkZXN0cm95Jyk7XG4gICAgaWYgKGlzX25lc3RlZCkge1xuICAgICAgICAvL2Rpc2FibGUgbW91c2Vkb3duXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAgICAgLmZpbmQoJy5hY3RpdmUtYnJhbmNoLmhpZGRlbi1hY3RpdmUtYnJhbmNoIC5icmFuY2gtc29ydGFibGUnKVxuICAgICAgICAgICAgLm9mZignbW91c2Vkb3duJylcbiAgICAgICAgICAgIC5vbignbW91c2Vkb3duJywgJy5mYS1jaGV2cm9uLWxlZnQnLCBpbnB1dF9jb2xsZWN0aW9uX2JyYW5jaF9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5vbignbW91c2Vkb3duJywgJy5mYS1jaGV2cm9uLWxlZnQnLCBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayk7XG4gICAgfVxuXG4gICAgdW5kby5wdXNoU3RhdGUoKTtcbn07XG5cbkdyb3VwSW5wdXQucHJvdG90eXBlLmV4aXROZXN0ZWRHcm91cFNvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9leGl0IG5lc3RlZCBncm91cCBzb3J0YWJsZVxuICAgIGNvbnNvbGUubG9nKCdleGl0aW5nIG5lc3RlZCBncm91cCwgZ29lcyB1cCB0byBicmFuY2gnKTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgYnJhbmNoX3NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvYnJhbmNoLXNvcnRhYmxlJyk7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2ggPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1icmFuY2gnKTtcbiAgICB2YXIgY3VycmVudF9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgdmFyIGN1cnJlbnRfYnJhbmNoX25hbWUgPSBjdXJyZW50X2JyYW5jaC5xdWVzdGlvbjtcbiAgICB2YXIgYWN0aXZlX2dyb3VwID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5pbnB1dC5hY3RpdmUtZ3JvdXAnKTtcbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lucHV0X3NvcnRhYmxlID0gYWN0aXZlX2dyb3VwLmZpbmQoJy5ncm91cC1zb3J0YWJsZScpO1xuICAgIHZhciBhY3RpdmVfZ3JvdXBfaW5uZXIgPSBhY3RpdmVfZ3JvdXAuZmluZCgnID4gLmlucHV0LWlubmVyJyk7XG4gICAgdmFyIGFjdGl2ZV9uZXN0ZWRfZ3JvdXBfaW5wdXQ7XG5cbiAgICBpZiAoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpIHtcbiAgICAgICAgYWN0aXZlX25lc3RlZF9ncm91cF9pbnB1dCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZihjdXJyZW50X2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAvL3ZhbGlkYXRlIGxhc3QgYWN0aXZlIGdyb3VwIGlucHV0IGFuZCB1cGRhdGUgZG9tIGFjY29yZGluZ2x5IChpZiBhbiBpbnB1dCB3YXMgc2VsZWN0ZWQpXG4gICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24oYWN0aXZlX25lc3RlZF9ncm91cF9pbnB1dCwgZmFsc2UsIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbik7XG4gICAgfVxuXG4gICAgLy9lbmFibGUgb3duZXIgYnJhbmNoIHNvcnRhYmxlXG4gICAgYWN0aXZlX2JyYW5jaC5maW5kKCcuYnJhbmNoLXNvcnRhYmxlJykuc29ydGFibGUoYnJhbmNoX3NvcnRhYmxlKS5kaXNhYmxlU2VsZWN0aW9uKCk7XG5cbiAgICBhY3RpdmVfZ3JvdXAucmVtb3ZlQ2xhc3MoJ2FjdGl2ZS1ncm91cCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgIC8vcmVtb3ZlIGV4aXQgYnV0dG9uXG4gICAgYWN0aXZlX2dyb3VwX2lubmVyLmZpbmQoJy5leGl0LW5lc3RlZC1ncm91cC1lZGl0aW5nJykucmVtb3ZlKCk7XG5cbiAgICAvL3Jlc3RvcmUgcXVlc3Rpb24gaW4gaW5wdXQgY29sbGVjdGlvblxuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5wcmVwZW5kKCc8c3BhbiBjbGFzcz1cInF1ZXN0aW9uLXByZXZpZXdcIj4nICsgc2VsZi5xdWVzdGlvbiArICc8L3NwYW4+Jyk7XG4gICAgYWN0aXZlX2dyb3VwX2lubmVyLnByZXBlbmQoJzxpIGNsYXNzPVwiZmEgZmEtMnggZmEtZncgZmEtYWxpZ24tanVzdGlmeVwiPjwvaT4nKTtcblxuICAgIC8vc2hvdyBvd25lciBicmFuY2hcbiAgICBhY3RpdmVfYnJhbmNoXG4gICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuLWFjdGl2ZS1icmFuY2gnKVxuICAgICAgICAuZmluZCgnID4gLmlucHV0LWlubmVyID4gaScpXG4gICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIGFjdGl2ZV9icmFuY2guZmluZCgnID4gLmlucHV0LWlubmVyID4gLmV4aXQtYnJhbmNoLWVkaXRpbmcnKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vc2hvdyBpbmFjdGl2ZSBicmFuY2ggaW5wdXRzXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgIC5maW5kKCcuYWN0aXZlLWJyYW5jaCcpXG4gICAgICAgIC5maW5kKCcuYnJhbmNoLXNvcnRhYmxlJylcbiAgICAgICAgLmZpbmQoJyA+IC5pbnB1dCcpXG4gICAgICAgIC5ub3QoJy5hY3RpdmUtZ3JvdXAnKVxuICAgICAgICAuc2xpZGVEb3duKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuICAgIC8vdXBkYXRlIG1pZGRsZSBjb2x1bSBwYW5lbCBoZWFkZXIgc2hvd2luZyBvd25lciBicmFuY2ggcXVlc3Rpb25cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VkaXQtc3RhdGUnKS50ZXh0KG1lc3NhZ2VzLmxhYmVscy5FRElUSU5HX0JSQU5DSCk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lbGVtZW50LW5hbWUnKS50ZXh0KGN1cnJlbnRfYnJhbmNoX25hbWUudHJ1bmMoY29uc3RzLklOUFVUU19DT0xMRUNUSU9OX0dST1VQX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG5cbiAgICBzZWxmLnRvZ2dsZUVkaXRCdXR0b24odHJ1ZSk7XG5cbiAgICAvL3NldCBkcmFnZ2FibGUgdG8gd29yayB3aXRoIHRoZSBhY3RpdmUgYnJhbmNoIHNvcnRhYmxlXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZHJhZ2dhYmxlKCdvcHRpb24nLCAnY29ubmVjdFRvU29ydGFibGUnLCAnLmJyYW5jaC1zb3J0YWJsZScpO1xuXG4gICAgLy9oaWRlIG5lc3RlZCBncm91cCBzb3J0YWJsZVxuICAgIGFjdGl2ZV9ncm91cF9pbnB1dF9zb3J0YWJsZS5hZGRDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAvKlxuICAgICByZXN0b3JlIHBhcmVudCBiaW5kaW5nIGFmdGVyIGV4aXRpbmcgZ3JvdXAgZWRpdGluZ1xuICAgICAqL1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAuZmluZCgnLmFjdGl2ZS1icmFuY2gnKVxuICAgICAgICAub2ZmKClcbiAgICAgICAgLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9icmFuY2hfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrKTtcblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWJyYW5jaCA+IC5icmFuY2gtc29ydGFibGUnKS5zb3J0YWJsZShicmFuY2hfc29ydGFibGUpO1xuXG4gICAgLy9pZiBib3RoIGhlYWRlciBhbmQgZ3JvdXBzIGFyZSB2YWxpZCwgc2hvdyBncmVlbiBjaGVjayBvbiBhY3RpdmUgZ3JvdXAgaW5wdXRcbiAgICBpZiAoc2VsZi5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgLy9yZXBsYWNlIHdhcm5pbmcgaWNvbiB3aXRoIGdyZWVuIGNoZWNrXG4gICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFZhbGlkSWNvbihzZWxmLnJlZik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy9yZXBsYWNlIHdhcm5pbmcgaWNvbiB3aXRoIGdyZWVuIGNoZWNrXG4gICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKHNlbGYucmVmKTtcbiAgICB9XG5cbiAgICAvL3Nob3cgYSBwcmV2aWV3IG9mIHRoZSBuZXN0ZWQgZ3JvdXAgaGVhZGVyIChsaW1pdCB0byAyMCBjaGFycylcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChzZWxmLnF1ZXN0aW9uLnRydW5jKDIwKSk7XG5cbiAgICAvL2hpZGUgbm8gaW5wdXRzIHNlbGVjdGVkIChqdXN0IGluIGNhc2Ugbm8gaW5wdXQgd2FzIHNlbGVjdGVkIGluIHRoZSBuZXN0ZWQgZ3JvdXApXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJykuaGlkZSgpO1xuXG4gICAgLy9oaWRlIGFueSBpbnB1dCBwcmV2aW91c2x5IHNlbGVjdGVkXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgKyAnXCJdJykuaGlkZSgpO1xuXG4gICAgLy9zaG93IG5lc3RlZCBncm91cCBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZiArICdcIl0nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vZW5hYmxlIGdyb3VwIGlucHV0IHRvb2xzIGluIGxlZnQgc2lkZWJhclxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LWdyb3VwJykuc2hvdygpO1xuXG4gICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IGZhbHNlO1xuICAgIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgLy9lbmFibGUganVtcHMgdGFiIHdoZW4gZXhpdCBlZGl0aW5nIGEgZ3JvdXBcbiAgICAkKCcuanVtcC10YWInKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQgZGlzYWJsZWQtdGFiJyk7XG5cbiAgICAvL3Nob3cgYWN0aW9uIGJ1dHRvbnMgZm9yIG93bmVyIGlucHV0XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbn07XG5cbkdyb3VwSW5wdXQucHJvdG90eXBlLmV4aXRHcm91cFNvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBhY3RpdmVfZ3JvdXBfaW5wdXQ7XG4gICAgdmFyIHNvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvc29ydGFibGUnKTtcbiAgICB2YXIgY3VycmVudF9mb3JtX25hbWUgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0ubmFtZTtcbiAgICB2YXIgYWN0aXZlX2dyb3VwID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5pbnB1dC5hY3RpdmUtZ3JvdXAnKTtcbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lucHV0X3NvcnRhYmxlID0gYWN0aXZlX2dyb3VwLmZpbmQoJy5ncm91cC1zb3J0YWJsZScpO1xuICAgIHZhciBhY3RpdmVfZ3JvdXBfaW5uZXIgPSBhY3RpdmVfZ3JvdXAuZmluZCgnID4gLmlucHV0LWlubmVyJyk7XG5cbiAgICBpZiAoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpIHtcbiAgICAgICAgYWN0aXZlX2dyb3VwX2lucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgLy92YWxpZGF0ZSBsYXN0IGFjdGl2ZSBncm91cCBpbnB1dCBhbmQgdXBkYXRlIGRvbSBhY2NvcmRpbmdseVxuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9ncm91cF9pbnB1dCwgZmFsc2UsIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbik7XG4gICAgfVxuXG4gICAgYWN0aXZlX2dyb3VwLnJlbW92ZUNsYXNzKCdhY3RpdmUtZ3JvdXAnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3JlbW92ZSBleGl0IGJ1dHRvblxuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5maW5kKCcuZXhpdC1ncm91cC1lZGl0aW5nJykucmVtb3ZlKCk7XG5cbiAgICAvL3Jlc3RvcmUgcXVlc3Rpb24gaW4gaW5wdXQgY29sbGVjdGlvblxuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5wcmVwZW5kKCc8c3BhbiBjbGFzcz1cInF1ZXN0aW9uLXByZXZpZXdcIj4nICsgc2VsZi5xdWVzdGlvbiArICc8L3NwYW4+Jyk7XG4gICAgYWN0aXZlX2dyb3VwX2lubmVyLnByZXBlbmQoJzxpIGNsYXNzPVwiZmEgZmEtMnggZmEtZncgZmEtYWxpZ24tanVzdGlmeVwiPjwvaT4nKTtcblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuaW5wdXQnKS5ub3QoJy5hY3RpdmUnKS5zbGlkZURvd24oY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgLy91cGRhdGUgcGFuZWwgaGVhZGVyXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJykudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19GT1JNKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoY3VycmVudF9mb3JtX25hbWUudHJ1bmMoY29uc3RzLklOUFVUU19DT0xMRUNUSU9OX0dST1VQX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG5cbiAgICAvL3Nob3cgZm9ybSBhY3Rpb24gYnV0dG9ucyBpbiBwYW5lbCBoZWFkaW5nXG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlRm9ybUFjdGlvbkJ1dHRvbnModHJ1ZSk7XG5cbiAgICAvL2VuYWJsZSBqdW1wcyB0YWJcbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUp1bXBUYWIoc2VsZi5yZWYsIHRydWUpO1xuXG4gICAgc2VsZi50b2dnbGVFZGl0QnV0dG9uKHRydWUpO1xuXG4gICAgLy9zZXQgZHJhZ2dhYmxlIHRvIHdvcmsgd2l0aCBtYWluIHNvcnRhYmxlXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZHJhZ2dhYmxlKCdvcHRpb24nLCAnY29ubmVjdFRvU29ydGFibGUnLCAnLnNvcnRhYmxlJyk7XG5cbiAgICBhY3RpdmVfZ3JvdXBfaW5wdXRfc29ydGFibGUuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLypcbiAgICAgcmVzdG9yZSBwYXJlbnQgYmluZGluZyBhbmQgc29ydGFibGUgYWZ0ZXIgZXhpdGluZyBncm91cCBlZGl0aW5nXG4gICAgICovXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9mZignbW91c2Vkb3duJykub24oJ21vdXNlZG93bicsICdkaXYuaW5wdXQnLCBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayk7XG4gICAgc29ydGFibGUoKTtcblxuICAgIC8vaWYgYm90aCBoZWFkZXIgYW5kIGdyb3VwcyBhcmUgdmFsaWQsIHNob3cgZ3JlZW4gY2hlY2sgb24gYWN0aXZlIGdyb3VwIGlucHV0XG4gICAgaWYgKHNlbGYuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgIC8vdXBkYXRlIHRoZSBqdXN0IHNhdmVkIGlucHV0IHNob3dpbmcgYSBwcmV2aWV3IG9mIHRoZSBxdWVzdGlvbiB0ZXh0IChsaW1pdCB0byA1MCBjaGFycylcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KHNlbGYucmVmLCBzZWxmLnF1ZXN0aW9uLnRydW5jKDUwKSk7XG4gICAgICAgIC8vcmVwbGFjZSB3YXJuaW5nIGljb24gd2l0aCBncmVlbiBjaGVja1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRWYWxpZEljb24oc2VsZi5yZWYpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vcmVwbGFjZSB3YXJuaW5nIGljb24gd2l0aCBncmVlbiBjaGVja1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihzZWxmLnJlZik7XG4gICAgfVxuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJykuaGlkZSgpO1xuXG4gICAgLy9oaWRlIGFueSBpbnB1dCBwcmV2aW91c2x5IHNlbGVjdGVkXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgKyAnXCJdJykuaGlkZSgpO1xuXG4gICAgLy9zaG93IGJyYW5jaCBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZiArICdcIl0nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vZW5hYmxlIGJyYW5jaCAmIGdyb3VwIGlucHV0IHRvb2xzIGluIGxlZnQgc2lkZWJhclxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LWJyYW5jaCwgLmlucHV0LWdyb3VwJykuc2hvdygpO1xuXG4gICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IGZhbHNlO1xuICAgIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgLy9lbmFibGUganVtcHMgdGFiIHdoZW4gZXhpdCBlZGl0aW5nIGEgZ3JvdXBcbiAgICAkKCcuanVtcC10YWInKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQgZGlzYWJsZWQtdGFiJyk7XG5cbiAgICAvL3Nob3cgdGl0bGUgZmxhZ1xuICAgICQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX190aXRsZS1mbGFnJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLy9lbmFibGUgZm9ybSB0YWJzIGJ1dHRvbnNcbiAgICB1aS5mb3Jtc190YWJzLnRvZ2dsZUZvcm1UYWJzQnV0dG9ucyh7XG4gICAgICAgIGVuYWJsZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBvd25lciBpbnB1dFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG59O1xuXG5Hcm91cElucHV0LnByb3RvdHlwZS5zaG93RWRpdEdyb3VwVUkgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAvL2hpZGUgZmlyc3QgbGV2ZWwgaW5wdXRzIGZyb20gdGhlIGlucHV0IGNvbGxlY3Rpb25cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnID4gLmlucHV0Jykubm90KCcuYWN0aXZlLWdyb3VwJykuc2xpZGVVcChjb25zdHMuQU5JTUFUSU9OX05PUk1BTCk7XG5cbiAgICAvL3VwZGF0ZSBwYW5lbCBoZWFkZXJcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VkaXQtc3RhdGUnKS50ZXh0KG1lc3NhZ2VzLmxhYmVscy5FRElUSU5HX0dST1VQKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoc2VsZi5xdWVzdGlvbi50cnVuYyhjb25zdHMuSU5QVVRTX0NPTExFQ1RJT05fR1JPVVBfTkFNRV9NQVhfRElTUExBWV9MRU5HSFQpKTtcblxuICAgIC8vZGlzYWJsZSBmb3JtIGFjdGlvbiBidXR0b25zIGluIHBhbmVsIGhlYWRpbmdcbiAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVGb3JtQWN0aW9uQnV0dG9ucyhmYWxzZSk7XG5cbiAgICAvL2Rpc2FibGUganVtcHMgdGFiIC8vdG9kbyBpcyB0aGlzIG5lZWRlZD9cbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUp1bXBUYWIoc2VsZi5yZWYsIGZhbHNlKTtcblxuICAgIC8vaGlkZSBvd25lciBncm91cCBpbnB1dCBwYW5lbCBhbmQgc2hvdyAnbm8gZ3JvdXAgaW5wdXRzIHNlbGVjdGVkJyBieSBkZWZhdWx0XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKS5oaWRlKCk7XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKS5zaG93KCk7XG5cbiAgICAvL2hpZGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbCBhY3Rpb24gYnV0dG9ucyB1bnRpbCBhIGdyb3VwIGlucHV0IGdldHMgc2VsZWN0ZWRcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vLy9oaWRlIGJyYW5jaCAmIGdyb3VwIGlucHV0IHRvb2xzIGluIGxlZnQgc2lkZWJhciwgYXMgd2UgY2Fubm90IGhhdmUgYSBicmFuY2ggb3IgYSBncm91cCB3aXRoaW5nIGEgZ3JvdXBcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1icmFuY2gsIC5pbnB1dC1ncm91cCcpLmhpZGUoKTtcblxufTtcblxuR3JvdXBJbnB1dC5wcm90b3R5cGUuc2hvd0VkaXROZXN0ZWRHcm91cFVJID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5hY3RpdmUtYnJhbmNoJyk7XG5cbiAgICAvL3JlbmRlciBVSSBmb3IgYSBuZXN0ZWQgZ3JvdXAsIGFzIHdlIGNhbm5vdCBqdXN0IGhpZGUgdGhlIG1haW4gcGFyZW50IHNpbmNlIGl0IGlzIGEgYnJhbmNoIHNvcnRhYmxlXG4gICAgLy9oaWRlIGluYWN0aXZlIGJyYW5jaCBpbnB1dHMgZnJvbSB0aGUgaW5wdXQgY29sbGVjdGlvblxuICAgIGFjdGl2ZV9icmFuY2hcbiAgICAgICAgLmZpbmQoJy5icmFuY2gtc29ydGFibGUnKVxuICAgICAgICAuZmluZCgnID4gLmlucHV0JylcbiAgICAgICAgLm5vdCgnLmFjdGl2ZS1ncm91cCcpXG4gICAgICAgIC5zbGlkZVVwKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuICAgIC8vaGlkZSBvd25lciBicmFuY2ggYW50IGl0cyBpbmFjdGl2ZSBpbnB1dHMgKHdpdGhvdXQgdXNpbmcgZGlzcGxheTpub25lIGFzIHRoYXQgd2lsbCBoaWRlIHRoZSBuZXN0ZWQgZ3JvdXAgYXMgd2VsbCA6LylcbiAgICBhY3RpdmVfYnJhbmNoXG4gICAgICAgIC5hZGRDbGFzcygnaGlkZGVuLWFjdGl2ZS1icmFuY2gnKVxuICAgICAgICAuZmluZCgnID4gLmlucHV0LWlubmVyID4gaScpXG4gICAgICAgIC5oaWRlKCk7XG5cbiAgICBhY3RpdmVfYnJhbmNoLmZpbmQoJy5leGl0LWJyYW5jaC1lZGl0aW5nJykuaGlkZSgpO1xuXG4gICAgLy9yZW1vdmUgYWxsIGV2ZW50cyBmcm9tIGFjdGl2ZSBicmFuY2ggYXMgd2UgYXJlIG9ubHkgaW50ZXJlc3RlZCBpbiB0aGUgbW91c2Vkb3duIGV2ZW50IG9mIHRoZSBncm91cCBzb3J0YWJsZVxuICAgIGFjdGl2ZV9icmFuY2gub2ZmKCk7XG5cbiAgICAvL3VwZGF0ZSBwYW5lbCBoZWFkZXIsIGFzIGl0IGEgbmVzdGVkIGdyb3VwIHNob3cgZnVsbCBicmVhZGNydW1ic1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VkaXQtc3RhdGUnKVxuICAgICAgICAudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19CUkFOQ0ggKyBtZXNzYWdlcy5sYWJlbHMuRURJVElOR19ORVNURURfR1JPVVApO1xuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lbGVtZW50LW5hbWUnKS50ZXh0KHNlbGYucXVlc3Rpb24udHJ1bmMoY29uc3RzLklOUFVUU19DT0xMRUNUSU9OX0dST1VQX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG5cbiAgICAvL2hpZGUgb3duZXIgZ3JvdXAgaW5wdXQgcGFuZWwgYW5kIHNob3cgJ25vIGdyb3VwIGlucHV0cyBzZWxlY3RlZCcgYnkgZGVmYXVsdFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJykuaGlkZSgpO1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLnNob3coKTtcblxuICAgIC8vaGlkZSBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsIGFjdGlvbiBidXR0b25zIHVudGlsIGEgZ3JvdXAgaW5wdXQgZ2V0cyBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgLy8vL2Rpc2FibGUgYnJhbmNoICYgZ3JvdXAgaW5wdXQgdG9vbHMgaW4gbGVmdCBzaWRlYmFyLCBhcyB3ZSBjYW5ub3QgaGF2ZSBhIGJyYW5jaCBvciBhIGdyb3VwIHdpdGhpbmcgYSBncm91cFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LWJyYW5jaCwgLmlucHV0LWdyb3VwJykuaGlkZSgpO1xufTtcblxuR3JvdXBJbnB1dC5wcm90b3R5cGUudmFsaWRhdGVHcm91cElucHV0cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgZ3JvdXBfaW5wdXRzX3ZhbGlkYXRpb24gPSB2YWxpZGF0aW9uLnZhbGlkYXRlR3JvdXBJbnB1dHMoc2VsZik7XG4gICAgaWYgKCFncm91cF9pbnB1dHNfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dCBhbmQgc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIGVycm9ycy5zaG93R3JvdXBJbnB1dHNFcnJvcnMoc2VsZi5kb20ucHJvcGVydGllc19wYW5lbCwgZ3JvdXBfaW5wdXRzX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIC8vc2V0IGVsZW1lbnQgYXMgaW52YWxpZFxuICAgICAgICBzZWxmLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vc2V0IGVsZW1lbnQgYXMgdmFsaWRcbiAgICAgICAgc2VsZi5kb20uaXNfdmFsaWQgPSB0cnVlO1xuICAgICAgICBlcnJvcnMuaGlkZUdyb3VwSW5wdXRzRXJyb3JzKHNlbGYuZG9tLnByb3BlcnRpZXNfcGFuZWwpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR3JvdXBJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSAoJ3RlbXBsYXRlJyk7XG5cbnZhciBOdW1lcmljSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBkZWZhdWx0IHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5JTlRFR0VSX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5OdW1lcmljSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG4vKlxuIE92ZXJyaWRlc1xuICovXG5cbi8vdmFsaWRhdGUgaW5pdGlhbCBhbnN3ZXJcbk51bWVyaWNJbnB1dC5wcm90b3R5cGUuaXNJbml0aWFsQW5zd2VyVmFsaWQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgdmFsaWRhdGUgPSB2YWxpZGF0aW9uLmlzSW5pdGlhbEFuc3dlclZhbGlkKHRoaXMudHlwZSx0aGlzLmRlZmF1bHQsIHRoaXMucmVnZXgpO1xuXG4gICAgaWYgKHZhbGlkYXRlLmlzX3ZhbGlkKSB7XG4gICAgICAgIC8vdmFsaWRhdGUgZm9yIGludGVnZXIgdHlwZVxuICAgICAgICBpZiAodGhpcy50eXBlID09PSBjb25zdHMuSU5URUdFUl9UWVBFICYmIHRoaXMuZGVmYXVsdCAhPT0gJycpIHtcbiAgICAgICAgICAgIC8vaW5pdGlhbCBhbnN3ZXIgbXVzdCBiZSBhbiBpbnRlZ2VyLCBub3QgYSBmbG9hdFxuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsdWVJbnQodGhpcy5kZWZhdWx0KSkge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLlZBTFVFX01VU1RfQkVfSU5URUdFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsaWRhdGU7XG59O1xuXG5OdW1lcmljSW5wdXQucHJvdG90eXBlLmlzTWluVmFsdWVWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL3ZhbGlkYXRlIG1pbiB2YWx1ZVxuICAgIHJldHVybiB2YWxpZGF0aW9uLmlzTWluTWF4VmFsdWVWYWxpZCh0aGlzLnR5cGUsIHRoaXMubWluKTtcbn07XG5cbk51bWVyaWNJbnB1dC5wcm90b3R5cGUuaXNNYXhWYWx1ZVZhbGlkID0gZnVuY3Rpb24gKCkge1xuICAgIC8vdmFsaWRhdGUgbWF4IHZhbHVlXG4gICAgcmV0dXJuIHZhbGlkYXRpb24uaXNNaW5NYXhWYWx1ZVZhbGlkKHRoaXMudHlwZSwgdGhpcy5tYXgpO1xufTtcblxuTnVtZXJpY0lucHV0LnByb3RvdHlwZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb247XG4gICAgdmFyIG1pbl92YWx1ZV92YWxpZGF0aW9uO1xuICAgIHZhciBtYXhfdmFsdWVfdmFsaWRhdGlvbjtcbiAgICB2YXIgdW5pcXVlbmVzcztcblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhpcy5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAvL2NsZWFyIGFsbCBhZHZhbmNlZCBwcm9wZXJ0aWVzIGVycm9ycyBmcm9tIGRvbVxuICAgIHRoaXMuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycygpO1xuXG4gICAgLy9zZXQgaW50ZWdlciBvciBkZWNpbWFsIG51bWVyaWMgdHlwZVxuICAgIHRoaXMudHlwZSA9IHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fbnVtZXJpYyBpbnB1dDpjaGVja2VkJykudmFsKCk7XG5cbiAgICAvL3NldCBkZWZhdWx0IChpbml0aWFsIGFuc3dlcilcbiAgICB0aGlzLmRlZmF1bHQgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQgaW5wdXQnKS52YWwoKTtcblxuICAgIC8vc3RyaXAgaHRtbCB0YWdzXG4gICAgdGhpcy5kZWZhdWx0ID0gdGhpcy5kZWZhdWx0LnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnJyk7XG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IGlucHV0JykudmFsKHRoaXMuZGVmYXVsdCk7XG5cblxuICAgIC8vc2V0IG1pbiB2YWx1ZVxuICAgIHRoaXMubWluID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19taW4gaW5wdXQnKS52YWwoKTtcbiAgICB0aGlzLm1pbiA9IHRoaXMubWluLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnJyk7XG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19taW4gaW5wdXQnKS52YWwodGhpcy5taW4pO1xuXG4gICAgLy9zZXQgbWF4IHZhbHVlXG4gICAgdGhpcy5tYXggPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX21heCBpbnB1dCcpLnZhbCgpO1xuICAgIHRoaXMubWF4ID0gdGhpcy5tYXgucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcnKTtcbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX21heCBpbnB1dCcpLnZhbCh0aGlzLm1heCk7XG5cbiAgICAvL3NldCByZWdleFxuICAgIHRoaXMucmVnZXggPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0JykudmFsKCk7XG4gICAgdGhpcy5yZWdleCA9IHRoaXMucmVnZXgucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcnKTtcbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0JykudmFsKHRoaXMucmVnZXgpO1xuXG4gICAgLy9zZXQgdmVyaWZ5IGZsYWdcbiAgICB0aGlzLnZlcmlmeSA9IHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZG91YmxlLWVudHJ5IGlucHV0JykuaXMoJzpjaGVja2VkJyk7XG5cbiAgICAvL3ZhbGlkYXRlIGluaXRpYWwgYW5zd2VyIChiYXNlZCBhbHNvIG9uIG1pbiBtYXggYW5kIG51bWVyaWMgdHlwZSlcbiAgICBpbml0aWFsX2Fuc3dlcl92YWxpZGF0aW9uID0gdGhpcy5pc0luaXRpYWxBbnN3ZXJWYWxpZCgpO1xuICAgIGlmICghaW5pdGlhbF9hbnN3ZXJfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuICAgICAgICAvL3dhcm4gdXNlciBpbml0aWFsIGFuc3dlciBpcyBub3QgdmFsaWRcbiAgICAgICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXRcbiAgICAgICAgdGhpcy5zaG93QWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZLCBpbml0aWFsX2Fuc3dlcl92YWxpZGF0aW9uLmVycm9yLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8vdmFsaWRhdGUgbWluIHZhbHVlXG4gICAgbWluX3ZhbHVlX3ZhbGlkYXRpb24gPSB0aGlzLmlzTWluVmFsdWVWYWxpZCgpO1xuICAgIGlmICghbWluX3ZhbHVlX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgLy93YXJuIHVzZXIgbWluIHZhbHVlIGlzIG5vdCB2YWxpZFxuICAgICAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dFxuICAgICAgICB0aGlzLnNob3dBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoY29uc3RzLk1JTl9WQUxVRV9QUk9QRVJUWSwgbWluX3ZhbHVlX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuXG4gICAgLy92YWxpZGF0ZSBtYXggdmFsdWVcbiAgICBtYXhfdmFsdWVfdmFsaWRhdGlvbiA9IHRoaXMuaXNNYXhWYWx1ZVZhbGlkKCk7XG4gICAgaWYgKCFtYXhfdmFsdWVfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuICAgICAgICAvL3dhcm4gdXNlciBtaW4gdmFsdWUgaXMgbm90IHZhbGlkXG4gICAgICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0XG4gICAgICAgIHRoaXMuc2hvd0FkdmFuY2VkUHJvcGVydGllc0Vycm9ycyhjb25zdHMuTUFYX1ZBTFVFX1BST1BFUlRZLCBtYXhfdmFsdWVfdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlKTtcbiAgICB9XG5cbiAgICAvL2FsbCBhZHZhbmNlZCBwcm9wZXJ0aWVzIGFyZSB2YWxpZCwgdmFsaWRhdGUgY29tYmluYXRpb25zIGFjcm9zcyBwcm9wZXJ0aWVzXG4gICAgLy9taW4gKGlmIHNldCkgbmVlZHMgdG8gYmUgc21hbGxlciB0aGFuIG1heCAoaWYgc2V0KVxuICAgIGlmIChtaW5fdmFsdWVfdmFsaWRhdGlvbi5pc192YWxpZCAmJiBtYXhfdmFsdWVfdmFsaWRhdGlvbi5pc192YWxpZCAmJiB0aGlzLm1pbiAhPT0gJycgJiYgdGhpcy5tYXggIT09ICcnKSB7XG5cbiAgICAgICAgaWYgKHBhcnNlRmxvYXQodGhpcy5taW4pID49IHBhcnNlRmxvYXQodGhpcy5tYXgpKSB7XG4gICAgICAgICAgICAvL3dhcm4gdXNlciBtaW4gdmFsdWUgaXMgbm90IHZhbGlkXG4gICAgICAgICAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXRcbiAgICAgICAgICAgIHRoaXMuc2hvd0FkdmFuY2VkUHJvcGVydGllc0Vycm9ycyhjb25zdHMuTUlOX1ZBTFVFX1BST1BFUlRZLCBtZXNzYWdlcy5lcnJvci5NSU5fTVVTVF9CRV9TTUFMTEVSX1RIQU5fTUFYKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vaW50aWFsIGFuc3dlciAoaWYgc2V0KSBzaG91bGQgYmUgd2l0aGluIHRoZSByYW5nZSBzZXQgYnkgbWluL21heCBwcm9wZXJ0aWVzXG4gICAgaWYgKGluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb24uaXNfdmFsaWQgJiYgdGhpcy5kZWZhdWx0ICE9PSAnJykge1xuXG4gICAgICAgIGlmIChtaW5fdmFsdWVfdmFsaWRhdGlvbi5pc192YWxpZCAmJiB0aGlzLm1pbiAhPT0gJycpIHtcbiAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KHRoaXMuZGVmYXVsdCkgPCBwYXJzZUZsb2F0KHRoaXMubWluKSkge1xuICAgICAgICAgICAgICAgIC8vd2FybiB1c2VyIG1pbiB2YWx1ZSBpcyBub3QgdmFsaWRcbiAgICAgICAgICAgICAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93QWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZLCBtZXNzYWdlcy5lcnJvci5JTklUSUFMX0FOU1dFUl9PVVRfT0ZfUkFOR0UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1heF92YWx1ZV92YWxpZGF0aW9uLmlzX3ZhbGlkICYmIHRoaXMubWF4ICE9PSAnJykge1xuICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQodGhpcy5kZWZhdWx0KSA+IHBhcnNlRmxvYXQodGhpcy5tYXgpKSB7XG4gICAgICAgICAgICAgICAgLy93YXJuIHVzZXIgbWluIHZhbHVlIGlzIG5vdCB2YWxpZFxuICAgICAgICAgICAgICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXRcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoY29uc3RzLkRFRkFVTFRfUFJPUEVSVFksIG1lc3NhZ2VzLmVycm9yLklOSVRJQUxfQU5TV0VSX09VVF9PRl9SQU5HRSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3NhdmUgdW5pcXVlbmVzc1xuICAgIHNhdmUuc2F2ZVVuaXF1ZW5lc3ModGhpcyk7XG59O1xuXG5OdW1lcmljSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvL3Jlc2V0IHZhbGlkYXRpb24gZG9tIGZlZWRiYWNrIChoaWRlIGFsbCBlcnJvcnMgZnJvbSBkb20pXG4gICAgdmFyIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvciA9IFtcbiAgICAgICAgY29uc3RzLkRFRkFVTFRfUFJPUEVSVFksXG4gICAgICAgIGNvbnN0cy5NSU5fVkFMVUVfUFJPUEVSVFksXG4gICAgICAgIGNvbnN0cy5NQVhfVkFMVUVfUFJPUEVSVFlcbiAgICBdO1xuXG4gICAgZXJyb3JzLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnModGhpcywgcHJvcGVydGllc190b19oaWRlX2Vycm9yKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTnVtZXJpY0lucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG52YXIgTG9jYXRpb25JbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBwcm9wZXJ0aWVzXG4gICAvLyB0aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuTE9DQVRJT05fVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcbkxvY2F0aW9uSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG4vKlxuIE92ZXJyaWRlc1xuICovXG4vL0xvY2F0aW9uSW5wdXQucHJvdG90eXBlLnByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbi8vfTtcbi8vXG4vL0xvY2F0aW9uSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAvL2RvIG5vdGhpbmdcbi8vfTtcblxubW9kdWxlLmV4cG9ydHMgPSBMb2NhdGlvbklucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgUGhvbmVJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCAodXNpbmcgYSBjbG9uZSwgbm90IGEgcmVmZXJlbmNlKSB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5QSE9ORV9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScpKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcblBob25lSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG4vKlxuIE92ZXJyaWRlc1xuICovXG5cblBob25lSW5wdXQucHJvdG90eXBlLnNldEFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9zZXQgICdkZWZhdWx0JyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQgaW5wdXQnKS52YWwodGhpcy5kZWZhdWx0KTtcblxuICAgIC8vc2V0ICdyZWdleCcgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCh0aGlzLnJlZ2V4KTtcblxuICAgIC8vc2V0ICdpbnB1dF9yZWYnIG9uICdkb3VibGUgZW50cnkgdmVyaWZpY2F0aW9uJyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RvdWJsZS1lbnRyeSBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnZlcmlmeSk7XG5cbiAgICAvL3NldCAnaW5wdXRfcmVmJyBvbiAndW5pcXVlbmVzcycgb3B0aW9uXG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zZXRVbmlxdWVuZXNzUHJvcGVydHkoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LCB0aGlzKTtcbn07XG5cblxuUGhvbmVJbnB1dC5wcm90b3R5cGUuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vcmVzZXQgdmFsaWRhdGlvbiBkb20gZmVlZGJhY2sgKGhpZGUgYWxsIGVycm9ycyBmcm9tIGRvbSlcbiAgICB2YXIgcHJvcGVydGllc190b19oaWRlX2Vycm9yID0gW1xuICAgICAgICBjb25zdHMuREVGQVVMVF9QUk9QRVJUWVxuICAgIF07XG4gICAgZXJyb3JzLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnModGhpcywgcHJvcGVydGllc190b19oaWRlX2Vycm9yKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUGhvbmVJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCcuLi9jb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCcuLi9jb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIFBob3RvSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLlBIT1RPX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5QaG90b0lucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcbi8qXG4gT3ZlcnJpZGVzXG4gKi9cbi8vUGhvdG9JbnB1dC5wcm90b3R5cGUucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuLy99O1xuXG4vL1Bob3RvSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAvL2RvIG5vdGhpbmdcbi8vfTtcblxubW9kdWxlLmV4cG9ydHMgPSBQaG90b0lucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBwb3NzaWJsZV9hbnN3ZXJzID0gcmVxdWlyZSgnYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciBJbnB1dE11bHRpcGxlQW5zd2VycyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtbXVsdGlwbGUtYW5zd2Vycy1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIFJhZGlvSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLlJBRElPX1RZUEU7XG5cbiAgICAvL3NldCBhIGRlZmF1bHQgYW5zd2VyIG9uIG5ld2x5IGNyZWF0ZWQgZHJvcGRvd25zIGlucHV0c1xuICAgIHRoaXMucG9zc2libGVfYW5zd2VycyA9IFt7XG4gICAgICAgIGFuc3dlcjogJ0kgYW0gYSBwbGFjZWhvbGRlciBhbnN3ZXInLFxuICAgICAgICBhbnN3ZXJfcmVmOiB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpXG4gICAgfV07XG5cblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAvL3BhZ2luYXRpb24gZGVmYXVsdHNcbiAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bdGhpcy5yZWZdID0ge307XG4gICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW3RoaXMucmVmXS5wYWdlID0gMTtcblxufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0IGFuZCBtdWx0aXBsZSBhbnN3ZXIgb2JqZWN0XG5SYWRpb0lucHV0LnByb3RvdHlwZSA9ICQuZXh0ZW5kKHt9LCBJbnB1dC5wcm90b3R5cGUsIElucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZSk7XG5cbm1vZHVsZS5leHBvcnRzID0gUmFkaW9JbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIFJlYWRtZUlucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0ICh1c2luZyBhIGNsb25lLCBub3QgYSByZWZlcmVuY2UpIHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLlJFQURNRV9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScpKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAvL292ZXJyaWRlIGEgZmV3IHByb3BlcnRpZXMgZm9yIHZhbGlkYXRpb24gcHVycG9zZXMgc2VydmVyIHNpZGVcbiAgICB0aGlzLmlzX3RpdGxlID0gZmFsc2U7XG4gICAgdGhpcy52ZXJpZnkgPSBmYWxzZTtcbiAgICB0aGlzLmlzX3JlcXVpcmVkID0gZmFsc2U7XG5cblxuXG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcblJlYWRtZUlucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuXG4vKlxuIE92ZXJyaWRlc1xuICovXG5cblxubW9kdWxlLmV4cG9ydHMgPSBSZWFkbWVJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgcG9zc2libGVfYW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2VycycpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgSW5wdXRNdWx0aXBsZUFuc3dlcnMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LW11bHRpcGxlLWFuc3dlcnMtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBTZWFyY2hJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFO1xuXG4gICAgLy9zZXQgYSBkZWZhdWx0IGFuc3dlciBvbiBuZXdseSBjcmVhdGVkIGRyb3Bkb3ducyBpbnB1dHNcbiAgICB0aGlzLnBvc3NpYmxlX2Fuc3dlcnMgPSBbe1xuICAgICAgICBhbnN3ZXI6ICdJIGFtIGEgcGxhY2Vob2xkZXIgYW5zd2VyJyxcbiAgICAgICAgYW5zd2VyX3JlZjogdXRpbHMuZ2VuZXJhdGVVbmlxSUQoKVxuICAgIH1dO1xuXG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW3RoaXMucmVmXSA9IHt9O1xuICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvblt0aGlzLnJlZl0ucGFnZSA9IDE7XG5cbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdCBhbmQgbXVsdGlwbGUgYW5zd2VyIG9iamVjdFxuU2VhcmNoSW5wdXQucHJvdG90eXBlID0gJC5leHRlbmQoe30sIElucHV0LnByb3RvdHlwZSwgSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlKTtcblxubW9kdWxlLmV4cG9ydHMgPSBTZWFyY2hJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIFRleHRJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCAodXNpbmcgYSBjbG9uZSwgbm90IGEgcmVmZXJlbmNlKSB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5URVhUX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJykqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuVGV4dElucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuLypcbiBPdmVycmlkZXNcbiAqL1xuXG5UZXh0SW5wdXQucHJvdG90eXBlLnNldEFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9zZXQgICdkZWZhdWx0JyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQgaW5wdXQnKS52YWwodGhpcy5kZWZhdWx0KTtcblxuICAgIC8vc2V0ICdyZWdleCcgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCh0aGlzLnJlZ2V4KTtcblxuICAgIC8vc2V0ICdpbnB1dF9yZWYnIG9uICdkb3VibGUgZW50cnkgdmVyaWZpY2F0aW9uJyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RvdWJsZS1lbnRyeSBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnZlcmlmeSk7XG5cbiAgICAvL3NldCAnaW5wdXRfcmVmJyBvbiAndW5pcXVlbmVzcycgb3B0aW9uXG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zZXRVbmlxdWVuZXNzUHJvcGVydHkoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LCB0aGlzKTtcbn07XG5cblxuVGV4dElucHV0LnByb3RvdHlwZS5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIHZhciBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IgPSBbXG4gICAgICAgIGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZXG4gICAgXTtcbiAgICBlcnJvcnMuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyh0aGlzLCBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUZXh0SW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBUZXh0YXJlYUlucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBkZWZhdWx0IHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5URVhUQVJFQV9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuVGV4dGFyZWFJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbi8qXG4gT3ZlcnJpZGVzXG4gKi9cblxuVGV4dGFyZWFJbnB1dC5wcm90b3R5cGUuc2V0QWR2YW5jZWRJbnB1dFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIgPSBmb3JtYnVpbGRlclxuICAgICAgICAuZG9tXG4gICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhpcy5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAvL3NldCAgJ2RlZmF1bHQnIG9wdGlvblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBpbnB1dCcpLnZhbCh0aGlzLmRlZmF1bHQpO1xuXG4gICAgLy9zZXQgJ3JlZ2V4JyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0JykudmFsKHRoaXMucmVnZXgpO1xuXG4gICAgLy9zZXQgJ2lucHV0X3JlZicgb24gJ2RvdWJsZSBlbnRyeSB2ZXJpZmljYXRpb24nIG9wdGlvblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZG91YmxlLWVudHJ5IGlucHV0JykucHJvcCgnY2hlY2tlZCcsIHRoaXMudmVyaWZ5KTtcblxuICAgIC8vc2V0ICdpbnB1dF9yZWYnIG9uICd1bmlxdWVuZXNzJyBvcHRpb25cbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNldFVuaXF1ZW5lc3NQcm9wZXJ0eShmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgsIHRoaXMpO1xufTtcblxuVGV4dGFyZWFJbnB1dC5wcm90b3R5cGUuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL3Jlc2V0IHZhbGlkYXRpb24gZG9tIGZlZWRiYWNrIChoaWRlIGFsbCBlcnJvcnMgZnJvbSBkb20pXG4gICAgdmFyIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvciA9IFtcbiAgICAgICAgY29uc3RzLkRFRkFVTFRfUFJPUEVSVFlcbiAgICBdO1xuICAgIGVycm9ycy5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKHRoaXMsIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvcik7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRleHRhcmVhSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBUaW1lSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLlRJTUVfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcblRpbWVJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbi8qXG4gT3ZlcnJpZGVzXG4gKi9cblxuXG5UaW1lSW5wdXQucHJvdG90eXBlLnNldEFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG5cbiAgICAvL3NldCBkZWZhdWx0IHRvIGN1cnJlbnQgZGF0ZXRpbWU/XG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdC10by1jdXJyZW50IGxhYmVsIGlucHV0JykucHJvcCgnY2hlY2tlZCcsIHRoaXMuc2V0X3RvX2N1cnJlbnRfZGF0ZXRpbWUpO1xuXG4gICAgLy9zZXQgZGF0ZXRpbWUgZm9ybWF0XG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdGltZWZvcm1hdCBpbnB1dFtuYW1lPVwidGltZWZvcm1hdFJhZGlvXCJdW3ZhbHVlPVwiJyArIHRoaXMuZGF0ZXRpbWVfZm9ybWF0ICsgJ1wiXScpXG4gICAgICAgIC5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAvL3NldCAndW5pcXVlbmVzcycgb3B0aW9uXG4gICAgLy9zZXQgJ2lucHV0X3JlZicgb24gJ3VuaXF1ZW5lc3MnIG9wdGlvblxuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG5cbn07XG5cblRpbWVJbnB1dC5wcm90b3R5cGUuc2F2ZUFkdmFuY2VkUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgIHZhciB1bmlxdWVuZXNzO1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGlzLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgIC8vc2V0IGRlZmF1bHQgdG8gY3VycmVudCBkYXRldGltZT9cbiAgICB0aGlzLnNldF90b19jdXJyZW50X2RhdGV0aW1lID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdC10by1jdXJyZW50IGlucHV0JylcbiAgICAgICAgLmlzKCc6Y2hlY2tlZCcpO1xuXG4gICAgLy9zZXQgZGF0ZXRpbWUgZm9ybWF0XG4gICAgdGhpcy5kYXRldGltZV9mb3JtYXQgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX190aW1lZm9ybWF0IGlucHV0W25hbWU9XCJ0aW1lZm9ybWF0UmFkaW9cIl06Y2hlY2tlZCcpXG4gICAgICAgIC52YWwoKTtcblxuICAgIC8vc2F2ZSB1bmlxdWVuZXNzXG4gICAgc2F2ZS5zYXZlVW5pcXVlbmVzcyh0aGlzKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVGltZUlucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgVmlkZW9JbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuVklERU9fVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcblZpZGVvSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFZpZGVvSW5wdXQ7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cy5qcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBsb2FkX2NoaWxkX2Zvcm1fY29udGFpbmVycyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBkZWZlcnJlZCA9IG5ldyAkLkRlZmVycmVkKCk7XG4gICAgdmFyIHZpZXdzID0ge307XG4gICAgdmFyIHBhdGggPSB1dGlscy5nZXRDb250YWluZXJzUGF0aCgpO1xuICAgIHZhciB2ZXJzaW9uID0gY29uc3RzLkZPUk1CVUlMREVSX1ZFUlNJT047XG5cbiAgICAkLndoZW4oXG4gICAgICAgIC8vaW5wdXRzIGNvbGxlY3Rpb24gKHNvcnRhYmxlKSwgaG9sZGluZyBhbGwgdGhlIGlucHV0cyBmb3IgYSBjaGlsZCBmb3JtXG4gICAgICAgICQuZ2V0KHBhdGggKyAnaW5wdXRzLWNvbGxlY3Rpb24uaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuaW5wdXRzX2NvbGxlY3Rpb24gPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgLy9pbnB1dHMgcHJvcGVydGllcywgc2hvd2luZyBwcm9wZXJ0aWVzIGZvciBzZWxlY3RlZCBpbnB1dFxuICAgICAgICAkLmdldChwYXRoICsgJ2lucHV0cy1wcm9wZXJ0aWVzLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLmlucHV0c19wcm9wZXJ0aWVzID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZpZXdzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBsb2FkX2NoaWxkX2Zvcm1fY29udGFpbmVycztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBsb2FkX3BhcnRpYWxzID0gcmVxdWlyZSgnbG9hZGVycy9sb2FkLXBhcnRpYWxzJyk7XG52YXIgbG9hZF9jb250YWluZXJzID0gcmVxdWlyZSgnbG9hZGVycy9sb2FkLWNvbnRhaW5lcnMnKTtcbnZhciBsb2FkX2lucHV0X3Byb3BlcnRpZXNfdmlld3MgPSByZXF1aXJlKCdsb2FkZXJzL2xvYWQtaW5wdXQtcHJvcGVydGllcy12aWV3cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiBMb2FkIGh0bWwgY29tcG9uZW50c1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG52YXIgbG9hZF9jb21wb25lbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGRlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcblxuICAgIC8vbG9hZCBtYWluIGNvbnRhaW5lcnMgKGlucHV0cyB0b29scywgaW5wdXRzIGNvbGxlY3Rpb24gYW5kIGlucHV0cyBwcm9wZXJ0aWVzKSAoXCJjb250YWluZXJzIHdpbGwgYmUgdW5kZWZpbmVkXCIpXG4gICAgLy9sb2FkIHBhcnRpYWxzIGZvciBpbnB1dCBwcm9wZXJ0aWVzIHRhYnMgKFwicGFydGlhbHNcIilcbiAgICAvL2xvYWQgdmlld3MgZm9yIGlucHV0IHByb3BlcnRpZXMgKFwidmlld3NcIilcbiAgICAkLndoZW4obG9hZF9jb250YWluZXJzKCksIGxvYWRfcGFydGlhbHMoKSwgbG9hZF9pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzKCkpLnRoZW4oZnVuY3Rpb24gKGNvbnRhaW5lcnMsIHBhcnRpYWxzLCB2aWV3cykge1xuXG4gICAgICAgIC8vaW5pdCB3aXRoIGZpcnN0IGZvcm0gcmVmXG4gICAgICAgIHZhciBmb3JtX3JlZiA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0ucmVmO1xuXG4gICAgICAgIC8vaW5qZWN0IHJlZiBpbnRvIGZpcnN0IGZvcm0gaW4gdGhlIGRvbVxuICAgICAgICB1aS5mb3Jtc190YWJzLmluamVjdFJlZkludG9Gb3JtVGFiKGZvcm1fcmVmKTtcblxuICAgICAgICAvL3NldHVwIGZvcm1idWlsZGVyIG9iamVjdFxuICAgICAgICBmb3JtYnVpbGRlci5zZXR1cChmb3JtX3JlZiwgcGFydGlhbHMsIHZpZXdzKTtcblxuXG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBsb2FkX2NvbXBvbmVudHM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cy5qcycpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgZ2V0X2NvbnRhaW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuICAgIHZhciBwYXRoID0gdXRpbHMuZ2V0Q29udGFpbmVyc1BhdGgoKTtcbiAgICB2YXIgdmVyc2lvbiA9IGNvbnN0cy5GT1JNQlVJTERFUl9WRVJTSU9OO1xuXG4gICAgLy9sb2FkIGNvbnRhaW5lciB2aWV3cyBmb3IgaW5kZXguaHRtbCAobWFpbiBlbnRyeSBwb2ludClcbiAgICAkLndoZW4oXG4gICAgICAgIC8vbmF2YmFyXG4gICAgICAgICQuZ2V0KHBhdGggKyAnbmF2YmFyLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICQoJy5uYXZiYXInKS5odG1sKGRhdGEpO1xuICAgICAgICB9KSxcbiAgICAgICAgLy9pbnB1dHMgdG9vbHMgbGlzdCAoc291cmNlIGlucHV0cyB0byBkcmFnLCBkcmFnZ2FibGUpXG4gICAgICAgICQuZ2V0KHBhdGggKyAnaW5wdXRzLXRvb2xzLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICQoJy5pbnB1dHMtdG9vbHMnKS5odG1sKGRhdGEpO1xuICAgICAgICB9KSxcbiAgICAgICAgLy9pbnB1dHMgY29sbGVjdGlvbiAoc29ydGFibGUpLCBob2xkaW5nIGFsbCB0aGUgaW5wdXRzIGZvciBhIGZvcm1cbiAgICAgICAgJC5nZXQocGF0aCArICdpbnB1dHMtY29sbGVjdGlvbi5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAkKCcuaW5wdXRzLWNvbGxlY3Rpb24nKS5odG1sKGRhdGEpO1xuICAgICAgICB9KSxcbiAgICAgICAgLy9pbnB1dHMgcHJvcGVydGllcywgc2hvd2luZyBwcm9wZXJ0aWVzIGZvciBzZWxlY3RlZCBpbnB1dFxuICAgICAgICAkLmdldChwYXRoICsgJ2lucHV0cy1wcm9wZXJ0aWVzLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICQoJy5pbnB1dC1wcm9wZXJ0aWVzJykuaHRtbChkYXRhKTtcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRfY29udGFpbmVycztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzLmpzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cblxudmFyIGxvYWRfaW5wdXRfcHJvcGVydGllc192aWV3cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciB2aWV3cyA9IHt9O1xuICAgIHZhciBkZWZlcnJlZCA9IG5ldyAkLkRlZmVycmVkKCk7XG4gICAgdmFyIHBhdGggPSB1dGlscy5nZXRQcm9wZXJ0aWVzUGF0aCgpO1xuICAgIHZhciB2ZXJzaW9uID0gY29uc3RzLkZPUk1CVUlMREVSX1ZFUlNJT047XG5cbiAgICAkLndoZW4oXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1hdWRpby5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5hdWRpbyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtYmFyY29kZS5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5iYXJjb2RlID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1icmFuY2guaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuYnJhbmNoID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1jaGVja2JveC5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5jaGVja2JveCA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtZGF0ZS5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5kYXRlID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1kcm9wZG93bi5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5kcm9wZG93biA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtZ3JvdXAuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuZ3JvdXAgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwcm9wZXJ0aWVzLWludGVnZXIuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuaW50ZWdlciA9IGRhdGE7XG4gICAgICAgICAgICB2aWV3cy5kZWNpbWFsID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1sb2NhdGlvbi5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5sb2NhdGlvbiA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtcGhvdG8uaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MucGhvdG8gPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwcm9wZXJ0aWVzLXBob25lLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLnBob25lID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1yYWRpby5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5yYWRpbyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtdGV4dGFyZWEuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MudGV4dGFyZWEgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwcm9wZXJ0aWVzLXJlYWRtZS5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5yZWFkbWUgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwcm9wZXJ0aWVzLXRleHQuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MudGV4dCA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtdGltZS5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy50aW1lID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy12aWRlby5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy52aWRlbyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtc2VhcmNoc2luZ2xlLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLnNlYXJjaHNpbmdsZSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtc2VhcmNoc2luZ2xlLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLnNlYXJjaG11bHRpcGxlID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZpZXdzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBsb2FkX2lucHV0X3Byb3BlcnRpZXNfdmlld3M7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cy5qcycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgZ2V0X3BhcnRpYWxzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHBhcnRpYWxzID0ge307XG4gICAgdmFyIGRlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcbiAgICB2YXIgcGF0aCA9IHV0aWxzLmdldFBhcnRpYWxzUGF0aCgpO1xuICAgIHZhciB2ZXJzaW9uID0gY29uc3RzLkZPUk1CVUlMREVSX1ZFUlNJT047XG5cbiAgICAkLndoZW4oXG4gICAgICAgICQuZ2V0KHBhdGggKyAnbmF2LXRhYnMuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMubmF2dGFicyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2Jhc2ljLXByb3BlcnRpZXMuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuYmFzaWNfcHJvcGVydGllcyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3VuaXF1ZW5lc3MtZm9ybS1jaGVja2JveC5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy51bmlxdWVuZXNzX2Zvcm1fY2hlY2tib3ggPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICd1bmlxdWVuZXNzLWhpZXJhcmNoeS1jaGVja2JveGVzLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLnVuaXF1ZW5lc3NfaGllcmFyY2h5X2NoZWNrYm94ZXMgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICd1bmlxdWVuZXNzLWJyYW5jaC1jaGVja2JveC5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy51bmlxdWVuZXNzX2JyYW5jaF9jaGVja2JveCA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2V4aXQtYnJhbmNoZ3JvdXAtZWRpdGluZy5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5leGl0X2JyYW5jaGdyb3VwX2VkaXRpbmcgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdiYXNpYy1tZWRpYS1wcm9wZXJ0aWVzLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLmJhc2ljX21lZGlhX3Byb3BlcnRpZXMgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdiYXNpYy1icmFuY2gtcHJvcGVydGllcy5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5iYXNpY19icmFuY2hfcHJvcGVydGllcyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2Jhc2ljLWdyb3VwLXByb3BlcnRpZXMuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuYmFzaWNfZ3JvdXBfcHJvcGVydGllcyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2Jhc2ljLXJlYWRtZS1wcm9wZXJ0aWVzLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLmJhc2ljX3JlYWRtZV9wcm9wZXJ0aWVzID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncG9zc2libGUtYW5zd2Vycy13cmFwcGVyLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLnBvc3NpYmxlX2Fuc3dlcnNfd3JhcHBlciA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Bvc3NpYmxlLWFuc3dlci1saXN0LWl0ZW0uaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2p1bXBzLXdyYXBwZXIuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuanVtcHNfd3JhcHBlciA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2p1bXAtbGlzdC1pdGVtLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLmp1bXBfbGlzdF9pdGVtID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAnanVtcC1saXN0LWl0ZW0tYWx3YXlzLWp1bXAuaHRtbD92PScgKyB2ZXJzaW9uLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuanVtcF9saXN0X2l0ZW1fYWx3YXlzX2p1bXAgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdtb2RhbC1mb3JtLmh0bWw/dj0nICsgdmVyc2lvbiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLm1vZGFsX2VkaXRfZm9ybV9uYW1lID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAnaW5wdXQtdG9vbC5odG1sP3Y9JyArIHZlcnNpb24sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5pbnB1dF90b29sID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHBhcnRpYWxzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRfcGFydGlhbHM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBsb2FkX3Byb2plY3QgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvL2dldCB2ZXJzaW9uIGZpcnN0LCB3ZSBuZWVkIGl0IGZvciBidXN0aW5nIGNhY2hlIGluIGlubmVyIGFqYXggcmVxdWVzdHNcbiAgICBjb25zb2xlLmxvZygkKCcjZm9ybWJ1aWxkZXItdmVyc2lvbicpLmRhdGEoKSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3RzLkZPUk1CVUlMREVSX1ZFUlNJT04gPSAkKCcjZm9ybWJ1aWxkZXItdmVyc2lvbicpLmRhdGEoKS52ZXJzaW9uO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICBjb25zdHMuRk9STUJVSUxERVJfVkVSU0lPTiA9IERhdGUubm93KCk7XG4gICAgfVxuXG4gICAgdmFyIGRlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcblxuICAgIHV0aWxzLnNldFByb2plY3RVUkwoKTtcblxuICAgIGNvbnNvbGUubG9nKGNvbnN0cy5QUk9KRUNUX1VSTCArICc/JyArIERhdGUubm93KCkpO1xuXG4gICAgLy9sb2FkIGNvbnRhaW5lciB2aWV3cyBmb3IgaW5kZXguaHRtbCAobWFpbiBlbnRyeSBwb2ludClcbiAgICAkLndoZW4oXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IGNvbnN0cy5QUk9KRUNUX1VSTCArICc/JyArIERhdGUubm93KCksXG4gICAgICAgICAgICB0eXBlOiAnR0VUJyxcbiAgICAgICAgICAgIC8vY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi92bmQuYXBpK2pzb24nLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24gPSBkYXRhO1xuICAgICAgICAgICAgICAgIC8vIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbiA9IGRhdGFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbiA9IEpTT04ucGFyc2UocGFrby51bmd6aXAod2luZG93LmF0b2IoZXJyb3IucmVzcG9uc2VUZXh0KSwgeyAndG8nOiAnc3RyaW5nJyB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgIH0pLmZhaWwoZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbG9hZF9wcm9qZWN0O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIG1ldGhvZHMgPSB7fTtcblxubWV0aG9kcy5yZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9yZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzJyk7XG5tZXRob2RzLmNyZWF0ZUlucHV0VG9vbEhUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUlucHV0VG9vbEhUTUwnKTtcbm1ldGhvZHMucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvcHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCcpO1xubWV0aG9kcy5nZXRKdW1wVGFiQnRuSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0SnVtcFRhYkJ0bkhUTUwnKTtcbm1ldGhvZHMuZ2V0QWR2YW5jZWRUYWJCdG5IVE1MID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9nZXRBZHZhbmNlZFRhYkJ0bkhUTUwnKTtcbm1ldGhvZHMuY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTCcpO1xubWV0aG9kcy5nZXRVbmlxdWVuZXNzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0VW5pcXVlbmVzc0hUTUwnKTtcbm1ldGhvZHMuZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCcpO1xubWV0aG9kcy5nZXRJbnB1dFByb3BlcnRpZXNQYW5lbEhUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldElucHV0UHJvcGVydGllc1BhbmVsSFRNTCcpO1xubWV0aG9kcy5jcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9jcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MJyk7XG5tZXRob2RzLmdldEp1bXBzTGlzdEhUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldEp1bXBzTGlzdEhUTUwnKTtcblxudmFyIHRlbXBsYXRlID0ge1xuXG4gICAgcmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllczogZnVuY3Rpb24gKHRoZV9tYXJrdXAsIHRoZV9pbnB1dCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5yZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzKHRoZV9tYXJrdXAsIHRoZV9pbnB1dCk7XG4gICAgfSxcbiAgICBjcmVhdGVJbnB1dFRvb2xIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuY3JlYXRlSW5wdXRUb29sSFRNTChpbnB1dCk7XG4gICAgfSxcbiAgICBwcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAodmlldywgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCh2aWV3LCBpbnB1dCk7XG4gICAgfSxcbiAgICBnZXRBZHZhbmNlZFRhYkJ0bkhUTUw6IGZ1bmN0aW9uIChyZWYsIGlzX2FjdGl2ZSkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRBZHZhbmNlZFRhYkJ0bkhUTUwocmVmLCBpc19hY3RpdmUpO1xuICAgIH0sXG4gICAgZ2V0SnVtcFRhYkJ0bkhUTUw6IGZ1bmN0aW9uIChyZWYsIGlzX2FjdGl2ZSkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRKdW1wVGFiQnRuSFRNTChyZWYsIGlzX2FjdGl2ZSk7XG4gICAgfSxcbiAgICBjcmVhdGVCYXNpY1Byb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTChpbnB1dCk7XG4gICAgfSxcbiAgICBnZXRVbmlxdWVuZXNzSFRNTDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBtZXRob2RzLmdldFVuaXF1ZW5lc3NIVE1MKGlucHV0KTtcbiAgICB9LFxuICAgIGdldFBvc3NpYmxlQW5zd2Vyc0hUTUw6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRQb3NzaWJsZUFuc3dlcnNIVE1MKGlucHV0KTtcbiAgICB9LFxuICAgIGdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBtZXRob2RzLmdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTChpbnB1dCk7XG4gICAgfSxcbiAgICBjcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAoaW5wdXQsIHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuY3JlYXRlSW5wdXRQcm9wZXJ0aWVzSFRNTChpbnB1dCwgdmlldyk7XG4gICAgfSxcbiAgICBnZXRKdW1wc0xpc3RIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuZ2V0SnVtcHNMaXN0SFRNTChpbnB1dCk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB0ZW1wbGF0ZTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIGNyZWF0ZUJhc2ljUHJvcGVydGllc0hUTUwgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBodG1sO1xuICAgIHZhciBwYXJ0aWFscyA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscztcbiAgICB2YXIgcXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbjtcbiAgICB2YXIgaXNfcmVxdWlyZWRfY2hlY2tlZCA9IChpbnB1dC5pc19yZXF1aXJlZCkgPyAnY2hlY2tlZCcgOiAnJztcbiAgICB2YXIgaXNfdGl0bGVfY2hlY2tlZCA9IChpbnB1dC5pc190aXRsZSkgPyAnY2hlY2tlZCcgOiAnJztcbiAgICB2YXIgaXNfYnJhbmNoX2VkaXRfZGlzYWJsZWQgPSAoaW5wdXQucXVlc3Rpb24gPT09ICcnKSA/ICdkaXNhYmxlZCcgOiAnJztcbiAgICB2YXIgaXNfZ3JvdXBfZWRpdF9kaXNhYmxlZCA9IChpbnB1dC5xdWVzdGlvbiA9PT0gJycpID8gJ2Rpc2FibGVkJyA6ICcnO1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgIHZhciBicmFuY2hfaW5wdXRzID0gW107XG5cbiAgICAvL3doZW4gZWRpdGluZyBhIGJyYW5jaCwgY2hlY2sgdGhlIHRpdGxlIGxpbWl0IGFnYWluc3QgdGhlIGlucHV0cyB3aXRoaW4gYSBicmFuY2ggKGV2ZW4gdGhlIGdyb3VwIGlucHV0cylcbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKS5icmFuY2g7XG4gICAgfVxuXG4gICAgLy9pZiB0aGUgaW5wdXQgaXMgTk9UIG1lZGlhIHR5cGUsIGdldCBiYXNpYyBwcm9wZXJ0aWVzXG4gICAgaWYgKGNvbnN0cy5TSU5HTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xIHx8IGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcblxuICAgICAgICAvL2lmIGlucHV0IGlzIGEgcmVhZG1lIHR5cGUsIGdldCByZWFkbWUgcHJvcGVydHlcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX3JlYWRtZV9wcm9wZXJ0aWVzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX3Byb3BlcnRpZXM7XG5cbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7cmVxdWlyZWQtZmxhZy1jaGVja2VkfX0nLCBpc19yZXF1aXJlZF9jaGVja2VkKTtcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7dGl0bGUtZmxhZy1jaGVja2VkfX0nLCBpc190aXRsZV9jaGVja2VkKTtcblxuICAgICAgICAgICAgLy9pZiAzIHRpdGxlcyBhcmUgYWxyZWFkeSBzZXQsIGRpc2FibGUgdGl0bGUgY2hlY2tib3ggYW5kIHNob3cgcHJvcGVyIG1lc3NhZ2VcbiAgICAgICAgICAgIC8vaWYgd2UgYXJlIGVkaXRpbmcgYSBicmFuY2gsIGNoZWNrIGJyYW5jaCBpbnB1dHMgZm9yIHRpdGxlc1xuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggPyB1dGlscy5pc01heFRpdGxlTGltaXRSZWFjaGVkKGJyYW5jaF9pbnB1dHMpIDogdXRpbHMuaXNNYXhUaXRsZUxpbWl0UmVhY2hlZChpbnB1dHMpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dC5pc190aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lzLXRpdGxlLWRpc2FibGVkfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpcy1jaGVja2JveC1kaXNhYmxlZH19L2csICdkaXNhYmxlZC1jaGVja2JveCcpO1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2NoZWNrYm94LXRpdGxlLWxhYmVsfX0nLCBjb25zdHMuTUFYX1RJVExFX0xJTUlUX1JFQUNIRUQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy10aXRsZS1kaXNhYmxlZH19JywgJycpO1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lzLWNoZWNrYm94LWRpc2FibGVkfX0vZywgJycpO1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2NoZWNrYm94LXRpdGxlLWxhYmVsfX0nLCBjb25zdHMuVVNFX0FOU1dFUl9BU19USVRMRSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy10aXRsZS1kaXNhYmxlZH19JywgJycpO1xuICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aXMtY2hlY2tib3gtZGlzYWJsZWR9fS9nLCAnJyk7XG4gICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tjaGVja2JveC10aXRsZS1sYWJlbH19JywgY29uc3RzLlVTRV9BTlNXRVJfQVNfVElUTEUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9pZiBpbnB1dCBpcyBhIG1lZGlhIHR5cGUsIGdldCBtZWRpYSBwcm9wZXJ0aWVzXG4gICAgaWYgKGNvbnN0cy5NRURJQV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcbiAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX21lZGlhX3Byb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgLy9pcyBhIGJyYW5jaD8gY2hlY2sgdGhlIGVkaXQgYnV0dG9uIHN0YXR1c1xuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX2JyYW5jaF9wcm9wZXJ0aWVzO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2JyYW5jaC1lZGl0LWRpc2FibGVkfX0nLCBpc19icmFuY2hfZWRpdF9kaXNhYmxlZCk7XG4gICAgfVxuXG4gICAgLy9pcyBhIGdyb3VwPyBjaGVjayB0aGUgZWRpdCBidXR0b24gc3RhdHVzXG4gICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgIGh0bWwgPSBwYXJ0aWFscy5iYXNpY19ncm91cF9wcm9wZXJ0aWVzO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2dyb3VwLWVkaXQtZGlzYWJsZWR9fScsIGlzX2dyb3VwX2VkaXRfZGlzYWJsZWQpO1xuICAgIH1cblxuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLXF1ZXN0aW9ufX0vZywgaW5wdXQucmVmICsgJy1xdWVzdGlvbicpO1xuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7YmFzaWMtaW5wdXQtcmVmfX0nLCAnYmFzaWMtJyArIGlucHV0LnJlZik7XG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpbnB1dC1xdWVzdGlvbi12YWx1ZX19JywgcXVlc3Rpb24pO1xuXG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUJhc2ljUHJvcGVydGllc0hUTUw7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBjcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX3ZpZXcpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgaHRtbCA9IHRoZV92aWV3O1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgcGFydGlhbHMgPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHM7XG4gICAgdmFyIGlzX21lZGlhX3R5cGUgPSBjb25zdHMuTUVESUFfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xO1xuICAgIHZhciBuYXZfdGFicyA9IHBhcnRpYWxzLm5hdnRhYnM7XG4gICAgdmFyIGFkdmFuY2VkX3RhYl9idG47XG4gICAgdmFyIGp1bXBfdGFiX2J1dHRvbjtcbiAgICB2YXIgcHJvcGVydGllcztcbiAgICB2YXIganVtcHNfaHRtbDtcbiAgICB2YXIganVtcF9saXN0X2h0bWw7XG5cbiAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lucHV0LXJlZn19JywgaW5wdXQucmVmKTtcbiAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2FkdmFuY2VkLWlucHV0LXJlZn19JywgJ2FkdmFuY2VkLScgKyBpbnB1dC5yZWYpO1xuXG4gICAgLy9nZXQgbmF2dGFicyBodG1sXG4gICAgbmF2X3RhYnMgPSBuYXZfdGFicy5yZXBsYWNlKCd7eyNiYXNpYy1pbnB1dC1yZWZ9fScsICcjYmFzaWMtJyArIGlucHV0LnJlZik7XG5cbiAgICAvL2ZvciBtZWRpYSBpbnB1dHMsIGJyYW5jaCBhbmQgZ3JvdXBzLCByZWFkbWUsIGdldCBkaXNhYmxlZCAnQWR2YW5jZWQgdGFiJyBidXR0b25cbiAgICBpZiAoaXNfbWVkaWFfdHlwZSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgIGFkdmFuY2VkX3RhYl9idG4gPSBzZWxmLmdldEFkdmFuY2VkVGFiQnRuSFRNTChpbnB1dC5yZWYsIGZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vZ2V0IGVuYWJsZSBhZHZhbmNlZCB0YWIgYnV0dG9uXG4gICAgICAgIGFkdmFuY2VkX3RhYl9idG4gPSBzZWxmLmdldEFkdmFuY2VkVGFiQnRuSFRNTChpbnB1dC5yZWYsIHRydWUpO1xuICAgIH1cblxuICAgIG5hdl90YWJzID0gbmF2X3RhYnMucmVwbGFjZSgne3thZHZhbmNlZC10YWItYnRufX0nLCBhZHZhbmNlZF90YWJfYnRuKTtcblxuICAgIC8vZm9yIGlucHV0cyBORVNURUQgd2l0aGluIGEgZ3JvdXAsIGRpc2FibGUganVtcHMgdGFiLCBhcyB3ZSBjYW5ub3QgaGF2ZSBqdW1wcyBpbiBncm91cHNcbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICBqdW1wX3RhYl9idXR0b24gPSBzZWxmLmdldEp1bXBUYWJCdG5IVE1MKGlucHV0LnJlZiwgZmFsc2UpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAganVtcF90YWJfYnV0dG9uID0gc2VsZi5nZXRKdW1wVGFiQnRuSFRNTChpbnB1dC5yZWYsIHRydWUpO1xuICAgIH1cblxuICAgIG5hdl90YWJzID0gbmF2X3RhYnMucmVwbGFjZSgne3tqdW1wcy10YWItYnRufX0nLCBqdW1wX3RhYl9idXR0b24pO1xuXG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tuYXYtdGFic319JywgbmF2X3RhYnMpO1xuXG4gICAgLy9nZXQgcHJvcGVydGllcyBodG1sXG4gICAgcHJvcGVydGllcyA9IHNlbGYuY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTChpbnB1dCk7XG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3twcm9wZXJ0aWVzfX0nLCBwcm9wZXJ0aWVzKTtcblxuICAgIC8vZ2V0IGp1bXBzIGh0bWxcbiAgICBqdW1wc19odG1sID0gcGFydGlhbHMuanVtcHNfd3JhcHBlcjtcbiAgICBqdW1wc19odG1sID0ganVtcHNfaHRtbC5yZXBsYWNlKCd7e2p1bXBzLWlucHV0LXJlZn19JywgJ2p1bXBzLScgKyBpbnB1dC5yZWYpO1xuXG4gICAgLy9idWlsZCBqdW1wIGxpc3QgaHRtbFxuICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vZ2V0IGxpc3Qgb2YganVtcHMgbWFya3VwXG4gICAgICAgIGp1bXBfbGlzdF9odG1sID0gc2VsZi5nZXRKdW1wc0xpc3RIVE1MKGlucHV0KTtcbiAgICAgICAganVtcHNfaHRtbCA9IGp1bXBzX2h0bWwucmVwbGFjZSgne3tuby1qdW1wc19tZXNzYWdlLWhpZGRlbn19JywgJ2hpZGRlbicpO1xuXG4gICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7anVtcHMtbGlzdH19JywganVtcF9saXN0X2h0bWwpO1xuXG4gICAgICAgIC8vaWYgd2UgcmVhY2hlZCB0aGUgbWF4IG51bWJlciBvZiBqdW1wcyBvciB0aGlzIGlucHV0IGRvZXMgbm90IGFsbG93IG11bHRpcGxlIGp1bXBzLCBkaXNhYmxlIGJ1dHRvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIC8vbXVsdGlwbGUgYW5zd2VyIGlucHV0LCBkaXNhYmxlIGFkZCBqdW1wIGlmIHRoZSBtYXhpbXVtIG51bWJlciBvZiBqdW1wcyBmb3IgdGhlIGlucHV0IGlzIHJlYWNoZWRcbiAgICAgICAgICAgIC8vIG9yIGV4Y2VlZGVkLCB0aGUgbGF0dGVyIGJlY2F1c2Ugd2UgaGFkIGEgYnVnLlxuICAgICAgICAgICAgaWYgKGlucHV0Lmp1bXBzLmxlbmd0aCA+PSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3NpbmdsZSBhbnN3ZXIgaW5wdXRcbiAgICAgICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9ubyBqdW1wcyBsaXN0IHRvIHJlbmRlclxuICAgICAgICBqdW1wc19odG1sID0ganVtcHNfaHRtbC5yZXBsYWNlKCd7e2p1bXBzLWxpc3R9fScsICcnKTtcbiAgICAgICAganVtcHNfaHRtbCA9IGp1bXBzX2h0bWwucmVwbGFjZSgne3thZGQtanVtcC1idG4tc3RhdGV9fScsICcnKTtcbiAgICAgICAganVtcHNfaHRtbCA9IGp1bXBzX2h0bWwucmVwbGFjZSgne3tuby1qdW1wc19tZXNzYWdlLWhpZGRlbn19JywgJycpO1xuICAgIH1cblxuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7anVtcHN9fScsIGp1bXBzX2h0bWwpO1xuXG4gICAgLy9kaXNhYmxlIFwiQWRkIEp1bXBcIiBidXR0b24gaWYgdGhlIG1heCBudW1iZXIgb2YganVtcHMgaXMgcmVhY2hlZFxuICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xKSB7XG4gICAgICAgIC8vbXVsdGlwbGUganVtcHMgYWxsb3dlZCwgY2hlY2sgaWYgbGltaXQgbWV0IChudW1iZXIgb2YganVtcHMgbXVzdCBiZSBsZXNzIG9yIGVxdWFsIHRvIHBvc3NpYmxlIGFuc3dlcnMpXG4gICAgICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPj0gaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnZGlzYWJsZWQ9XCJkaXNhYmxlZFwiJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2FkZC1qdW1wLWJ0bi1zdGF0ZX19JywgJycpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL3NpbmdsZSBqdW1wIGFsbG93ZWQsIGVuYWJsZSBhZGQganVtcCBidXR0b25cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3thZGQtanVtcC1idG4tc3RhdGV9fScsICcnKTtcbiAgICB9XG5cbiAgICAvL2lmIG11bHRpcGxlIGNob2ljZSBpbnB1dCB0eXBlLCBhcHBlbmQgcG9zc2libGUgYW5zd2VyIHdyYXBwZXJcbiAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpICE9PSAtMSkge1xuXG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7cG9zc2libGUtYW5zd2Vyc319Jywgc2VsZi5nZXRQb3NzaWJsZUFuc3dlcnNIVE1MKGlucHV0KSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e3Bvc3NpYmxlLWFuc3dlcnN9fScsICcnKTtcbiAgICB9XG5cbiAgICAvL2NoZWNrIGlmIGlucHV0IGFsbG93cyB1bmlxdWVuZXNzXG4gICAgaWYgKGNvbnN0cy5VTklRVUVORVNTX0FMTE9XRURfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3t1bmlxdWVuZXNzfX0nLCBzZWxmLmdldFVuaXF1ZW5lc3NIVE1MKGlucHV0KSk7XG4gICAgfVxuICAgIHJldHVybiBodG1sO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MO1xuXG5cbiIsIid1c2Ugc3RyaWN0JztcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcblxudmFyIGNyZWF0ZUlucHV0VG9vbEhUTUwgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBodG1sID0gJyc7XG4gICAgdmFyIGljb24gPSB1dGlscy5nZXRJbnB1dFRvb2xJY29uKGlucHV0LnR5cGUpO1xuICAgIHZhciBpc19pbnB1dF9icmFuY2ggPSAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSA/ICdpbnB1dC1icmFuY2gnIDogJyc7XG4gICAgdmFyIGlzX2lucHV0X2dyb3VwID0gKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSA/ICdpbnB1dC1ncm91cCcgOiAnJztcbiAgICB2YXIgcXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbiA9PT0gJycgPyBtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVCA6IGlucHV0LnF1ZXN0aW9uO1xuICAgIHZhciBpbnZpc2libGVfY2xhc3MgPSBpbnB1dC5qdW1wcy5sZW5ndGggPiAwID8gJycgOiAnaW52aXNpYmxlJztcblxuICAgIC8vY29udmVydCBodG1sIGVudGl0aWVzIHRvIHRhZ3MgYW5kIHN0cmlwIGh0bWwgdGFncyBmcm9tIHJlYWRtZSB0eXBlIGlmIGFueVxuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgcXVlc3Rpb24gPSBxdWVzdGlvbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcbiAgICAgICAgLy93cmFwIGluIFwiXCIgdG8gYXZvaWQgcmVuZGVyaW5nIG9mIDxici8+XG4gICAgICAgIHF1ZXN0aW9uID0gJ1wiJyArIHF1ZXN0aW9uICsgJ1wiJztcbiAgICB9XG5cbiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiaW5wdXQgJyArIGlzX2lucHV0X2JyYW5jaCArIGlzX2lucHV0X2dyb3VwICsgJyB1aS1kcmFnZ2FibGUgdWktZHJhZ2dhYmxlLWhhbmRsZVwiICc7XG4gICAgaHRtbCArPSAnZGF0YS10eXBlPVwiJyArIGlucHV0LnR5cGUgKyAnXCIgZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiPic7XG4gICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cImlucHV0LWlubmVyXCI+JztcbiAgICBodG1sICs9ICc8aSBjbGFzcz1cImZhIGZhLTJ4IGZhLWZ3ICcgKyBpY29uICsgJ1wiPjwvaT4nO1xuICAgIGh0bWwgKz0gJzxzcGFuIGNsYXNzPVwicXVlc3Rpb24tcHJldmlld1wiPicgKyBxdWVzdGlvbi50cnVuYyhjb25zdHMuTElNSVRTLnF1ZXN0aW9uX3ByZXZpZXdfbGVuZ3RoKSArICc8L3NwYW4+JztcbiAgICBodG1sICs9ICc8aSBjbGFzcz1cInF1ZXN0aW9uLXN0YXRlIGZhIGZhLWNoZWNrIGZhLTJ4IGZhLWZ3IHB1bGwtcmlnaHRcIj48L2k+JztcbiAgICBodG1sICs9ICc8aSBjbGFzcz1cImp1bXAtc3RhdGUgZmEgZmEtYXJyb3ctY2lyY2xlLW8tZG93biBmYS0yeCBmYS1mdyBwdWxsLXJpZ2h0ICcgKyBpbnZpc2libGVfY2xhc3MgKyAnXCI+PC9pPic7XG5cbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgIGh0bWwgKz0gJ3t7YnJhbmNoLWNvbnRlbnR9fSc7XG4gICAgfVxuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICBodG1sICs9ICd7e2dyb3VwLWNvbnRlbnR9fSc7XG4gICAgfVxuICAgIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgaHRtbCArPSAnPC9kaXY+JztcblxuICAgIHJldHVybiBodG1sO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVJbnB1dFRvb2xIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2V0QWR2YW5jZWRUYWJCdG5IVE1MID0gZnVuY3Rpb24gKHJlZiwgaXNfYWN0aXZlKSB7XG5cbiAgICB2YXIgaHRtbCA9ICcnO1xuXG4gICAgaWYgKGlzX2FjdGl2ZSkge1xuICAgICAgICBodG1sICs9ICc8bGkgcm9sZT1cInByZXNlbnRhdGlvblwiIGNsYXNzPVwibmF2LXRhYnNfX3RhYi1idG4taXRlbSBhZHZhbmNlZC10YWJcIj4nO1xuICAgICAgICBodG1sICs9ICc8YSBocmVmPVwiI2FkdmFuY2VkLScgKyByZWYgKyAnXCIgcm9sZT1cInRhYlwiIGRhdGEtdG9nZ2xlPVwidGFiXCI+IEFkdmFuY2VkJm5ic3A7JztcbiAgICAgICAgaHRtbCArPSAnPGkgY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvbiBmYS0yeCBpbnZpc2libGUgYWR2YW5jZWQtZXJyb3JcIj48L2k+JztcbiAgICAgICAgaHRtbCArPSAnPC9hPic7XG4gICAgICAgIGh0bWwgKz0gJzwvbGk+JztcbiAgICB9XG4gICAgZWxzZSB7XG5cbiAgICAgICAgaHRtbCArPSAnPGxpIHJvbGU9XCJwcmVzZW50YXRpb25cIiBjbGFzcz1cImRpc2FibGVkIGRpc2FibGVkLXRhYiBuYXYtdGFic19fdGFiLWJ0bi1pdGVtXCI+JztcbiAgICAgICAgaHRtbCArPSAnPGEgaHJlZj1cIiNcIiByb2xlPVwidGFiXCIgPiBBZHZhbmNlZCZuYnNwOyc7XG4gICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwiZmEgZmEtZXhjbGFtYXRpb24gZmEtMnggIGludmlzaWJsZSBhZHZhbmNlZC1lcnJvclwiPjwvaT4nO1xuICAgICAgICBodG1sICs9ICc8L2E+JztcbiAgICAgICAgaHRtbCArPSAnPC9saT4nO1xuICAgIH1cbiAgICByZXR1cm4gaHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0QWR2YW5jZWRUYWJCdG5IVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG52YXIgZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgLy90b2RvIHVzZSB0aGUgZnVuY3Rpb24gaGVyZSBodHRwOi8vanNmaWRkbGUubmV0L2pmcmllbmQwMC9EeUN3ay9cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciBpc19tZWRpYV90eXBlID0gY29uc3RzLk1FRElBX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpICE9PSAtMTtcbiAgICB2YXIgaHRtbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzW2lucHV0LnR5cGVdO1xuXG4gICAgLy9nZXQgZHluYW1pYyBodG1sIGZvciBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgaHRtbCA9IHNlbGYuY3JlYXRlSW5wdXRQcm9wZXJ0aWVzSFRNTChpbnB1dCwgaHRtbCk7XG5cbiAgICAvL3ByZXBhcmUgYWR2YW5jZWQgcHJvcGVydGllcyAoTk9UIGZvciBicmFuY2ggb3IgZ3JvdXBzIG9yIG1lZGlhIHR5cGVzKVxuICAgIGlmIChpbnB1dC50eXBlICE9PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSAhPT0gY29uc3RzLkdST1VQX1RZUEUgfHwgIWlzX21lZGlhX3R5cGUpIHtcbiAgICAgICAgLy9tYW5pcHVsYXRlIGRvbSBmb3IgYWR2YW5jZWQgb3B0aW9ucywgd2hpY2ggYXJlIHVuaXF1ZSAobW9zdCBvZiB0aGUgdGltZSkgdG8gdGhlIGlucHV0IHR5cGVcbiAgICAgICAgaHRtbCA9IHNlbGYucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTChodG1sLCBpbnB1dCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGh0bWw7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2V0SnVtcFRhYkJ0bkhUTUwgPSBmdW5jdGlvbiAocmVmLCBpc19hY3RpdmUpIHtcblxuICAgIHZhciBodG1sID0gJyc7XG5cbiAgICBpZiAoaXNfYWN0aXZlKSB7XG4gICAgICAgIGh0bWwgKz0gJzxsaSByb2xlPVwicHJlc2VudGF0aW9uXCIgY2xhc3M9XCJqdW1wLXRhYiBuYXYtdGFic19fdGFiLWJ0bi1pdGVtXCI+JztcbiAgICAgICAgaHRtbCArPSAnPGEgaHJlZj1cIiNqdW1wcy0nICsgcmVmICsgJ1wiIHJvbGU9XCJ0YWJcIiBkYXRhLXRvZ2dsZT1cInRhYlwiID4gSnVtcHMgKElGIC0gRUxTRSkmbmJzcDsnO1xuICAgICAgICBodG1sICs9ICc8aSBjbGFzcz1cImZhIGZhLWV4Y2xhbWF0aW9uIGZhLTJ4IGludmlzaWJsZSBqdW1wcy1lcnJvclwiPjwvaT4nO1xuICAgICAgICBodG1sICs9ICc8L2E+JztcbiAgICAgICAgaHRtbCArPSAnPC9saT4nO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaHRtbCArPSAnPGxpIHJvbGU9XCJwcmVzZW50YXRpb25cIiBjbGFzcz1cImp1bXAtdGFiIGRpc2FibGVkIGRpc2FibGVkLXRhYiBuYXYtdGFic19fdGFiLWJ0bi1pdGVtXCI+JztcbiAgICAgICAgaHRtbCArPSAnPGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5hdi10YWJzX19qdW1wXCIgcm9sZT1cInRhYlwiID4gSnVtcHMgKElGIC0gRUxTRSkmbmJzcDsnO1xuICAgICAgICBodG1sICs9ICc8aSBjbGFzcz1cImZhIGZhLWV4Y2xhbWF0aW9uIGZhLTJ4IGludmlzaWJsZSBqdW1wcy1lcnJvclwiPjwvaT4nO1xuICAgICAgICBodG1sICs9ICc8L2E+JztcbiAgICAgICAgaHRtbCArPSAnPC9saT4nO1xuICAgIH1cbiAgICByZXR1cm4gaHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0SnVtcFRhYkJ0bkhUTUw7XG4iLCIvKmpzaGludCBleHByOnRydWUgKi9cbid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxuZnVuY3Rpb24gX2dldFNlbGVjdGVkSnVtcEFuc3dlckhUTUwocG9zc2libGVfYW5zd2VyKSB7XG4gICAgcmV0dXJuICc8b3B0aW9uIHZhbHVlPVwiJyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmICsgJ1wiIHNlbGVjdGVkPVwic2VsZWN0ZWRcIj4nICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICc8L29wdGlvbj4nO1xufVxuXG5mdW5jdGlvbiBfZ2V0U2VsZWN0ZWRKdW1wQ29uZGl0aW9uSFRNTChqdW1wKSB7XG5cbiAgICB2YXIgdGV4dCA9ICcnO1xuXG4gICAgJChjb25zdHMuSlVNUF9DT05ESVRJT05TKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgY29uZGl0aW9uKSB7XG4gICAgICAgIGlmIChjb25kaXRpb24ua2V5ID09PSBqdW1wLndoZW4pIHtcbiAgICAgICAgICAgIHRleHQgPSBjb25kaXRpb24udGV4dDtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiAnPG9wdGlvbiB2YWx1ZT1cIicgKyBqdW1wLndoZW4gKyAnXCIgc2VsZWN0ZWQ9XCJzZWxlY3RlZFwiPicgKyB0ZXh0ICsgJzwvb3B0aW9uPic7XG59XG5cbmZ1bmN0aW9uIF9nZXRTZWxlY3RlZEp1bXBEZXN0aW5hdGlvbkhUTUwoZGVzdGluYXRpb25faW5wdXQpIHtcbiAgICByZXR1cm4gJzxvcHRpb24gdmFsdWU9XCInICsgZGVzdGluYXRpb25faW5wdXQucmVmICsgJ1wiIHNlbGVjdGVkPVwic2VsZWN0ZWRcIj4nICsgZGVzdGluYXRpb25faW5wdXQucXVlc3Rpb24gKyAnPC9vcHRpb24+Jztcbn1cblxudmFyIGdldEp1bXBzTGlzdEhUTUwgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBodG1sID0gJyc7XG4gICAgdmFyIGlucHV0cyA9IFtdO1xuICAgIHZhciBzZWxlY3RlZF9jb25kaXRpb25faHRtbDtcbiAgICB2YXIgc2VsZWN0ZWRfcG9zc2libGVfYW5zd2VyX2h0bWw7XG5cbiAgICAvL2dldCBpbnB1dCBsaXN0IChoaWVyYXJjaHkgb3IgYnJhbmNoKVxuICAgIHZhciBwYXJ0cyA9IGlucHV0LnJlZi5zcGxpdCgnXycpO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggPiAzKSB7XG4gICAgICAgIC8vdGhpcyBpcyBhIGJyYW5jaCByZWZcbiAgICAgICAgcGFydHMucG9wKCk7XG4gICAgICAgIGlucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYocGFydHMuam9pbignXycpKS5icmFuY2g7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgIH1cbiAgICAvL2p1bXAgZGVzdGluYXRpb25zOiBjYW5ub3QganVtcCBvbiB0aGUgbmV4dCBvbmUsIGJ1dCBhbHdheXMgbmV4dCArIDFcbiAgICB2YXIganVtcF9kZXN0aW5hdGlvbnMgPSB1dGlscy5nZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zKGlucHV0LCBpbnB1dHMpO1xuXG4gICAgJChpbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGp1bXApIHtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBzZXQgYHdoZW4gb3B0aW9uYFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vYXBwZW5kIGEganVtcCB3aXRoIGNvbmRpdGlvbiBkaXNhYmxlZCBhbmQgc2V0IHRvICdhbHdheXMnIGp1bXBcbiAgICAgICAgICAgIC8vd2UgZG8gdGhpcyBiZWNhdXNlIG9uIEVDNSB3aGVuIHRoZSBxdWVzdGlvbiBpcyBhbiBvcGVuIGFuc3dlciwgYSBqdW1wIHdpbGwgYWx3YXlzIGp1bXAgbm8gbWF0dGVyIHRoZSBhbnN3ZXIgZ2l2ZW5cbiAgICAgICAgICAgIGh0bWwgKz0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLmp1bXBfbGlzdF9pdGVtX2Fsd2F5c19qdW1wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9qdW1wcyBnZXQgZnVsbCBmdW5jdGlvbmFsaXR5IHdpdGggbXVsdGlwbGUgYW5zd2VycyBpbnB1dCB0eXBlc1xuICAgICAgICAgICAgaHRtbCArPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMuanVtcF9saXN0X2l0ZW07XG5cbiAgICAgICAgICAgIHNlbGVjdGVkX2NvbmRpdGlvbl9odG1sID0gX2dldFNlbGVjdGVkSnVtcENvbmRpdGlvbkhUTUwoanVtcCk7XG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2xvZ2ljLXdoZW4tc2F2ZWQtb3B0aW9ufX0nLCBzZWxlY3RlZF9jb25kaXRpb25faHRtbCk7XG5cbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiAgc2V0IHNlbGVjdGVkIGBhbnN3ZXJgXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICQoaW5wdXQucG9zc2libGVfYW5zd2VycykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZiA9PT0ganVtcC5hbnN3ZXJfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkX3Bvc3NpYmxlX2Fuc3dlcl9odG1sID0gX2dldFNlbGVjdGVkSnVtcEFuc3dlckhUTUwocG9zc2libGVfYW5zd2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7bG9naWMtYW5zd2VyLXNhdmVkLW9wdGlvbn19Jywgc2VsZWN0ZWRfcG9zc2libGVfYW5zd2VyX2h0bWwpO1xuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICB9XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqICBzZXQgc2VsZWN0ZWQgYGdvdG9gXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgc2VsZWN0ZWRfZ290b19odG1sID0gJyc7XG4gICAgICAgIGlmIChqdW1wLnRvID09PSAnRU5EJykge1xuICAgICAgICAgICAgc2VsZWN0ZWRfZ290b19odG1sID0gX2dldFNlbGVjdGVkSnVtcERlc3RpbmF0aW9uSFRNTCh7IHJlZjogJ0VORCcsIHF1ZXN0aW9uOiAnRW5kIG9mIGZvcm0nIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgJChqdW1wX2Rlc3RpbmF0aW9ucykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGp1bXBfZGVzdGluYXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoanVtcF9kZXN0aW5hdGlvbi5yZWYgPT09IGp1bXAudG8pIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfZ290b19odG1sID0gX2dldFNlbGVjdGVkSnVtcERlc3RpbmF0aW9uSFRNTChqdW1wX2Rlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tsb2dpYy1nb3RvLXNhdmVkLW9wdGlvbn19Jywgc2VsZWN0ZWRfZ290b19odG1sKTtcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1sb2dpYy13aGVufX0vZywgaW5kZXggKyAnLScgKyBpbnB1dC5yZWYgKyAnLWxvZ2ljLXdoZW4nKTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtbG9naWMtZ290b319L2csIGluZGV4ICsgJy0nICsgaW5wdXQucmVmICsgJy1sb2dpYy1nb3RvJyk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLWxvZ2ljLWFuc3dlcn19L2csIGluZGV4ICsgJy0nICsgaW5wdXQucmVmICsgJy1sb2dpYy1hbnN3ZXInKTtcblxuICAgIH0pO1xuXG5cbiAgICByZXR1cm4gaHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0SnVtcHNMaXN0SFRNTDtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0ID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9nZXRQb3NzaWJsZUFuc3dlcnNMaXN0Jyk7XG5cbi8vZ2VuZXJhdGUgbGlzdCBvZiBwb3NzaWJsZSBhbnN3ZXJzIGFuZCBpbmplY3QgaXQgaW50byBpdHMgd3JhcHBlciwgdGhlbiByZXR1cm4gaXRcbnZhciBnZXRQb3NzaWJsZUFuc3dlcnNIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciB3cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLnBvc3NpYmxlX2Fuc3dlcnNfd3JhcHBlcjtcbiAgICB2YXIgbGlzdCA9IGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QoaW5wdXQucG9zc2libGVfYW5zd2Vycyk7XG5cbiAgICB3cmFwcGVyID0gd3JhcHBlci5yZXBsYWNlKCd7e3Bvc3NpYmxlLWFuc3dlcnMtbGlzdH19JywgbGlzdCk7XG5cbiAgICAvL3RvZ2dsZSBcImFkZCBhbnN3ZXJzXCIgYnV0dG9uXG4gICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXgpIHtcbiAgICAgICAgLy9pcyBpdCBhIHNlYXJjaCB0eXBlPyBsaW1pdCBpcyBoaWdoZXIgZm9yIHNlYXJjaCB0eXBlXG4gICAgICAgIGlmKGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPj0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heF9zZWFyY2gpIHtcbiAgICAgICAgICAgICAgICB3cmFwcGVyID0gd3JhcHBlci5yZXBsYWNlKCd7e2Rpc2FibGVkfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdyYXBwZXIgPSB3cmFwcGVyLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdyYXBwZXIgPSB3cmFwcGVyLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsICdkaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB3cmFwcGVyID0gd3JhcHBlci5yZXBsYWNlKCd7e2Rpc2FibGVkfX0nLCAnJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHdyYXBwZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFBvc3NpYmxlQW5zd2Vyc0hUTUw7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbi8vZ2VuZXJhdGUgbGlzdCBvZiBwb3NzaWJsZSBhbnN3ZXJzIGFuZCByZXR1cm4gaHRtbFxudmFyIGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QgPSBmdW5jdGlvbiAocG9zc2libGVfYW5zd2Vycykge1xuXG4gICAgdmFyIGxpc3QgPSAnJztcbiAgICB2YXIgbGlzdF9pdGVtID0gJyc7XG5cbiAgICAvL2dlbmVyYXRlIG1hcmt1cCBmb3IgZmlyc3QgcG9zc2libGUgYW5zd2VycyBwYWdlXG4gICAgJChwb3NzaWJsZV9hbnN3ZXJzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxpc3RfaXRlbSA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscy5wb3NzaWJsZV9hbnN3ZXJfbGlzdF9pdGVtO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZik7XG4gICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlcn19JywgcG9zc2libGVfYW5zd2VyLmFuc3dlcik7XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSAwICYmIHBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3tkaXNhYmxlZH19JywgJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3tkaXNhYmxlZH19JywgJycpO1xuICAgICAgICB9XG4gICAgICAgIGxpc3QgKz0gbGlzdF9pdGVtO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGxpc3Q7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFBvc3NpYmxlQW5zd2Vyc0xpc3Q7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbi8vZ2VuZXJhdGUgbGlzdCBvZiBwb3NzaWJsZSBhbnN3ZXJzIGFuZCBpbmplY3QgaXQgaW50byBpdHMgd3JhcHBlciwgdGhlbiByZXR1cm4gaXRcbnZhciBnZXRQb3NzaWJsZUFuc3dlcnNQYWdlID0gZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX3BhZ2UpIHtcblxuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgY3VycmVudF9wYWdlID0gdGhlX3BhZ2U7XG4gICAgdmFyIGxpc3RfaXRlbSA9ICcnO1xuICAgIHZhciBsaXN0ID0gJyc7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX3dyYXBwZXIgPSBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0Jyk7XG4gICAgdmFyIGZyb21faW5kZXggPSAoY3VycmVudF9wYWdlIC0gMSkgKiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2U7XG4gICAgdmFyIHRvX2luZGV4ID0gY3VycmVudF9wYWdlICogY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlO1xuXG4gICAgLy9yZW1vdmUgcG9zc2libGUgYXN3ZXJzIGZyb20gZG9tXG4gICAgcG9zc2libGVfYW5zd2Vyc193cmFwcGVyLmZpbmQoJ2xpJykucmVtb3ZlKCk7XG5cbiAgICAvL2dldCBuZXh0IHBvc3NpYmxlIGFuc3dlcnNcbiAgICB2YXIgcG9zc2libGVfYW5zd2VycyA9ICBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLnNsaWNlKGZyb21faW5kZXgsIHRvX2luZGV4KTtcblxuICAgICQocG9zc2libGVfYW5zd2VycykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgIC8vcmVwbGFjZSBkb3VibGUgcXVvdGVzIHdpdGggaHRtbCBlbnRpdGllc1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlci5yZXBsYWNlKC9cIi9naSwgJyZxdW90OycpO1xuXG4gICAgICAgIGxpc3RfaXRlbSA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscy5wb3NzaWJsZV9hbnN3ZXJfbGlzdF9pdGVtO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZik7XG4gICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlcn19JywgcG9zc2libGVfYW5zd2VyLmFuc3dlcik7XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSAwICYmIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3tkaXNhYmxlZH19JywgJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3tkaXNhYmxlZH19JywgJycpO1xuICAgICAgICB9XG4gICAgICAgIGxpc3QgKz0gbGlzdF9pdGVtO1xuXG4gICAgICAgIC8vaWYgdGhlIHBvc3NpYmxlIGFuc3dlciBpcyBpbnZhbGlkLCBhZGQgZXJyb3IgaW4gdGhlIGRvbVxuICAgICAgICBpZihwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyID09PSAnJykge1xuICAgICAgICAgICAgLy90b2RvXG5cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy9hcHBlbmQgbmV3IHBhZ2UgdG8gZG9tXG4gICAgcG9zc2libGVfYW5zd2Vyc193cmFwcGVyLmhpZGUoKS5odG1sKGxpc3QpLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRQb3NzaWJsZUFuc3dlcnNQYWdlO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xuXG52YXIgZ2V0VW5pcXVlbmVzc0hUTUwgPSBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG5cbiAgICB2YXIgaHRtbCA9ICcnO1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICB2YXIgY3VycmVudF9mb3JtX25hbWUgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLm5hbWU7XG4gICAgdmFyIHBhcnRpYWxzID0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzO1xuICAgIHZhciBwYXJlbnRfZm9ybV9uYW1lO1xuICAgIHZhciBpc191bmlxdWVuZXNzX2Zvcm1fY2hlY2tlZDtcbiAgICB2YXIgaXNfdW5pcXVlbmVzc19oaWVyYXJjaHlfY2hlY2tlZDtcblxuICAgIGZ1bmN0aW9uIGdldFN0YW5kYXJkVW5pcXVlc3NNYXJrdXAobWFya3VwKSB7XG5cbiAgICAgICAgbWFya3VwID0gcGFydGlhbHMudW5pcXVlbmVzc19oaWVyYXJjaHlfY2hlY2tib3hlcztcbiAgICAgICAgcGFyZW50X2Zvcm1fbmFtZSA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleCAtIDFdLm5hbWU7XG4gICAgICAgIG1hcmt1cCA9IG1hcmt1cC5yZXBsYWNlKC97e3BhcmVudC1mb3JtLW5hbWV9fS9nLCBwYXJlbnRfZm9ybV9uYW1lKTtcbiAgICAgICAgbWFya3VwID0gbWFya3VwLnJlcGxhY2UoJ3t7aW5wdXQtcmVmLXVuaXF1ZW5lc3MtaGllcmFyY2h5fX0nLCBpbnB1dC5yZWYgKyAnLXVuaXF1ZW5lc3MtaGllcmFyY2h5Jyk7XG5cbiAgICAgICAgaXNfdW5pcXVlbmVzc19oaWVyYXJjaHlfY2hlY2tlZCA9IChpbnB1dC51bmlxdWVuZXNzID09PSBjb25zdHMuVU5JUVVFU1NfSElFUkFSQ0hZKSA/ICdjaGVja2VkJyA6ICcnO1xuICAgICAgICBtYXJrdXAgPSBtYXJrdXAucmVwbGFjZSgne3tpbnB1dC1yZWYtdW5pcXVlbmVzcy1oaWVyYXJjaHktY2hlY2tlZH19JywgaXNfdW5pcXVlbmVzc19oaWVyYXJjaHlfY2hlY2tlZCk7XG5cbiAgICAgICAgcmV0dXJuIG1hcmt1cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRCcmFuY2hVbmlxdWVuZXNzTWFya3VwKG1hcmt1cCkge1xuICAgICAgICAvL2JyYW5jaCB1bmlxdWVzcyBpcyB3aXRoaW4gZm9yIGFsbCB0aGUgJ3ticmFuY2ggaGVhZGVyfScgZW50cmllcyBmb3IgYSBicmFuY2ggcXVlc3Rpb24gd2l0aGluIGEgc2luZ2xlIGVudHJ5ICgnZm9ybScpXG4gICAgICAgIG1hcmt1cCA9IHBhcnRpYWxzLnVuaXF1ZW5lc3NfYnJhbmNoX2NoZWNrYm94O1xuICAgICAgICBtYXJrdXAgPSBtYXJrdXAucmVwbGFjZSgne3ticmFuY2gtaGVhZGVyfX0nLCBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9oZWFkZXIpO1xuXG4gICAgICAgIHJldHVybiBtYXJrdXA7XG4gICAgfVxuXG4gICAgLy9hZGQgdW5pcXVlbmVzcyBjb25zdHJhaW50IGJhc2VkIG9uIGZvcm0gaGllcmFyY2h5XG4gICAgaWYgKGZvcm1faW5kZXggPiAwKSB7XG4gICAgICAgIC8vY2hpbGQgZm9ybXMsIHVzZXIgY24gc2VsZWN0IGZvcm0gb3IgaGllcmFyY2h5IHVuaXF1ZW5lc3NcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAvL2lmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvLyAgICAvL25lc3RlZCBncm91cCBnZXRzIHN0YW5kYXJkIHVuaXF1ZW5lc3NcbiAgICAgICAgICAgIC8vICAgIGh0bWwgPSBnZXRTdGFuZGFyZFVuaXF1ZXNzTWFya3VwKGh0bWwpO1xuICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAvLyAgZWxzZSB7XG4gICAgICAgICAgICAvL2JyYW5jaGVzIGdldCBpdHMgb3duIHVuaXF1ZW5lc3NcbiAgICAgICAgICAgIGh0bWwgPSBnZXRCcmFuY2hVbmlxdWVuZXNzTWFya3VwKGh0bWwpO1xuICAgICAgICAgICAgLy8gIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vc3RhbmRhcmQgdW5pcXVlbmVzc1xuICAgICAgICAgICAgaHRtbCA9IGdldFN0YW5kYXJkVW5pcXVlc3NNYXJrdXAoaHRtbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBlbHNlIHtcbiAgICAgICAgLy9zdGFuZGFyZCB1bmlxdWVuZXNzLCB0b3AgcGFyZW50IGZvcm0gaW5wdXRzY2FuIGJlIHNldCB0byBmb3JtIHVuaXF1ZW5lc3Mgb25seVxuICAgICAgICBpZiAoIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICBodG1sID0gcGFydGlhbHMudW5pcXVlbmVzc19mb3JtX2NoZWNrYm94O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9icmFuY2hlcyBnZXQgaXRzIG93biB1bmlxdWVuZXNzXG4gICAgICAgICAgICAvL2lmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvLyAgICAvL2dyb3VwIGdldHMgc3RhbmRhcmQgdW5pcXVlbmVzc1xuICAgICAgICAgICAgLy8gICAgaHRtbCA9IHBhcnRpYWxzLnVuaXF1ZW5lc3NfZm9ybV9jaGVja2JveDtcbiAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgLy9lbHNlIHtcbiAgICAgICAgICAgIC8vYnJhbmNoIHVuaXF1ZXNzIGlzIHdpdGhpbiBmb3IgYWxsIHRoZSBicmFuY2hlcyB3aXRoaW4gYSBzaW5nbGUgZW50cnkgKCdmb3JtJylcbiAgICAgICAgICAgIGh0bWwgPSBnZXRCcmFuY2hVbmlxdWVuZXNzTWFya3VwKGh0bWwpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9jb21tb24gbWFya3VwXG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpbnB1dC1yZWYtdW5pcXVlbmVzcy1mb3JtfX0nLCBpbnB1dC5yZWYgKyAnLXVuaXF1ZW5lc3MtZm9ybScpO1xuICAgIGlzX3VuaXF1ZW5lc3NfZm9ybV9jaGVja2VkID0gKGlucHV0LnVuaXF1ZW5lc3MgPT09IGNvbnN0cy5VTklRVUVTU19GT1JNKSA/ICdjaGVja2VkJyA6ICcnO1xuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7aW5wdXQtcmVmLXVuaXF1ZW5lc3MtZm9ybS1jaGVja2VkfX0nLCBpc191bmlxdWVuZXNzX2Zvcm1fY2hlY2tlZCk7XG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tmb3JtLW5hbWV9fS9nLCBjdXJyZW50X2Zvcm1fbmFtZSk7XG5cbiAgICByZXR1cm4gaHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0VW5pcXVlbmVzc0hUTUw7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgcHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCA9IGZ1bmN0aW9uICh2aWV3LCBpbnB1dCkge1xuXG4gICAgdmFyIGh0bWwgPSB2aWV3O1xuICAgIHZhciByZWYgPSBpbnB1dC5yZWY7XG4gICAgdmFyIHR5cGUgPSBpbnB1dC50eXBlO1xuICAgIHZhciBkYXRldGltZV9mb3JtYXQgPSB7XG4gICAgICAgIGlzX2NoZWNrZWRfZGF0ZXRpbWVfZm9ybWF0XzE6ICcnLC8vc2V0IGZpcnN0IGZvcm1hdCBhcyBkZWZhdWx0XG4gICAgICAgIGlzX2NoZWNrZWRfZGF0ZXRpbWVfZm9ybWF0XzI6ICcnLFxuICAgICAgICBpc19jaGVja2VkX2RhdGV0aW1lX2Zvcm1hdF8zOiAnJyxcbiAgICAgICAgaXNfY2hlY2tlZF9kYXRldGltZV9mb3JtYXRfNDogJycsXG4gICAgICAgIGlzX2NoZWNrZWRfZGF0ZXRpbWVfZm9ybWF0XzU6ICcnXG4gICAgfTtcblxuICAgIHZhciBpc19pbnRlZ2VyX2NoZWNrZWQ7XG4gICAgdmFyIGlzX2RlY2ltYWxfY2hlY2tlZDtcbiAgICB2YXIgaXNfc2VhcmNoX3NpbmdsZV9jaGVja2VkO1xuICAgIHZhciBpc19zZWFyY2hfbXVsdGlwbGVfY2hlY2tlZDtcblxuICAgIGZ1bmN0aW9uIF9yZXBsYWNlRGF0ZXRpbWVBZHZhbmNlZFByb3BlcnRpZXModHlwZSkge1xuXG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgaUxlbmd0aCA9IDY7XG5cbiAgICAgICAgLy9pZiBpdCBpcyBhIG5ldyBpbnB1dCwgc2V0IGRhdGF0aW1lIGZvcm1hdCB0byBkZWZhdWx0XG4gICAgICAgIGlmIChpbnB1dC5kYXRldGltZV9mb3JtYXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuVElNRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgLy9mb3IgdGltZSBxdWVzdGlvbnMsIGRlZmF1bHQgdG8gSEg6bW0gdG8gZ2V0IGJlc3QgVUkgb24gZGV2aWNlXG4gICAgICAgICAgICAgICAgaW5wdXQuZGF0ZXRpbWVfZm9ybWF0ID0gY29uc3RzW3R5cGUudG9VcHBlckNhc2UoKSArICdfRk9STUFUXzMnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0LmRhdGV0aW1lX2Zvcm1hdCA9IGNvbnN0c1t0eXBlLnRvVXBwZXJDYXNlKCkgKyAnX0ZPUk1BVF8xJ107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL3NldCBkYXRldGltZSBmb3JtYXQgdG8gdGhlIG9uZSBzYXZlZFxuICAgICAgICBmb3IgKGkgPSAxOyBpIDwgaUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkYXRldGltZV9mb3JtYXRbJ2lzX2NoZWNrZWRfZGF0ZXRpbWVfZm9ybWF0XycgKyBpXSA9IGlucHV0LmRhdGV0aW1lX2Zvcm1hdCA9PT0gY29uc3RzW3R5cGUudG9VcHBlckNhc2UoKSArICdfRk9STUFUXycgKyBpXSA/ICdjaGVja2VkJyA6ICcnO1xuICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy1jaGVja2VkLWRhdGV0aW1lLWZvcm1hdC0nICsgaSArICd9fScsIGRhdGV0aW1lX2Zvcm1hdFsnaXNfY2hlY2tlZF9kYXRldGltZV9mb3JtYXRfJyArIGldKTtcbiAgICAgICAgfVxuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lucHV0LXJlZi1kZWZhdWx0LXRvLWN1cnJlbnR9fScsIHJlZiArICctZGVmYXVsdC10by1jdXJyZW50Jyk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7c2V0LXRvLWN1cnJlbnQtZGF0ZXRpbWV9fScsIHNldF90b19jdXJyZW50X2RhdGV0aW1lKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfcmVwbGFjZU51bWVyaWNBZHZhbmNlZFByb3BlcnRpZXModHlwZSkge1xuXG4gICAgICAgIGlzX2ludGVnZXJfY2hlY2tlZCA9ICdjaGVja2VkJztcbiAgICAgICAgaXNfZGVjaW1hbF9jaGVja2VkID0gJyc7XG5cbiAgICAgICAgaWYgKHR5cGUgPT09IGNvbnN0cy5ERUNJTUFMX1RZUEUpIHtcbiAgICAgICAgICAgIGlzX2ludGVnZXJfY2hlY2tlZCA9ICcnO1xuICAgICAgICAgICAgaXNfZGVjaW1hbF9jaGVja2VkID0gJ2NoZWNrZWQnO1xuICAgICAgICB9XG5cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy1pbnRlZ2VyLWNoZWNrZWR9fScsIGlzX2ludGVnZXJfY2hlY2tlZCk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7aXMtZGVjaW1hbC1jaGVja2VkfX0nLCBpc19kZWNpbWFsX2NoZWNrZWQpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lucHV0LXJlZi1taW4tdmFsdWV9fScsIGlucHV0Lm1pbik7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7aW5wdXQtcmVmLW1heC12YWx1ZX19JywgaW5wdXQubWF4KTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtaW50ZWdlcn19L2csIHJlZiArICctaW50ZWdlcicpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1kZWNpbWFsfX0vZywgcmVmICsgJy1kZWNpbWFsJyk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLW1pbn19L2csIHJlZiArICctbWluJyk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLW1heH19L2csIHJlZiArICctbWF4Jyk7XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfcmVwbGFjZVNlYXJjaEFkdmFuY2VkUHJvcGVydGllcyh0eXBlKSB7XG5cbiAgICAgICAgaXNfc2VhcmNoX3NpbmdsZV9jaGVja2VkID0gJ2NoZWNrZWQnO1xuICAgICAgICBpc19zZWFyY2hfbXVsdGlwbGVfY2hlY2tlZCA9ICcnO1xuXG4gICAgICAgIGlmICh0eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcbiAgICAgICAgICAgIGlzX3NlYXJjaF9zaW5nbGVfY2hlY2tlZCA9ICcnO1xuICAgICAgICAgICAgaXNfc2VhcmNoX211bHRpcGxlX2NoZWNrZWQgPSAnY2hlY2tlZCc7XG4gICAgICAgIH1cblxuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lzLXNlYXJjaHNpbmdsZS1jaGVja2VkfX0nLCBpc19zZWFyY2hfc2luZ2xlX2NoZWNrZWQpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lzLXNlYXJjaG11bHRpcGxlLWNoZWNrZWR9fScsIGlzX3NlYXJjaF9tdWx0aXBsZV9jaGVja2VkKTtcblxuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2dldEluaXRpYWxBbnN3ZXJIVE1MKGlucHV0LCB0aGVfaHRtbCkge1xuXG4gICAgICAgIHZhciBodG1sID0gdGhlX2h0bWw7XG4gICAgICAgIHZhciBhbnN3ZXJfbGFiZWwgPSAnJztcblxuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1kZWZhdWx0fX0vZywgaW5wdXQucmVmICsgJy1kZWZhdWx0Jyk7XG5cbiAgICAgICAgaWYgKGlucHV0LmRlZmF1bHQgPT09ICcnIHx8IGlucHV0LmRlZmF1bHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIC8vbm8sIHNldCAnbm9uZSdcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7c2VsZWN0ZWR9fS9nLCAnc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5pdGlhbC1hbnN3ZXJ9fS9nLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IHBvc3NpYmxlIGFuc3dlciBsYWJlbFxuICAgICAgICAgICAgYW5zd2VyX2xhYmVsID0gdXRpbHMuZ2V0UG9zc2libGVBbnN3ZXJMYWJlbChpbnB1dCk7XG5cbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7c2VsZWN0ZWR9fS9nLCAnJyk7XG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2luaXRpYWwtYW5zd2VyfX0vZywgJzxvcHRpb24gdmFsdWU9XCInICsgaW5wdXQuZGVmYXVsdCArICdcIiAgc2VsZWN0ZWQgPicgKyBhbnN3ZXJfbGFiZWwgKyAnPC9vcHRpb24+Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfVxuXG4gICAgdmFyIHNldF90b19jdXJyZW50X2RhdGV0aW1lID0gKGlucHV0LnNldF90b19jdXJyZW50X2RhdGV0aW1lKSA/ICdjaGVja2VkJyA6ICcnO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG5cbiAgICAgICAgY2FzZSBjb25zdHMuRFJPUERPV05fVFlQRTpcbiAgICAgICAgICAgIC8vc2V0IGluaXRpYWwgYW5zd2VyXG4gICAgICAgICAgICBodG1sID0gX2dldEluaXRpYWxBbnN3ZXJIVE1MKGlucHV0LCBodG1sKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIGNvbnN0cy5SQURJT19UWVBFOlxuICAgICAgICAgICAgLy9zZXQgaW5pdGlhbCBhbnN3ZXJcbiAgICAgICAgICAgIGh0bWwgPSBfZ2V0SW5pdGlhbEFuc3dlckhUTUwoaW5wdXQsIGh0bWwpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgY29uc3RzLkNIRUNLQk9YX1RZUEU6XG4gICAgICAgICAgICAvL3NldCBpbml0aWFsIGFuc3dlclxuICAgICAgICAgICAgaHRtbCA9IF9nZXRJbml0aWFsQW5zd2VySFRNTChpbnB1dCwgaHRtbCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBjb25zdHMuSU5URUdFUl9UWVBFOlxuICAgICAgICAgICAgaHRtbCA9IHRoaXMucmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllcyhodG1sLCBpbnB1dCk7XG4gICAgICAgICAgICBfcmVwbGFjZU51bWVyaWNBZHZhbmNlZFByb3BlcnRpZXModHlwZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBjb25zdHMuREVDSU1BTF9UWVBFOlxuICAgICAgICAgICAgaHRtbCA9IHRoaXMucmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllcyhodG1sLCBpbnB1dCk7XG4gICAgICAgICAgICBfcmVwbGFjZU51bWVyaWNBZHZhbmNlZFByb3BlcnRpZXModHlwZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBjb25zdHMuREFURV9UWVBFOlxuICAgICAgICAgICAgX3JlcGxhY2VEYXRldGltZUFkdmFuY2VkUHJvcGVydGllcyhjb25zdHMuREFURV9UWVBFKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIGNvbnN0cy5USU1FX1RZUEU6XG4gICAgICAgICAgICBfcmVwbGFjZURhdGV0aW1lQWR2YW5jZWRQcm9wZXJ0aWVzKGNvbnN0cy5USU1FX1RZUEUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRTpcbiAgICAgICAgICAgIF9yZXBsYWNlU2VhcmNoQWR2YW5jZWRQcm9wZXJ0aWVzKGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUpO1xuICAgICAgICAgICAgLy9zZXQgaW5pdGlhbCBhbnN3ZXJcbiAgICAgICAgICAgIGh0bWwgPSBfZ2V0SW5pdGlhbEFuc3dlckhUTUwoaW5wdXQsIGh0bWwpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFOlxuICAgICAgICAgICAgX3JlcGxhY2VTZWFyY2hBZHZhbmNlZFByb3BlcnRpZXMoY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKTtcbiAgICAgICAgICAgIC8vc2V0IGluaXRpYWwgYW5zd2VyXG4gICAgICAgICAgICBodG1sID0gX2dldEluaXRpYWxBbnN3ZXJIVE1MKGlucHV0LCBodG1sKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgaHRtbCA9IHRoaXMucmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllcyhodG1sLCBpbnB1dCk7XG5cbiAgICB9XG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllc0hUTUw7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciByZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKHRoZV9tYXJrdXAsIHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIGh0bWwgPSB0aGVfbWFya3VwO1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcblxuICAgIHZhciByZXBsYWNlbWVudHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvX2JlX3JlcGxhY2VkOiAve3tpbnB1dC1yZWYtZGVmYXVsdH19L2csXG4gICAgICAgICAgICB3aXRoX3RoaXM6IGlucHV0LnJlZiArICctZGVmYXVsdCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgdG9fYmVfcmVwbGFjZWQ6IC97e2lucHV0LXJlZi1yZWdleH19L2csXG4gICAgICAgICAgICB3aXRoX3RoaXM6IGlucHV0LnJlZiArICctcmVnZXgnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvX2JlX3JlcGxhY2VkOiAve3tpbnB1dC1yZWYtZG91YmxlLWVudHJ5fX0vZyxcbiAgICAgICAgICAgIHdpdGhfdGhpczogaW5wdXQucmVmICsgJy1kb3VibGUtZW50cnknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvX2JlX3JlcGxhY2VkOiAne3tpbnB1dC1yZWYtZGVmYXVsdC12YWx1ZX19JyxcbiAgICAgICAgICAgIHdpdGhfdGhpczogKGlucHV0LmRlZmF1bHQgPT09IG51bGwpID8gJycgOiBpbnB1dC5kZWZhdWx0XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvX2JlX3JlcGxhY2VkOiAne3tpbnB1dC1yZWYtcmVnZXgtdmFsdWV9fScsXG4gICAgICAgICAgICB3aXRoX3RoaXM6IChpbnB1dC5yZWdleCA9PT0gbnVsbCkgPyAnJyA6IGlucHV0LnJlZ2V4XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvX2JlX3JlcGxhY2VkOiAne3tpbnB1dC1yZWYtZG91YmxlLWVudHJ5LWNoZWNrZWR9fScsXG4gICAgICAgICAgICB3aXRoX3RoaXM6IGlucHV0LnZlcmlmeSA/ICdjaGVja2VkJyA6ICcnXG4gICAgICAgIH1cbiAgICBdO1xuXG4gICAgLy9yZXBsYWNlIHBsYWNlaG9sZGVyIHdpdGggdmFsdWVzIGZyb20gaW5wdXRcbiAgICAkKHJlcGxhY2VtZW50cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UocmVwbGFjZW1lbnQudG9fYmVfcmVwbGFjZWQsIHJlcGxhY2VtZW50LndpdGhfdGhpcyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllcztcblxuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciB0b2FzdCA9IHJlcXVpcmUoJ2NvbmZpZy90b2FzdCcpO1xudmFyIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZScpO1xuXG52YXIgYnJhbmNoX3NvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGJyYW5jaF9pbnB1dDtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGN1cnNvcjogJ21vdmUnLFxuICAgICAgICBpdGVtczogJy5pbnB1dCcsXG4gICAgICAgIHJldmVydDogMTAwLFxuICAgICAgICAvL2F4aXM6ICd5JywvLyBpdCBjYXVzZXMgdGhlIHBsYWNlaG9sZGVyIHRvIGJlIGFsd2F5cyBhY3RpdmVcbiAgICAgICAgY29udGFpbm1lbnQ6ICdwYXJlbnQnLFxuICAgICAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcbiAgICAgICAgLy8gZm9yY2VQbGFjZWhvbGRlclNpemU6IHRydWUsXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnaW5wdXQtY29sbGVjdGlvbi1kcm9wLXBsYWNlaG9sZGVyJyxcblxuICAgICAgICAvL3RyaWdnZXJlZCB3aGVuIGEgbmV3IGlucHV0IGlzIGRyb3BwZWQgb3ZlciB0aGUgc29ydGFibGVcbiAgICAgICAgcmVjZWl2ZTogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgIHZhciBwcmV2aW91c19icmFuY2hfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRfZWxlbWVudDtcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRzID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZikuYnJhbmNoO1xuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9yZWYgPSB1dGlscy5nZW5lcmF0ZUJyYW5jaEdyb3VwSW5wdXRSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9pbmRleCA9IGJyYW5jaF9pbnB1dHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF90eXBlID0ganF1ZXJ5X3VpLml0ZW0uYXR0cignZGF0YS10eXBlJyk7XG4gICAgICAgICAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuXG4gICAgICAgICAgICAvL2RvIG5vdCBjb25zaWRlciBicmFuY2ggaW5wdXRzIHdpdGhpbiBhIGJyYW5jaFxuICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dF90eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZiA9IGJyYW5jaF9pbnB1dF9yZWY7XG5cbiAgICAgICAgICAgICAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnkpIHRvIHNob3cgZW1iZWRkZWQgZXJyb3JzIChpbiBjYXNlIHRoZSBzZXIgZGlkIG5vdCBwcmVzcyB2YWxpZGF0ZSBidXR0b24pXG4gICAgICAgICAgICAgICAgLy90b2RvIGlzIHRoaXMgYW4gb3ZlcmtpbGw/XG4gICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzX2JyYW5jaF9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbih1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKHByZXZpb3VzX2JyYW5jaF9pbnB1dF9yZWYpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKCdicmFuY2ggc29ydGFibGUgcmVjZWl2ZScpO1xuXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvL2dlbmVyYXRlIGlucHV0IG9iamVjdCBiYXNlZCBvbiB0eXBlIGFuZCBzZXQgaW5kZXggaW5jcmVtZW50YWxseVxuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXQoYnJhbmNoX2lucHV0X3R5cGUsIGJyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgICAgIC8vZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBpbnB1dC5yZWY7XG4gICAgICAgICAgICAgICAgLy8gICBjb25zb2xlLmxvZyhicmFuY2hfaW5wdXQpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIGN1cnJlbnQgYWN0aXZlIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBjdXJyZW50X2VsZW1lbnQgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZScpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbWVudC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAvL2FkZCBpbnB1dCB0byBjb2xsZWN0aW9uIGFzIHRoZSBsYXN0IG9uZVxuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dHMucHVzaChicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYnJhbmNoX2lucHV0cyk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGFzIGJ5IGRlZmF1bHQgYW4gaW5wdXQgaXMgaW52YWxpZCB3aGVuIGl0IGlzIGNyZWF0ZWRcbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcblxuICAgICAgICAgICAgLy9zZXQgZm9ybSB0YWIgYXMgaW52YWxpZCwgYXMgdGhlIG5ldyBpbnB1dCB3aWxsIGJlIGludmFsaWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICB2YXIgb3duZXJfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICB2YXIgb3duZXJfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKG93bmVyX2lucHV0X3JlZik7XG4gICAgICAgICAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgICAgICB2YXIgYnJhbmNoX2lucHV0cyA9IGlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uYnJhbmNoO1xuICAgICAgICAgICAgdmFyIHBsYWNlaG9sZGVyX3RleHQgPSBtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVDtcbiAgICAgICAgICAgIHZhciBpbnB1dF90eXBlID0ganF1ZXJ5X3VpLml0ZW0uYXR0cignZGF0YS10eXBlJyk7XG4gICAgICAgICAgICB2YXIgYWN0aXZlX2JyYW5jaDtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsX2h0bWw7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBkcmFnZ2FibGUgaWYgd2UgaGl0IHRoZSBtYXggYW1vdW50IG9mIGlucHV0cyBhbGxvd2VkXG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0SW5wdXRzVG90YWwoaW5wdXRzKSA+PSBjb25zdHMuSU5QVVRTX01BWF9BTExPV0VEKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuZGlzYWJsZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3JlamVjdCBicmFuY2ggaW5wdXRzIGhlcmVcbiAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgIC8vaWYgYnJhbmNoIGlucHV0cyBsZW5ndGggaXMgemVybywgc2hvdyBoZWxwIHRleHQgcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAvL3RvZG9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgLy9jb3VudCBzZWFyY2ggaW5wdXRzXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgJiYgIWZvcm1idWlsZGVyLmJyYW5jaC5jb2xsZWN0aW9uX2lzX2JlaW5nX3NvcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBsaW1pdCBpcyByZWFjaGVkLCBoaWRlIHNlYXJjaCBmcm9tIGlucHV0IHRvb2xzXG4gICAgICAgICAgICAgICAgICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpID49IGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCBsaW1pdCByZWFjaGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2hvdyB3YXJuaW5nIHRvIHVzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0LnNob3dXYXJuaW5nKG1lc3NhZ2VzLndhcm5pbmcuU0VBUkNIX0lOUFVUU19MSU1JVF9SRUFDSEVEICsgJygnICsgY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCArICcpJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyAgICBjb25zb2xlLmxvZygnc29ydGFibGUgc3RvcCcpO1xuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLnJlbW92ZUF0dHIoJ3N0eWxlJyk7IC8vIHVuZG8gc3R5bGluZyBzZXQgYnkganF1ZXJ5VUkgKGh0dHA6Ly9nb28uZ2wvRUt6OHRDKVxuXG4gICAgICAgICAgICAgICAgLy9nZXQgdGhlIGluZGV4IHdoZXJlIHRoZSBpbnB1dCB3YXMgZHJvcHBlZCAoc2tpcCB3aGVuIGxpc3QgaXMgZW1wdHkpXG4gICAgICAgICAgICAgICAgLy9uYiB0aGUgLTIgaXMgdG8gcmVtb3ZlIHRoZSBlbGVtZW50IHdoaWNoIGFyZSBubyBpbnB1dCAod2FybmluZyBtZXNzYWdlcylcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2gudG9faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgpID09PSAwID8ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgLSAyO1xuXG4gICAgICAgICAgICAgICAgLy9oaWRlIG1lc3NhZ2UgYWJvdXQgbm8gaW5wdXQgc2VsZWN0ZWQsIGFzIGRyb3BwZWQgaW5wdXQgZ2V0cyBmb2N1c1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmhpZGUoKTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgIGlmIHRoZSB1c2VyIGlzIGRyYWdnaW5nIGEgbmV3IGlucHV0IG92ZXIsIGl0IHdhcyBhZGRlZCBhcyB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBhcnJheVxuICAgICAgICAgICAgICAgICBvdGhlcndpc2UgdGhlIGN1cnJlbnQgaW5wdXQgcG9zaXRpb24gaXMgc2V0IGluIHRoZSBzdGFydCBldmVudFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuYnJhbmNoLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9vdmVycmlkZSAnZnJvbV9pbmRleCcgYXMgd2UgYXJlIGRyb3BwaW5nIGEgbmV3IGVsZW1lbnQgKG1pbiB2YWx1ZSBmb3IgbGVuZ3RoIGlzIDEsIGFzIHdlIGFkZCB0aGUgaW5wdXQgaW4gdGhlIGByZWNlaXZlYCBmdW5jdGlvbilcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmZyb21faW5kZXggPSBicmFuY2hfaW5wdXRzLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9tb3ZlIGlucHV0cyB0byBrZWVwIHRoZSBhcnJheSBzZXF1ZW5jZSBsaWtlIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbiBzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0cy5tb3ZlKGZvcm1idWlsZGVyLmJyYW5jaC5mcm9tX2luZGV4LCBmb3JtYnVpbGRlci5icmFuY2gudG9faW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGJyYW5jaF9pbnB1dHMpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGJyYW5jaF9pbnB1dHMubGVuZ3RoKTtcblxuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmF0dHIoJ2RhdGEtaW5wdXQtcmVmJywgYnJhbmNoX2lucHV0X3JlZik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgaWQgYW5kIGEgd2FybmluZyBpY29uLCBhcyBieSBkZWZhdWx0IHRoZSBxdWVzdGlvbiBkb2VzIG5vdCBoYXZlIGFueSB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmZpbmQoJy5pbnB1dC1pbm5lcicpLmFwcGVuZCh1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRJbnB1dFN0YXRlSWNvbnNIVE1MKCkpO1xuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5maW5kKCdzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KHBsYWNlaG9sZGVyX3RleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2V0IG93bmVyIGJyYW5jaCBhcyBpbnZhbGlkIGFzIHdlIGFyZSBhZGRpbmcgYW4gaW52YWxpZCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihhY3RpdmVfYnJhbmNoLnJlZik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGlucHV0IHByb3BlcnRpZXMgZm9yIHRoZSBuZXcgZHJvcHBlZCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3BhbicpLnRleHQocGxhY2Vob2xkZXJfdGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGUgcHJvcGVydGllcyBwYW5lbCBpbiByaWdodCBzaWRlYmFyIGZvciB0aGlzIGlucHV0IChjb21tb24gcHJvcGVydGllcylcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllc19wYW5lbF9odG1sID0gdGVtcGxhdGUuZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MKGJyYW5jaF9pbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgYW5kIHNob3cgaXQgYXMgaXQgZ2V0cyBzZWxlY3RlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAkKHByb3BlcnRpZXNfcGFuZWxfaHRtbCkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpLmFwcGVuZFRvKGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZm9yIG5lc3RlZCBncm91cCwgZW5hYmxlIGtleXVwIHRvIGNoZWNrIGZvciB2YWxpZGF0aW9uIG9mIGhlYWRlciB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgdHlwZSBpbiB0aGUgaGVhZGVyIGlucHV0IGZpZWxkIGZvciBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgLy90b2RvIGNoZWNrIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9mb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoJ2tleXVwJykub24oJ2tleXVwJywgJ2lucHV0JywgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Zvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXQgKG9ubHkgd2hlbiBmaXJzdCBjcmVhdGVkKVxuICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZShicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAvLydmcm9tX2luZGV4IGlzIHNldCBpbiBzdGFydCBldmVudCBvZiBzb3J0YWJsZSdcbiAgICAgICAgICAgICAgICAgICAgLy9tb3ZlIGJyYW5jaCBpbnB1dHMgdG8ga2VlcCB0aGUgYXJyYXkgc2VxdWVuY2UgbGlrZSB0aGUgaW5wdXQgc2VxdWVuY2Ugb24gc2NyZWVuXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dHMubW92ZShmb3JtYnVpbGRlci5icmFuY2guZnJvbV9pbmRleCwgZm9ybWJ1aWxkZXIuYnJhbmNoLnRvX2luZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhicmFuY2hfaW5wdXRzKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3J1biB0aGUgdmFsaWRhdGlvbiBvbiBhbGwgYnJhbmNoIGp1bXBzLCBhcyB3ZSBtaWdodCBoYXZlIHNvbWUgaW52YWxpZCBkZXN0aW5hdGlvbnMgYWZ0ZXIgcmUtb3JkZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgLy9JIGFtIGZvcmNlZCB0byBkbyB0aGlzIGFnYWluc3QgYWxsIHRoZSBicmFuY2ggaW5wdXRzXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb24udmFsaWRhdGVKdW1wc0FmdGVyU29ydGluZyhicmFuY2hfaW5wdXRzKTtcblxuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3RvZG8gdGVzdCB0aGlzIHRoaW5nXG4gICAgICAgICAgICAvL2FkZCB0aGlzIHN0YXRlIGZvciB1bmRvaW5nLCBzbyBpdCBpcyBlYXNpZXIgdG8gcmViaW5kIGV2ZXJ5dGhpbmdcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcbiAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAkKCcuc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm90IGFueSB0aXRsZSBzZXQsIHNob3cgd2FybmluZ1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKHV0aWxzLmdldFRpdGxlQ291bnQoYnJhbmNoX2lucHV0cyksIHRydWUpO1xuXG4gICAgICAgIH0sXG4gICAgICAgIC8vdGhpcyBjYWxsYmFjayBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBzdGFydCBkcmFnZ2luZyBhbiBleGlzdGluZyBpbnB1dCBmcm9tIHRoZSAgICAgIHNvcnRhYmxlXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NvcnRhYmxlIHN0YXJ0Jyk7XG4gICAgICAgICAgICAvL2dldCBjdXJyZW50IGlucHV0IHBvc2l0aW9uLCBhcyB3ZSBuZWVkIHRvIG1vdmUgZnJvbSBoZXJlXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdicmFuY2ggaW5wdXQgaW5kZXg6ICcgKyBqcXVlcnlfdWkuaXRlbS5pbmRleCgpKTtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy9uYiB0aGUgLTIgaXMgdG8gcmVtb3ZlIHRoZSBlbGVtZW50IHdoaWNoIGFyZSBubyBpbnB1dCAod2FybmluZyBtZXNzYWdlcylcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmJyYW5jaC5mcm9tX2luZGV4ID0ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA9PT0gMCA/IDAgOiBqcXVlcnlfdWkuaXRlbS5pbmRleCgpIC0gMjtcblxuICAgICAgICAgICAgLy9kZS1hY3RpdmF0ZSBhbGwgaW5wdXRzIGluIGNvbGxlY3Rpb25cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgc2Nyb2xsOiB0cnVlLFxuICAgICAgICBzbmFwOiBmYWxzZSxcbiAgICAgICAgb3ZlcjogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuXG4gICAgICAgICAgICB2YXIgb3duZXJfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmO1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICAvL2hpZGUgaGVscCB0ZXh0IGlmIHRoZSBsaXN0IGlzIGVtcHR5IGFuZCB3ZSBhcmUgaG92ZXJpbmcgd2l0aCBhbiBpbnB1dFxuICAgICAgICAgICAgaWYgKG93bmVyX2lucHV0LmJyYW5jaC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIG93bmVyX2lucHV0X3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWJyYW5jaC1xdWVzdGlvbnMtbWVzc2FnZScpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBicmFuY2hfc29ydGFibGUoKTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJy4uL2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGRyYWdnYWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgICQoJ3VsI2lucHV0cy10b29scy1saXN0IGxpIGRpdi5pbnB1dCcpLmRyYWdnYWJsZSh7XG4gICAgICAgIGNvbm5lY3RUb1NvcnRhYmxlOiAnLnNvcnRhYmxlJyxcbiAgICAgICAgLy9jbG9uZSBlbGVtZW50IGtlZXBpbmcgc2FtZSB3aWR0aCB3aGVuIGRyYWdnaW5nXG4gICAgICAgIC8vbWluZDogYGV2dGAgaXMganF1ZXJ5IGdlbmVyYXRlZCwgaXQgY2Fubm90IGJlIGNhbGxlZCBhbnl0aGluZyBlbHNlIVxuICAgICAgICBoZWxwZXI6IGZ1bmN0aW9uIChldnQpIHtcblxuICAgICAgICAgICAgdmFyIGV2ZW50ID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICBjbG9uZSBhbHdheXMgdGhlIGlucHV0IHdyYXBwZXIsIGNoZWNraW5nIHdoaWNoIGVsZW1lbnQgdGhlIHVzZXIgaXMgYWN0dWFsbHkgZHJhZ2dpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKCQoZXZlbnQudGFyZ2V0KS5wcm9wKCd0YWdOYW1lJykgPT09ICdTUEFOJyB8fCAkKGV2ZW50LnRhcmdldCkucHJvcCgndGFnTmFtZScpID09PSAnSScpIHtcbiAgICAgICAgICAgICAgICAvL2RyYWdnaW5nIGVsZW1lbnRzIGluc2lkZSBpbm5lciBkaXZcbiAgICAgICAgICAgICAgICByZXR1cm4gJChldmVudC50YXJnZXQpLnBhcmVudCgpLnBhcmVudCgpLmNsb25lKCkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICQoZXZlbnQudGFyZ2V0KS5wYXJlbnQoKS53aWR0aCgpXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2RyYWdnaW5nIGlubmVyIGRpdlxuICAgICAgICAgICAgICAgIGlmICgkKGV2ZW50LnRhcmdldCkuaGFzQ2xhc3MoJ2lucHV0LWlubmVyJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoZXZlbnQudGFyZ2V0KS5wYXJlbnQoKS5jbG9uZSgpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJChldmVudC50YXJnZXQpLndpZHRoKClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZHJhZ2dpbmcgb3V0ZXIgZGl2IChpbnB1dCB3cmFwcGVyKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChldmVudC50YXJnZXQpLmNsb25lKCkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAkKGV2ZW50LnRhcmdldCkud2lkdGgoKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNuYXA6IGZhbHNlLFxuICAgICAgICAvL2N1cnNvckF0OiB7bGVmdDogJzUwJScsIHRvcDogJzUwJSd9LCBnZXQgbW91c2UgeCBhbmQgeSBkaW5hbWljYWxseVxuICAgICAgICAvL2hhbmRsZTogJ2knLFxuICAgICAgICAvLyBjYW5jZWw6ICdpJywgLy90aGlzIHN0b3AgdGhlIGRyYWdnaW5nIG92ZXIgdGhlIGljb24sIG5vdCBnb29kXG4gICAgICAgIC8vYmV0dGVyIHN0b3AgcHJvcGFnYXRpb24gb24gbW91c2Vkb3duIGxpa2VcbiAgICAgICAgLy8gY3Vyc29yOiAnbW92ZScsIHRoaXMga2VlcCB0aGUgY3Vyc29yICdtb3ZlJyBhZnRlciBkcm9wcGluZywgbm90IGdvb2RcbiAgICAgICAgcmV2ZXJ0OiAnaW52YWxpZCcsXG4gICAgICAgIHJldmVydER1cmF0aW9uOiAxMDAsXG4gICAgICAgIHpJbmRleDogOTk5OSxcbiAgICAgICAgYXBwZW5kVG86ICdib2R5JywvL2FwcGVuZCBvdXRzaWRlIHNvcnRhYmxlIHRvIGF2b2lkIGZsaWNrZXJpbmdcbiAgICAgICAgc3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSBmYWxzZTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZSwgdWkpIHtcblxuXG4gICAgICAgICAgICBpZiAoJChlLnRhcmdldCkucHJvcCgndGFnTmFtZScpID09PSAnU1BBTicgfHwgJChlLnRhcmdldCkucHJvcCgndGFnTmFtZScpID09PSAnSScpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLndpZHRoKCQoZS50YXJnZXQpLnBhcmVudCgpLndpZHRoKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLndpZHRoKCQoZS50YXJnZXQpLndpZHRoKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9rZWVwIHRyYWNrIHdlIGFyZSBkcmFnZ2luZyBmcm9tIHNpZGViYXIgYSBuZXcgaW5wdXQgdG8gdGhlIGlucHV0IGxpc3RcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbDogdHJ1ZVxuICAgIH0pLmRpc2FibGVTZWxlY3Rpb24oKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZHJhZ2dhYmxlO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xudmFyIGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldFBvc3NpYmxlQW5zd2Vyc0xpc3QnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKHBhcmFtcykge1xuXG4gICAgdmFyIHNlbGVjdGVkSGVhZGVySW5kZXggPSBwYXJhbXMuc2VsZWN0ZWRIZWFkZXJJbmRleDtcbiAgICB2YXIgaW5wdXQgPSBwYXJhbXMuaW5wdXQ7XG4gICAgdmFyIGltcG9ydGVkSnNvbiA9IHBhcmFtcy5pbXBvcnRlZEpzb247XG4gICAgdmFyIGxpc3Q7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWw7XG4gICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdDtcbiAgICB2YXIgaGVhZGVycyA9IGltcG9ydGVkSnNvbi5tZXRhLmZpZWxkcztcbiAgICB2YXIgdXNlcldhbnRzdG9SZXBsYWNlQW5zd2VycyA9IHBhcmFtcy51c2VyV2FudHN0b1JlcGxhY2VBbnN3ZXJzO1xuICAgIHZhciBkb2VzRmlyc3RSb3dDb250YWluc0hlYWRlcnMgPSBwYXJhbXMuZG9lc0ZpcnN0Um93Q29udGFpbnNIZWFkZXJzO1xuICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX21heCA9IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXg7XG5cbiAgICBpZihpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX21heCA9IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXhfc2VhcmNoO1xuICAgIH1cblxuICAgIC8vaWYgbm8gY29sdW1uIGlzIHNlbGVjdGVkIGFib3J0XG4gICAgaWYgKHNlbGVjdGVkSGVhZGVySW5kZXggPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vcmVwbGFjZSBvciBhcHBlbmQ/XG4gICAgaWYgKHVzZXJXYW50c3RvUmVwbGFjZUFuc3dlcnMpIHtcbiAgICAgICAgLy9yZXNldCBhbnN3ZXJzIGFycmF5XG4gICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMgPSBbXTtcbiAgICB9XG5cbiAgICAvL2hlYWRlcnMgb24gZmlyc3Qgcm93IG9yIG5vdD9cbiAgICBpZiAoIWRvZXNGaXJzdFJvd0NvbnRhaW5zSGVhZGVycykge1xuXG4gICAgICAgIHZhciBmaXJzdF9yb3cgPSB7fTtcbiAgICAgICAgZmlyc3Rfcm93W2ltcG9ydGVkSnNvbi5tZXRhLmZpZWxkc1tzZWxlY3RlZEhlYWRlckluZGV4XV0gPSBpbXBvcnRlZEpzb24ubWV0YS5maWVsZHNbc2VsZWN0ZWRIZWFkZXJJbmRleF07XG4gICAgICAgIC8vY3N2IGZpbGUgZG9lcyBub3QgaGF2ZSBhbnkgaGVhZGVycywgcHJlcGVuZCBtZXRhLmZpZWxkcyAod2hpY2ggaXMgdGhlIGhlYWRlcnMpXG4gICAgICAgIGltcG9ydGVkSnNvbi5kYXRhLnVuc2hpZnQoZmlyc3Rfcm93KTtcbiAgICB9XG5cbiAgICAvL2FwcGVuZCBpbXBvcnRlZCBwb3NzaWJsZSBhbnN3ZXJzIGJhc2VkIG9uIHNlbGVjdGVkIGNvbHVtbiAodXAgdG8gbWF4IG51bWJlciBhbGxvd2VkKVxuICAgICQoaW1wb3J0ZWRKc29uLmRhdGEpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG5cbiAgICAgICAgdmFyIGltcG9ydGVkX2Fuc3dlciA9IGl0ZW1baGVhZGVyc1tzZWxlY3RlZEhlYWRlckluZGV4XV07XG5cbiAgICAgICAgLy9pbXBvcnQgYXMgbWFueSBhcyB3ZSBjYW5cbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIDwgcG9zc2libGVfYW5zd2Vyc19tYXggJiYgaW1wb3J0ZWRfYW5zd2VyICE9PSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3NcbiAgICAgICAgICAgIGltcG9ydGVkX2Fuc3dlciA9IGltcG9ydGVkX2Fuc3dlci5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcblxuICAgICAgICAgICAgLy9lc2NhcGUgZG91YmxlIHF1b3Rlc1xuICAgICAgICAgICAgaW1wb3J0ZWRfYW5zd2VyID0gaW1wb3J0ZWRfYW5zd2VyLnJlcGxhY2UoL1wiL2dpLCAnJnF1b3Q7Jyk7XG5cbiAgICAgICAgICAgIC8vZmlsdGVyIG91dCBlbXB0eSBhbnN3ZXJzXG4gICAgICAgICAgICBpZiAoaW1wb3J0ZWRfYW5zd2VyLnRyaW0oKSAhPT0gJycpIHtcblxuICAgICAgICAgICAgICAgIC8vdHJ1bmNhdGUgaWYgdG9vIGxvbmdcbiAgICAgICAgICAgICAgICBpZiAoaW1wb3J0ZWRfYW5zd2VyLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2VyX21heF9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0ZWRfYW5zd2VyID0gaW1wb3J0ZWRfYW5zd2VyLnN1YnN0cmluZygwLGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2VyX21heF9sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vYWRkIHRvIG9iamVjdFxuICAgICAgICAgICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGFuc3dlcjogaW1wb3J0ZWRfYW5zd2VyLFxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3RvbyBtYW55LCBleGl0XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXhpdCBhdCAnICsgcG9zc2libGVfYW5zd2Vyc19tYXgpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOy8vanVzdCB0byBleGl0IGxvb3BcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy9nZXQgcG9zc2libGUgYW5zd2VycyBsaXN0IG1hcmt1cFxuICAgIGxpc3QgPSBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0KGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpO1xuXG4gICAgcHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuXG4gICAgcG9zc2libGVfYW5zd2Vyc19saXN0ID0gcHJvcGVydGllc19wYW5lbFxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcblxuICAgIC8vZW1wdHkgY3VycmVudCBsaXN0IGFuZCBhcHBlbmQgbmV3IG9uZSB0byBkb21cbiAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3RcbiAgICAgICAgLmVtcHR5KClcbiAgICAgICAgLmhpZGUoKVxuICAgICAgICAuYXBwZW5kKGxpc3QpXG4gICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vd2hlbiB0aGVyZSBpcyBtb3JlIHRoYW4gMSBwb3NzaWJsZSBhbnN3ZXJzLCBlbmFibGUgYWxsIHJlbW92ZSBidXR0b25zXG4gICAgcG9zc2libGVfYW5zd2Vyc19saXN0LmZpbmQoJ2xpIGRpdiBzcGFuIGJ1dHRvbicpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuXG4gICAgLy9zaG93IHBhZ2luYXRpb24gaWYgbmVlZGVkLCBzdGFydGluZyBmcm9tIHBhZ2UgMVxuICAgIGlmKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID4gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSB7XG4gICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgPSAxO1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLmluaXQoaW5wdXQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9yZXNldCBwYWdpbmF0aW9uXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIudGVhckRvd24oaW5wdXQpO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGZpbGVzKSB7XG5cbiAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuXG5cbiAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2RlbGV0ZSBhbGwgaW5wdXRzIGZyb20gZG9tXG4gICAgJChpbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAvL3JlbW92ZSBwcm9wZXJ0aWVzIGRvbSBlbGVtZW50cyAocmlnaHQgc2lkZWJhcilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgIC5maW5kKCdkaXYucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuICAgIH0pO1xuXG4gICAgLy9kZWxldGUgYWxsIHF1ZXN0aW9uIGZyb20gcHJvamVjdCBkZWZpbml0aW9uXG4gICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cyA9IFtdO1xuXG4gICAgLy9hZnRlciBkZWxldGlvbiBubyBpbnB1dCBpcyBzZWxlY3RlZCwgc2hvdyBtZXNzYWdlIGFuZCBoaWRlIGNvbnRleHQgYnV0dG9uc1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIC8vaGlkZSBhY3Rpb24gYnV0dG9uIGZvciBpbnB1dFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgLy9yZW1vdmUgdHJhY2sgb2YgYW55IGlucHV0c1xuICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgLy9yZSBjYWxjdWxhdGUgc2VhcmNoIHF1ZXN0aW9ucyB0b3RhbFxuICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpIDw9IChjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4IC0gMSkpIHtcbiAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgfVxuXG4gICAgLy9yZW1vdmUgdGl0bGUgd2FybmluZyBpZiBhbnlcbiAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoMSxmYWxzZSk7XG5cbiAgICAvL3NldCBmb3JtIGFzIGludmFsaWRcbiAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuXG4gICAgLy9zaG93IGltcG9ydCBmb3JtIGJ1dHRvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAvL2hhbmRsZSB0aGUgdW5kby4uLmNhbiB3ZSBnbyBiYWNrP1xuICAgIHVpLm5hdmJhci50b2dnbGVVbmRvQnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG5cbiAgICAvL2hpZGUgb3ZlcmxheVxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIH0sIDEwMDApO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG5cblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGUpIHtcblxuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGZvcm1fZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvZm9ybS1mYWN0b3J5Jyk7XG4gICAgdmFyIGZvcm1fcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZjtcbiAgICB2YXIgZm9ybV90YWIgPSBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCcuYWN0aXZlJyk7XG4gICAgdmFyIHByZXZpb3VzX3RhYl90cmlnZ2VyID0gZm9ybV90YWIucHJldigpLmZpbmQoJ2EnKTtcbiAgICB2YXIgcHJldmlvdXNfZm9ybV9yZWYgPSBwcmV2aW91c190YWJfdHJpZ2dlci5hdHRyKCdocmVmJyk7XG4gICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcblxuICAgIC8vaWYgY3VycmVudCBmb3JtIGluZGV4ID09PSAwLCBkbyBub3QgZGVsZXRlIGFzIHRoaXMgaXMgdGhlIGZpcnN0IGZvcm1cbiAgICBpZihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPT09IDApIHtcbiAgICAgICAgLy9jYW5ub3QgZGVsZXRlIHRvcCBwYXJlbnQgZm9ybVxuICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9DQU5OT1RfQkVfREVMRVRFRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvL2lmIHRoZSBjdXJyZW50IGZvcm0gaXMgbm90IHRoZSBsYXN0IGluIHRoZSBoaWVyYXJjaHksIGRvIG5vdCBkZWxldGUgaXRcbiAgICBpZihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggIT09IChmb3Jtcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAvL2Nhbm5vdCBkZWxldGUgdG9wIHBhcmVudCBmb3JtXG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0NBTk5PVF9CRV9ERUxFVEVEKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHByZXZpb3VzX2Zvcm1fcmVmID0gcHJldmlvdXNfZm9ybV9yZWYuc3Vic3RyaW5nKDEsIHByZXZpb3VzX2Zvcm1fcmVmLmxlbmd0aCAtIDkpO1xuICAgIC8vYWZ0ZXIgdGhlIGZvcm0gdG8gYmUgZGVsZXRlZCBpcyBoaWRkZW4sIGRlbGV0ZSBpdCBhbmQgdW5iaW5kIHRoZSBjYWxsYmFja1xuICAgIHByZXZpb3VzX3RhYl90cmlnZ2VyLm9uKCdzaG93bi5icy50YWInLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgIGZvcm1fZmFjdG9yeS5yZW1vdmVGb3JtKHByZXZpb3VzX2Zvcm1fcmVmLCBmb3JtX3JlZiwgZm9ybV90YWIpO1xuXG4gICAgICAgIC8vc2hvdyB0b2FzdFxuICAgICAgICB0b2FzdHIud2FybmluZyhtZXNzYWdlcy53YXJuaW5nLkZPUk1fREVMRVRFRCk7XG4gICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgcHJldmlvdXNfdGFiX3RyaWdnZXIub2ZmKCk7XG5cbiAgICAgICAgLy9ydW4gdmFsaWRhdGlvbiwgdGhlIHJlbW92ZWQgZm9ybSBuaWdodCBoYXZlIGJlZW4gdGhlIG9ubHkgb25lIHdpdGggaW52YWxpZCBpbnB1dHNcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlQWxsSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkge1xuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3Nob3cgc2VhcmNoIGlucHV0IGlmIHdlIGRlbGV0ZWQgc29tZSBzZWFyY2ggcWVzdGlvbnNcbiAgICAgICAgaWYgKHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCkgPD0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCkge1xuICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vdW5iaW5kIGN1cnJlbnQgcGFuZWwgaGFuZGxlcnMgYmVmb3JlIHN3aXRjaGluZ1xuICAgIGZvcm1fZmFjdG9yeS51bmJpbmRGb3JtUGFuZWxzRXZlbnRzKCk7XG5cbiAgICAvL3VwZGF0ZSBmb3JtYnVpbGRlciBkb20gcmVmZXJlbmNlcyB0byBwb2ludCB0byB0aGUgc2VsZWN0ZWQgZm9ybSBtYXJrdXBcbiAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKHByZXZpb3VzX2Zvcm1fcmVmKTtcblxuICAgIC8vYmluZCBldmVudHMgdG8gYWN0aXZlIGZvcm1cbiAgICBmb3JtX2ZhY3RvcnkuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcblxuICAgIC8vc3dpdGNoIHRvIHByZXZpb3VzIGZvcm1cbiAgICBmb3JtX3RhYi5wcmV2KCkuZmluZCgnYScpLnRhYignc2hvdycpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgIC8vIHZhciBnZW5lcmF0ZV9zZWFyY2hfdHlwZV9wcm9qZWN0ID0gcmVxdWlyZSgnaGVscGVycy9nZW5lcmF0ZS1zZWFyY2gtdHlwZS1wcm9qZWN0Jyk7XG4gICAgLy9cbiAgICAvLyBnZW5lcmF0ZV9zZWFyY2hfdHlwZV9wcm9qZWN0LmRvSXQoKTtcbiAgICAvLyByZXR1cm4gZmFsc2U7XG5cbiAgICB2YXIgaW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgdmFyIGZvcm1Ub0V4cG9ydCA9IHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgdHlwZTogJ2Zvcm0nLFxuICAgICAgICAgICAgZm9ybToge31cbiAgICAgICAgfVxuICAgIH07XG4gICAgLy9jcmVhdGUgYSBkZWVwIGNvcHkgb2YgdGhlIHByb2plY3Qgb2JqZWN0IHByb3BlcnRpZXNcbiAgICB2YXIgcHJvamVjdF9kZWZpbml0aW9uX2pzb24gPSB3aW5kb3cuQ2lyY3VsYXJKU09OLnBhcnNlKHdpbmRvdy5DaXJjdWxhckpTT04uc3RyaW5naWZ5KGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpO1xuICAgIHZhciBpc192YWxpZF9mb3JtID0gdHJ1ZTtcbiAgICB2YXIgcHJvamVjdF9zbHVnID0gcHJvamVjdF9kZWZpbml0aW9uX2pzb24uZGF0YS5wcm9qZWN0LnNsdWc7XG4gICAgdmFyIGZvcm0gPSBwcm9qZWN0X2RlZmluaXRpb25fanNvbi5kYXRhLnByb2plY3QuZm9ybXNbaW5kZXhdO1xuICAgIHZhciBmaWxlbmFtZSA9IHByb2plY3Rfc2x1ZyArICdfXycgKyBmb3JtLnNsdWcgKyAnX19mb3JtLmpzb24nO1xuXG4gICAgaWYgKGZvcm0uaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9JU19JTlZBTElEKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgICQoZm9ybS5pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGlucHV0SW5kZXgsIGlucHV0KSB7XG5cbiAgICAgICAgLy9nZXQgdmFsaWQganVtcCBkZXN0aW5hdGlvbnNcbiAgICAgICAgdmFyIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5cyhpbnB1dEluZGV4LCBpbnB1dCwgZm9ybS5pbnB1dHMsIGZhbHNlKTtcblxuICAgICAgICAvL2V4dHJhIHZhbGlkYXRpb24gZm9yIGp1bXBzLCBjaGVjayBpZiB0aGUgZGVzdGluYXRpb24gc3RpbGwgZXhpc3RzIGFuZCBpdCBpcyB2YWxpZFxuICAgICAgICAkKGlucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChqdW1wSW5kZXgsIGp1bXApIHtcbiAgICAgICAgICAgIC8vZG9lcyB0aGUganVtcCBcInRvXCIgcHJvcGVydHkgcmVmZXJlbmNlIGEgdmFsaWQgZGVzdGluYXRpb24gaW5wdXQ/XG4gICAgICAgICAgICBpZiAoIWp1bXBfZGVzdGluYXRpb25zW2p1bXAudG9dKSB7XG4gICAgICAgICAgICAgICAgLy9pbnZhbGlkIGRlc3RpbmF0aW9uIGZvdW5kXG4gICAgICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkKGlucHV0LmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoYnJhbmNoSW5wdXRJbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgICAgIGlmICghYnJhbmNoX2lucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkX2Zvcm0gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVsZXRlIGJyYW5jaF9pbnB1dC5kb207XG5cbiAgICAgICAgICAgIC8vdG9kbyB2YWxpZGF0ZSBicmFuY2gganVtcHNcbiAgICAgICAgICAgIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5cyhicmFuY2hJbnB1dEluZGV4LCBicmFuY2hfaW5wdXQsIGlucHV0LmJyYW5jaCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIC8vZXh0cmEgdmFsaWRhdGlvbiBmb3IganVtcHMsIGNoZWNrIGlmIHRoZSBkZXN0aW5hdGlvbiBzdGlsbCBleGlzdHMgYW5kIGl0IGlzIHZhbGlkXG4gICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbiAoYnJhbmNoSnVtcEluZGV4LCBicmFuY2hKdW1wKSB7XG4gICAgICAgICAgICAgICAgLy9kb2VzIHRoZSBqdW1wIFwidG9cIiBwcm9wZXJ0eSByZWZlcmVuY2UgYSB2YWxpZCBkZXN0aW5hdGlvbiBpbnB1dD9cbiAgICAgICAgICAgICAgICBpZiAoIWp1bXBfZGVzdGluYXRpb25zW2JyYW5jaEp1bXAudG9dKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZ3JvdXBfaW5wdXQpIHtcblxuICAgICAgICAgICAgICAgIGlmICghZ3JvdXBfaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkX2Zvcm0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVsZXRlIGdyb3VwX2lucHV0LmRvbTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgJChpbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG4gICAgICAgICAgICBpZiAoIWdyb3VwX2lucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkX2Zvcm0gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSBncm91cF9pbnB1dC5kb207XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGlucHV0LmRvbTtcbiAgICB9KTtcblxuICAgIC8vd3JhcCBmb3JtIGluIFwiZGF0YSB7fVwiIGFjY29yZGluIHRvIGpzb24gYXBpXG4gICAgZm9ybVRvRXhwb3J0LmRhdGEuaWQgPSBmb3JtLnJlZjtcbiAgICBmb3JtVG9FeHBvcnQuZGF0YS5mb3JtID0gZm9ybTtcblxuICAgIGlmIChpc192YWxpZF9mb3JtKSB7XG4gICAgICAgIC8vZG8gZXhwb3J0XG5cbiAgICAgICAgdmFyIGZpbGU7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZpbGUgPSBuZXcgRmlsZShbSlNPTi5zdHJpbmdpZnkoZm9ybVRvRXhwb3J0KV0sIGZpbGVuYW1lLCB7IHR5cGU6ICd0ZXh0L3BsYWluOmNoYXJzZXQ9dXRmLTgnIH0pO1xuICAgICAgICAgICAgc2F2ZUFzKGZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuXG4gICAgICAgICAgICAvL01pY3Jvc29mdCBicm93c2Vycz9cbiAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IubXNTYXZlQmxvYikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuYXZpZ2F0b3IubXNTYXZlQmxvYihuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkoZm9ybVRvRXhwb3J0KV0sIHsgdHlwZTogJ3RleHQvcGxhaW46Y2hhcnNldD11dGYtOCcgfSksIGZpbGVuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vYnJvd3NlciBub3Qgc3VwcG9ydGVkIHlldFxuICAgICAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5CUk9XU0VSX05PVF9TVVBQT1JURUQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0lTX0lOVkFMSUQpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtX2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2Zvcm0tZmFjdG9yeScpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgdmFyIHRhcmdldCA9ICQodGhpcyk7XG4gICAgdmFyIGhyZWYgPSB0YXJnZXQuYXR0cignaHJlZicpO1xuICAgIHZhciBmb3JtX3JlZiA9IHRhcmdldC5hdHRyKCdocmVmJykuc3Vic3RyaW5nKDEsIGhyZWYubGVuZ3RoIC0gOSk7XG4gICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcbiAgICB2YXIgaW5wdXRzO1xuICAgIHZhciBpc19sYXN0X2NoaWxkX2Zvcm07XG4gICAgdmFyIGFjdGl2ZV9pbnB1dDtcblxuXG4gICAgLy9pZ25vcmUgY2xpY2tzIG9uIGFjdGl2ZSB0YWJcbiAgICBpZiAodGFyZ2V0LnBhcmVudCgpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy92YWxpZGF0ZSBhY3RpdmUgaW5wdXQgKGlmIGFueSkgYmVmb3JlIHN3aXRjaGluZ1xuICAgIGlmIChmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICBhY3RpdmVfaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICB9XG5cbiAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICBpZiAoYWN0aXZlX2lucHV0KSB7XG4gICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24oYWN0aXZlX2lucHV0LCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy91bmJpbmQgY3VycmVudCBwYW5lbCBoYW5kbGVycyBiZWZvcmUgc3dpdGNoaW5nXG4gICAgZm9ybV9mYWN0b3J5LnVuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcblxuICAgIC8vdXBkYXRlIGZvcm1idWlsZGVyIGRvbSByZWZlcmVuY2VzIHRvIHBvaW50IHRvIHRoZSBzZWxlY3RlZCBmb3JtIG1hcmt1cFxuICAgIGZvcm1fZmFjdG9yeS51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybV9yZWYpO1xuXG4gICAgLy9iaW5kIGV2ZW50cyB0byBhY3RpdmUgZm9ybVxuICAgIGZvcm1fZmFjdG9yeS5iaW5kRm9ybVBhbmVsc0V2ZW50cygpO1xuXG4gICAgLy9nZXQgYWN0aXZlIGlucHV0IGZvciB0aGUgc2VsZWN0ZWQgZm9ybSAoaWYgYW55KVxuICAgIHZhciBhY3RpdmVfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5hY3RpdmUnKS5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuXG4gICAgLy9zd2l0Y2ggZm9ybSB0byBzZWxlY3RlZCBvbmVcbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPSBwYXJzZUludCh0YXJnZXQuYXR0cignZGF0YS1mb3JtLWluZGV4JyksIDEwKTtcbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5yZWY7XG5cbiAgICAvL3JlbW92ZSBhbnkgcmVmZXJlbmNlIHRvIHNlbGVjdGVkIGlucHV0XG4gICAgLy90b2RvIGNoZWNrIHRoaXMgYXMgd2UgbWlnaHQgbmVlZCB0byBydW4gYSB2YWxpZGF0aW9uIGJlZm9yZSBzd2l0Y2hpbmcgdGFiXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBhY3RpdmVfaW5wdXRfcmVmO1xuXG4gICAgaXNfbGFzdF9jaGlsZF9mb3JtID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID09PSBmb3Jtcy5sZW5ndGggLSAxO1xuICAgIC8vZW5hYmxlIGRlbGV0ZSBidXR0b24gaWYgdGhlIGFjdGl2ZSBjaGlsZCBmb3JtIGlzIHRoZSBsYXN0IGNoaWxkXG4gICAgaWYgKGlzX2xhc3RfY2hpbGRfZm9ybSkge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2J1dHRvbnMtLXJlbW92ZS1mb3JtJylcbiAgICAgICAgICAgIC5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fYnV0dG9ucy0tcmVtb3ZlLWZvcm0nKVxuICAgICAgICAgICAgLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgfVxuXG4gICAgaW5wdXRzID0gZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG5cbiAgICAvL2lmIHRoZSBuZXcgYWN0aXZlIGZvcm0gZG9lcyBub3QgaGF2ZSBhIHRpdGxlIHNldCwgc2hvdyB3YXJuaW5nXG4gICAgLy9zaG93IG5vIHRpdGxlIHdhcm5pbmcgKGlmIG5vIHRpdGxlIHNldCBmb3IgdGhlIGZpcnN0IGZvcm0pXG4gICAgaWYgKHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKSA9PT0gMCAmJiBpbnB1dHMubGVuZ3RoID4gMCkge1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoMCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8vaWYgbm8gaW5wdXRzLCBkaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgaWYgKGlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICB9XG5cbiAgICAvL3RvZ2dsZSBmb3JtIGljb24gdG8gYSBncmVlbiBjaGNrIGlmIHRoZSB0b3AgcGFyZW50IGZvcm0gaXMgdmFsaWRcbiAgICBpZiAodmFsaWRhdGlvbi5hcmVGb3JtSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KSkge1xuICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgLy9lbmFibGUgZG93bmxvYWQgZm9ybSBidXR0b25cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgIC8vZW5hYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9kaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgcGFyc2VyID0ge1xuICAgIGdldEJyYW5jaElucHV0c0hUTUw6IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9nZXRCcmFuY2hJbnB1dHNIVE1MJyksXG4gICAgZ2V0R3JvdXBJbnB1dHNIVE1MOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvZ2V0R3JvdXBJbnB1dHNIVE1MJyksXG4gICAgcmVuZGVySW5wdXRzOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVySW5wdXRzJyksXG4gICAgcmVuZGVyUHJvamVjdDogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL3JlbmRlclByb2plY3QnKSxcbiAgICByZW5kZXJDaGlsZEZvcm1zOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVyQ2hpbGRGb3JtcycpLFxuICAgIGluaXRGb3JtYnVpbGRlcjogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL2luaXRGb3JtYnVpbGRlcicpXG59O1xuXG52YXIgaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2hlbHBlcnMvaW1wb3J0LWZvcm0tdmFsaWRhdGlvbicpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZmlsZXMpIHtcblxuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGZpbGUgPSBmaWxlc1swXTtcbiAgICB2YXIgZmlsZV9wYXJ0cztcbiAgICB2YXIgZmlsZV9leHQ7XG5cbiAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2lmIHRoZSB1c2VyIGNhbmNlbHMgdGhlIGFjdGlvblxuICAgIGlmICghZmlsZSkge1xuICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmaWxlX3BhcnRzID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XG4gICAgZmlsZV9leHQgPSBmaWxlX3BhcnRzW2ZpbGVfcGFydHMubGVuZ3RoIC0gMV07XG5cbiAgICBjb25zb2xlLmxvZyhmaWxlKTtcblxuICAgIC8vaXQgbXVzdCBiZSBqc29uXG4gICAgaWYgKGZpbGVfZXh0ICE9PSBjb25zdHMuRk9STV9GSUxFX0VYVEVOU0lPTikge1xuICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvL3RvZG8gc2tpcCBNSU1FIHR5cGUgdmFsaWRhdGlvbiBvbiB0aGUgZnJvbnQgZW5kIGFzIGl0IGlzIGEgbWVzc1xuICAgIC8vanNvbiBmb3JtYXQgYWNjb3JkaW5nIHRvIGVwaWNvbGxlY3Q1IGFwaVxuICAgIC8vaWYgKGZpbGUudHlwZSAhPT0gY29uc3RzLkZPUk1fRklMRV9BQ0NFUFRFRF9UWVBFKSB7XG4gICAgLy9oaWRlIG92ZXJsYXlcbiAgICAvLyAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIC8vICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgIC8vICAgICByZXR1cm47XG4gICAgLy8gfVxuXG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICB2YXIganNvbl90ZXh0ID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICB2YXIgZm9ybTtcbiAgICAgICAgdmFyIGN1cnJlbnRfZm9ybV9yZWY7XG4gICAgICAgIHZhciBpbXBvcnRlZF9mb3JtX3JlZjtcbiAgICAgICAgdmFyIHJlZ2V4O1xuICAgICAgICB2YXIgaW5wdXRzO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9ybSA9IEpTT04ucGFyc2UoanNvbl90ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAvL2l0IG1lYW5zIHRoZSBqc29uIGlzIGluIGludmFsaWQgZm9ybWF0XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cblxuICAgICAgICAvL3ZhbGlkYXRlIGZvcm0gc3RydWN0dXJlXG4gICAgICAgIGlmICghaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbi5oYXNWYWxpZEZvcm1TdHJ1Y3R1cmUoZm9ybSkpIHtcbiAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAvL2l0IG1lYW5zIHRoZSBzdHJ1Y3R1cmUgaXMgaW52YWxpZFxuICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZ3JhYiBpbnB1dHNcbiAgICAgICAgaW5wdXRzID0gZm9ybS5kYXRhLmZvcm0uaW5wdXRzO1xuXG4gICAgICAgIC8vYXJlIHRoZXJlIGFueSBpbnB1dHM/XG4gICAgICAgIGlmIChpbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9pcyBpbnB1dHMgYXJyYXk/XG4gICAgICAgIGlmICghJC5pc0FycmF5KGlucHV0cykpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYXJlX3ZhbGlkX2lucHV0cyA9IHRydWU7XG4gICAgICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbXBvcnRfZm9ybV92YWxpZGF0aW9uLmlzVmFsaWRJbnB1dChmb3JtLmRhdGEuZm9ybS5yZWYsIGlucHV0LCBmYWxzZSwgZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoaW5wdXQpKTtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3ZhbGlkX2lucHV0cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghYXJlX3ZhbGlkX2lucHV0cykge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgcXVlc3Rpb25zL2JyYW5jaGVzXG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0SW5wdXRzVG90YWwoaW5wdXRzKSA+IGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQpIHtcbiAgICAgICAgICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgdGl0bGVzIChtYWluIGZvcm0pXG4gICAgICAgICAgICBpZiAodXRpbHMuaXNNYXhUaXRsZUxpbWl0RXhjZWVkZWQoaW5wdXRzKSkge1xuICAgICAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgdGl0bGVzIChicmFuY2hlcylcbiAgICAgICAgICAgIHZhciBhcmVfYnJhbmNoX2lucHV0c192YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdEV4Y2VlZGVkKGlucHV0LmJyYW5jaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX2JyYW5jaF9pbnB1dHNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIWFyZV9icmFuY2hfaW5wdXRzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vY2hlY2sganVtcHMgZGVzdGluYXRpb25zXG4gICAgICAgICAgICBpZiAoIWltcG9ydF9mb3JtX3ZhbGlkYXRpb24uYXJlSnVtcHNEZXN0aW5hdGlvbnNWYWxpZChpbnB1dHMpKSB7XG4gICAgICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL3dlIG5lZWQgdG8gdXNlIHRoZSBjdXJyZW50IGZvcm0gcmVmXG4gICAgICAgIGN1cnJlbnRfZm9ybV9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmO1xuICAgICAgICBpbXBvcnRlZF9mb3JtX3JlZiA9IGZvcm0uZGF0YS5mb3JtLnJlZjtcbiAgICAgICAgcmVnZXggPSBuZXcgUmVnRXhwKGltcG9ydGVkX2Zvcm1fcmVmLCAnZycpO1xuXG4gICAgICAgIC8vcmVwbGFjZSBpbXBvcnRlZCBmb3JtIHJlZiB3aXRoIGN1cnJlbnQgZm9ybSByZWYoYWxsIG9jY3VycnJlbmNlcylcbiAgICAgICAganNvbl90ZXh0ID0ganNvbl90ZXh0LnJlcGxhY2UocmVnZXgsIGN1cnJlbnRfZm9ybV9yZWYpO1xuICAgICAgICBmb3JtID0gSlNPTi5wYXJzZShqc29uX3RleHQpO1xuXG4gICAgICAgIC8vIHRlbXBvcmFybHkgc2V0dXAgaW5wdXRzIHdpdGggdGhlIGN1cnJlbnRfZm9ybV9yZWYgaW4gZm9ybWJ1aWxkZXIgZ2xvYmFsIG9iamVjdCAoc28gaXQgY2FuIHBhc3MganVtcCBkZXN0aW5hdGlvbnMgdmFsaWRhdGlvbiB3aGVuIHBhcnNpbmcsIGFuZCBhbHNvIHRvIHJlbmRlciBqdW1wcyBwcm9wZXJseSBpbiB0aGUgZG9tKVxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF1cbiAgICAgICAgICAgIC5pbnB1dHMgPSBmb3JtLmRhdGEuZm9ybS5pbnB1dHMuc2xpY2UoKTtcblxuICAgICAgICAvL3BhcnNlIHRoZSBmb3JtIGFuZCBhZGQgdGhlIG1hcmt1cCB0aGVuLlxuICAgICAgICB2YXIgcmVuZGVyZWRJbnB1dHMgPSBwYXJzZXIucmVuZGVySW5wdXRzKGZvcm0uZGF0YS5mb3JtLmlucHV0cyk7XG5cbiAgICAgICAgLy9yZW1vdmUgbm8gcXVlc3Rpb25zIG1lc3NhZ2UgKGlmIGFueSBpbnB1dHMpXG4gICAgICAgIGlmIChyZW5kZXJlZElucHV0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLXF1ZXN0aW9ucy1tZXNzYWdlJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IG5vIHRpdGxlIHdhcm5pbmcgKGlmIG5vIHRpdGxlIHNldCBmb3IgdGhlIGZpcnN0IGZvcm0pXG4gICAgICAgIGlmICh1dGlscy5nZXRUaXRsZUNvdW50KHJlbmRlcmVkSW5wdXRzKSA9PT0gMCkge1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDAsIGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdG9nZ2xlIGZvcm0gaWNvbiB0byBhIGdyZWVuIGNoZWNrIGlmIHRoZSB0b3AgcGFyZW50IGZvcm0gaXMgdmFsaWRcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlRm9ybUlucHV0c1ZhbGlkKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCkpIHtcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1WYWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcbiAgICAgICAgICAgIC8vZW5hYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAvL2VuYWJsZSBwcmludCBhcyBwZGYgZm9ybSBidXR0b25cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZXBsYWNlIG9iamVjdCBsaXRlcmFsIGlucHV0cyB3aXRoIG5ld2x5IGdlbmVyYXRlZCBvbmVzIHZpYSBmYWN0b3J5IChpLmUuIHVzaW5nIG5ldykgc28gdGhleSBnZXQgdGhlIHByb3RvdHlwZVxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzID0gcmVuZGVyZWRJbnB1dHMuc2xpY2UoKTsvL2J5IHZhbHVlXG5cblxuICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGlmIGFsbCBpbnB1dHMgYXJlIHZhbGlkXG4gICAgICAgIGlmICh2YWxpZGF0aW9uLmFyZUFsbElucHV0c1ZhbGlkKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpIHtcblxuICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiAoaWYgZGlzYWJsZWQpXG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcblxuICAgICAgICAgICAgLy9yZXNldCBzb21lIGZsYWdzXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IG51bGw7IC8vbm8gaW5wdXQgaXMgc2VsZWN0ZWRcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaWYgdGhlcmUgYXJlIHRvbyBtYW55IHNlYXJjaCBpbnB1dHMsIGhpZGUgdGhlIHNlYXJjaCBpbnB1dCB0b29sIGluIHRoZSBzaWRlYmFyXG4gICAgICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpID49IGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXgpIHtcbiAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuXG4gICAgICAgICAgICAvL2Fsc28gc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICAvL3Nob3cgd2FybmluZyB0byB1c2VyXG4gICAgICAgICAgICB0b2FzdC5zaG93V2FybmluZyhtZXNzYWdlcy53YXJuaW5nLlNFQVJDSF9JTlBVVFNfTElNSVRfUkVBQ0hFRCArICcoJyArIGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggKyAnKScpO1xuICAgICAgICB9XG5cbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9TTE9XKTtcbiAgICAgICAgICAgIC8vc2hvdyBzdWNjZXNzIHRvYXN0XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhtZXNzYWdlcy5zdWNjZXNzLkZPUk1fSU1QT1JURUQpO1xuICAgICAgICAgICAgLy9wdXNoIHN0YXRlIGZvciB1bmRvXG4gICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xuICAgIH07XG5cbiAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgcG9zc2libGVBbnN3ZXJzU29ydGFibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9wb3NzaWJsZS1hbnN3ZXJzLXNvcnRhYmxlJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xuXG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICBjb25zb2xlLmxvZygnY2FsbGVkIGJyYW5jaC1zb3J0YWJsZS1tb3VzZWRvd24nKTtcblxuXG4gICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xuICAgIGNvbnNvbGUubG9nKCdmb3JtYnVpbGRlciBjdXJyZW50IGlucHV0IHJlZiAtPicsIEpTT04uc3RyaW5naWZ5KGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKSk7XG4gICAgY29uc29sZS5sb2coJ2Zvcm1idWlsZGVyIGFjdGl2ZSBicmFuY2ggcmVmIC0+JywgSlNPTi5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKSk7XG5cbiAgICB2YXIgcmVmID0gc2VsZi5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuICAgIHZhciBicmFuY2hfaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKHJlZik7XG4gICAgdmFyIHByZXZpb3VzX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICB2YXIgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpLmJyYW5jaDtcbiAgICB2YXIgcXVlc3Rpb247XG5cbiAgICAvL2JyYW5jaF9pbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyByZWYgKyAnXCJdJyk7XG5cbiAgICAvKlxuICAgICBpZiBib3RoIHRoZSBlZGl0aW5nIGJyYW5jaCBmbGFnIGFuZCB0aGUgZWRpdGluZyBncm91cCBmbGFnIGFyZSBzZXQsIHdlIGFyZSBleGl0aW5nIGEgbmVzdGVkIGdyb3VwXG4gICAgICovXG4gICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgLy93ZSBhcmUgaW4gbmVzdGVkIGdyb3VwIGVkaXQgbW9kZSwgZXhpdCBpcyB0aGUgb25seSBhY3Rpb24gd2UgbmVlZCB0byBpbnRlcmNlcHRcbiAgICAgICAgaWYgKHNlbGYuaGFzQ2xhc3MoJ2ZhLWNoZXZyb24tbGVmdCcpKSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IGFjdGl2ZSBuZXN0ZWQgZ3JvdXAgd2UgYXJlIGV4aXRpbmcgZnJvbVxuICAgICAgICAgICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICAvL2V4aXQgbmVzdGVkIGdyb3VwIGVkaXRpbmdcbiAgICAgICAgICAgIGlucHV0LmV4aXROZXN0ZWRHcm91cFNvcnRhYmxlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG5cbiAgICAgICAgLy9kZWFjdGl2YXRlIGFsbCBpbnB1dHMgaW4gYWN0aXZlIGJyYW5jaCBzb3J0YWJsZSBjb2xsZWN0aW9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWJyYW5jaCAuYnJhbmNoLXNvcnRhYmxlJykuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgLy9hY3RpdmF0ZSBuZXcgY2xpY2tlZCBlbGVtZW50XG4gICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIC8vdmFsaWRhdGUgcHJldmlvdXMgaW5wdXQgKGlmIGFueSwgSSBtaWdodCBoYXZlIG9ubHkgb25lIGxlZnQpIHdoZW4gdXNlciBnb2VzIHRvIGFub3RoZXIgaW5wdXQsIGJ1dCBkbyBub3Qgc2hvdyB0b2FzdFxuICAgICAgICBpZiAocHJldmlvdXNfYnJhbmNoX2lucHV0KSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHByZXZpb3VzX2JyYW5jaF9pbnB1dCwgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICovXG5cbiAgICAgICAgaWYgKCFicmFuY2hfaW5wdXQucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gdXRpbHMuZGVjb2RlSHRtbChicmFuY2hfaW5wdXQucXVlc3Rpb24pO1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gcXVlc3Rpb24ucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQocXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KGJyYW5jaF9pbnB1dC5xdWVzdGlvbi50cnVuYygyMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy90b2dnbGUgdGl0bGUgYmFzZSBvbiBudW1iZXIgb2YgdGl0bGVzIHNlbGVjdGVkIHdpdGhpbiB0aGlzIGJyYW5jaCAoYnV0IG9ubHkgaWYgbm90IGNoZWNrZWQpXG4gICAgICAgIGlmICh1dGlscy5pc01heFRpdGxlTGltaXRSZWFjaGVkKGJyYW5jaF9pbnB1dHMpKSB7XG4gICAgICAgICAgICBpZiAoIWJyYW5jaF9pbnB1dC5pc190aXRsZSkge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlVGl0bGVDaGVja2JveChjb25zdHMuRElTQUJMRURfU1RBVEUsIHJlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkVOQUJMRURfU1RBVEUsIHJlZik7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm0nKS5oaWRlKCk7XG4gICAgICAgIC8vIC8vZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyByZWYgKyAnXCJdJyk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgcmVmICsgJ1wiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgICAgIC8vaGlkZSAnbm8gaW5wdXRzIHNlbGVjdGVkIGJ1dHRvbnMnXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJykuaGlkZSgpO1xuXG4gICAgICAgIC8vaWYgdGhlIGlucHV0IHR5cGUgaGFzIHBvc3NpYmxlIGFuc3dlcnMsIHNob3cgcGFnZXIgaWYgbmVlZGVkXG4gICAgICAgIGlmICgkLmluQXJyYXkoYnJhbmNoX2lucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAvL3Nob3cgcGFnaW5hdGlvblxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIuaW5pdChicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci50ZWFyRG93bihicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IHNhdmUvZGVsZXRlIGJ0bnNcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmID0gcmVmO1xuXG4gICAgICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXRcbiAgICAgICAgcG9zc2libGVBbnN3ZXJzU29ydGFibGUoYnJhbmNoX2lucHV0KTtcbiAgICB9XG5cbiAgICBpZiAoYnJhbmNoX2lucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAkKCcuc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcbnZhciBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyID0gcmVxdWlyZSgnYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLXBhZ2VyJyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICBjb25zb2xlLmxvZygnY2FsbGVkIGdyb3VwLXNvcnRhYmxlLW1vdXNlZG93bicpO1xuXG4gICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xuICAgIHZhciByZWYgPSBzZWxmLmF0dHIoJ2RhdGEtaW5wdXQtcmVmJyk7XG4gICAgdmFyIGdyb3VwX2lucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKHJlZik7XG4gICAgdmFyIHByZXZpb3VzX2dyb3VwX2lucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICB2YXIgcXVlc3Rpb247XG5cbiAgICAvL2RlYWN0aXZhdGUgYWxsIGlucHV0cyBpbiBhY3RpdmUgZ3JvdXAgc29ydGFibGUgY29sbGVjdGlvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWdyb3VwIC5ncm91cC1zb3J0YWJsZScpLmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgLy9hY3RpdmF0ZSBuZXcgY2xpY2tlZCBlbGVtZW50XG4gICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICBpZiAocHJldmlvdXNfZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihwcmV2aW91c19ncm91cF9pbnB1dCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qXG4gICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgKi9cbiAgICBpZiAoIWdyb3VwX2lucHV0LnF1ZXN0aW9uKSB7XG4gICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUKTtcbiAgICB9XG4gICAgZWxzZSB7XG5cbiAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3MgZnJvbSByZWFkbWUgdHlwZSBpZiBhbnlcbiAgICAgICAgaWYgKGdyb3VwX2lucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGdyb3VwX2lucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gcXVlc3Rpb24ucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChxdWVzdGlvbi50cnVuYygyMCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQoZ3JvdXBfaW5wdXQucXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vdG9nZ2xlIHRpdGxlIGJhc2Ugb24gbnVtYmVyIG9mIHRpdGxlcyBzZWxlY3RlZCAoYnV0IG9ubHkgaWYgbm90IGNoZWNrZWQpXG4gICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdFJlYWNoZWQoaW5wdXRzKSkge1xuICAgICAgICBpZiAoIWdyb3VwX2lucHV0LmlzX3RpdGxlKSB7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkRJU0FCTEVEX1NUQVRFLCByZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkVOQUJMRURfU1RBVEUsIHJlZik7XG4gICAgfVxuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybScpLmhpZGUoKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHJlZiArICdcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuICAgIC8vaGlkZSAnbm8gaW5wdXRzIHNlbGVjdGVkIGJ1dHRvbnMnXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKS5oaWRlKCk7XG5cbiAgICAvL2lmIHRoZSBpbnB1dCB0eXBlIGhhcyBwb3NzaWJsZSBhbnN3ZXJzLCBzaG93IHBhZ2VyIGlmIG5lZWRlZFxuICAgIGlmICgkLmluQXJyYXkoZ3JvdXBfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgPiAtMSkge1xuICAgICAgICBpZiAoZ3JvdXBfaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UpIHtcbiAgICAgICAgICAgIC8vc2hvdyBwYWdpbmF0aW9uXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLmluaXQoZ3JvdXBfaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci50ZWFyRG93bihncm91cF9pbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3Nob3cgc2F2ZS9kZWxldGUgYnRuc1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgPSByZWY7XG5cbiAgICBpZiAoZ3JvdXBfaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICQoJy5zdW1tZXJub3RlJykuc3VtbWVybm90ZShjb25zdHMuU1VNTUVSTk9URV9PUFRJT05TKTtcbiAgICB9XG4gICAgLy9lbmFibGUgc29ydGFibGUgb24gY3VycmVudCBpbnB1dFxuICAgIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlKGdyb3VwX2lucHV0KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcbnZhciBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyID0gcmVxdWlyZSgnYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLXBhZ2VyJyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICB2YXIgc2VsZiA9ICQodGhpcyk7XG4gICAgdmFyIHJlZiA9IHNlbGYuYXR0cignZGF0YS1pbnB1dC1yZWYnKTtcbiAgICB2YXIgb3duZXJfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgIHZhciBncm91cF9pbnB1dCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZihvd25lcl9icmFuY2gsIHJlZik7XG4gICAgdmFyIHByZXZpb3VzX2dyb3VwX2lucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgIHZhciBicmFuY2hfaW5wdXRzID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZikuYnJhbmNoO1xuICAgIHZhciBxdWVzdGlvbjtcblxuICAgIC8vIGdyb3VwX2lucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHJlZiArICdcIl0nKTtcblxuICAgIC8vZGVhY3RpdmF0ZSBhbGwgaW5wdXRzIGluIGFjdGl2ZSBuZXN0ZWQgZ3JvdXAgc29ydGFibGUgY29sbGVjdGlvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWdyb3VwIC5ncm91cC1zb3J0YWJsZScpLmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgLy9hY3RpdmF0ZSBuZXcgY2xpY2tlZCBlbGVtZW50XG4gICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICBpZiAocHJldmlvdXNfZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihwcmV2aW91c19ncm91cF9pbnB1dCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qXG4gICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgKi9cbiAgICBpZiAoIWdyb3VwX2lucHV0LnF1ZXN0aW9uKSB7XG4gICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgIGlmIChncm91cF9pbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gdXRpbHMuZGVjb2RlSHRtbChncm91cF9pbnB1dC5xdWVzdGlvbik7XG4gICAgICAgICAgICBxdWVzdGlvbiA9IHF1ZXN0aW9uLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQocXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KGdyb3VwX2lucHV0LnF1ZXN0aW9uLnRydW5jKDIwKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3RvZ2dsZSB0aXRsZSBiYXNlIG9uIG51bWJlciBvZiB0aXRsZXMgc2VsZWN0ZWQgKGJ1dCBvbmx5IGlmIG5vdCBjaGVja2VkKVxuICAgIGlmICh1dGlscy5pc01heFRpdGxlTGltaXRSZWFjaGVkKGJyYW5jaF9pbnB1dHMpKSB7XG4gICAgICAgIGlmICghZ3JvdXBfaW5wdXQuaXNfdGl0bGUpIHtcbiAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlVGl0bGVDaGVja2JveChjb25zdHMuRElTQUJMRURfU1RBVEUsIHJlZik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlVGl0bGVDaGVja2JveChjb25zdHMuRU5BQkxFRF9TVEFURSwgcmVmKTtcbiAgICB9XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuaGlkZSgpO1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgcmVmICsgJ1wiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgLy9oaWRlICdubyBpbnB1dHMgc2VsZWN0ZWQgYnV0dG9ucydcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLmhpZGUoKTtcblxuICAgIC8vaWYgdGhlIGlucHV0IHR5cGUgaGFzIHBvc3NpYmxlIGFuc3dlcnMsIHNob3cgcGFnZXIgaWYgbmVlZGVkXG4gICAgaWYgKCQuaW5BcnJheShncm91cF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSA+IC0xKSB7XG4gICAgICAgIGlmIChncm91cF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZSkge1xuICAgICAgICAgICAgLy9zaG93IHBhZ2luYXRpb25cbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIuaW5pdChncm91cF9pbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnRlYXJEb3duKGdyb3VwX2lucHV0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vc2hvdyBzYXZlL2RlbGV0ZSBidG5zXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZiA9IHJlZjtcblxuICAgIGlmIChncm91cF9pbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgJCgnLnN1bW1lcm5vdGUnKS5zdW1tZXJub3RlKGNvbnN0cy5TVU1NRVJOT1RFX09QVElPTlMpO1xuICAgIH1cblxuICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXRcbiAgICBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZShncm91cF9pbnB1dCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWtleXVwLWNhbGxiYWNrJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xudmFyIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZScpO1xuXG5mdW5jdGlvbiBfZXhpdEJyYW5jaCh0aGVfaW5wdXQpIHtcblxuICAgIHZhciBhY3RpdmVfYnJhbmNoX2lucHV0O1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgYnJhbmNoX3ZhbGlkYXRpb247XG5cbiAgICAvL2lmIHRoZXJlIGlzIGFueSBicmFuY2ggdG8gdmFsaWRhdGUsIGRvIGl0IGJlZm9yZSBleGl0aW5nXG4gICAgaWYgKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICAvL3ZhbGlkYXRlIGN1cnJlbnRseSBhY3RpdmUgYnJhbmNoIGlucHV0IChpbiBjYXNlIHRoZSB1c2VyIGRpZCBub3QgY2xpY2sgdmFsaWRhdGUgaGltc2VsZilcbiAgICAgICAgYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihhY3RpdmVfYnJhbmNoX2lucHV0LCBmYWxzZSk7XG5cbiAgICB9XG4gICAgLy9leGl0XG4gICAgaW5wdXQuZXhpdEJyYW5jaFNvcnRhYmxlKCk7XG59XG5cbmZ1bmN0aW9uIF9leGl0R3JvdXAodGhlX2lucHV0KSB7XG5cbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lucHV0O1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcblxuICAgIC8vaWYgdGhlcmUgaXMgYW55IGdyb3VwIHRvIHZhbGlkYXRlLCBkbyBpdCBiZWZvcmUgZXhpdGluZ1xuICAgIGlmIChmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICAvL3ZhbGlkYXRlIGN1cnJlbnRseSBhY3RpdmUgZ3JvdXAgaW5wdXQgKGluIGNhc2UgdGhlIHVzZXIgZGlkIG5vdCBjbGljayB2YWxpZGF0ZSBoaW1zZWxmKVxuICAgICAgICBhY3RpdmVfZ3JvdXBfaW5wdXQgPSB1dGlscy5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9ncm91cF9pbnB1dCwgZmFsc2UpO1xuXG4gICAgICAgIC8vYnJhbmNoIGlucHV0cyBhcmUgYWxyZWFkeSBhdHRhY2hlZCB0byB0aGUgYnJhbmNoIHByb3BlcnR5IG90IHRoZSBvd25lciBpbnB1dCwganVzdCB2YWxpZGF0ZSB0aGVtXG4gICAgICAgIGlucHV0LnZhbGlkYXRlR3JvdXBJbnB1dHMoKTtcbiAgICB9XG4gICAgLy9leGl0XG4gICAgaW5wdXQuZXhpdEdyb3VwU29ydGFibGUoKTtcbn1cblxuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvL2hhY2sgdG8gcmVtb3ZlIGZvY3VzIGZyb20ganVtcCBzZWxlY3Qgc28gaXQgZ2V0cyByZWZyZXNoZWRcbiAgICB2YXIgJGZvY3VzZWQgPSAkKCc6Zm9jdXMnKTtcbiAgICB2YXIganVtcF9zZWxlY3QgPSAkZm9jdXNlZC5hdHRyKCdkYXRhLWp1bXAtbG9naWMnKTtcbiAgICBpZiAoanVtcF9zZWxlY3QgPT09ICdnb3RvJykge1xuICAgICAgICAkZm9jdXNlZC5ibHVyKCk7XG4gICAgfVxuICAgIC8vZW5kIGhhY2tcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIHZhciBzZWxmID0gJCh0aGlzKTtcbiAgICB2YXIgcHJldmlvdXNfaW5wdXQ7XG4gICAgdmFyIHJlZjtcbiAgICB2YXIgaW5wdXQ7XG4gICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgdmFyIHF1ZXN0aW9uO1xuICAgIHZhciBjb3B5X2J0bl9zdGF0ZTtcbiAgICAvL3ZhciBwYWdlcjtcblxuICAgIC8qXG4gICAgIElmIHdlIGFyZSBlZGl0bmcgYSBuZXN0ZWQgYnJhbmNoICBvciBncm91cCB3ZSBhcmUganVzdCBpbnRlcmVzdGVkIG9uIGEgY2xpY2sgb24gdGhlIGV4aXQgYnV0dG9uXG4gICAgIHRvIGdvIGJhY2sgdG8gdGhlIHBhcmVudCBzb3J0YWJsZVxuICAgICAqL1xuICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCB8fCBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgIC8vd2UgYXJlIGluIGJyYW5jaCBlZGl0IG1vZGUsIGV4aXQgaXMgdGhlIG9ubHkgYWN0aW9uIHdlIG5lZWQgdG8gaW50ZXJjZXB0XG4gICAgICAgIGlmIChzZWxmLmhhc0NsYXNzKCdjaGV2cm9uLWxlZnQnKSkge1xuICAgICAgICAgICAgLy9nZXQgcmVmIGZyb20gcGFyZW50XG4gICAgICAgICAgICByZWYgPSBzZWxmLnBhcmVudHMoKS5lcSgxKS5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKHJlZik7XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIF9leGl0QnJhbmNoKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF9leGl0R3JvdXAoaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuXG4gICAgICAgIC8qXG4gICAgICAgICB3ZSBhcmUgZWRpdGluZyBhIHRvcCBsZXZlbCBzb3J0YWJsZVxuICAgICAgICAgKi9cbiAgICAgICAgcHJldmlvdXNfaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgcmVmID0gc2VsZi5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuICAgICAgICBpbnB1dCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYocmVmKTtcblxuICAgICAgICAvL2VuYWJsZSBzb3J0YWJsZSBvbiBjdXJyZW50IGlucHV0XG4gICAgICAgIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlKGlucHV0KTtcblxuICAgICAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICAgICAgaWYgKHByZXZpb3VzX2lucHV0KSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHByZXZpb3VzX2lucHV0LCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2RlYWN0aXZhdGUgYWxsIGlucHV0cyBpbiBjb2xsZWN0aW9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIC8vYWN0aXZhdGUganVzdCBjdXJyZW50IGNsaWNrZWQgaW5wdXQgaW4gdGhlIGNvbGxlY3Rpb25cbiAgICAgICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgLypcbiAgICAgICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICovXG4gICAgICAgIGlmICghaW5wdXQucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbiA9IHF1ZXN0aW9uLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KHF1ZXN0aW9uLnRydW5jKDIwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChpbnB1dC5xdWVzdGlvbi50cnVuYygyMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy90b2dnbGUgY2hlY2tib3ggZXZlbnRzIGZvciB1bmlxdWVuZXNzIGlmIHRoaXMgaXMgYSBjaGlsZCBmb3JtXG4gICAgLy8gaS5lLiBjaGVja2JveGVzIGJlaGF2ZSBsaWtlIHJhZGlvXG4gICAgaWYgKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCA+IDApIHtcblxuICAgICAgICAvL2RvIG5vdCBhdHRhY2ggdGhpcyBldmVudCBmb3IgYnJhbmNoZXNcbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAvL2dldCBoYW5kbGUgb2YgY3VycmVudCBhY3RpdmUgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgICAgICAgICAgLmRvbVxuICAgICAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgICAgICAgICAgLy9iaW5kIGZ1bmN0aW9uIHRvIG1ha2Ugb25seSBhIHNpbmdsZSBjaGVja2JveCBzZWxlY3RlZCBhdCBhIHRpbWVcbiAgICAgICAgICAgIGlucHV0LmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3VuaXF1ZW5lc3MgaW5wdXQnKVxuICAgICAgICAgICAgICAgIC5vZmYoKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IHRoZSBjdXJyZW50IGNoZWNrL3VuY2tlY2sgc3RhdGUgb2YgdGhlIGNoZWNrYm94IHRoZSB1c2VyIGhhcyBjbGljayB0byByZXN0b3JlIGl0XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Q2hlY2tCb3hTdGF0ZSA9ICQodGhpcykucHJvcCgnY2hlY2tlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vdW5jaGVjayBhbGxcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdW5pcXVlbmVzcycpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vY2hlY2svdW5jaGVjayB0aGUgc2VsZWN0ZWQgb25lIGJhc2VkIG9uIHRoZSBwcmV2aW91cyBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnByb3AoJ2NoZWNrZWQnLCBjdXJyZW50Q2hlY2tCb3hTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vdG9nZ2xlIHRpdGxlIGJhc2Ugb24gbnVtYmVyIG9mIHRpdGxlcyBzZWxlY3RlZCAoYnV0IG9ubHkgaWYgbm90IGNoZWNrZWQpXG4gICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdFJlYWNoZWQoaW5wdXRzKSkge1xuICAgICAgICBpZiAoIWlucHV0LmlzX3RpdGxlKSB7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkRJU0FCTEVEX1NUQVRFLCByZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkVOQUJMRURfU1RBVEUsIHJlZik7XG4gICAgfVxuXG4gICAgLy8vL2lmIGFueSBqdW1wLCByZWZyZXNoIHRoZSBqdW1wcyBzZWxlY3RlZCBkZXN0aW5hdGlvbiBsYWJlbCBhcyBpdCBtaWdodCBoYXZlIGNoYW5nZWQgKGN1cnJlbnQgc2VsZWN0ZWQgaW5wdXQgb25seSlcbiAgICBpZiAoaW5wdXQuanVtcHMubGVuZ3RoID4gMCkge1xuICAgICAgICBqdW1wcy5yZWZyZXNoSW5wdXRKdW1wc0RvbShpbnB1dCwgaW5wdXRzKTtcbiAgICB9XG5cbiAgICAvL3Nob3cgY3VycmVudCBhY3RpdmUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIC8vZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybScpLnJlbW92ZUNsYXNzKCdzaG93bicpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHJlZiArICdcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuXG4gICAgLy8gLy9pZiB0aGUgaW5wdXQgdHlwZSBoYXMgcG9zc2libGUgYW5zd2Vycywgc2hvdyBwYWdlciBpZiBuZWVkZWRcbiAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgLy8gcGFnZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAvLyAgICAuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgLy8gICAgLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyJyk7XG4gICAgICAgIGlmIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZSkge1xuICAgICAgICAgICAgLy9zaG93IHBhZ2luYXRpb25cbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIuaW5pdChpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnRlYXJEb3duKGlucHV0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vc2hvdyBzYXZlL2RlbGV0ZSBidG5zXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vaGlkZSBtZXNzYWdlIGFib3V0IG5vIGlucHV0IHNlbGVjdGVkLCBhcyBpbnB1dCBnZXRzIGZvY3VzXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQuaGlkZSgpO1xuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSByZWY7XG5cbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICQoJy5zdW1tZXJub3RlJykuc3VtbWVybm90ZShjb25zdHMuU1VNTUVSTk9URV9PUFRJT05TKTtcbiAgICB9XG5cbiAgICAvL3RvZ2dsZSBjb3B5IGJ1dHRvblxuICAgIGNvcHlfYnRuX3N0YXRlID0gaW5wdXQuZG9tLmlzX3ZhbGlkID8gY29uc3RzLkJUTl9FTkFCTEVEIDogY29uc3RzLkJUTl9ESVNBQkxFRDtcbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUNvcHlJbnB1dEJ1dHRvbihpbnB1dC5yZWYsIGNvcHlfYnRuX3N0YXRlKTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG5cbiAgICBjb25zb2xlLmxvZyhlLnRhcmdldCk7XG4gICAgY29uc29sZS5sb2coJCh0aGlzKSk7XG5cbiAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG5cbiAgICAvL2dldCBzZWxlY3RlZCBpbml0aWFsIGFuc3dlclxuICAgIHZhciBpbml0aWFsX2Fuc3dlciA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCcpXG4gICAgICAgIC5maW5kKCdzZWxlY3QnKS5maW5kKCc6c2VsZWN0ZWQnKTtcblxuICAgIGNvbnNvbGUubG9nKGluaXRpYWxfYW5zd2VyKTtcblxuICAgIGlmIChpbml0aWFsX2Fuc3dlci52YWwoKSA9PT0gaW5wdXQuZGVmYXVsdCAmJiBpbnB1dC5kZWZhdWx0ICE9PSAnJykge1xuICAgICAgICBpbml0aWFsX2Fuc3dlci50ZXh0KHV0aWxzLmdldFBvc3NpYmxlQW5zd2VyTGFiZWwoaW5wdXQpKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhpbnB1dCk7XG4gICAgY29uc29sZS5sb2coJ3JlZnJlc2ggaW5pdGlhbCBhbnN3ZXInKTtcblxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgdmFyIG93bmVyX2JyYW5jaDtcblxuICAgIC8vaXMgZWRpdGluZyBhIGJyYW5jaD9cbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgLy9vdmVycmlkZSBpbnB1dCB0byBiZSB0aGUgYnJhbmNoIGlucHV0XG4gICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuXG4gICAgICAgIC8vaGFuZGxlIG5lc3RlZCBncm91cCBpbnNpZGUgYSBicmFuY2hcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIG93bmVyX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL2lzIGVkaXRpbmcgYSBncm91cD9cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vb3ZlcnJpZGUgaW5wdXQgdG8gYmUgdGhlIGJyYW5jaCBpbnB1dFxuICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCQodGhpcykuYXR0cignZGF0YS1qdW1wLWxvZ2ljJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2l0IGlzIGEganVtcCcpO1xuICAgIH1cblxuICAgIGlmICgkKHRoaXMpLmF0dHIoJ2RhdGEtaW5pdGlhbC1hbnN3ZXInKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnbXVsdGkgc2VsZWN0Jyk7XG4gICAgICAgIGlucHV0LnVwZGF0ZVBvc3NpYmxlSW5pdGlhbEFuc3dlcnMoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciwgRmlsZSwgc2F2ZUFzKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBpbnB1dF9kdXBsaWNhdG9yID0gcmVxdWlyZSgnYWN0aW9ucy9pbnB1dC1kdXBsaWNhdG9yJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcblxuLypcbiBoYW5kbGUgY2xpY2sgYWN0aW9uIG9uIGlucHV0IHByb3BlcnRpZXMgcGFuZWwgaW4gdGhlIHJpZ2h0IHNpZGViYXIgKHVzZSBldmVudCBkZWxlZ2F0aW9uKVxuIHdlIGNoZWNrIHRoZSBjbGFzcyBvZiB0aGUgdGFyZ2V0IGVsZW1lbnQgdG8gdHJpZ2dlciB0aGUgcHJvcGVyIGFjdGlvblxuICovXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgY29uc29sZS5sb2coJ3Byb3BlcnRpZXMgcGFuZWwgY2xpY2tlZC4nKTtcblxuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSByZXF1aXJlKCdhY3Rpb25zL3Bvc3NpYmxlLWFuc3dlcnMnKTtcbiAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuICAgIC8vZ2V0IGhvbGQgb2YgdGhlIGN1cnJlbnQgYWN0aXZlIGlucHV0IGluIHRoZSBpbnB1dCBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgIHZhciBpbnB1dCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgIHZhciBmaXJzdF9pbnB1dF9yZWY7XG4gICAgdmFyIG5lc3RlZF9ncm91cDtcbiAgICB2YXIgb3duZXJfYnJhbmNoO1xuICAgIC8vZ2V0IGhvbGQgb2YgdGFwcGVkIGVsZW1lbnQgZG9tIGVsZW1lbnRcbiAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKTtcbiAgICB2YXIgY3N2O1xuICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcblxuICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcblxuICAgIGZ1bmN0aW9uIF9nZXRJbnB1dCgpIHtcblxuICAgICAgICAvL2NoZWNrIHdoZXRoZXIgd2UgYXJlIHZhbGlkYXRpbiBhIG5lc3RlZCBpbnB1dCBpLmUuIEJPVEggYnJhbmNoIEFORCBncm91cCBlZGl0IGZsYWdzIGFyZSB0cnVlXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL2dldCBuZXN0ZWQgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgIG93bmVyX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgYnJhbmNoIGlucHV0XG4gICAgICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3ZhbGlkYXRlQnJhbmNoKCkge1xuXG4gICAgICAgIC8vY2hlY2sgdGhlIGJyYW5jaCBoYXMgZ290IGF0IGxlYXN0IDEgaW5wdXQgbGVmdFxuXG4gICAgICAgIHZhciBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuXG4gICAgICAgIGlmIChhY3RpdmVfYnJhbmNoLmJyYW5jaC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9icmFuY2guYnJhbmNoWzBdLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2ludmFsaWQgdGhlIGZvcm0gYXMgaXQgZG9lcyBub3QgaGF2ZSBhbnkgaW5wdXRzXG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5zYXZlX3Byb2plY3RfYnRuLm9mZignY2xpY2snKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIF92YWxpZGF0ZUZvcm0oKSB7XG5cbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG5cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZpcnN0X2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzWzBdLnJlZjtcbiAgICAgICAgICAgIGlmIChmaXJzdF9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZmlyc3RfaW5wdXRfcmVmKSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9pbnZhbGlkIHRoZSBmb3JtIGFzIGl0IGRvZXMgbm90IGhhdmUgYW55IGlucHV0c1xuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9ESVNBQkxFRCk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoJ2NsaWNrJyk7XG5cbiAgICAgICAgICAgIC8vYWRkIG5vIHF1ZXN0aW9uIG1lc3NhZ2VcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2dldCBob2xkIG9mIGFkdmFuY2VkIHByb3BlcnRpZXMgcGFuZWwgZm9yIHRoaXMgaW5wdXRcbiAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBSZW1vdmUgc2VsZWN0ZWQgaW5wdXRcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fYnV0dG9ucy0tcmVtb3ZlLWlucHV0JykpIHtcblxuICAgICAgICB2YXIgZGVsZXRlUXVlc3Rpb24gID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvL3JlLWVuYWJsZSBkcmFnZ2FibGUgaWYgbmVlZGVkXG4gICAgICAgICAgICBpZiAoJCgndWwjaW5wdXRzLXRvb2xzLWxpc3QgbGkgZGl2LmlucHV0JykuaGFzQ2xhc3MoJ2RyYWdnaW5nLWRpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5lbmFibGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvblxuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG5cbiAgICAgICAgICAgIC8vY2hlY2sgd2hldGhlciB3ZSBhcmUgdmFsaWRhdGluIGEgbmVzdGVkIGlucHV0IGkuZS4gQk9USCBicmFuY2ggQU5EIGdyb3VwIGVkaXQgZmxhZ3MgYXJlIHRydWVcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgICAgICBpbnB1dF9mYWN0b3J5LnJlbW92ZU5lc3RlZEdyb3VwSW5wdXQoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmLCBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcobWVzc2FnZXMud2FybmluZy5JTlBVVF9ERUxFVEVEKTtcbiAgICAgICAgICAgICAgICBfdmFsaWRhdGVGb3JtKCk7XG4gICAgICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGRlbGV0aW5nIGlucHV0KVxuICAgICAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIC8vbmVzdGVkIGdyb3VwP1xuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdG8gaGFuZGxlIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9mYWN0b3J5LnJlbW92ZUJyYW5jaElucHV0KGlucHV0LnJlZiwgZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2VzLndhcm5pbmcuSU5QVVRfREVMRVRFRCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcnVuIHZhbGlkYXRpb24gYXMgSSBtaWdodCBoYXZlIGRlbGV0ZWQgdGhlIG9ubHkgaW52YWxpZCBpbnB1dCBmb3IgdGhlIGJyYW5jaFxuICAgICAgICAgICAgICAgICAgICAgICAgLy9zaW5jZSB0aGVyZSBpcyBub3QgYSBwcmV2aW91cyBvbmUsIHNvIGl0IHVzZXMgdGhlIGZpcnN0IGlucHV0IG9mIHRoZSB0b3AgcGFyZW50IGZvcm0gKGlmIGFueSkganVzdCB0byB0cmlnZ2VyIHRoZSB2YWxpZGF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBfdmFsaWRhdGVCcmFuY2goKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGRlbGV0aW5nIGlucHV0KVxuICAgICAgICAgICAgICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9mYWN0b3J5LnJlbW92ZUdyb3VwSW5wdXQoaW5wdXQucmVmLCBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZyhtZXNzYWdlcy53YXJuaW5nLklOUFVUX0RFTEVURUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGRlbGV0aW5nIGlucHV0KVxuICAgICAgICAgICAgICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGlucHV0IGZyb20gaW5wdXQgY29sbGVjdGlvbiAoYWxzbyByZW1vdmUgaXRzIHByb3BlcnRpZXMpXG4gICAgICAgICAgICAgICAgaW5wdXRfZmFjdG9yeS5yZW1vdmVJbnB1dChpbnB1dC5yZWYpO1xuICAgICAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2VzLndhcm5pbmcuSU5QVVRfREVMRVRFRCk7XG5cbiAgICAgICAgICAgICAgICAvL3RvZG8gSSBuZWVkIHRvIGRvIHRoZSBzYW1lIGZvciBicmFuY2hlcywgZ3JvdXBzIGFuZCBuZXN0ZWQgZ3JvdXBzXG4gICAgICAgICAgICAgICAgLy9ydW4gdmFsaWRhdGlvbiBhcyBJIG1pZ2h0IGhhdmUgZGVsZXRlZCB0aGUgb25seSBpbnZhbGlkIGlucHV0XG4gICAgICAgICAgICAgICAgLy90aGVyZSBpcyBub3QgYSBwcmV2aW91cyBvbmUsIHNvIGl0IHVzZXMgdGhlIGZpcnN0IGlucHV0IG9mIHRoZSB0b3AgcGFyZW50IGZvcm0gKGlmIGFueSlcbiAgICAgICAgICAgICAgICBfdmFsaWRhdGVGb3JtKCk7XG4gICAgICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGRlbGV0aW5nIGlucHV0KVxuICAgICAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgICAgICAgICAvL3Nob3cgbWVzc2FnZSBhbmQgaW1wb3J0IGJ1dHRvbiB3aGVuIG5vIGlucHV0cyBsZWZ0XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBubyBxdWVzdGlvbnMgbWVzc2FnZSBhbmQgdXBsb2FkIGJ1dHRvbiwgYXMgbm93IHdlIGhhdmUgYXQgbGVhc3QgMSBpbnB1dFxuICAgICAgICAgICAgICAgIC8vdG9kbyBhdm9pZCB0byB0byB0aGlzIGFsbCB0aGUgdGltZT9cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZhZGVJbigpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vaGlkZSB0aXRsZSB3YXJuaW5nIG1lc3NhZ2UsIHBhc3NpbmcgYSBjb3VudCA+IDFcbiAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDEsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2Rpc2FibGUgZG93bmxvYWQgZm9ybSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZGlzYWJsZSBwcmludCBhcyBwZGYgZm9ybSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFNob3cgdGhlIHdhcm5pbmcgbW9kYWxcbiAgICAgICAgdmFyIHRvdGFsRW50cmllcyA9IHBhcnNlSW50KCQoJy50b3RhbC1lbnRyaWVzJykuZGF0YSgndG90YWwtZW50cmllcycpLCAxMCkgfHwgMDtcbiAgICAgICAgaWYodG90YWxFbnRyaWVzID4gMCkge1xuICAgICAgICAgICAgJCgnI3dhcm5pbmctZGVsZXRlLXF1ZXN0aW9uJykubW9kYWwoJ3Nob3cnKTtcbiAgICAgICAgICAgICQoJy5idG4tY29uZmlybS1kZWxldGUtcXVlc3Rpb24nKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoJyN3YXJuaW5nLWRlbGV0ZS1xdWVzdGlvbicpLm1vZGFsKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgZGVsZXRlUXVlc3Rpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBkZWxldGVRdWVzdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIENvcHkgc2VsZWN0ZWQgaW5wdXRcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fYnV0dG9ucy0tY29weS1pbnB1dCcpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjb3B5aW5nIGlucHV0ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKicpO1xuXG4gICAgICAgIHZhciBpbnB1dF9jb3BpZWQ7XG4gICAgICAgIHZhciBzZWFyY2hfaW5wdXRzX3RvdGFsID0gdXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKTtcblxuICAgICAgICBpbnB1dCA9IF9nZXRJbnB1dCgpO1xuXG4gICAgICAgIC8vaWYgdGhlIGlucHV0IGlzIG5vdCB2YWxpZCwgcmVqZWN0IGNvcHkgYWN0aW9uXG4gICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuSU5QVVRfTk9UX1ZBTElEKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaWYgd2UgcmVhY2hlZCB0aGUgbWF4IG51bWJlciBvZiBxdWVzdGlvbnMgZm9yIHRoaXMgZm9ybSwgYmFpbCBvdXRcbiAgICAgICAgaWYgKHV0aWxzLmdldElucHV0c1RvdGFsKGlucHV0cykgPj0gY29uc3RzLklOUFVUU19NQVhfQUxMT1dFRCkge1xuICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLk1BWF9RVUVTVElPTlNfTElNSVRfUkVBQ0hFRCArICcgKCcgKyBjb25zdHMuSU5QVVRTX01BWF9BTExPV0VEICsgJyknKTtcbiAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmRpc2FibGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaWYgdGhlIGlucHV0IGlzIG9mIHR5cGUgc2VhcmNoIGFuZCB3ZSByZWFjaGVkIHRoZSBsaW1pdCBhbHJlYWR5LCBiYWlsIG91dFxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcblxuICAgICAgICAgICAgLy93YXJuIHRoZSB1c2VyIGlmIGxpbWl0IHdhcyByZWFjaGVkXG4gICAgICAgICAgICBpZiAoc2VhcmNoX2lucHV0c190b3RhbCA9PT0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCkge1xuICAgICAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy53YXJuaW5nLlNFQVJDSF9JTlBVVFNfTElNSVRfUkVBQ0hFRCArICcoJyArIGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggKyAnKScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vaWYgd2UgYXJlIHJlYWNoaW5nIHRoZSBzZWFyY2ggaW5wdXQgbGltaXRzIHdpdGggdGhpcyBjb3B5LCBoaWRlIHNlYXJjaCBxdWVzdGlvbiB0b29sXG4gICAgICAgICAgICBpZiAoc2VhcmNoX2lucHV0c190b3RhbCA9PT0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCAtIDEpIHtcbiAgICAgICAgICAgICAgICAvL2hpZGUgc2VhcmNoIGlucHV0IGZyb20gcXVlc3Rpb24gbGlzdFxuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IG92ZXJsYXlcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKCk7XG5cbiAgICAgICAgLy9nZXQgY29weSBpZiBvcmlnaW5hbCBpbnB1dFxuICAgICAgICBpbnB1dF9jb3BpZWQgPSBpbnB1dF9kdXBsaWNhdG9yLmNyZWF0ZUlucHV0Q29weShpbnB1dCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ29yaWdpbmFsIGlucHV0Jywgd2luZG93LkNpcmN1bGFySlNPTi5zdHJpbmdpZnkoaW5wdXQpKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnaW5wdXRfY29waWVkJywgd2luZG93LkNpcmN1bGFySlNPTi5zdHJpbmdpZnkoaW5wdXRfY29waWVkKSk7XG5cbiAgICAgICAgLy9hZGQgY29waWVkIGlucHV0IHRvIHByb2plY3QgZGVmaW5pdGlvblxuICAgICAgICBpbnB1dF9kdXBsaWNhdG9yLnB1c2hJbnB1dChpbnB1dF9jb3BpZWQpO1xuXG4gICAgICAgIC8vYXBwZW5kIHRoZSBjb3BpZWQgaW5wdXQgbWFya3VwXG4gICAgICAgIGlucHV0X2R1cGxpY2F0b3IuYXBwZW5kSW5wdXRUb0RvbShpbnB1dF9jb3BpZWQpO1xuXG4gICAgICAgIC8qKiBpbXA6XG4gICAgICAgICAqIEFmdGVyIHRoZSBpbnB1dCBpcyBjb3BpZWQgd2hlbiBlZGl0aW5nIGEgYnJhbmNoLCB3ZSBjaGVjayB0aGUgZm9ybWJ1aWxkZXIgY3VycmVudCByZWZcbiAgICAgICAgICogSWYgdGhlIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmIGlzIG5vdCByZWZlcmVuY2luZyB0aGUgYnJhbmNoXG4gICAgICAgICAqIGJ1dGggdGhlIGlubmVyIGJyYW5jaCBpbnB1dCB3ZSByZXNldCBpdCB0byByZWZlcmVuY2UgdGhlIGFjdGl2ZSBicmFuY2hcbiAgICAgICAgICovXG4gICAgICAgIC8vSEFDSzpcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICB2YXIgb3duZXJfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIGlmIChvd25lcl9pbnB1dF9pbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgb3duZXJfaW5wdXRfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy9lbmQgSEFDSzpcblxuXG5cbiAgICAgICAgLy9oaWRlIG92ZXJsYXkgKHdpdGggZGVsYXkpXG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNULCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvd1N1Y2Nlc3MobWVzc2FnZXMuc3VjY2Vzcy5JTlBVVF9DT1BJRUQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU0xPVyk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIFZhbGlkYXRlIHNlbGVjdGVkIGlucHV0XG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2J1dHRvbnMtLXZhbGlkYXRlLWlucHV0JykpIHtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihfZ2V0SW5wdXQoKSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIEFkZCBwb3NzaWJsZSBhbnN3ZXJcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fYWRkLWFuc3dlcicpKSB7XG5cbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbWF4ID0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heDtcblxuICAgICAgICBpbnB1dCA9IF9nZXRJbnB1dCgpO1xuXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19tYXggPSBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4X3NlYXJjaDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYWRkIHBvc3NpYmxlIGFuc3dlciAoaWYgdG90YWwgaXMgbGVzcyB0aGFuIG1heCBhbGxvd2VkKVxuICAgICAgICBpZiAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPCBwb3NzaWJsZV9hbnN3ZXJzX21heCkge1xuICAgICAgICAgICAgaW5wdXQuYWRkUG9zc2libGVBbnN3ZXIoKTtcbiAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICogUmVtb3ZlIHBvc3NpYmxlIGFuc3dlclxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0X19yZW1vdmUtYW5zd2VyJykpIHtcblxuICAgICAgICBpbnB1dCA9IF9nZXRJbnB1dCgpO1xuXG4gICAgICAgIC8vd2UgbmVlZCB0byBsZWF2ZSBhdCBsZWFzdCAxIHBvc3NpYmxlIGFuc3dlclxuICAgICAgICBpZiAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPj0gMikge1xuICAgICAgICAgICAgaW5wdXQucmVtb3ZlUG9zc2libGVBbnN3ZXIodGFyZ2V0LmNsb3Nlc3QoJ2xpJykuaW5kZXgoKSk7XG4gICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIEFkZCBqdW1wIHRvIHNlbGVjdGVkIGlucHV0XG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19hZGQtanVtcCcpKSB7XG5cbiAgICAgICAgaW5wdXQgPSBfZ2V0SW5wdXQoKTtcblxuICAgICAgICAvL2Rpc2FibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBhcyB0aGUgbmV3IGFkZGVkIGp1bXAgbWFrZXMgdGhlIGlucHV0IGludmFsaWRcbiAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuXG4gICAgICAgIC8vc2V0IGlucHV0IGFzIGludmFsaWRcbiAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAgICAgLy9mbGFnIGlucHV0IGRvbSBpbiBpbnB1dCBjb2xsZWN0aW9uIGFzIGludmFsaWRcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oaW5wdXQucmVmKTtcblxuICAgICAgICAvL2ZsYWcgY3VycmVudCBmb3JtIGFzIGludmFsaWRcbiAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgaW5wdXQuYWRkSnVtcCgpO1xuICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBSZW1vdmUgc2VsZWN0ZWQganVtcFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fcmVtb3ZlLWp1bXAnKSkge1xuXG4gICAgICAgIGlucHV0ID0gX2dldElucHV0KCk7XG5cbiAgICAgICAgaW5wdXQucmVtb3ZlSnVtcCh0YXJnZXQpO1xuXG4gICAgICAgIC8vcmV2YWxpZGF0ZSBpbnB1dCBhZnRlciBkZWxldGluZyBhIGp1bXAgYXMgdGhlIGp1bXAgbWlnaHQgaGF2ZSBiZWVuIHRoZSBvbmx5IHRoaW5nIGtlZXBpbmcgaXQgaW52YWxpZFxuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGlucHV0LCBmYWxzZSk7XG4gICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIEVkaXQgYnJhbmNoXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2VkaXQtYnJhbmNoJykpIHtcbiAgICAgICAgdGFyZ2V0LmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgaW5wdXQuZW50ZXJCcmFuY2hTb3J0YWJsZSgpO1xuICAgIH1cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19leGl0LWJyYW5jaC1lZGl0aW5nJykpIHtcbiAgICAgICAgdGFyZ2V0LmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIHRhcmdldC5wcmV2KCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZWRpdC1icmFuY2gnKS5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgaW5wdXQuZXhpdEJyYW5jaFNvcnRhYmxlKCk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIEVkaXQgZ3JvdXBcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZWRpdC1ncm91cCcpKSB7XG4gICAgICAgIHRhcmdldC5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuXG4gICAgICAgIC8vY2hlY2sgd2hldGhlciB3ZSBhcmUgZWRpdGluZyBhIGdyb3VwIG5lc3RlZCBpbnRvIGEgYnJhbmNoXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICBuZXN0ZWRfZ3JvdXAgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG5cbiAgICAgICAgICAgIGlmIChuZXN0ZWRfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL3VzZXIgY2xpY2tlZCBvbiBlZGl0IG5lc3RlZCBncm91cCBidXR0b25cbiAgICAgICAgICAgICAgICBpbnB1dCA9IG5lc3RlZF9ncm91cDtcbiAgICAgICAgICAgICAgICBpbnB1dC5lbnRlckdyb3VwU29ydGFibGUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnB1dC5lbnRlckdyb3VwU29ydGFibGUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXhpdC1ncm91cC1lZGl0aW5nJykpIHtcbiAgICAgICAgdGFyZ2V0LmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIHRhcmdldC5wcmV2KCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZWRpdC1icmFuY2gnKS5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgICAgICAvL2NoZWNrIHdoZXRoZXIgd2UgYXJlIGVkaXRpbmcgYSBncm91cCBuZXN0ZWQgaW50byBhIGJyYW5jaFxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgIG5lc3RlZF9ncm91cCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcblxuICAgICAgICAgICAgaWYgKG5lc3RlZF9ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vdXNlciBjbGlja2VkIG9uIGVkaXQgbmVzdGVkIGdyb3VwIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlucHV0ID0gbmVzdGVkX2dyb3VwO1xuICAgICAgICAgICAgICAgIGlucHV0LmV4aXRHcm91cFNvcnRhYmxlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5wdXQuZXhpdEdyb3VwU29ydGFibGUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygncG9zc2libGVfYW5zd2Vyc19fZXhwb3J0LWNzdicpKSB7XG5cbiAgICAgICAgLy9zaG93IG92ZXJsYXkgYW5kIGN1cnNvclxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlSW4oMCk7XG5cbiAgICAgICAgY3N2ID0gcG9zc2libGVfYW5zd2Vycy5leHBvcnRQb3NzaWJsZUFuc3dlcnNDU1YoKTtcblxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgICAgIGlmIChjc3YpIHtcbiAgICAgICAgICAgICAgICAvL2RvIGV4cG9ydFxuICAgICAgICAgICAgICAgIHZhciBmaWxlO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG5ldyBGaWxlKFtjc3YuZGF0YV0sIGNzdi5maWxlbmFtZSwgeyB0eXBlOiAndGV4dC9wbGFpbjpjaGFyc2V0PXV0Zi04JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2F2ZUFzKGZpbGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9NaWNyb3NvZnQgYnJvd3NlcnM/XG4gICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubmF2aWdhdG9yLm1zU2F2ZUJsb2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cubmF2aWdhdG9yLm1zU2F2ZUJsb2IobmV3IHdpbmRvdy5CbG9iKFtjc3YuZGF0YV0sIHsgdHlwZTogJ3RleHQvcGxhaW46Y2hhcnNldD11dGYtOCcgfSksIGNzdi5maWxlbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Jyb3dzZXIgbm90IHN1cHBvcnRlZCB5ZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5CUk9XU0VSX05PVF9TVVBQT1JURUQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9zaG93IGVycm9yXG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUlNfSU5WQUxJRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU1VQRVJfU0xPVyk7XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygncG9zc2libGVfYW5zd2Vyc19faW1wb3J0LWNzdicpKSB7XG5cbiAgICAgICAgLy9pbXBvcnQgZmlsZSBmaXJzdCB0aGVuIHNob3cgbW9kYWwgdG8gcGljayB3aGljaCBjb2x1bW4gKGlmIG1vcmUgdGhhbiBvbmUpXG4gICAgICAgIC8vdG9kbyBub3QgdXNlIHdpbmRvdywgdXNlIGZvcm1idWlsZGVyIG9iamVjdFxuICAgICAgICBpZiAoIWZvcm1idWlsZGVyLmlzT3BlbmluZ0ZpbGVCcm93c2VyKSB7XG5cbiAgICAgICAgICAgIHZhciBmaWxlX2lucHV0ID0gdGFyZ2V0LmZpbmQoJy5wb3NzaWJsZV9hbnN3ZXJzX19pbXBvcnQtY3N2LWlucHV0LWZpbGUnKTtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNPcGVuaW5nRmlsZUJyb3dzZXIgPSB0cnVlO1xuXG4gICAgICAgICAgICBmaWxlX2lucHV0Lm9mZignY2hhbmdlJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzLmltcG9ydENTVkZpbGUodGhpcy5maWxlcyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS52YWwobnVsbCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5wb3NzaWJsZV9hbnN3ZXJzX19pbXBvcnQtY3N2LWlucHV0LWZpbGUnKS50cmlnZ2VyKCdjbGljaycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy90byBhdm9pZCBhIGluZmludGUgbG9vcCAoc2luY2Ugd2UgYXJlIHRyaWdnZXJpbmcgdGhlIGNsaWNrIGV2ZW50KVxuICAgICAgICAvL3dlIHJlbW92ZSB0aGUgZmxhZyBsYXRlciwgdG8gYmUgYWJsZSB0byB1cGxvYWQgYW5vdGhlciBmaWxlXG4gICAgICAgIC8vZXZlbiBpZiB0aGUgdXNlciB0YXBwZWQgb24gXCJjYW5jZWxcIlxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5pc09wZW5pbmdGaWxlQnJvd3NlciA9IGZhbHNlO1xuICAgICAgICB9LCAzMDAwKTtcblxuICAgIH1cblxuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ3Bvc3NpYmxlX2Fuc3dlcnNfX2RlbGV0ZS1hbGwnKSkge1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzLmRlbGV0ZUFsbEFuc3dlcnMoKTtcbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdwb3NzaWJsZV9hbnN3ZXJzX19vcmRlci1heicpKSB7XG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMub3JkZXJQb3NzaWJsZUFuc3dlcnMoY29uc3RzLlBPU1NJQkxFX0FOU1dFUlNfT1JERVIuQVopO1xuICAgIH1cblxuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ3Bvc3NpYmxlX2Fuc3dlcnNfX29yZGVyLXphJykpIHtcbiAgICAgICAgcG9zc2libGVfYW5zd2Vycy5vcmRlclBvc3NpYmxlQW5zd2Vycyhjb25zdHMuUE9TU0lCTEVfQU5TV0VSU19PUkRFUi5aQSk7XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygncG9zc2libGVfYW5zd2Vyc19fb3JkZXItc2h1ZmZsZScpKSB7XG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMub3JkZXJQb3NzaWJsZUFuc3dlcnMoY29uc3RzLlBPU1NJQkxFX0FOU1dFUlNfT1JERVIuU0hVRkZMRSk7XG4gICAgfVxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGUpIHtcblxuICAgIHZhciBpbnB1dCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucztcbiAgICB2YXIgb3duZXJfYnJhbmNoO1xuXG4gICAgLy9pcyBlZGl0aW5nIGEgYnJhbmNoP1xuICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAvL292ZXJyaWRlIGlucHV0cywgZ2V0IGJyYW5jaCBpbnB1dHMgZnJvbSBvd25lciBpbnB1dFxuICAgICAgICBpbnB1dHMgPSBpbnB1dC5icmFuY2g7XG4gICAgICAgIC8vb3ZlcnJpZGUgaW5wdXQgdG8gYmUgdGhlIGJyYW5jaCBpbnB1dFxuICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcblxuICAgICAgICAvL2hhbmRsZSBuZXN0ZWQgZ3JvdXAgaW5zaWRlIGEgYnJhbmNoXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICBpbnB1dHMgPSBpbnB1dC5ncm91cDtcbiAgICAgICAgICAgIG93bmVyX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL2lzIGVkaXRpbmcgYSBncm91cD9cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vb3ZlcnJpZGUgaW5wdXRzLCBnZXQgZ3JvdXAgaW5wdXRzIGZyb20gb3duZXIgaW5wdXRcbiAgICAgICAgICAgIGlucHV0cyA9IGlucHV0Lmdyb3VwO1xuICAgICAgICAgICAgLy9vdmVycmlkZSBpbnB1dCB0byBiZSB0aGUgYnJhbmNoIGlucHV0XG4gICAgICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2dldCBhbGwganVtcHMgYXZhaWxhYmxlXG4gICAganVtcF9kZXN0aW5hdGlvbnMgPSB1dGlscy5nZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zKGlucHV0LCBpbnB1dHMpO1xuXG4gICAgLy9jaGVjayBpZiB0aGUgPHNlbGVjdD4gaXMgZWl0aGVyIGEganVtcCBsb2dpYyBvciBhIG11bHRpcGxlIGNob2ljZSBpbnB1dFxuICAgIGlmICgkKHRoaXMpLmF0dHIoJ2RhdGEtanVtcC1sb2dpYycpKSB7XG5cbiAgICAgICAgdmFyIGZvY3VzZWRfc2VsZWN0ID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIGZvY3VzZWRfc2VsZWN0X2lkID0gZm9jdXNlZF9zZWxlY3QuYXR0cignaWQnKTtcblxuICAgICAgICAvL3NwbGl0IG9uIHRoZSBkYXNoIHRvIHJlbW92ZSB0aGUgZmlyc3QgcGFydCBvZiBcImZvY3VzZWRfc2VsZWN0X2lkXCIgYXMgaXQgY2FuXG4gICAgICAgIC8vYmUgMS0sIDItLCAxMS0sIDQ1LS4uLi4gc286XG4gICAgICAgIHZhciBmb2N1c2VkX3NlbGVjdF9pZF9wYXJ0cyA9IGZvY3VzZWRfc2VsZWN0X2lkLnNwbGl0KCctJyk7XG4gICAgICAgIGZvY3VzZWRfc2VsZWN0X2lkX3BhcnRzLnNoaWZ0KCk7XG4gICAgICAgIGZvY3VzZWRfc2VsZWN0X2lkID0gZm9jdXNlZF9zZWxlY3RfaWRfcGFydHMuam9pbignLScpO1xuICAgICAgICAvL3RvZG8gdGhlIGFib3ZlIGlzIGZhc3RlciB3aXRoIGEgcmVnZXgsIHdoZW4gdGhlcmUgaXMgdGltZS4uLlxuXG4gICAgICAgIHN3aXRjaCAoZm9jdXNlZF9zZWxlY3RfaWQpIHtcblxuICAgICAgICAgICAgLy9mb3Igb3BlbiBhbnN3ZXIgaW5wdXQgdHlwZSBsaWtlICAndGV4dCcsIHRoaXMgd2lsbCBiZSBzZXQgdG8gJ2Fsd2F5cydcbiAgICAgICAgICAgIGNhc2UgaW5wdXQucmVmICsgJy1sb2dpYy13aGVuJzpcbiAgICAgICAgICAgICAgICAvL2xpc3QgYWwgdGhlIGF2YWlsYWJsZSBjb25kaXRpb25zXG4gICAgICAgICAgICAgICAganVtcHMubGlzdEp1bXBDb25kaXRpb25zKGZvY3VzZWRfc2VsZWN0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgZ2V0IGFsbCBwb3NzaWJsZSBhbnN3ZXJzIGZvciBjdXJyZW50IGlucHV0IGFuZCBsaXN0IHRoZW0gYXMgb3B0aW9uc1xuICAgICAgICAgICAgIChmb3Igb3BlbiBhbnN3ZXIgaW5wdXQgdHlwZSBsaWtlICAndGV4dCcsIHRoaXMgd2lsbCBiZSBoaWRkZW4pXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNhc2UgaW5wdXQucmVmICsgJy1sb2dpYy1hbnN3ZXInOlxuICAgICAgICAgICAgICAgIGp1bXBzLmxpc3RKdW1wUG9zc2libGVBbnN3ZXJzKGZvY3VzZWRfc2VsZWN0LCBpbnB1dCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vZ2V0IGFsbCBwb3NzaWJsZSBqdW1wIGRlc3RpbmF0aW9ucyBmb3IgY3VycmVudCBpbnB1dCBhbmQgbGlzdCB0aGVtIGFzIG9wdGlvbnNcbiAgICAgICAgICAgIGNhc2UgaW5wdXQucmVmICsgJy1sb2dpYy1nb3RvJzpcbiAgICAgICAgICAgICAgICBqdW1wcy5saXN0SnVtcERlc3RpbmF0aW9ucyhmb2N1c2VkX3NlbGVjdCwganVtcF9kZXN0aW5hdGlvbnMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnB1dC5saXN0UG9zc2libGVJbml0aWFsQW5zd2VycygpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGUpIHtcblxuICAgIC8vaWdub3JlIGxlZnQgYW5kIHJpZ2h0IGFycm93IGtleWJvYXJkIGtleXMgKG90aGVyd2lzZSB0aGUgdXNlciBjYW5ub3QgZWRpdCBhIHN0cmluZylcbiAgICAvL2Zyb20gdGhlIGRvY3M6XG4gICAgLy8gVGhlIGV2ZW50LndoaWNoIHByb3BlcnR5IG5vcm1hbGl6ZXMgZXZlbnQua2V5Q29kZSBhbmQgZXZlbnQuY2hhckNvZGUuXG4gICAgLy8gSXQgaXMgcmVjb21tZW5kZWQgdG8gd2F0Y2ggZXZlbnQud2hpY2ggZm9yIGtleWJvYXJkIGtleSBpbnB1dC5cbiAgICBpZiAoZS53aGljaCA9PT0gMzcgfHwgZS53aGljaCA9PT0gMzkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBpbnB1dDtcbiAgICB2YXIgaW5wdXRfcXVlc3Rpb25fdmFsaWRhdGlvbjtcbiAgICB2YXIgcG9zc2libGVfYW5zd2VyX3ZhbGlkYXRpb247XG4gICAgdmFyIHRhcmdldCA9ICQodGhpcyk7XG4gICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTsvL2l0IGlzIGhlcmUgb3RoZXJ3aXNlIGl0IGJyZWFrcyB3aGVuIGNvbXBpbGluZy4uLmdvIGZpZ3VyZT8/XG4gICAgLy8gQ2FwdHVyZSBpbml0aWFsIGN1cnNvciBwb3NpdGlvbiwgYXMgd2UgYXJlIHJlcGxhY2luZyB0aGUgaW5wdXQgdmFsdWUgb24ga2V5dXAsIHRvIGF2b2lkIHRoZSBjdXJzb3IgZ28gdG8gdGhlIGVuZCBvZiB0aGUgc3RyaW5nXG4gICAgdmFyIHBvc2l0aW9uID0gdGFyZ2V0WzBdLnNlbGVjdGlvblN0YXJ0O1xuXG4gICAgZnVuY3Rpb24gX2lucHV0SXNWYWxpZCgpIHtcblxuICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSB0cnVlO1xuXG4gICAgICAgIC8vdmFsaWRhdGUgaW5wdXQgdG8gcmVmcmVzaCBkb21cbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihpbnB1dCwgZmFsc2UpO1xuXG4gICAgICAgIHRhcmdldFswXS5zZWxlY3Rpb25FbmQgPSBwb3NpdGlvbjsgICAgLy8gU2V0IHRoZSBjdXJzb3IgYmFjayB0byB0aGUgaW5pdGlhbCBwb3NpdGlvbi5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfZ2V0SW5wdXQoKSB7XG5cbiAgICAgICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIHZhciBjdXJyZW50X2JyYW5jaDtcblxuICAgICAgICAvL2NoZWNrIHdoZXRoZXIgd2UgYXJlIHZhbGlkYXRpbiBhIG5lc3RlZCBpbnB1dCBpLmUuIEJPVEggYnJhbmNoIEFORCBncm91cCBlZGl0IGZsYWdzIGFyZSB0cnVlXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IG93bmVyIGJyYW5jaFxuICAgICAgICAgICAgY3VycmVudF9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG5cbiAgICAgICAgICAgIC8vZ2V0IG5lc3RlZCBncm91cCBpbnB1dFxuICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYoY3VycmVudF9icmFuY2gsIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIC8vZ2V0IHNlbGVjdGVkIGJyYW5jaCBpbnB1dFxuICAgICAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vZ2V0IHNlbGVjdGVkIGdyb3VwIGlucHV0XG4gICAgICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cblxuICAgIGlucHV0ID0gX2dldElucHV0KCk7XG4gICAgLy9nZXQgaGFuZGxlIG9mIGlucHV0IHByb3BlcnRpZXMgcGFuZWxcbiAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG5cbiAgICAvL2hpZGUgZXJyb3JzXG4gICAgaW5wdXQuaGlkZVF1ZXN0aW9uRXJyb3JzKCk7XG5cbiAgICBpZiAodGFyZ2V0LnBhcmVudCgpLmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbicpKSB7XG4gICAgICAgIC8vZ2V0IHF1ZXN0aW9uXG4gICAgICAgIGlucHV0LnF1ZXN0aW9uID0gJCh0aGlzKS52YWwoKTtcblxuICAgICAgICAvL3ZhbGlkYXRlIHF1ZXN0aW9uIG9yIGhlYWRlclxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgICAgICBpbnB1dF9xdWVzdGlvbl92YWxpZGF0aW9uID0gaW5wdXQuaXNIZWFkZXJUZXh0VmFsaWQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0X3F1ZXN0aW9uX3ZhbGlkYXRpb24gPSBpbnB1dC5pc1F1ZXN0aW9uVGV4dFZhbGlkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlucHV0X3F1ZXN0aW9uX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgIC8vIHdhcm4gdXNlciBxdWVzdGlvbiB0ZXh0IGlzIHdyb25nXG4gICAgICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXQgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgaW5wdXQuc2hvd1F1ZXN0aW9uRXJyb3JzKGlucHV0X3F1ZXN0aW9uX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBlZGl0IGJ0biBmb3IgZ3JvdXBzIG9yIGJyYW5jaGVzXG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQudG9nZ2xlRWRpdEJ1dHRvbihmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vdmFsaWRhdGUgYWxsIGlucHV0cyAodG8gdG9nZ2xlIHNhdmUgcHJvamVjdCBidXR0b24gb24ga2V5dXApXG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGlucHV0LCBmYWxzZSk7XG4gICAgICAgICAgICB0YXJnZXRbMF0uc2VsZWN0aW9uRW5kID0gcG9zaXRpb247ICAgIC8vIFNldCB0aGUgY3Vyc29yIGJhY2sgdG8gdGhlIGluaXRpYWwgcG9zaXRpb24uXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIC8vYnJhbmNoIGFuZCBncm91cCBpbnB1dHMgYXJlIGludmFsaWQgaWYgdGhleSBkbyBub3QgaGF2ZSBhbnkgaW5wdXRzXG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG5cbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBlZGl0IGJ0biBmb3IgZ3JvdXBzIG9yIGJyYW5jaGVzXG4gICAgICAgICAgICAgICAgaW5wdXQudG9nZ2xlRWRpdEJ1dHRvbih0cnVlKTtcblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgJiYgaW5wdXQuYnJhbmNoLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFICYmIGlucHV0Lmdyb3VwLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBfaW5wdXRJc1ZhbGlkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgX2lucHV0SXNWYWxpZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5wYXJlbnQoKS5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdF9fcG9zc2libGVfYW5zd2VyX2l0ZW0nKSkge1xuXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcl92YWxpZGF0aW9uID0gdmFsaWRhdGlvbi5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQodGFyZ2V0LnZhbCgpKTtcblxuICAgICAgICAvL3ZhbGlkYXRlIGVhY2ggcG9zc2libGUgYW5zd2VyIGFuZCBzaG93IGVtYmVkZGVkIGVycm9ycyBpZiBhbnlcbiAgICAgICAgaWYgKCFwb3NzaWJsZV9hbnN3ZXJfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuICAgICAgICAgICAgLy8gd2FybiB1c2VyIHF1ZXN0aW9uIHRleHQgaXMgd3JvbmdcbiAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBhbnN3ZXIgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgaW5wdXQuc2hvd1Bvc3NpYmxlQW5zd2VyRXJyb3JzKHRhcmdldC5wYXJlbnQoKS5wYXJlbnQoKSwgcG9zc2libGVfYW5zd2VyX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG5cbiAgICAgICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24oaW5wdXQsIGZhbHNlKTtcbiAgICAgICAgICAgIHRhcmdldFswXS5zZWxlY3Rpb25FbmQgPSBwb3NpdGlvbjsgICAgLy8gU2V0IHRoZSBjdXJzb3IgYmFjayB0byB0aGUgaW5pdGlhbCBwb3NpdGlvbi5cblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2lucHV0SXNWYWxpZCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKHR5cGluZykgcGFzc2luZyBcInRydWVcIiBzbyBpdCBnZXRzIGEgYml0IG9mIHRocm90dGxpbmdcbiAgICB1bmRvLnB1c2hTdGF0ZSh0cnVlKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgRnRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBjb3VudDtcbiAgICB2YXIgaW5wdXRzID0gW107XG4gICAgdmFyIGFjdGl2ZV9pbnB1dDtcbiAgICB2YXIgYWN0aXZlX2JyYW5jaDtcblxuICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgIGFjdGl2ZV9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG5cbiAgICAgICAgLy9ncm91cCBpbiBhIGJyYW5jaD9cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vc2V0IGFjdGl2ZSBpbnB1dCB0byBiZSB0aGUgYWN0aXZlIGdyb3VwIGlucHV0XG4gICAgICAgICAgICBhY3RpdmVfaW5wdXQgPSB1dGlscy5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYoYWN0aXZlX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYWN0aXZlX2lucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zYXZlIGN1cnJlbnQgaW5wdXRcbiAgICAgICAgc2F2ZS5zYXZlUHJvcGVydGllcyhhY3RpdmVfaW5wdXQpO1xuXG4gICAgICAgIGlucHV0cyA9IGFjdGl2ZV9icmFuY2guYnJhbmNoO1xuICAgICAgICBjb3VudCA9IHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKTtcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKGNvdW50LCB0cnVlKTtcblxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9pcyBpdCBhIGdyb3VwP1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9zZXQgYWN0aXZlIGlucHV0IHRvIGJlIHRoZSBhY3RpdmUgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgIGFjdGl2ZV9pbnB1dCA9IHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2Zvcm0gbGV2ZWwgaW5wdXRcbiAgICAgICAgICAgIGFjdGl2ZV9pbnB1dCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIC8vc2F2ZSBjdXJyZW50IGlucHV0XG4gICAgICAgIHNhdmUuc2F2ZVByb3BlcnRpZXMoYWN0aXZlX2lucHV0KTtcblxuICAgICAgICBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICBjb3VudCA9IHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKTtcbiAgICAgICAgLy9pZiB0aGVyZSBpcyBub3QgYW55IHRpdGxlIHNldCBmb3JtIHRoZSBmb3JtLCBzaG93IHdhcm5pbmdcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKGNvdW50LCBmYWxzZSk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgZm9ybV9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9mb3JtLWZhY3RvcnknKTtcbnZhciBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9zYXZlLXByb2plY3QtY2xpY2stY2FsbGJhY2snKTtcbnZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChldnQpIHtcblxuICAgIHZhciB0YXJnZXQgPSAkKGV2dC5yZWxhdGVkVGFyZ2V0KTsvLyBCdXR0b24gdGhhdCB0cmlnZ2VyZWQgdGhlIG1vZGFsXG4gICAgdmFyIG1vZGFsID0gJCh0aGlzKTtcbiAgICB2YXIgZm9ybV9uYW1lX2lucHV0O1xuICAgIHZhciBmb3JtX3JlZjtcbiAgICB2YXIgaXNfYWRkaW5nX25ld19mb3JtID0gZmFsc2U7XG4gICAgdmFyIGZvcm0gPSB7fTtcbiAgICB2YXIgbmV4dF9mb3JtX2luZGV4O1xuXG4gICAgLy9nZXQgcGFydGlhbFxuICAgIG1vZGFsLmh0bWwoZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLm1vZGFsX2VkaXRfZm9ybV9uYW1lKTtcbiAgICBmb3JtX25hbWVfaW5wdXQgPSBtb2RhbC5maW5kKCcubW9kYWwtYm9keSBpbnB1dCcpO1xuXG4gICAgLy92YWxpZGF0ZSBvbiBrZXl1cCBmb3IgYmV0dGVyIFVYIHRvZG9cbiAgICBmb3JtX25hbWVfaW5wdXQub24oJ2tleXVwJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnYWN0aXZhdGVkJyk7XG4gICAgfSk7XG5cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdtYWluX190YWJzX2FkZC1mb3JtJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJyoqKioqKioqKioqKiAtIGFkZCBuZXcgZm9ybSAtICoqKioqKioqKioqKioqJyk7XG4gICAgICAgIC8vdG9kb1xuICAgICAgICBpc19hZGRpbmdfbmV3X2Zvcm0gPSB0cnVlO1xuICAgICAgICBmb3JtX3JlZiA9IHV0aWxzLmdlbmVyYXRlRm9ybVJlZigpO1xuICAgICAgICBuZXh0X2Zvcm1faW5kZXggPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zLmxlbmd0aDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vc2V0IGN1cnJlbnQgZm9ybSBuYW1lIGluIG1vZGFsXG4gICAgICAgIGZvcm1fbmFtZV9pbnB1dC52YWwoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLm5hbWUpO1xuICAgICAgICBmb3JtX3JlZiA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9yZWY7XG4gICAgfVxuXG4gICAgLy9iaW5kIHNhdmUgY2hhbmdlcyBidXR0b25cbiAgICAkKCcubWFpbl9fbW9kYWwtLWVkaXQtZm9ybS1uYW1lX19zYXZlLWJ0bicpLm9mZigpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvL2dldCB1cGRhdGVkIHZhbHVlXG4gICAgICAgIHZhciBuYW1lID0gZm9ybV9uYW1lX2lucHV0LnZhbCgpO1xuICAgICAgICB2YXIgaXNfZm9ybV9uYW1lX3ZhbGlkO1xuICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcblxuICAgICAgICAvL2hpZGUgZXJyb3JzXG4gICAgICAgIGVycm9ycy5oaWRlRm9ybU5hbWVFcnJvcnMobW9kYWwpO1xuXG4gICAgICAgIC8vdmFsaWRhdGUgZm9ybSBuYW1lXG4gICAgICAgIGlzX2Zvcm1fbmFtZV92YWxpZCA9IHZhbGlkYXRpb24uaXNGb3JtTmFtZVZhbGlkKG5hbWUsIGlzX2FkZGluZ19uZXdfZm9ybSk7XG5cbiAgICAgICAgaWYgKCFpc19mb3JtX25hbWVfdmFsaWQuaXNfdmFsaWQpIHtcbiAgICAgICAgICAgIC8vc2hvdyBlcnJvcnNcbiAgICAgICAgICAgIGVycm9ycy5zaG93Rm9ybU5hbWVFcnJvcnMobW9kYWwsIGlzX2Zvcm1fbmFtZV92YWxpZC5lcnJvci5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGJ1dHRvbiB0byBhdm9pZCBkb3VibGUgY2xpY2tzXG4gICAgICAgICAgICAkKHRoaXMpLm9mZigpLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmIChpc19hZGRpbmdfbmV3X2Zvcm0pIHtcblxuICAgICAgICAgICAgICAgIC8vYWRkIGNoaWxkIGZvcm1cbiAgICAgICAgICAgICAgICBmb3JtX2ZhY3RvcnkuY3JlYXRlQ2hpbGRGb3JtKG5hbWUsIGZvcm1fcmVmLCBuZXh0X2Zvcm1faW5kZXgsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24gYXMgd2UgZG8gbm90IGFjY2VwdCBlbXB0eSBmb3Jtc1xuICAgICAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcblxuICAgICAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL3VwZGF0ZSBuYW1lIGZvciBjdXJyZW50IGZvcm1cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uc2x1ZyA9IHV0aWxzLnNsdWdpZnkobmFtZSk7XG5cbiAgICAgICAgICAgICAgICAvL3Nob3cgbmFtZSBvZiBmb3JtIGluIHRhYiBhbmQgaW5wdXRzIGNvbGxlY3Rpb24gY29udGFpbmVyLCB0cnVuY2F0aW5nIGZvcm0gbmFtZSAoPjEwKSBmb3IgVUkgcHVycG9zZXNcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0KG5hbWUudHJ1bmMoY29uc3RzLlRBQl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUIC0gKGZvcm1zLmxlbmd0aCAqIDIpKSk7XG5cbiAgICAgICAgICAgICAgICAvL3RhYiwgdGFyZ2V0IHRoZSBhY3RpdmUgb25lXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnLmFjdGl2ZSBhJylcbiAgICAgICAgICAgICAgICAgICAgLnRleHQobmFtZS50cnVuYyhjb25zdHMuVEFCX0ZPUk1fTkFNRV9NQVhfRElTUExBWV9MRU5HSFQgLSAoZm9ybXMubGVuZ3RoICogMikpKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCcmbmJzcDs8aSBjbGFzcz1cImZvcm0tc3RhdGUgZmEgZmEtY2hlY2tcIj48L2k+Jyk7XG5cbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9oaWRlIGFkZCBjaGlsZCBmb3JtIGJ1dHRvbiBpZiB0aGUgZm9ybSB0b3RhbCBpcyBNQVhfTlVNQkVSX09GX05FU1RFRF9DSElMRF9GT1JNU1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXMubGVuZ3RoID09PSBjb25zdHMuTUFYX05VTUJFUl9PRl9ORVNURURfQ0hJTERfRk9STVMpIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCcubWFpbl9fdGFic19hZGQtZm9ybScpLnBhcmVudCgpLmhpZGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9yZXNpemUgZm9ybSB0YWJzXG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnJlc2l6ZUZvcm1UYWJzKCk7XG5cbiAgICAgICAgICAgIC8vY2xvc2UgbW9kYWwgKHdpdGggYSBsaXR0bGUgZGVsYXkgZm9yIGJldHRlciBVWCwgbm8gRk9VQylcbiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtb2RhbC5tb2RhbCgnaGlkZScpO1xuICAgICAgICAgICAgICAgIC8vZm9yY2UgYSBiYWNrZHJvcCByZW1vdmFsIGFzIHNvbWV0aW1lcyBpdCBpcyB0cmlnZ2VyZWQgdHdpY2VcbiAgICAgICAgICAgICAgICAkKCcubW9kYWwtYmFja2Ryb3AnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG5cblxuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbi8vdG9kbyBtYXliZSB0aGlzIGNhbGxiYWNrIGlzIG5vdCBuZWVkZWQgYW55bW9yZVxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9nZXQgaG9sZCBvZiBtb2RhbDtcbiAgICB2YXIgbW9kYWwgPSAkKHRoaXMpO1xuXG4gICAgLy9iaW5kIGJ1dHRvbnNcbiAgICBtb2RhbC5maW5kKCcudGFibGUnKS5vZmYoKS5vbignY2xpY2snLCAnLmJ0bicsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgYnV0dG9uID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIGN1cnJlbnRfaW5wdXRfcmVnZXhfcHJvcGVydHk7XG5cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIGN1cnJlbnRfaW5wdXRfcmVnZXhfcHJvcGVydHkgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRfaW5wdXRfcmVnZXhfcHJvcGVydHkgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgIGN1cnJlbnRfaW5wdXRfcmVnZXhfcHJvcGVydHkgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fcmVnZXggaW5wdXQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vYXBwbHkgdGhlIHNlbGVjdGVkIHJlZ2V4XG4gICAgICAgIGN1cnJlbnRfaW5wdXRfcmVnZXhfcHJvcGVydHkudmFsKGNvbnN0cy5SRUdFWFtidXR0b24uYXR0cignZGF0YS1hcHBseS1yZWdleCcpXSk7XG5cbiAgICAgICAgbW9kYWwubW9kYWwoJ2hpZGUnKTtcbiAgICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciB0b2FzdCA9IHJlcXVpcmUoJ2NvbmZpZy90b2FzdCcpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgZnVuY3Rpb24gX3JlbmRlclF1ZXN0aW9uKGlucHV0KSB7XG5cbiAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3MgZnJvbSByZWFkbWUgdHlwZSBpZiBhbnlcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgaW5wdXQucXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgIGlucHV0LnF1ZXN0aW9uID0gaW5wdXQucXVlc3Rpb24ucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICBodG1sICs9ICc8aHIvPic7XG4gICAgICAgIH1cblxuICAgICAgICBodG1sICs9ICc8aDQgY2xhc3M9XCJxdWVzdGlvblwiPicgKyBpbnB1dC5xdWVzdGlvbiArICc8L2g0Pic7XG5cbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5URVhUQVJFQV9UWVBFKSB7XG4gICAgICAgICAgICBodG1sICs9ICc8dGFibGUgYm9yZGVyPVwiMVwiIHdpZHRoPVwiMTAwJVwiPic7XG4gICAgICAgICAgICBodG1sICs9ICc8dHI+PHRkPjwvdGQ+PC90ZD48L3RyPic7XG4gICAgICAgICAgICBodG1sICs9ICc8dHI+PHRkPjwvdGQ+PC90ZD48L3RyPic7XG4gICAgICAgICAgICBodG1sICs9ICc8dHI+PHRkPjwvdGQ+PC90ZD48L3RyPic7XG4gICAgICAgICAgICBodG1sICs9ICc8dHI+PHRkPjwvdGQ+PC90ZD48L3RyPic7XG4gICAgICAgICAgICBodG1sICs9ICc8L3RhYmxlPic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSAhPT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRhYmxlIGJvcmRlcj1cIjFcIiB3aWR0aD1cIjEwMCVcIj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzx0cj48dGQ+PC90ZD48L3RkPjwvdHI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L3RhYmxlPic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8aHIvPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfcmVuZGVyUG9zc2libGVBbnN3ZXJzKGlucHV0KSB7XG4gICAgICAgICQuZWFjaChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLCBmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEU6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8dWwgY2xhc3M9XCJwb3NzaWJsZS1hbnN3ZXJzLWxpc3RcIj4nO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGxpPjxoNT4nICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICc8L2g1PjwvbGk+JztcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPC91bD4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIC8vcmVuZGVyIGRyb3Bkb3duIGFuZCByYWRpbyBhcyByYWRpbyBidXR0b25zIChzaW5nbGUgY2hvaWNlKVxuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkRST1BET1dOX1RZUEU6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuUkFESU9fVFlQRTpcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInJhZGlvLXR5cGVcIj48aDU+JztcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGlucHV0IHR5cGU9XCJyYWRpb1wiICB2YWx1ZT1cIicgKyBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyICsgJ1wiPic7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxsYWJlbCBmb3I9XCInICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICdcIj4nICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICc8L2xhYmVsPic7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvaDU+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuQ0hFQ0tCT1hfVFlQRTpcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cImNoZWNrYm94LXR5cGVcIj48aDU+JztcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiICB2YWx1ZT1cIicgKyBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyICsgJ1wiPic7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxsYWJlbCBmb3I9XCInICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICdcIj4nICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICc8L2xhYmVsPic7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvaDU+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICB2YXIgaHRtbCA9ICcnO1xuXG4gICAgLy9hZGQgZm9ybSB0aXRsZVxuICAgIGh0bWwgKz0gJyc7XG4gICAgdmFyIGluZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuXG4gICAgLy9jcmVhdGUgYSBkZWVwIGNvcHkgb2YgdGhlIHByb2plY3Qgb2JqZWN0IHByb3BlcnRpZXNcbiAgICB2YXIgcHJvamVjdF9kZWZpbml0aW9uX2pzb24gPSB3aW5kb3cuQ2lyY3VsYXJKU09OLnBhcnNlKHdpbmRvdy5DaXJjdWxhckpTT04uc3RyaW5naWZ5KGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpO1xuICAgIHZhciBpc192YWxpZF9mb3JtID0gdHJ1ZTtcbiAgICB2YXIgcHJvamVjdF9zbHVnID0gcHJvamVjdF9kZWZpbml0aW9uX2pzb24uZGF0YS5wcm9qZWN0LnNsdWc7XG4gICAgdmFyIGZvcm0gPSBwcm9qZWN0X2RlZmluaXRpb25fanNvbi5kYXRhLnByb2plY3QuZm9ybXNbaW5kZXhdO1xuXG4gICAgaWYgKGZvcm0uaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9JU19JTlZBTElEKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vcHJpbnQgcHJvamVjdCBuYW1lIGFzIGhlYWRlclxuICAgIGh0bWwgKz0gJzxoMj4nICsgcHJvamVjdF9kZWZpbml0aW9uX2pzb24uZGF0YS5wcm9qZWN0Lm5hbWUgKyAnPC9oMj4nO1xuXG4gICAgLy9wcmludCBmb3JtIG5hbWUgYXMgaGVhZGVyXG4gICAgaHRtbCArPSAnPGgzPicgKyBmb3JtLm5hbWUgKyAnPC9oMz4nO1xuXG4gICAgJChmb3JtLmlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5wdXRJbmRleCwgaW5wdXQpIHtcblxuICAgICAgICAvL2dldCB2YWxpZCBqdW1wIGRlc3RpbmF0aW9uc1xuICAgICAgICB2YXIganVtcF9kZXN0aW5hdGlvbnMgPSB1dGlscy5nZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zQXNLZXlzKGlucHV0SW5kZXgsIGlucHV0LCBmb3JtLmlucHV0cywgZmFsc2UpO1xuXG4gICAgICAgIC8vZXh0cmEgdmFsaWRhdGlvbiBmb3IganVtcHMsIGNoZWNrIGlmIHRoZSBkZXN0aW5hdGlvbiBzdGlsbCBleGlzdHMgYW5kIGl0IGlzIHZhbGlkXG4gICAgICAgICQoaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGp1bXBJbmRleCwganVtcCkge1xuICAgICAgICAgICAgLy9kb2VzIHRoZSBqdW1wIFwidG9cIiBwcm9wZXJ0eSByZWZlcmVuY2UgYSB2YWxpZCBkZXN0aW5hdGlvbiBpbnB1dD9cbiAgICAgICAgICAgIGlmICghanVtcF9kZXN0aW5hdGlvbnNbanVtcC50b10pIHtcbiAgICAgICAgICAgICAgICAvL2ludmFsaWQgZGVzdGluYXRpb24gZm91bmRcbiAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkge1xuXG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5CUkFOQ0hfVFlQRTpcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8aDQgY2xhc3M9XCJicmFuY2gtaGVhZGVyXCI+JyArIGlucHV0LnF1ZXN0aW9uICsgJzwvaDQ+JztcblxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzx0YWJsZSBib3JkZXI9XCIxXCIgY2VsbHBhZGRpbmc9XCIxMFwiIGNlbGxzcGFjaW5nPVwiMTBcIj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzx0cj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzx0ZD4nO1xuXG4gICAgICAgICAgICAgICAgJChpbnB1dC5icmFuY2gpLmVhY2goZnVuY3Rpb24gKGJyYW5jaElucHV0SW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghYnJhbmNoX2lucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGJyYW5jaF9pbnB1dC5kb207XG5cbiAgICAgICAgICAgICAgICAgICAgLy90b2RvIHZhbGlkYXRlIGJyYW5jaCBqdW1wc1xuICAgICAgICAgICAgICAgICAgICBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoYnJhbmNoSW5wdXRJbmRleCwgYnJhbmNoX2lucHV0LCBpbnB1dC5icmFuY2gsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZXh0cmEgdmFsaWRhdGlvbiBmb3IganVtcHMsIGNoZWNrIGlmIHRoZSBkZXN0aW5hdGlvbiBzdGlsbCBleGlzdHMgYW5kIGl0IGlzIHZhbGlkXG4gICAgICAgICAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hKdW1wSW5kZXgsIGJyYW5jaEp1bXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZG9lcyB0aGUganVtcCBcInRvXCIgcHJvcGVydHkgcmVmZXJlbmNlIGEgdmFsaWQgZGVzdGluYXRpb24gaW5wdXQ/XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWp1bXBfZGVzdGluYXRpb25zW2JyYW5jaEp1bXAudG9dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pbnZhbGlkIGRlc3RpbmF0aW9uIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvL211bHRpcGxlIGNob2ljZSBxdWVzdGlvbj9cbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShicmFuY2hfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8aDQgY2xhc3M9XCJxdWVzdGlvblwiPicgKyBicmFuY2hfaW5wdXQucXVlc3Rpb24gKyAnPC9oND4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW5kZXIgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICAgICAgICAgICAgICAgICAgX3JlbmRlclBvc3NpYmxlQW5zd2VycyhicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3JlbmRlclF1ZXN0aW9uKGJyYW5jaF9pbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZ3JvdXBfaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdyb3VwX2lucHV0LmRvbTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9tdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb24/XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGdyb3VwX2lucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxoNCBjbGFzcz1cInF1ZXN0aW9uXCI+JyArIGdyb3VwX2lucHV0LnF1ZXN0aW9uICsgJzwvaDQ+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JlbmRlciBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlbmRlclBvc3NpYmxlQW5zd2Vycyhncm91cF9pbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVuZGVyUXVlc3Rpb24oZ3JvdXBfaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdGQ+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L3RyPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPC90YWJsZT4nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5HUk9VUF9UWVBFOlxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxoNCBjbGFzcz1cImdyb3VwLWhlYWRlclwiPicgKyBpbnB1dC5xdWVzdGlvbiArICc8L2g0Pic7XG5cbiAgICAgICAgICAgICAgICBodG1sICs9ICc8dGFibGUgYm9yZGVyPVwiMVwiIGNlbGxwYWRkaW5nPVwiMTBcIiBjZWxsc3BhY2luZz1cIjEwXCI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8dHI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8dGQ+JztcblxuXG4gICAgICAgICAgICAgICAgJChpbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ3JvdXBfaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdyb3VwX2lucHV0LmRvbTtcblxuICAgICAgICAgICAgICAgICAgICAvL211bHRpcGxlIGNob2ljZSBxdWVzdGlvbj9cbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShncm91cF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxoNCBjbGFzcz1cInF1ZXN0aW9uXCI+JyArIGdyb3VwX2lucHV0LnF1ZXN0aW9uICsgJzwvaDQ+JztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVuZGVyIHBvc3NpYmxlIGFuc3dlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZW5kZXJQb3NzaWJsZUFuc3dlcnMoZ3JvdXBfaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3JlbmRlclF1ZXN0aW9uKGdyb3VwX2lucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPC90ZD4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdHI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L3RhYmxlPic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy9tdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb24/XG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGg0IGNsYXNzPVwicXVlc3Rpb25cIj4nICsgaW5wdXQucXVlc3Rpb24gKyAnPC9oND4nO1xuICAgICAgICAgICAgICAgICAgICAvL3JlbmRlciBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgICAgIF9yZW5kZXJQb3NzaWJsZUFuc3dlcnMoaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9vcGVuIGFuc3dlciBxdWVzdGlvblxuICAgICAgICAgICAgICAgICAgICBfcmVuZGVyUXVlc3Rpb24oaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGlucHV0LmRvbTtcbiAgICB9KTtcblxuICAgIGlmIChpc192YWxpZF9mb3JtKSB7XG4gICAgICAgIC8vZG8gcHJpbnRcbiAgICAgICAgJCgnLnByaW50LXByZXZpZXctd3JhcHBlcicpLmVtcHR5KCkuYXBwZW5kKGh0bWwpO1xuICAgICAgICB3aW5kb3cucHJpbnQoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0lTX0lOVkFMSUQpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyLCBGbGF0dGVkLCByZXF1aXJlICovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcblxuXG4vKlxuIGhhbmRsZSBjbGljayBhY3Rpb24gb24gc2F2ZSBwcm9qZWN0IGJ1dHRvblxuICovXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgLy9mb3IgdGVzdGluZ1xuICAgIHZhciB1cmwgPSAnLi4vcG9zdGR1bXAvaW5kZXgucGhwJztcbiAgICB2YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xuICAgIHZhciBjdXJyZW50X2lucHV0ID0gdXRpbHMuZ2V0Q3VycmVudGx5U2VsZWN0ZWRJbnB1dCgpO1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIFNhdmUgcHJvamVjdFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8vc2F2ZSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGlucHV0IGp1c3QgaW4gY2FzZVxuICAgIGlmIChjdXJyZW50X2lucHV0KSB7XG4gICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24odXRpbHMuZ2V0Q3VycmVudGx5U2VsZWN0ZWRJbnB1dCgpLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy9jcmVhdGUgYSBkZWVwIGNvcHkgb2YgdGhlIHByb2plY3Qgb2JqZWN0IHByb3BlcnRpZXNcbiAgICB2YXIgcHJvamVjdF9kZWZpbml0aW9uX2pzb24gPSBGbGF0dGVkLnBhcnNlKEZsYXR0ZWQuc3RyaW5naWZ5KGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpO1xuICAgIC8vY2xlYW4gdXAgZm9ybXMgZnJvbSBleHRyYSBwcm9wZXJ0aWVzXG5cbiAgICB2YXIgY2xlYW5lZEZvcm1zID0gc2F2ZS5kb0NsZWFuaW5nQmVmb3JlU2F2aW5nKHByb2plY3RfZGVmaW5pdGlvbl9qc29uLmRhdGEucHJvamVjdC5mb3Jtcyk7XG5cbiAgICBpZiAoY2xlYW5lZEZvcm1zLmFsbF9qdW1wc192YWxpZCAmJiBjbGVhbmVkRm9ybXMuaW52YWxpZF9qdW1wc19xdWVzdGlvbiA9PT0gJycpIHtcbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAvL2FmdGVyIGNsZWFuaW5nLCBkbyBleHRyYSB2YWxpZGF0aW9uLCB0aGUgc2FtZSBvbmUgdGhhdCBydW5zIHdoZW4gaW1wb3J0aW5nIGEgZm9ybSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICQocHJvamVjdF9kZWZpbml0aW9uX2pzb24uZGF0YS5wcm9qZWN0LmZvcm1zKS5lYWNoKGZ1bmN0aW9uIChmb3JtSW5kZXgsIGZvcm0pIHtcblxuICAgICAgICAgICAgdmFyIHZhbGlkYXRlQmVmb3JlU2F2aW5nID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJykudmFsaWRhdGVCZWZvcmVTYXZpbmc7XG5cbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbGlkYXRlQmVmb3JlU2F2aW5nKGZvcm0ucmVmLCBmb3JtLmlucHV0cyk7XG5cbiAgICAgICAgICAgIGlmICghcmVzdWx0LmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOy8vZXhpdCBsb29wXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vY2F0Y2ggZm9ybXMgaW52YWxpZCBoZXJlXG4gICAgICAgIGlmICghcmVzdWx0LmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IocmVzdWx0LmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgLy9hbGwgdmFsaWQsIHN0YXJ0IHNhdmluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgIC8vZm9yIGxvY2FsIHRlc3Rpbmcgb25seVxuICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZignbG9jYWxob3N0LycpICE9PSAtMSAmJiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCdlcGljb2xsZWN0NS1mb3JtYnVpbGRlci8nKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGNvbnN0cy5QUk9KRUNUX1VSTCA9IHVybDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTYXZlZCBwcm9qZWN0IGRlZmluaXRpb24gLT4nLCB3aW5kb3cuQ2lyY3VsYXJKU09OLnN0cmluZ2lmeShwcm9qZWN0X2RlZmluaXRpb25fanNvbikpO1xuICAgICAgICB9XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogY29uc3RzLlBST0pFQ1RfVVJMLFxuICAgICAgICAgICAgLy8gIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vdm5kLmFwaStqc29uJyxcbiAgICAgICAgICAgIGRhdGE6IHdpbmRvdy5idG9hKHBha28uZ3ppcChKU09OLnN0cmluZ2lmeShwcm9qZWN0X2RlZmluaXRpb25fanNvbiksIHtcbiAgICAgICAgICAgICAgICAndG8nOiAnc3RyaW5nJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKSksXG4gICAgICAgICAgICAvLyAgZGF0YTogSlNPTi5zdHJpbmdpZnkocHJvamVjdF9kZWZpbml0aW9uX2pzb24pLFxuICAgICAgICAgICAgLy8gICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Quc2hvd1N1Y2Nlc3MobWVzc2FnZXMuc3VjY2Vzcy5QUk9KRUNUX1NBVkVEKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwb3N0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgZXJyb3IsIHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZXJyb3Jfb2JqO1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZXMgPSAnJztcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yX29iaiA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh4aHIsIGVycm9yLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IHNlcnZlciBlcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgJChlcnJvcl9vYmouZXJyb3JzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlcyArPSAnPGJyLz4nICsgZXJyb3IudGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5QUk9KRUNUX05PVF9TQVZFRCArIHRpdGxlcywgMzAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5KVU1QX0lOVkFMSUQgKyBjbGVhbmVkRm9ybXMuaW52YWxpZF9qdW1wc19xdWVzdGlvbik7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX2tleXVwX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy1rZXl1cC1jYWxsYmFjaycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciB0b2FzdCA9IHJlcXVpcmUoJ2NvbmZpZy90b2FzdCcpO1xudmFyIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZScpO1xuXG52YXIgZ3JvdXBfc29ydGFibGUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZ3JvdXBfaW5wdXQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjdXJzb3I6ICdtb3ZlJyxcbiAgICAgICAgaXRlbXM6ICcuaW5wdXQnLFxuICAgICAgICByZXZlcnQ6IDEwMCxcbiAgICAgICAgLy9heGlzOiAneScsLy8gaXQgY2F1c2VzIHRoZSBwbGFjZWhvbGRlciB0byBiZSBhbHdheXMgYWN0aXZlXG4gICAgICAgIGNvbnRhaW5tZW50OiAncGFyZW50JyxcbiAgICAgICAgdG9sZXJhbmNlOiAncG9pbnRlcicsXG4gICAgICAgIC8vIGZvcmNlUGxhY2Vob2xkZXJTaXplOiB0cnVlLFxuICAgICAgICBwbGFjZWhvbGRlcjogJ2lucHV0LWNvbGxlY3Rpb24tZHJvcC1wbGFjZWhvbGRlcicsXG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiBhIG5ldyBpbnB1dCBpcyBkcm9wcGVkIG92ZXIgdGhlIHNvcnRhYmxlXG4gICAgICAgIHJlY2VpdmU6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNfZ3JvdXBfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICB2YXIgY3VycmVudF9lbGVtZW50O1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpLmdyb3VwO1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0X3JlZiA9IHV0aWxzLmdlbmVyYXRlQnJhbmNoR3JvdXBJbnB1dFJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB2YXIgZ3JvdXBfaW5wdXRfaW5kZXggPSBncm91cF9pbnB1dHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0X3R5cGUgPSBqcXVlcnlfdWkuaXRlbS5hdHRyKCdkYXRhLXR5cGUnKTtcbiAgICAgICAgICAgIHZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG4gICAgICAgICAgICB2YXIgb3duZXJfYnJhbmNoO1xuXG4gICAgICAgICAgICAvL2lmIHdlIGFyZSBlZGl0aW5nIGEgYnJhbmNoLCBpdCBtZWFucyB0aGlzIGlzIGEgbmVzdGVkIGdyb3VwLCB1cGRhdGUgcmVmZXJlbmNlcyBhY2NvcmRpbmdseVxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dlIGFyZSBlZGl0aW5nIGEgbmVzdGVkIGdyb3VwJyk7XG5cbiAgICAgICAgICAgICAgICBncm91cF9pbnB1dHMgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZikuZ3JvdXA7XG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRfcmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRfaW5kZXggPSBncm91cF9pbnB1dHMubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2RvIG5vdCBjb25zaWRlciBncm91cC9icmFuY2ggaW5wdXRzIHdpdGhpbiBhIGdyb3VwXG4gICAgICAgICAgICBpZiAoZ3JvdXBfaW5wdXRfdHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFIHx8IGdyb3VwX2lucHV0X3R5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZiA9IGdyb3VwX2lucHV0X3JlZjtcblxuICAgICAgICAgICAgICAgIC8vdmFsaWRhdGUgcHJldmlvdXMgaW5wdXQgKGlmIGFueSkgdG8gc2hvdyBlbWJlZGRlZCBlcnJvcnMgKGluIGNhc2UgdGhlIHVzZXIgZGlkIG5vdCBwcmVzcyB2YWxpZGF0ZSBidXR0b24pXG4gICAgICAgICAgICAgICAgLy90b2RvIGlzIHRoaXMgYW4gb3ZlcmtpbGw/XG4gICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzX2dyb3VwX2lucHV0X3JlZikge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzIGlzIGEgbmVzdGVkIGdyb3VwLGdldCBvd25lciBicmFuY2hcbiAgICAgICAgICAgICAgICAgICAgICAgIG93bmVyX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbih1dGlscy5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYob3duZXJfYnJhbmNoLCBwcmV2aW91c19ncm91cF9pbnB1dF9yZWYpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihwcmV2aW91c19ncm91cF9pbnB1dF9yZWYpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdncm91cCBzb3J0YWJsZSByZWNlaXZlJyk7XG5cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5jb2xsZWN0aW9uX2lzX2JlaW5nX3NvcnRlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgLy9nZW5lcmF0ZSBpbnB1dCBvYmplY3QgYmFzZWQgb24gdHlwZSBhbmQgc2V0IGluZGV4IGluY3JlbWVudGFsbHlcbiAgICAgICAgICAgICAgICBncm91cF9pbnB1dCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXQoZ3JvdXBfaW5wdXRfdHlwZSwgZ3JvdXBfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhncm91cF9pbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGUgY3VycmVudCBhY3RpdmUgZWxlbWVudFxuICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbWVudCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgY3VycmVudF9lbGVtZW50LnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgIC8vYWRkIGlucHV0IHRvIGNvbGxlY3Rpb24gYXMgdGhlIGxhc3Qgb25lXG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRzLnB1c2goZ3JvdXBfaW5wdXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2Rpc2FibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBhcyBieSBkZWZhdWx0IGFuIGlucHV0IGlzIGludmFsaWQgd2hlbiBpdCBpcyBjcmVhdGVkXG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9ESVNBQkxFRCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0cyA9IGlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uZ3JvdXA7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXJfdGV4dCA9IG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUO1xuICAgICAgICAgICAgdmFyIGlucHV0X3R5cGUgPSBqcXVlcnlfdWkuaXRlbS5hdHRyKCdkYXRhLXR5cGUnKTtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsX2h0bWw7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBkcmFnZ2FibGUgaWYgd2UgaGl0IHRoZSBtYXggYW1vdW50IG9mIGlucHV0cyBhbGxvd2VkXG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0SW5wdXRzVG90YWwoaW5wdXRzKSA+PSBjb25zdHMuSU5QVVRTX01BWF9BTExPV0VEKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuZGlzYWJsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9yZWplY3QgZ3JvdXAvYnJhbmNoIGlucHV0cyBoZXJlXG4gICAgICAgICAgICBpZiAoaW5wdXRfdHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFIHx8IGlucHV0X3R5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgLy9pZiBncm91cCBpbnB1dHMgbGVuZ3RoIGlzIHplcm8sIHNob3cgaGVscCB0ZXh0IHBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgLy90b2RvXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2NvdW50IHNlYXJjaCBpbnB1dHNcbiAgICAgICAgICAgICAgICBpZihpbnB1dF90eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFICYmICFmb3JtYnVpbGRlci5ncm91cC5jb2xsZWN0aW9uX2lzX2JlaW5nX3NvcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBsaW1pdCBpcyByZWFjaGVkLCBoaWRlIHNlYXJjaCBmcm9tIGlucHV0IHRvb2xzXG4gICAgICAgICAgICAgICAgICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpID49IGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zaG93IHdhcm5pbmcgdG8gdXNlclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Quc2hvd1dhcm5pbmcobWVzc2FnZXMud2FybmluZy5TRUFSQ0hfSU5QVVRTX0xJTUlUX1JFQUNIRUQgKyAnKCcgKyBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4ICsgJyknKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9pZiB3ZSBhcmUgZWRpdGluZyBhIGJyYW5jaCwgaXQgbWVhbnMgdGhpcyBpcyBhIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnd2UgYXJlIGVkaXRpbmcgYSBuZXN0ZWQgZ3JvdXAnKTtcbiAgICAgICAgICAgICAgICAgICAgb3duZXJfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgICAgICAgICBncm91cF9pbnB1dHMgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2lucHV0X3JlZikuZ3JvdXA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0ucmVtb3ZlQXR0cignc3R5bGUnKTsgLy8gdW5kbyBzdHlsaW5nIHNldCBieSBqcXVlcnlVSSAoaHR0cDovL2dvby5nbC9FS3o4dEMpXG5cbiAgICAgICAgICAgICAgICAvL2dldCB0aGUgaW5kZXggd2hlcmUgdGhlIGlucHV0IHdhcyBkcm9wcGVkIChza2lwIHdoZW4gbGlzdCBpcyBlbXB0eSlcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC50b19pbmRleCA9IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgPT09IDAgPyBqcXVlcnlfdWkuaXRlbS5pbmRleCgpIDoganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSAtIDE7XG5cbiAgICAgICAgICAgICAgICAvL2hpZGUgbWVzc2FnZSBhYm91dCBubyBpbnB1dCBzZWxlY3RlZCwgYXMgZHJvcHBlZCBpbnB1dCBnZXRzIGZvY3VzXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQuaGlkZSgpO1xuXG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICBpZiB0aGUgdXNlciBpcyBkcmFnZ2luZyBhIG5ldyBpbnB1dCBvdmVyLCBpdCB3YXMgYWRkZWQgYXMgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICAgb3RoZXJ3aXNlIHRoZSBjdXJyZW50IGlucHV0IHBvc2l0aW9uIGlzIHNldCBpbiB0aGUgc3RhcnQgZXZlbnRcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoIWZvcm1idWlsZGVyLmdyb3VwLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9vdmVycmlkZSAnZnJvbV9pbmRleCcgYXMgd2UgYXJlIGRyb3BwaW5nIGEgbmV3IGVsZW1lbnQgKG1pbiB2YWx1ZSBmb3IgbGVuZ3RoIGlzIDEsIGFzIHdlIGFkZCB0aGUgaW5wdXQgaW4gdGhlIGByZWNlaXZlYCBmdW5jdGlvbilcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAuZnJvbV9pbmRleCA9IGdyb3VwX2lucHV0cy5sZW5ndGggLSAxO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vbW92ZSBpbnB1dHMgdG8ga2VlcCB0aGUgYXJyYXkgc2VxdWVuY2UgbGlrZSB0aGUgaW5wdXQgc2VxdWVuY2Ugb24gc2NyZWVuXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0cy5tb3ZlKGZvcm1idWlsZGVyLmdyb3VwLmZyb21faW5kZXgsIGZvcm1idWlsZGVyLmdyb3VwLnRvX2luZGV4KTtcblxuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmF0dHIoJ2RhdGEtaW5wdXQtcmVmJywgZ3JvdXBfaW5wdXRfcmVmKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2FwcGVuZCBpbnB1dCBpZCBhbmQgYSB3YXJuaW5nIGljb24sIGFzIGJ5IGRlZmF1bHQgdGhlIHF1ZXN0aW9uIGRvZXMgbm90IGhhdmUgYW55IHRleHRcbiAgICAgICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0uZmluZCgnLmlucHV0LWlubmVyJykuYXBwZW5kKHVpLmlucHV0c19jb2xsZWN0aW9uLmdldElucHV0U3RhdGVJY29uc0hUTUwoKSk7XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmZpbmQoJ3NwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQocGxhY2Vob2xkZXJfdGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGlucHV0IHByb3BlcnRpZXMgZm9yIHRoZSBuZXcgZHJvcHBlZCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3BhbicpLnRleHQocGxhY2Vob2xkZXJfdGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGUgcHJvcGVydGllcyBwYW5lbCBpbiByaWdodCBzaWRlYmFyIGZvciB0aGlzIGlucHV0IChjb21tb24gcHJvcGVydGllcylcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllc19wYW5lbF9odG1sID0gdGVtcGxhdGUuZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MKGdyb3VwX2lucHV0KTtcblxuICAgICAgICAgICAgICAgICAgICAvL2FwcGVuZCBpbnB1dCBhbmQgc2hvdyBpdCBhcyBpdCBnZXRzIHNlbGVjdGVkIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICQocHJvcGVydGllc19wYW5lbF9odG1sKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYXBwZW5kVG8oZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlcik7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3Nob3cgYWN0aW9uIGJ1dHRvbnMgZm9yIGlucHV0XG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Zvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzIGlzIE5PVCBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgdHlwZSBpbiB0aGUgaGVhZGVyIGlucHV0IGZpZWxkIGZvciBicmFuY2hlcyBvciBncm91cHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cF9pbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdrZXl1cCcsICdpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy9lbmFibGUgc29ydGFibGUgb24gY3VycmVudCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZShncm91cF9pbnB1dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLydmcm9tX2luZGV4IGlzIHNldCBpbiBzdGFydCBldmVudCBvZiBzb3J0YWJsZSdcbiAgICAgICAgICAgICAgICAgICAgLy9tb3ZlIGlucHV0cyB0byBrZWVwIHRoZSBhcnJheSBzZXF1ZW5jZSBsaWtlIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbiBzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRzLm1vdmUoZm9ybWJ1aWxkZXIuZ3JvdXAuZnJvbV9pbmRleCwgZm9ybWJ1aWxkZXIuZ3JvdXAudG9faW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vcnVuIHRoZSB2YWxpZGF0aW9uIG9uIGFsbCBncm91cCBqdW1wcywgYXMgd2UgbWlnaHQgaGF2ZSBzb21lIGludmFsaWQgZGVzdGluYXRpb25zIGFmdGVyIHJlLW9yZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgIC8vSSBhbSBmb3JjZWQgdG8gZG8gdGhpcyBhZ2FpbnN0IGFsbCB0aGUgYnJhbmNoIGlucHV0c1xuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnZhbGlkYXRlSnVtcHNBZnRlclNvcnRpbmcoZ3JvdXBfaW5wdXRzKTtcblxuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2FkZCB0aGlzIHN0YXRlIGZvciB1bmRvaW5nLCBzbyBpdCBpcyBlYXNpZXIgdG8gcmViaW5kIGV2ZXJ5dGhpbmdcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcbiAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAkKCcuc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vdGhpcyBjYWxsYmFjayBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBzdGFydCBkcmFnZ2luZyBhbiBleGlzdGluZyBpbnB1dCBmcm9tIHRoZSBzb3J0YWJsZVxuICAgICAgICBzdGFydDogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuXG4gICAgICAgICAgICAvL2dldCBjdXJyZW50IGlucHV0IHBvc2l0aW9uLCBhcyB3ZSBuZWVkIHRvIG1vdmUgZnJvbSBoZXJlXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5jb2xsZWN0aW9uX2lzX2JlaW5nX3NvcnRlZCA9IHRydWU7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5mcm9tX2luZGV4ID0ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA9PT0gMCA/IDAgOiBqcXVlcnlfdWkuaXRlbS5pbmRleCgpIC0gMTtcbiAgICAgICAgICAgIC8vZGUtYWN0aXZhdGUgYWxsIGlucHV0cyBpbiBjb2xsZWN0aW9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbDogdHJ1ZSxcbiAgICAgICAgc25hcDogZmFsc2UsXG4gICAgICAgIG92ZXI6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWY7XG4gICAgICAgICAgICB2YXIgb3duZXJfaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2lucHV0X3JlZik7XG5cbiAgICAgICAgICAgIC8vaWYgd2UgYXJlIGVkaXRpbmcgYSBuZXN0ZWQgZ3JvdXAsIGdyYWIgdGhlIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgb3duZXJfaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaGlkZSBoZWxwIHRleHQgaWYgdGhlIGxpc3QgaXMgZW1wdHkgYW5kIHdlIGFyZSBob3ZlcmluZyB3aXRoIGFuIGlucHV0XG4gICAgICAgICAgICBpZiAob3duZXJfaW5wdXQuZ3JvdXAubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgaW5wdXQgZnJvbSBkb20gY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBvd25lcl9pbnB1dF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1ncm91cC1xdWVzdGlvbnMtbWVzc2FnZScpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBncm91cF9zb3J0YWJsZSgpO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgcG9zc2libGVBbnN3ZXJzU29ydGFibGUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG5cbiAgICAvL2lmIG5vdCBtdWx0aXBsZSBjaG9pY2UgdHlwZSwgcmV0dXJuXG4gICAgaWYgKCQuaW5BcnJheShpbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSA9PT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vYXR0YWNoIHNvcnRhYmxlIG9ubHkgb25jZSBwZXIgZWFjaCBpbnB1dCB0byBrZWVwIGxvdyBtZW1vcnkgdXNhZ2VcbiAgICBpZiAoJC5pbkFycmF5KGlucHV0LnJlZiwgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vycy5lbmFibGVkX3NvcnRhYmxlKSA9PT0gLTEpIHtcblxuICAgICAgICAvL2VuYWJsZSBzb3J0YWJsZSBmb3IgdGhpcyBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKS5zb3J0YWJsZSh7XG4gICAgICAgICAgICBheGlzOiAneScsXG4gICAgICAgICAgICBjb250YWlubWVudDogJ3BhcmVudCcsXG4gICAgICAgICAgICBoYW5kbGU6ICcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdF9fZHJhZy1hbnN3ZXInLFxuICAgICAgICAgICAgY2FuY2VsOiAnJyxcbiAgICAgICAgICAgIGhlbHBlcjogJ2Nsb25lJyxcbiAgICAgICAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxuICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdwb3NzaWJsZS1hbnN3ZXJzLWRyb3AtcGxhY2Vob2xkZXInLFxuICAgICAgICAgICAgc3RvcDogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuICAgICAgICAgICAgICAgIC8vJ2Zyb21faW5kZXggaXMgc2V0IGluIHN0YXJ0IGV2ZW50IG9mIHNvcnRhYmxlJ1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnMudG9faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgnJykgPT09IDAgPyBqcXVlcnlfdWkuaXRlbS5pbmRleCgpIDoganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKTtcblxuICAgICAgICAgICAgICAgIC8vbW92ZSBpbnB1dHMgdG8ga2VlcCB0aGUgcG9zc2libGUgYW5zd2VycyBzZXF1ZW5jZSBsaWtlIHRoZSBzZXF1ZW5jZSBvbiBzY3JlZW4gKGRvbSlcbiAgICAgICAgICAgICAgICBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLm1vdmUoZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vycy5mcm9tX2luZGV4LCBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzLnRvX2luZGV4KTtcblxuICAgICAgICAgICAgICAgIC8vc2F2ZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgaW5wdXQuc2F2ZVBvc3NpYmxlQW5zd2VycygpO1xuICAgICAgICAgICAgICAgIC8vdmFsaWRhdGUgaW5wdXRcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGlucHV0LCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGFzIHVzZXIgbWFkZSBhIGNoYW5nZVxuICAgICAgICAgICAgICAgIC8vYW5kIEFMTCB0aGUgaW5wdXRzIGFyZSB2YWxpZFxuXG4gICAgICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBpZiBhbGwgaW5wdXRzIGFyZSB2YWxpZFxuICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmFyZUFsbElucHV0c1ZhbGlkKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiAoaWYgZGlzYWJsZWQpXG4gICAgICAgICAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdGFydDogZnVuY3Rpb24oZSwganF1ZXJ5X3VpKXtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzLmZyb21faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgpID09PSAwID8gMCA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmRpc2FibGVTZWxlY3Rpb24oKTtcblxuICAgICAgICAvL2tlZXAgdHJhY2sgb2YgdGhlIGN1cnJlbnQgaW5wdW90IHNvIHdlIGRvIG5vdCBhdHRhY2ggdGhlIGV2ZW50IG1vcmUgdGhhbiBvbmNlXG4gICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnMuZW5hYmxlZF9zb3J0YWJsZS5wdXNoKGlucHV0LnJlZik7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xudmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbnZhciB0b2FzdCA9IHJlcXVpcmUoJ2NvbmZpZy90b2FzdCcpO1xudmFyIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZScpO1xuXG52YXIgc29ydGFibGUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgaW5wdXQ7XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuc29ydGFibGUoe1xuICAgICAgICB6SW5kZXg6IDk5OTksXG4gICAgICAgIGN1cnNvcjogJ21vdmUnLFxuICAgICAgICBpdGVtczogJz4gZGl2LmlucHV0JyxcbiAgICAgICAgcmV2ZXJ0OiAxMDAsXG4gICAgICAgIC8vYXhpczogJ3knLC8vIGl0IGNhdXNlcyB0aGUgcGxhY2Vob2xkZXIgdG8gYmUgYWx3YXlzIGFjdGl2ZVxuICAgICAgICBjb250YWlubWVudDogJ3BhcmVudCcsXG4gICAgICAgIC8vIGNvbnRhaW5tZW50OiAnZG9jdW1lbnQnLCBubyFcbiAgICAgICAgdG9sZXJhbmNlOiAncG9pbnRlcicsXG4gICAgICAgIC8vIGZvcmNlUGxhY2Vob2xkZXJTaXplOiB0cnVlLFxuICAgICAgICBwbGFjZWhvbGRlcjogJ2lucHV0LWNvbGxlY3Rpb24tZHJvcC1wbGFjZWhvbGRlcicsXG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiBhIG5ldyBpbnB1dCBpcyBkcm9wcGVkIG92ZXIgdGhlIHNvcnRhYmxlXG4gICAgICAgIHJlY2VpdmU6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIGZvcm1fcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZjtcbiAgICAgICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgICAgIHZhciBwcmV2aW91c19pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBpbnB1dF90eXBlID0ganF1ZXJ5X3VpLml0ZW0uYXR0cignZGF0YS10eXBlJyk7XG4gICAgICAgICAgICB2YXIgaW5wdXRfaW5kZXggPSBpbnB1dHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGlucHV0X3JlZiA9IHV0aWxzLmdlbmVyYXRlSW5wdXRSZWYoZm9ybV9yZWYpO1xuXG4gICAgICAgICAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnkpIHRvIHNob3cgZW1iZWRkZWQgZXJyb3JzIChpbiBjYXNlIHRoZSB1c2VyIGRpZCBub3QgcHJlc3MgdmFsaWRhdGUgYnV0dG9uKVxuICAgICAgICAgICAgaWYgKHByZXZpb3VzX2lucHV0X3JlZiAmJiBpbnB1dF9pbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYocHJldmlvdXNfaW5wdXRfcmVmKSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdzb3J0YWJsZSByZWNlaXZlJyk7XG4gICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5yZW1vdmVBdHRyKCdzdHlsZScpOyAvLyB1bmRvIHN0eWxpbmcgc2V0IGJ5IGpxdWVyeVVJIChodHRwOi8vZ29vLmdsL0VLejh0QylcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vZ2VuZXJhdGUgaW5wdXQgb2JqZWN0IGJhc2VkIG9uIHR5cGUgYW5kIHNldCBpbmRleCBpbmNyZW1lbnRhbGx5XG4gICAgICAgICAgICBpbnB1dCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXQoaW5wdXRfdHlwZSwgaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmID0gaW5wdXQucmVmO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaW5wdXQpO1xuXG4gICAgICAgICAgICAvL2Rpc2FibGUgY3VycmVudCBhY3RpdmUgZWxlbWVudFxuICAgICAgICAgICAgdmFyIGN1cnJlbnRfZWxlbWVudCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlJyk7XG4gICAgICAgICAgICBjdXJyZW50X2VsZW1lbnQucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICAvL2FkZCBpbnB1dCB0byBjb2xsZWN0aW9uIGFzIHRoZSBsYXN0IG9uZVxuICAgICAgICAgICAgaW5wdXRzLnB1c2goaW5wdXQpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhpbnB1dHMpO1xuXG4gICAgICAgICAgICAvL2hpZGUgbWVzc2FnZSBhYm91dCBubyBpbnB1dCBzZWxlY3RlZCwgYXMgZHJvcHBlZCBpbnB1dCBnZXRzIGZvY3VzXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZC5oaWRlKCk7XG5cbiAgICAgICAgICAgIC8vZ2V0IGhvbGQgb2YgYWR2YW5jZWQgcHJvcGVydGllcyBwYW5lbCBmb3IgdGhpcyBpbnB1dFxuICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgICAgICAgICAgLmRvbVxuICAgICAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24gYXMgYnkgZGVmYXVsdCBhbiBpbnB1dCBpcyBpbnZhbGlkIHdoZW4gaXQgaXMgY3JlYXRlZFxuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuXG4gICAgICAgICAgICAvL3NldCBmb3JtIHRhYiBhcyBpbnZhbGlkLCBhcyB0aGUgbmV3IGlucHV0IHdpbGwgYmUgaW52YWxpZCBieSBkZWZhdWx0XG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuXG5cbiAgICAgICAgfSxcbiAgICAgICAgc3RvcDogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlcl90ZXh0ID0gbWVzc2FnZXMuZXJyb3IuTk9fUVVFU1RJT05fVEVYVF9ZRVQ7XG4gICAgICAgICAgICB2YXIgaW5wdXRfdHlwZSA9IGpxdWVyeV91aS5pdGVtLmF0dHIoJ2RhdGEtdHlwZScpO1xuICAgICAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbDtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGRyYWdnYWJsZSBpZiB3ZSBoaXQgdGhlIG1heCBhbW91bnQgb2YgaW5wdXRzIGFsbG93ZWRcbiAgICAgICAgICAgIGlmICh1dGlscy5nZXRJbnB1dHNUb3RhbChpbnB1dHMpID49IGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQpIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5kaXNhYmxlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaGlkZSBzZWFyY2ggaW5wdXQgaWYgd2UgaGl0IHRoZSBtYXggKGdsb2JhbGx5KSBidXQgb25seSB3aGVuIGFkZGluZyBuZXcgaW5wdXRzXG4gICAgICAgICAgICBpZiAoaW5wdXRfdHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSAmJiAhZm9ybWJ1aWxkZXIuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA+PSBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoIGxpbWl0IHJlYWNoZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3Nob3cgd2FybmluZyB0byB1c2VyXG4gICAgICAgICAgICAgICAgICAgIHRvYXN0LnNob3dXYXJuaW5nKG1lc3NhZ2VzLndhcm5pbmcuU0VBUkNIX0lOUFVUU19MSU1JVF9SRUFDSEVEICsgJygnICsgY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCArICcpJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdzb3J0YWJsZSBzdG9wJyk7XG4gICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5yZW1vdmVBdHRyKCdzdHlsZScpOyAvLyB1bmRvIHN0eWxpbmcgc2V0IGJ5IGpxdWVyeVVJIChodHRwOi8vZ29vLmdsL0VLejh0QylcblxuICAgICAgICAgICAgdmFyIGlucHV0X3JlZiA9IGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmO1xuXG4gICAgICAgICAgICAvL2dldCB0aGUgaW5kZXggd2hlcmUgdGhlIGlucHV0IHdhcyBkcm9wcGVkIChza2lwIHdoZW4gbGlzdCBpcyBlbXB0eSlcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGpxdWVyeV91aS5pdGVtLmluZGV4KCkpO1xuICAgICAgICAgICAgLy9oZXJlIGZyb21faW5kZXggaXMgYmFzZWQgb24gdGhlIHNpYmxpbmdzLCBzbyB3ZSBuZWVkIHRvIHJlbW92ZSB0aGUgaW5kZXhlcyBmb3IgdGhlIHdhcm5pbmcgbWVzc2FnZXMgPGRpdj5cbiAgICAgICAgICAgIC8vd2UgaGF2ZSAyIDxkaXY+LCBzbyByZW1vdmUgMlxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIudG9faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgnJykgPT09IDAgPyBqcXVlcnlfdWkuaXRlbS5pbmRleCgpIDoganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSAtIDI7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgaWYgdGhlIHVzZXIgaXMgZHJhZ2dpbmcgYSBuZXcgaW5wdXQgb3ZlciwgaXQgd2FzIGFkZGVkIGFzIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGFycmF5XG4gICAgICAgICAgICAgb3RoZXJ3aXNlIHRoZSBjdXJyZW50IGlucHV0IHBvc2l0aW9uIGlzIHNldCBpbiB0aGUgc3RhcnQgZXZlbnRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5jb2xsZWN0aW9uX2lzX2JlaW5nX3NvcnRlZCkge1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSAnZnJvbV9pbmRleCcgYXMgd2UgYXJlIGRyb3BwaW5nIGEgbmV3IGVsZW1lbnRcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5mcm9tX2luZGV4ID0gaW5wdXRzLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgICAgICAvL21vdmUgaW5wdXRzIHRvIGtlZXAgdGhlIGFycmF5IHNlcXVlbmNlIGxpa2UgdGhlIGlucHV0IHNlcXVlbmNlIG9uIHNjcmVlblxuICAgICAgICAgICAgICAgIGlucHV0cy5tb3ZlKGZvcm1idWlsZGVyLmZyb21faW5kZXgsIGZvcm1idWlsZGVyLnRvX2luZGV4KTtcblxuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hdHRyKCdkYXRhLWlucHV0LXJlZicsIGlucHV0X3JlZik7XG5cbiAgICAgICAgICAgICAgICAvL2FwcGVuZCBpbnB1dCBpZCBhbmQgYSB3YXJuaW5nIGljb24sIGFzIGJ5IGRlZmF1bHQgdGhlIHF1ZXN0aW9uIGRvZXMgbm90IGhhdmUgYW55IHRleHRcbiAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5maW5kKCcuaW5wdXQtaW5uZXInKS5hcHBlbmQodWkuaW5wdXRzX2NvbGxlY3Rpb24uZ2V0SW5wdXRTdGF0ZUljb25zSFRNTCgpKTtcblxuICAgICAgICAgICAgICAgIC8vYWRkIHBsYWNlaG9sZGVyIHRleHQgb24gY3VycmVudCBpbnB1dCAoYmFzZWQgb24gaW5wdXQgdHlwZSlcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRfdHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaXQgaXMgYSBicmFuY2gsIGFkZCBicmFuY2ggcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJfdGV4dCA9IG1lc3NhZ2VzLmVycm9yLk5PX0JSQU5DSF9IRUFERVJfWUVUO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL2l0IGlzIGEgZ3JvdXAsIGFkZCBncm91cCBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcl90ZXh0ID0gbWVzc2FnZXMuZXJyb3IuTk9fR1JPVVBfSEVBREVSX1lFVDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5maW5kKCdzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KHBsYWNlaG9sZGVyX3RleHQpO1xuXG4gICAgICAgICAgICAgICAgLy9zaG93IGlucHV0IHByb3BlcnRpZXMgZm9yIHRoZSBuZXcgZHJvcHBlZCBpbnB1dFxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm0nKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4nKS50ZXh0KHBsYWNlaG9sZGVyX3RleHQpO1xuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGUgcHJvcGVydGllcyBwYW5lbCBpbiByaWdodCBzaWRlYmFyIGZvciB0aGlzIGlucHV0IChjb21tb24gcHJvcGVydGllcylcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsX2h0bWwgPSB0ZW1wbGF0ZS5nZXRJbnB1dFByb3BlcnRpZXNQYW5lbEhUTUwoaW5wdXQpO1xuXG4gICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgYW5kIHNob3cgaXQgYXMgaXQgZ2V0cyBzZWxlY3RlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJChwcm9wZXJ0aWVzX3BhbmVsX2h0bWwpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5hcHBlbmRUbyhmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyKTtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBpbnB1dFxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgICAgICAgICAvL2ZvciBicmFuY2hlcywgZW5hYmxlIGtleXVwIHRvIGNoZWNrIGZvciB2YWxpZGF0aW9uIG9mIGhlYWRlciB0ZXh0XG4gICAgICAgICAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VycyB0eXBlIGluIHRoZSBoZWFkZXIgaW5wdXQgZmllbGQgZm9yIGJyYW5jaGVzIG9yIGdyb3Vwc1xuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL2Zvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKS5vbigna2V5dXAnLCAnaW5wdXQnLCBpbnB1dF9wcm9wZXJ0aWVzX2tleXVwX2NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBzb3J0YWJsZSBvbiBjdXJyZW50IGlucHV0IChvbmx5IHdoZW4gaXQgZ2V0cyBjcmVhdGVkKVxuICAgICAgICAgICAgICAgIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgLy90b2RvIGRvIEkgbmVlZCB0byBiaW5kIGtleXVwIGZvciBicmFuY2hlcyBhbmQgZ3JvdXBzIGhlcmU/XG5cbiAgICAgICAgICAgICAgICAvLydmcm9tX2luZGV4IGlzIHNldCBpbiBzdGFydCBldmVudCBvZiBzb3J0YWJsZSdcbiAgICAgICAgICAgICAgICAvL21vdmUgaW5wdXRzIHRvIGtlZXAgdGhlIGFycmF5IHNlcXVlbmNlIGxpa2UgdGhlIGlucHV0IHNlcXVlbmNlIG9uIHNjcmVlblxuICAgICAgICAgICAgICAgIGlucHV0cy5tb3ZlKGZvcm1idWlsZGVyLmZyb21faW5kZXgsIGZvcm1idWlsZGVyLnRvX2luZGV4KTtcblxuICAgICAgICAgICAgICAgIC8vcnVuIHRoZSB2YWxpZGF0aW9uIG9uIGFsbCBqdW1wcywgYXMgd2UgbWlnaHQgaGF2ZSBzb21lIGludmFsaWQgZGVzdGluYXRpb25zIGFmdGVyIHJlLW9yZGVyaW5nXG4gICAgICAgICAgICAgICAgLy9JIGFtIGZvcmNlZCB0byBkbyB0aGlzIGFnYWluc3QgYWxsIHRoZSBpbnB1dHNcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnZhbGlkYXRlSnVtcHNBZnRlclNvcnRpbmcoaW5wdXRzKTtcblxuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvL3B1c2ggc3RhdGUgdG8gZW5hYmxlIHVuZG9pbmcgdGhlIGFjdGlvbiAoYWRkaW5nL2RyYWdnaW5nIGlucHV0KVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9IGNvbnN0cy5SRU5ERVJfQUNUSU9OX0RPO1xuICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcblxuICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgICAgICQoJy5zdW1tZXJub3RlJykuc3VtbWVybm90ZShjb25zdHMuU1VNTUVSTk9URV9PUFRJT05TKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pZiB0aGVyZSBpcyBub3QgYW55IHRpdGxlIHNldCwgc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICAvL2J1dCBvbmx5IGlmIHRoZXJlIGFyZSBhbnkgaW5wdXRzXG4gICAgICAgICAgICBpZiAoaW5wdXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcodXRpbHMuZ2V0VGl0bGVDb3VudChpbnB1dHMpLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2hpZGUgaXQsIHBhc3NpbmcgYSBjb3VudCA+IDFcbiAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoMSwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICB9LFxuICAgICAgICAvL3RoaXMgY2FsbGJhY2sgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgc3RhcnQgZHJhZ2dpbmcgYW4gZXhpc3RpbmcgaW5wdXQgZnJvbSB0aGUgc29ydGFibGVcbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgLy9nZXQgY3VycmVudCBpbnB1dCBwb3NpdGlvbiwgYXMgd2UgbmVlZCB0byBtb3ZlIGZyb20gaGVyZSAoaWYgdGhlcmUgaXMgYW55IGlucHV0KVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgLy9oZXJlIGZyb21faW5kZXggaXMgYmFzZWQgb24gdGhlIHNpYmxpbmdzLCBzbyB3ZSBuZWVkIHRvIHJlbW92ZSB0aGUgaW5kZXhlcyBmb3IgdGhlIHdhcm5pbmcgbWVzc2FnZXMgPGRpdj5cbiAgICAgICAgICAgIC8vd2UgaGF2ZSAyIDxkaXY+LCBzbyByZW1vdmUgMlxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZnJvbV9pbmRleCA9IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgPT09IDAgPyAwIDoganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSAtIDI7XG5cbiAgICAgICAgICAgIC8vZGUtYWN0aXZhdGUgYWxsIGlucHV0cyBpbiBjb2xsZWN0aW9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9LFxuICAgICAgICBvdmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgICAgIC8vcmVtb3ZlIG5vIHF1ZXN0aW9ucyBtZXNzYWdlIGFuZCB1cGxvYWQgYnV0dG9uIGlmIG5vIGlucHV0c1xuICAgICAgICAgICAgaWYgKGlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1xdWVzdGlvbnMtbWVzc2FnZScpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG91dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgICAgICAvL3Nob3cgbm8gcXVlc3Rpb25zIG1lc3NhZ2UgYW5kIHVwbG9hZCBidXR0b24gaWYgbm8gaW5wdXRzXG4gICAgICAgICAgICBpZiAoaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLXF1ZXN0aW9ucy1tZXNzYWdlJylcbiAgICAgICAgICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2Nyb2xsOiB0cnVlXG4gICAgfSkuZGlzYWJsZVNlbGVjdGlvbigpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBzb3J0YWJsZTtcbiJdfQ=="}