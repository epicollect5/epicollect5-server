!function(){var e,t={1993:function(e){function t(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=function(){return[]},t.resolve=t,t.id=1993,e.exports=t},1875:function(e){function t(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=function(){return[]},t.resolve=t,t.id=1875,e.exports=t},471:function(e,t,n){"use strict";n(6992),n(8674),n(9601),n(7727),n(3948),n(1637),n(6699),n(285),n(5306),n(8757);var r=n(8061),s=n(1809),o=n(7253),a=n(6252);var i=n(890);const l={APP_NAME:"Epicollect5 Beta",USER_GUIDE_URL:"https://docs.epicollect.net",COMMUNITY_SUPPORT_URL:"https://community.epicollect.net",DEBUG:"",IS_LOCALHOST:0,BYPASS_UNIQUENESS:"1",DEFAULT_SERVER_URL:"https://five.epicollect.net",HOW_MANY_ENTRIES:5,HOW_MANY_BRANCH_ENTRIES:2,DEFAULT_LANGUAGE:"en",EASTER_EGG:{STATUS:0,PROJECT_REF:"031ad19cdaf04dbb9cc9a1c2086bdcbd"},WEB:"web",ANDROID:"android",IOS:"ios",PWA:"pwa",LEGACY_ANDROID:"Android",LEGACY_IOS:"iOS",LEGACY_WEB:"WEB",PROVIDERS:{APPLE:"apple",GOOGLE:"google",PASSWORDLESS:"passwordless",LOCAL:"local",LDAP:"ldap"},PROJECT_LOGO_PRIVATE:"./assets/images/ec5-locked.png",GOOGLE_SIGNIN_BUTTON_IMAGE:"./assets/images/login-google@2x.png",APPLE_SIGNIN_BUTTON_IMAGE:"./assets/images/login-apple@2x.png",EMAIL_SIGNIN_BUTTON_IMAGE:"./assets/images/email-signin-128x128.png",CHECKBOX_SVG:"/assets/svg/checkbox.svg",API:{ROUTES:{ROOT:"/api",PROJECT:"/project/",PROJECTS:"/projects/",UPLOAD:"/upload/",MEDIA:"/media/",PROJECT_VERSION:"/project-version/",GET_LOGIN:"/login",LOGIN:"/login/",HANDLE_GOOGLE:"/handle/google",HANDLE_APPLE:"/handle/apple",GOOGLE_AUTH:"https://accounts.google.com/o/oauth2/auth?",LOCALHOST:"http://localhost",ENTRIES:"/entries/",PASSWORDLESS_CODE:"/login/passwordless/code",PASSWORDLESS_AUTH:"/login/passwordless",VERIFY:{GOOGLE:"/login/verify-google",APPLE:"/login/verify-apple"},PWA:{ROOT:"/api/internal",ROOT_DEBUG:"/api",PROJECT:"/project/",ENTRIES:"/entries/",ENTRIES_DEBUG:"/pwa-entries/",MEDIA:"/media/",UPLOAD:"/web-upload/",UPLOAD_DEBUG:"/pwa-upload/",UPLOAD_FILE:"/web-upload-file/",UPLOAD_FILE_DEBUG:"/pwa-upload-file/",TEMP_MEDIA:"/temp-media/",TEMP_MEDIA_DELETE:"/temp-media-delete/",TEMP_MEDIA_DELETE_DEBUG:"/pwa-temp-media-delete/",UNIQUE_ANSWER:"/unique-answer/",UNIQUE_ANSWER_DEBUG:"/pwa-unique-answer/",DATA_VIEWER:"/data",OPENCAGE:"/proxies/opencage/",OPENCAGE_DEBUG:"/proxies/pwa-opencage/"}},PARAMS:{PROJECT_LOGO_QUERY_STRING:"?type=photo&name=logo.jpg&format=project_mobile_logo",GOOGLE_CODE:"code",DATA_VIEWER_RESTORE_QUERY_STRING:"?restore=1"}},PHOTO_EXT:".jpg",AUDIO_EXT:".mp4",AUDIO_EXT_IOS:".wav",VIDEO_EXT:".mp4",ALLOWED_ORDERING_COLUMNS:["title","created_at"],ALLOWED_ORDERING:["ASC","DESC"],DEFAULT_ORDERING_COLUMN:"created_at",DEFAULT_ORDERING:"DESC",AUTH_ERROR_CODES:["ec5_70","ec5_71","ec5_77","ec5_78","ec5_50","ec5_51"],PROJECT_OUTDATED_ERROR_CODES:["ec5_201"],ENTRY_ADD:"ADD",ENTRY_EDIT:"EDIT",ENTRY_UPLOAD:"UPLOAD",UPLOAD_STOPPING_ERROR_CODES:["ec5_11","ec5_50","ec5_51","ec5_70","ec5_71","ec5_77","ec5_78","ec5_116","ec5_201","ec5_202","ec5_255"],ENTRY:"entry",ENTRIES_TABLE:"entries",BRANCH_ENTRY:"branch_entry",BRANCH_ENTRIES_TABLE:"branch_entries",JUMPS:{IS:"IS",IS_NOT:"IS_NOT",NO_ANSWER_GIVEN:"NO_ANSWER_GIVEN",ALL:"ALL",END_OF_FORM:"END"},QUESTION_TYPES:{TEXT:"text",PHONE:"phone",TEXTAREA:"textarea",INTEGER:"integer",DECIMAL:"decimal",DATE:"date",TIME:"time",RADIO:"radio",CHECKBOX:"checkbox",DROPDOWN:"dropdown",BARCODE:"barcode",LOCATION:"location",AUDIO:"audio",VIDEO:"video",PHOTO:"photo",BRANCH:"branch",GROUP:"group",README:"readme",SEARCH_SINGLE:"searchsingle",SEARCH_MULTIPLE:"searchmultiple"},QUESTION_ANSWER_MAX_LENGTHS:{TEXT:255,PHONE:255,TEXTAREA:1e3,INTEGER:255,DECIMAL:255,DATE:25,TIME:25,RADIO:13,DROPDOWN:13,BARCODE:255,AUDIO:51,VIDEO:51,PHOTO:51,BRANCH:0,GROUP:0},DATE_FORMAT_1:"dd/MM/YYYY",DATE_FORMAT_2:"MM/dd/YYYY",DATE_FORMAT_3:"YYYY/MM/dd",DATE_FORMAT_4:"MM/YYYY",DATE_FORMAT_5:"dd/MM",TIME_FORMAT_1:"HH:mm:ss",TIME_FORMAT_2:"hh:mm:ss",TIME_FORMAT_3:"HH:mm",TIME_FORMAT_4:"hh:mm",TIME_FORMAT_5:"mm:ss",DEFAULT_TEXT_SIZE:"0",MAX_SEARCH_HITS:10,MAX_SAVED_ANSWERS:50,POSSIBLE_ANSWERS_FILTER_THRESHOLD:10,POSSIBLE_ANSWERS_LAZY_THRESHOLD:10,FILTERS:{TITLE:"title",DATES:"dates"},FILTERS_DEFAULT:{title:"",from:null,to:null,oldest:null,newest:null,get status(){return l.STATUS.ALL}},STATUS:{ALL:"ALL",INCOMPLETE:"INCOMPLETE",ERROR:"ERROR"},ANDROID_ASSETS_ABS_PATH:"file:///android_asset/www/",IOS_ASSETS_ABS_PATH:"",USER_AGENT:"",COMPONENTS_PATH:"js/components/",GEOLOCATION_TIMEOUT:3e4,GEOLOCATION_DEFAULT_ACCURACY:4,DELAY_FAST:250,DELAY_MEDIUM:500,DELAY_LONG:1e3,DELAY_EXTRA_LONG:2e3,ANDROID_APP_PRIVATE_URI:"file:///data/data/",IOS_APP_PRIVATE_URI:"",ANDROID_APP_DOWNLOAD_FOLDER:"Download/epicollect5/",PHOTO_DIR:"photos/",AUDIO_DIR:"audios/",VIDEO_DIR:"videos/",LOGOS_DIR:"logos/",ROUTES:{PWA_QUIT:"pwa-quit",PROJECTS:"projects",PROJECTS_ADD:"projects-add",ENTRIES:"entries",ENTRIES_ADD:"entries-add",ENTRIES_EDIT:"entries-edit",ENTRIES_BRANCH_ADD:"entries-branch-add",ENTRIES_VIEW:"entries-view",ENTRIES_VIEW_BRANCH:"entries-view-branch",ENTRIES_UPLOAD:"entries-upload",ENTRIES_ERRORS:"entries-errors",ENTRIES_DOWNLOAD:"entries-download",SETTINGS:"settings",NOT_FOUND:"not-found"},ENTRIES_REMOTE_PER_PAGE:50,ENTRIES_PER_PAGE:25,ANSWERS_PER_PAGE:25,POSSIBLE_ANSWERS_PER_PAGE:25,POSSIBLE_ANSWERS_LIMIT:300,SYNCED_CODES:{SYNCED_WITH_ERROR:-1,UNSYNCED:0,SYNCED:1,INCOMPLETE:2,HAS_UNSYNCED_CHILD_ENTRIES:3},EDIT_CODES:{CAN:1,CANT:0},REMOTE_CODES:{IS:1,ISNT:0},ANIMATION_FADEIN:"animated fadeIn",ANIMATION_FADEOUT:"",BARCODE_VIEW_STYLE:" card ec5-barcode ec5__input ",ACTIONS:{FILE_DELETED:"file-deleted",FILE_QUEUED:"file-queded",ENTRY_QUIT:"entry-quit",ENTRY_SAVE:"entry-save"},SETTINGS_KEYS:{SERVER_URL:"server_url",SELECTED_TEXT_SIZE:"selected_text_size",FILTERS_TOGGLE:"filters_toggle"},PWA_MIMETYPES:{PHOTO:["image/jpeg","image/jpg","image/png","image/gif"],AUDIO:["audio/mp4","audio/wav","video/mp4"],VIDEO:["video/mp4"]},PWA_UPLOAD_MAX_SIZE:{PHOTO:1e7,AUDIO:1e8,VIDEO:5e8},PWA_FILE_ACCEPTED_FORMATS:{PHOTO:"jpg or png only, max file size 10 MB, max resolution 4096 x 4096px",AUDIO:"mp4 or wav only, max file size 100 MB",VIDEO:"mp4 only, max file size 500 MB"},PWA_ADD_ENTRY:"add-entry",PWA_EDIT_ENTRY:"edit-entry",PWA_BRANCH_LOCAL:"branch-local",PWA_BRANCH_REMOTE:"branch-remote",PWA_FILE_STATE:{CACHED:"cached",STORED:"stored"},PWA_MAX_LATLONG_LENGTH:10,PWA_LANGUAGE_FILES_ENDPOINT:"/data-editor/app/assets/ec5-status-codes/",ESRI_TILES_PROVIDER_SATELLITE:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}?token=AAPK3858688abcc047c7b73ae6c65346b6c7OlPw04j4dEcRhJNzEOMAzOkoqQ2z4nYtK7cFLbKrjVTMHjir9FmGIVG7jW8XfO4k",ESRI_TILES_PROVIDER_ATTRIBUTION:"Powered by Esri | Esri, Maxar, Earthstar Geographics, and the GIS User Community",MAPBOX_TILES_PROVIDER_OUTDOOR:"https://api.mapbox.com/styles/v1/mapbox/outdoors-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2dwc2RldiIsImEiOiJjbDVtcmlnb2Qwd244M29wamN0ZXI0cHAwIn0.tiEq4l6h2IIANHQfVhLu8A",MAPBOX_TILES_ATTRIBUTION:'© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',STAMEN_HIGH_CONTRAST_TILES_PROVIDER:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.png",STAMEN_TILES_ATTRIBUTION:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',CARTO_LIGHT_TILES_PROVIDER:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",CARTO_TILES_ATTRIBUTION:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; <a href="https://carto.com/attribution">CARTO</a>',OSM_TILES_PROVIDER:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",OSM_TILES_ATTRIBUTION:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',REGEX_BOOKMARK_TITLE:/^[\w\-\s]+$/},u={dbVersionName:"db_version",dbVersion:1},c={PROJECT_LOGO_IMG_FILENAME:"ec5-demo-project-logo.jpg",PROJECT_LOGO_STORED_FILENAME:"mobile-logo.jpg",PROJECT_FILENAME:"./assets/ec5-demo-project.json",PROJECT_NAME:"EC5 Demo Project",PROJECT_SLUG:"ec5-demo-project",PROJECT_REF:"b963c3867b1441b89cb552b982f04bc8",LAST_UPDATED:"2016-10-26 16:06:57",PROJECT_EXTRA:"",MAPPING:""},d={0:"ec5_109",1:"ec5_104",2:"ec5_105",3:"ec5_106",4:"ec5_107",5:"ec5_108",6:"ec5_109",7:"ec5_110"},p=(0,s.Q_)("RootStore",{state:()=>({serverUrl:"",device:{},isPWA:!1,app:{},language:l.DEFAULT_LANGUAGE,tempDir:"",persistentDir:"",hierarchyNavigation:[],selectedTextSize:l.DEFAULT_TEXT_SIZE,filtersToggle:!1,continueProjectVersionUpdate:!1,user:{jwt:null,name:"",email:"",action:""},deviceGeolocation:{error:null,position:null,watchId:0},geolocationPermission:!1,routeParams:{},routeParamsEntries:{},progressDialog:null,nextRoute:null,attemptedUploadOrErrorFix:!1,progressTransfer:{total:0,done:0},modalLogin:{},afterUserIsLoggedIn:{callback:null,params:null},isAudioModalActive:!1,isLocationModalActive:!1,ec5LoadingDialog:null,hasGoogleServices:!0,entriesAddScope:{},queueFilesToDelete:[],searchParams:null,notFound:!1,queueTempBranchEntriesPWA:{},queueRemoteFilesToDeletePWA:[],queueBranchUploadErrorsPWA:{},queueGlobalUploadErrorsPWA:[],branchEditType:l.PWA_BRANCH_LOCAL,providedSegment:null}),getters:{},actions:{}});var m=n(2931),_={name:"App",components:{IonApp:i.IonApp,IonRouterOutlet:i.IonRouterOutlet},setup(){const e=p(),t={needsDrawers:(0,m.Fl)((()=>e.device.platform!==l.PWA))};return(0,a.bv)((async()=>{e.isPWA&&document.querySelector("#loader.loader-placeholder").remove()})),{...t}}},f=n(3744);var w=(0,f.Z)(_,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("left-drawer"),l=(0,a.up)("right-drawer"),u=(0,a.up)("ion-router-outlet"),c=(0,a.up)("ion-app");return(0,a.wg)(),(0,a.j4)(c,null,{default:(0,a.w5)((()=>[e.needsDrawers?((0,a.wg)(),(0,a.j4)(i,{key:0})):(0,a.kq)("",!0),e.needsDrawers?((0,a.wg)(),(0,a.j4)(l,{key:1})):(0,a.kq)("",!0),(0,a.Wm)(u,{id:"main"})])),_:1})}]]),g=n(1089),h=n(6612);const E={key:1},y={class:"projects-list"};var A={props:{projects:{type:Array,required:!0},page:{type:String,required:!0}},emits:["project-selected"],setup(e,t){const n=l.PROJECT_LOGO_PRIVATE,r=(0,m.OT)(e.projects),s=(0,m.qj)({imagesLoaded:[]}),o={onImgLoaded(e){s.imagesLoaded.push(e)},handleSelectedProject(e){t.emit("project-selected",e)},getProjectLogo(t){let r="";return"add-project"===e.page&&("private"===t.access&&(r=n),"public"===t.access&&(r=t.logo)),"projects"===e.page&&(r=t.logo),r}},a={projects:(0,m.Fl)((()=>[...new Map(r.map((e=>[e.ref,e]))).values()]))};return{props:e,state:s,...o,...a}}};var S=(0,f.Z)(A,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-spinner"),u=(0,a.up)("ion-img"),c=(0,a.up)("ion-avatar"),d=(0,a.up)("ion-label"),p=(0,a.up)("ion-item");return(0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.projects,((t,n)=>((0,a.wg)(),(0,a.j4)(p,{key:t.ref,onClick:n=>e.handleSelectedProject(t)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(l,{class:"spinner",name:"crescent"},null,512),[[r.F8,!s.state.imagesLoaded.includes(n)]]),(0,a.Wm)(u,{class:"animate__animated animate__fadeIn",src:e.getProjectLogo(t),onIonImgDidLoad:t=>e.onImgLoaded(n)},null,8,["src","onIonImgDidLoad"])])),_:2},1024),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,h.zw)(t.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128)}],["__scopeId","data-v-7d892f1c"]]),T=n(1024);const b={en:{labels:{address:"Address",exit:"Exit",editing_branches_pwa:"Please note: to edit existing branch entries you must use the Epicollect5 Data Viewer.",format:"Format",clear_filters:"Clear Filters",invalid_value:"Invalid value",search:"Search",are_you_sure:"Are you sure?",delete:"Delete",share:"Share",locate:"Locate",or:"OR",check_email:"Check your email",enter_password:"Please enter password for verification",code_was_sent:"A code was sent for verification",account_exists:"Account already exists",login_with_email:"Login With Email",passwordless_teaser:"We will send you a code to your inbox",enter_code:"Enter code",send:"Send",all:"All",incomplete:"Incomplete",has_errors:"Error",wrong_range:"Range Invalid",invalid_entries:"Invalid Entries",add_branch:"Add Branch",status:"Status",from:"From",to:"To",reset:"Reset",show:"Show",show_filters:"Show filters on entries list",hide_filters:"Hide filters",filters:"Filters",filter_by_title:"Filter by title",no_hits_found:"Nothing found",not_available:"Not available",name:"Name",description:"Description",small_description:"Small Description",homepage:"Homepage",project_info:"Project Info",version:"Version",advanced_settings:"Advanced",ok:"Ok",download_remote_entries:"Download remote entries",remote_entry:"Remote entry",entry:"Entry",download_warning:"This will remove any remote entries you already have for this project on your device. Continue?",text_size:"Text size",accessibility:"Accessibility",type_answer_here:"Type answer here...",confirm_answer_here:"Confirm answer here...",confirm:"Confirm",help:"Help",user_guide:"User Guide",hi:"Hi",prev:"Prev",next:"Next",quit:"Quit",save:"Save",save_entry:"Save entry",quit_entry:"Quit",save_branch_entry:"Save branch",quit_branch:"Quit",login:"Login",logout:"Logout",scan:"Scan",entries:"entries",branch_entries:"Branch entries",update_location:"Update location",not_located_yet:"Not set yet",latitude:"Latitude",longitude:"Longitude",accuracy:"Accuracy",unknown_error:"Unknown error",db_created:"Epicollect5 database ready",db_not_created:"Error creating Epicollect5 database!",locating:"Locating",wait:"Please Wait...",saving:"Saving...",loading:"Loading...",acquiring_position:"Acquiring position",location_acquired:"Location acquired",location_fail:"Not able to locate!",location_service_fail:"Location Services and Permissions must both be enabled for Epicollect5 to get the device location.",ios_location_permission_denied:"Epicollect5 location permission was denied, please enable it in Settings",ios_location_permission_restricted:"Epicollect5 location permission is restricted for the current user",android_location_permission_denied_always:"Epicollect5 location permission is denied, please grant it. It is not possible to use Location Services without appropriate permission",no_projects_found:"No projects found",date_selected_is:"The date selected is: ",time_selected_is:"The time selected is: ",preparing_scanner:"Preparing scanner",failed_because:"Failed because: ",stop:"Stop",play:"Play",record:"Record",recording:"Recording",playing:"Playing",recording_audio:"Recording audio...",playing_audio:"Playing audio...",shoot:"Shoot",video_saved:"Video saved",audio_saved:"Audio saved",cannot_save_file:"Cannot save the file! Please retry",file_available:"File available",uploading:"Uploading",uploading_entries:"Uploading Entries",loading_project:"Loading project",loading_entries:"Loading entries",loading_entry:"Loading entry",no_entries_found:"No entries found",no_errors_found:"No errors found",pick_possible_answer:"Pick possible answer",permission_denied:"Permission denied",location_not_available:"Location is not available, Epicollect5 will not be able to locate you.",min:"Min",max:"Max",no_answer_given:"No answer given ",error:"Error",delete_project:"Delete Project",delete_entry:"Delete Entry",delete_all_entries:"Delete All Entries",delete_synced_entries:"Delete Synced Entries",delete_unsynced_entries:"Delete Unsynced Entries",bookmark:"Bookmark",bookmark_title:"Add a bookmark title",close:"Close",add_bookmark:"Add Bookmark",add_entry:"Add Entry",type_hint:"Type here",menu:"Menu",project_options:"Project Options",upload_entries:"Upload Entries",download_entries:"Download Entries",unsync_all_entries:"Unsync All Entries",export_all_entries:"Export All Entries",unsynced:"Unsynced",unsync_entry:"Unsync Entry",bookmark_page:"Bookmark Page",remove_bookmark:"Remove Bookmark",sort:"Sort",newest:"Newest",oldest:"Oldest",sign_in:"Signing in",no_bookmarks_found:"No bookmarks found",my_bookmarks:"My Bookmarks",export_entries:"Export json entries",exporting:"Exporting",exporting_success:"All Entries Exported!",exported_to:"Exported to: ",deleting_project:"Deleting Project",deleting_entries:"Deleting Entries",entry_deleted:"Entry Deleted",file_deleted:"File Deleted",email:"Email",password:"Password",ldap_username:"Ldap Username",ldap_password:"Ldap Password",google_sign_in:"Google Sign In",upload_data:"Upload data",upload_photos:"Upload photos",upload_videos:"Upload videos",upload_audios:"Upload audio",uploading_photos:"Uploading photos",uploading_videos:"Uploading videos",uploading_audios:"Uploading audio",all_entries_uploaded:"All Entries Uploaded",file_uploaded:"File uploaded",entries_errors:"Some of the entries have errors",children:"Children",search_for_project:"Search for a project",add_project:"Add Project",projects:"Projects",delete_branch_entry:"Delete Branch Entry",back:"Back",settings:"Settings",server_url:"Server Url",server_url_placeholder:"eg http://www.mydomain.com",downloads:"Downloads",download:"Download",warning:"Warning",missing_permission:"You must grant the appropriate permission to perform this action",please_wait:"Please Wait...",server_url_error:"Server not found, please check your server URL in the settings",quitting:"Quitting",cancel:"Cancel",project_outdated:"Form has been updated.",update_project:"Update form on your device?",project_updated:"Forms updated.",updating_project:"Updating Forms.",updating_entries:"Updating entries.",check_for_updates:"Check for Form Updates",checking_for_updates:"Checking for updates...",loading_projects:"Loading Projects",incomplete_entry:"This entry is incomplete",entry_completed:"Entry completed",unsynced_entries:"Unsynced entries",unsynced_entry:"Entry unsynced.",sync_now:"Upload",save_entry_and_sync:"Save entry and Sync",check_entries:"Check entries",connect_to_internet_to_upload:"Please connect to the internet to upload entries.",entries_errors_page:"Entries with Errors",check_entries_below:"Check the entries below for errors.",branch:"Branch",pattern:"Pattern",required:"* This field is required",entries_media_errors:"Could not upload your media. Please try again later.",db_updated:"Database updated.",downloading_entries:"Downloading entries",all_entries_downloaded:"All Entries Downloaded.",unsaved_branch_entries:"Unsaved Branch Entries",save_now:"Save Now",incomplete_entries:"You have incomplete entries which cannot be uploaded.",load_more:"Load More",take:"Take",pick:"Pick",collected_on:"Collected on ",dismiss:"Dismiss"}},it:{labels:{address:"Indirizzo",exit:"Esci",editing_branches_pwa:"Nota: per visualizzare le voci BRANCH esistenti è possibile utilizzare Epicollect5 Data Viewer.",format:"Formato",clear_filters:"Ripristina Filtri",invalid_value:"Invalido",search:"Cerca",are_you_sure:"Sei sicuro?",delete:"Elimina",share:"Esporta",locate:"Localizza",or:"Oppure",check_email:"Controlla la posta",enter_password:"Inserire password per verifica",code_was_sent:"Codice verifica inviato",account_exists:"Account esistente",login_with_email:"Login con Email",passwordless_teaser:"Ti mandiamo un codice nella tua inbox",enter_code:"Inserisci codice",send:"Invia",all:"Tutte",incomplete:"Incomplete",has_errors:"Errori",wrong_range:"Intervallo date invalido",invalid_entries:"Voci non valide",add_branch:"Aggiungi Branch",status:"Status",from:"Da",to:"A",reset:"Resetta",show:"Mostra",show_filters:"Mostra filtri sopra la lista voci",hide_filters:"Nascondi filtri",filters:"Filtri",filter_by_title:"Filtra per titolo",no_hits_found:"Trovato niente",not_available:"Non disponibile",name:"Nome",description:"Descrizione",small_description:"Piccola descrizione",homepage:"Homepage",project_info:"Informazioni Progetto",version:"Versione",advanced_settings:"Impostazioni avanzate",ok:"Ok",download_remote_entries:"Scarica voci remote",remote_entry:"Voce remota",entry:"Voce",download_warning:"Questa azione rimuove tutte le voci remote esistenti sul dispositivo per questo progetto. Continuare?",text_size:"Dimensione testo",accessibility:"Accessibilità",type_answer_here:"Scrivi qui...",confirm_answer_here:"Conferma risposta qui...",confirm:"Conferma",help:"Supporto",user_guide:"Istruzioni",hi:"Ciao",prev:"Prec",next:"Succ",quit:"Esci",save:"Salva",save_entry:"Salva voce",quit_entry:"Esci",save_branch_entry:"Salva branch",quit_branch:"Esci",login:"Login",logout:"Logout",scan:"Scan",entries:"voci",branch_entries:"Voci Branch",update_location:"Aggiorna posizione",not_located_yet:"N/A",latitude:"Latitudine",longitude:"Longitudine",accuracy:"Accuratezza",unknown_error:"Errore sconosciuto",db_created:"Epicollect5 database pronto",db_not_created:"Errore creazione Epicollect5 database!",locating:"Localizzando",wait:"Aspetta...",saving:"Salvando...",loading:"Caricando...",acquiring_position:"Cercando posizione...",location_acquired:"Posizione acquisita",location_fail:"Incapace di localizzare!",location_service_fail:"Geolocalizzazione e Permessi devono essere abilitati per Epicollect5 al fine di localizzare il dispositivo",ios_location_permission_denied:"Epicollect5 permesso di localizzazione negato, abilitarlo nelle impostazioni",ios_location_permission_restricted:"Epicollect5 permesso di localizzazione solo per utente corrente",android_location_permission_denied_always:"Epicollect5 permesso geolocalizzazione negato, per favore garantirlo. Non èpossible usare geolocalizzazione senza il permesso appropriato",no_projects_found:"Nesun progetto trovato",date_selected_is:"Data selezionata: ",time_selected_is:"Ora selezionata: ",preparing_scanner:"Preparazione scanner...",failed_because:"Fallito perchè: ",stop:"Stop",play:"Play",record:"Record",recording:"Registrando",playing:"Playing",recording_audio:"Registrando audio...",playing_audio:"Playing audio...",shoot:"Riprendi",video_saved:"Video salvato",audio_saved:"Audio salvato",cannot_save_file:"Non si è potuto salvare il file! Riprovare",file_available:"File disponibile",uploading:"Caricando",uploading_entries:"Carica voci",loading_project:"Caricando progetto",loading_entries:"Caricando voci",loading_entry:"Caricando voce",no_entries_found:"Nessuna voce trovata",no_errors_found:"Nessun errore",pick_possible_answer:"Scegli possible risposta",permission_denied:"Permesso negato",location_not_available:"Gelocalizzazione non disponibile, Epicollect5 non può  localizzarti.",min:"Min",max:"Max",no_answer_given:"Nessuna risposta fornita ",error:"Errore",delete_project:"Elimina progetto",delete_entry:"Elimina voce",delete_all_entries:"Elimina tutte le voci ",delete_synced_entries:"Elimina voci sincronizzate",delete_unsynced_entries:"Elimina voci non sincronizzate",bookmark:"Segnalibro",bookmark_title:"Aggiungi titolo per segnalibro",close:"Chiudi",add_bookmark:"Aggiungi segnalibro",add_entry:"Aggiungi voce",type_hint:"Scrivi qui",menu:"Menu",project_options:"Opzioni progetto",upload_entries:"Carica voci",download_entries:"Scarica voci",unsync_all_entries:"De-sync tutte le voci",export_all_entries:"Exporta tutte le voci",unsync_entry:"De-sync voce",unsynced:"De-sync completato",bookmark_page:"Aggiungi ai segnalibri",remove_bookmark:"Rimuovi dai segnalibri",sort:"Ordina",newest:"Dal più nuovo",oldest:"Dal più vecchio",sign_in:"Entrando",no_bookmarks_found:"Nessun segnalibro trovato",my_bookmarks:"Segnalibri",export_entries:"Esporta voci in formato json",exporting:"Esportando",exporting_success:"Tutte le voci esportate!",exported_to:"Esportate in: ",deleting_project:"Elimina progetto",deleting_entries:"Elimina voci",entry_deleted:"Voce cancellata",file_deleted:"File cancellato",email:"Email",password:"Password",ldap_username:"Ldap Username",ldap_password:"Ldap Password",google_sign_in:"Google Sign In",upload_data:"Carica dati",upload_photos:"Carica foto",upload_videos:"Carica video",upload_audios:"Carica audio",uploading_photos:"Caricando foto",uploading_videos:"Caricando video",uploading_audios:"Caricando audio",all_entries_uploaded:"Tutte le voci caricate",file_uploaded:"File caricato",entries_errors:"Alcune voci hanno errori",children:"Figli",search_for_project:"Cerca progetto",add_project:"Aggiungi progetto",projects:"Progetti",delete_branch_entry:"Elimina voce branch",back:"Indietro",settings:"Impostazioni",server_url:"URL del server",server_url_placeholder:"ex. http://www.mydomain.com",downloads:"Downloads",download:"Scarica",warning:"Attenzione",missing_permission:"Devi concedere il permesso di compiere questa azione",please_wait:"Aspetta...",server_url_error:"Server non trovato, controlla il server URL nelle impostazioni",quitting:"Uscendo",cancel:"Cancella",project_outdated:"Modulo aggiornato.",update_project:"Aggiorna modulo sul tuo dispositivo?",project_updated:"Moduli aggiornato.",updating_project:"Aggiornando moduli.",updating_entries:"Aggiornando voci.",check_for_updates:"Controllo per aggiornamento moduli...",checking_for_updates:"Controllo per aggiornamenti...",loading_projects:"Caricando progetti",incomplete_entry:"Questa voce è incompleta",entry_completed:"Voce completa",unsynced_entries:"Voci non sincronizzate",unsynced_entry:"Voce non sincronizzata",sync_now:"Upload",save_entry_and_sync:"Salva voce e sync",check_entries:"Controlla voci",connect_to_internet_to_upload:"Connessione internet richiesta per caricare voci",entries_errors_page:"Voci con errori",check_entries_below:"Controlla voci per errori",branch:"Branch",pattern:"Pattern",required:"* campo obbligatorio",entries_media_errors:"Non è possibile caricre media. Rirpova più tardi.",db_updated:"Database aggiornato.",downloading_entries:"Scaricando voci",all_entries_downloaded:"Tutte le voci scaricate",unsaved_branch_entries:"Voci BRANCH non salvate",save_now:"Salva ora",incomplete_entries:"Ci sono voci incomplete che non possono essere caricate",load_more:"Mostra di più",take:"Camera",pick:"Galleria",collected_on:"Aggiunta il ",dismiss:"Chiudi"}},es:{labels:{address:"Dirección",exit:"Terminar",editing_branches_pwa:"Tenga en cuenta: para ver las entradas BRANCH existentes, puede usar Epicollect5 Data Viewer.",format:"Formato",clear_filters:"Reiniciar Filtros",invalid_value:"No válido",search:"Buscar",are_you_sure:"¿Estás seguro?",delete:"Eliminar",share:"Exportar",locate:"Localizar",or:"O",check_email:"Consultar su email",enter_password:"Ingrese la password para la verificación",code_was_sent:"Se envió un código para verificación",account_exists:"Account ya existe",login_with_email:"Iniciar sesión con email",passwordless_teaser:"Le enviaremos un código",enter_code:"Introduzca el código",send:"Enviar",all:"Todos",incomplete:"Incompleta",has_errors:"Error",wrong_range:"Intervalo incorrecto",invalid_entries:"Entradas inválidas",add_branch:"Añadir Branch",status:"Status",from:"Desde",to:"A",reset:"Reiniciar",show:"Mostrar",show_filters:"Mostrar filtros en la lista de entradas",hide_filters:"Ocultar filtros",filters:"Filtros",filter_by_title:"Filtrar por título",no_hits_found:"No se encontró nada",not_available:"No disponible",name:"Nombre",description:"Descripción",small_description:"Pequeña descripción",homepage:"Página principal",project_info:"Información del proyecto",version:"Versión",advanced_settings:"Avanzado",ok:"Ok",download_remote_entries:"Descargar entradas remotas",remote_entry:"Entrada remota",entry:"Entrada",download_warning:"Esto eliminará cualquier entrada remota que ya tengas para este proyecto en tu dispositivo. ¿Continuar?",text_size:"Tamaño del texto",accessibility:"Accesibilidad",type_answer_here:"Escriba la respuesta aquí...",confirm_answer_here:"Confirmar la respuesta aquí...",confirm:"Confirmar",help:"Auxilio",user_guide:"Instrucciones",hi:"Hola",prev:"Prev",next:"Próx",quit:"Abandonar",save:"Guardar",save_entry:"Guardar entrada",quit_entry:"Abandonar entrada",save_branch_entry:"Guardar branch",quit_branch:"Abandonar",login:"Iniciar sesión",logout:"Cerrar sesión",scan:"Escanear",entries:"entradas",branch_entries:"Branch entradas",update_location:"Actualizar ubicación",not_located_yet:"N/D",latitude:"Latitud",longitude:"Longitud",accuracy:"Precisión",unknown_error:"Error desconocido",db_created:"Base de datos Epicollect5 creada",db_not_created:"Error al crear la bases de datos Epicollect5!",locating:"Localización",wait:"Espere...",saving:"Guardando...",loading:"Cargando...",acquiring_position:"Adquirir la ubicación...",location_acquired:"Ubicación adquirida",location_fail:"No se pudo localizar!",location_service_fail:"La geolocalización y permisos deben estar habilitadas para Epicollect5 con el fin de localizar su dispositivo",ios_location_permission_denied:"Epicollect5 negó el permiso de localización, que permite en la configuración",ios_location_permission_restricted:"Epicollect5 localización permite solamente al usuario actual",android_location_permission_denied_always:"Epicollect5 localización negó el permiso, por favor provea. No es posible usar geolocalización sin la autorización correspondiente",no_projects_found:"No se encontraron proyectos",date_selected_is:"Fecha seleccionada: ",time_selected_is:"Hora seleccionada: ",preparing_scanner:"Preparación del escáner...",failed_because:"Falló porque: ",stop:"Detener",play:"Reproducir",record:"Grabar",recording:"Grabando",playing:"Reproduciendo",recording_audio:"Grabando audio...",playing_audio:"Reproduciendo audio...",shoot:"Grabar",video_saved:"Video guardado",audio_saved:"Audio guardado",cannot_save_file:"Archivo no guardado! Inténtelo de nuevo",file_available:"Archivo disponible",uploading:"Cargar",uploading_entries:"Cargar entradas",loading_project:"Cargar proyecto",loading_entries:"Cargando entradas",loading_entry:"Cargando entrada",no_entries_found:"No encontradas",no_errors_found:"No hay error",pick_possible_answer:"Elige la respuesta posible",permission_denied:"Permiso denegado",location_not_available:"La geolocalización no se encuentra disponible, Epicollect5 no puede localizarte.",min:"Min",max:"Max",no_answer_given:"Ninguna respuesta proveída ",error:"Error",delete_project:"Eliminar proyecto",delete_entry:"Eliminar entrada",delete_all_entries:"Eliminar todas las entradas ",delete_synced_entries:"Eliminar entradas sincronizadas",delete_unsynced_entries:"Eliminar entradas no sincronizadas",bookmark:"Marcador",bookmark_title:"Título del marcador",close:"Cerrar",add_bookmark:"Añadir marcador",add_entry:"Añadir entrada",type_hint:"Escriba aquí",menu:"Menú",project_options:"Opciones del proyecto",upload_entries:"Subir entradas",download_entries:"Descargar entradas",unsync_all_entries:"Desincronizar entradas",export_all_entries:"Exportar entradas",unsync_entry:"Desincronizar entrada",unsynced:"Entradas desincronizadas",bookmark_page:"Marca esta pagina",remove_bookmark:"Eliminar marcador",sort:"Orden",newest:"El más nuevo",oldest:"El más antiguo",sign_in:"Iniciar",no_bookmarks_found:"Ningún marcadores",my_bookmarks:"Marcadores",export_entries:"Exportar entradas",exporting:"Exportando",exporting_success:"Todas las entradas exportadas!",exported_to:"Exportado a: ",deleting_project:"Eliminando proyecto",deleting_entries:"Eliminando entradas",entry_deleted:"Entrada suprimida",file_deleted:"File suprimido",email:"Email",password:"Password",ldap_username:"Ldap Username",ldap_password:"Ldap Password",google_sign_in:"Google Sign In",upload_data:"Subir datos",upload_photos:"Subir fotos",upload_videos:"Subir videos",upload_audios:"Subir audios",uploading_photos:"Subiendo fotos",uploading_videos:"Subiendo videos",uploading_audios:"Subiendo audios",all_entries_uploaded:"Todas las entradas subidas",file_uploaded:"File subido",entries_errors:"Algunas entradas tienen errores",children:"Niños",search_for_project:"Buscar proyecto",add_project:"Añadir proyecto",projects:"Proyectos",delete_branch_entry:"Eliminar entrada branch",back:"Regresar",settings:"Configuración",server_url:"URL del servidor",server_url_placeholder:"ej. http://www.mydomain.com",downloads:"Descargas",download:"Descarga",warning:"Advertencia",missing_permission:"Necesitas permiso para realizar esta acción",please_wait:"Espere...",server_url_error:"Servidor no encontrado. Compruebe la URL del servidor en la configuración",quitting:"Abandonando",cancel:"Cancelar",project_outdated:"formulario desactualizado.",update_project:"Actualizar proyecto en el dispositivo?",project_updated:"Formularios actualizados.",updating_project:"Actualizando de formularios...",updating_entries:"Actualizando de entradas.",check_for_updates:"Buscar actualizaciones de formularios...",checking_for_updates:"Buscando actualizaciones...",loading_projects:"Cargando proyectos",incomplete_entry:"Entrada incompleta",entry_completed:"Entrada completa",unsynced_entries:"Entradas no sincronizadas",unsynced_entry:"Entrada no sincronizada",sync_now:"Sincronizar",save_entry_and_sync:"Guardar entrada y sincronizar",check_entries:"Comprobar entradas",connect_to_internet_to_upload:"Se requiere conexión a Internet",entries_errors_page:"Entradas con errores",check_entries_below:"Compruebe las entradas de los errores",branch:"Branch",pattern:"Pattern",required:"* Requerido",entries_media_errors:"Error al cargar medios. Intenta más tarde",db_updated:"Base de datos actualizada",downloading_entries:"Descarga de entradas",all_entries_downloaded:"Todas las entradas descargadas",unsaved_branch_entries:"Entradas BRANCH no guardadas",save_now:"Guardar ahora",incomplete_entries:"Las entradas incompletas no se pueden cargar",load_more:"Mostrar más",take:"Cámara",pick:"Galería",collected_on:"Recogida en ",dismiss:"Cerrar"}},fr:{labels:{address:"Adresse",exit:"Sortir",editing_branches_pwa:"Remarque: pour afficher les entrées BRANCH existantes, vous pouvez utiliser Epicollect5 Data Viewer.",format:"Format",clear_filters:"Effacer filtres",invalid_value:"Valeur invalide",search:"Chercher",are_you_sure:"Es-tu sûr?",delete:"Supprimer",share:"Exporter",locate:"Localiser",or:"Ou",check_email:"Vérifiez votre email",enter_password:"Veuillez saisir password pour vérification",code_was_sent:"Un code a été envoyé pour vérification",account_exists:"Account existe déjà",login_with_email:"Se connecter par e-maill",passwordless_teaser:"Nous vous enverrons un code",enter_code:"Entrez le code",send:"Envoyer",all:"Toute",incomplete:"Incomplète",has_errors:"Erreur",wrong_range:"Intervalle incorrect",invalid_entries:"Entrées invalides",add_branch:"Ajouter Branch",status:"Status",from:"De",to:"À",reset:"Réinitialiser",show:"Afficher",show_filters:"Afficher les filtres",hide_filters:"Masquer les filtres",filters:"Filtres",filter_by_title:"Filtrer par titre",no_hits_found:"Rien n'a été trouvé",not_available:"Indisponible",name:"Prénom",description:"Description",small_description:"Petite description",homepage:"Homepage",project_info:"Informations sur le projet",version:"Version",advanced_settings:"Avancé",ok:"Ok",download_remote_entries:"Télécharger les entrées distantes",remote_entry:"Entrée à distance",entry:"Entrée",download_warning:"Ceci remplacera les données déjà téléchargées pour ce projet sur votre mobile. Continuer?",text_size:"Taille du texte",accessibility:"Accessibilité",type_answer_here:"Tapez la réponse ici...",confirm_answer_here:"Confirmer la réponse ici...",confirm:"Confirmer",help:"Aidez-moi",user_guide:"Mode d'emploi",hi:"Salut",prev:"Retour",next:"Suite",quit:"Quitter",save:"Enr",save_entry:"Enregistrer",quit_entry:"Quitter",save_branch_entry:"Enregistrer branch",quit_branch:"Quitter",login:"Se connecter",logout:"Se déconnecter",scan:"Scanner",entries:"entrées",branch_entries:"Branch entrées",update_location:"Actualiser la position",not_located_yet:"Pas encore réglé",latitude:"Latitude",longitude:"Longitude",accuracy:"Précision",unknown_error:"Erreur inconnue",db_created:"Base de données Epicollect5 prête",db_not_created:"Erreur de création de base de données Epicollect5!",locating:"Localisation",wait:"Patientez svp...",saving:"Sauvegarde...",loading:"Chargement...",acquiring_position:"Acquisition de la position",location_acquired:"Localisation acquise",location_fail:"Impossible de localiser!",location_service_fail:"Les services de localisation et les autorisations doivent tous deux être activés pour que Epicollect5 obtienne la localisation de l'appareil.",ios_location_permission_denied:"L'autorisation de localisation d'Epicollect5 a été refusée, veuillez l'activer dans les Réglages",ios_location_permission_restricted:"L'autorisation de localisation Epicollect5 est limitée pour l'utilisateur actuel",android_location_permission_denied_always:"L'autorisation de localisation Epicollect5 est refusée, veuillez l'accorder. Il n'est pas possible d'utiliser les services de localisation sans l'autorisation appropriée",no_projects_found:"Aucun projet trouvé",date_selected_is:"La date choisie est: ",time_selected_is:"L'heure choisie est: ",preparing_scanner:"Préparation du scanner",failed_because:"Cause de l'échec: ",stop:"Stop",play:"Lecture",record:"Enregistrer",recording:"Enregistrement",playing:"Lecture",recording_audio:"Enregistrement audio...",playing_audio:"Lecture audio...",shoot:"Shoot",video_saved:"Vidéo enregistrée",audio_saved:"Audio enregistrée",cannot_save_file:"Impossible d'enregistrer le fichier! Réessayez",file_available:"Fichier disponible",uploading:"Envoi",uploading_entries:"Envoi des entrées",loading_project:"Chargement du projet",loading_entries:"Chargement des entrées",loading_entry:"Chargement de l'entrée",no_entries_found:"Aucune entrée trouvée",no_errors_found:"Pas d'erreur",pick_possible_answer:"Choisir une réponse possible",permission_denied:"Permission refusée",location_not_available:"La localisation n'est pas disponible, Epicollect5 ne pourra pas vous localiser.",min:"Min",max:"Max",no_answer_given:"Pas de réponse donnée ",error:"Erreur",delete_project:"Supprimer le projet",delete_entry:"Supprimer l'entrée",delete_all_entries:"Supprimer toutes les entrées",delete_synced_entries:"Supprimer les entrées synchronisées",delete_unsynced_entries:"Supprimer les entrées non synchronisées",bookmark:"Signet",bookmark_title:"Ajouter un titre de signet",close:"Fermer",add_bookmark:"Ajouter un signet",add_entry:"Ajouter une entrée",type_hint:"Ecrire ici",menu:"Menu",project_options:"Options de Projet",upload_entries:"Envoyer les entrées",download_entries:"Télécharger les entrées",unsync_all_entries:"Désinstaller toutes les entrées",unsync_entry:"Désynchroniser les entrées",unsynced:"Toutes les entrées desynchronisées",bookmark_page:"Créer un signet",remove_bookmark:"Retirer le signet",sort:"Ordonner",newest:"Le plus récent",oldest:"Le plus ancien",sign_in:"Connectez-vous",no_bookmarks_found:"Aucun signé trouvé",my_bookmarks:"Mes signets",export_entries:"Exporter les entrées json",exporting:"Export en cours",exporting_success:"Toutes les entrées exportées!",exported_to:"Exporté vers: ",deleting_project:"Suppression du projet",deleting_entries:"Suppression des entrées",entry_deleted:"Entrée supprimée",file_deleted:"File supprimée",email:"Email",password:"Mot de passe",ldap_username:"Nom Ldap",ldap_password:"Mot de passe Ldap",google_sign_in:"Connexion Google",upload_data:"Envoyer les données",upload_photos:"Envoyer les photos",upload_videos:"Envoyer les vidéos",upload_audios:"Envoyer les sons",uploading_photos:"Envoi de photos",uploading_videos:"Envoi de vidéos",uploading_audios:"Envoi de son",all_entries_uploaded:"Toutes les entrées envoyées",file_uploaded:"File envoyée",entries_errors:"Certaines entrées ont des erreurs",children:"Enfants",search_for_project:"Chercher un projet",add_project:"Ajout Projet",projects:"Projets",delete_branch_entry:"Supprimer l'entrée de branche",back:"Retour",settings:"Réglages",server_url:"Url du serveur",server_url_placeholder:"ex http://www.mydomain.com",downloads:"Téléchargements",download:"Téléchargement",warning:"Avertissement",missing_permission:"Vous devez accorder l'autorisation appropriée pour effectuer cette action",please_wait:"SVP attendez...",server_url_error:"Serveur non trouvé, vérifiez l'URL de votre serveur dans les réglages",quitting:"Sortie",cancel:"Annuler",project_outdated:"Le formulaire a été mis à jour.",update_project:"Mettre à jour le formulaire sur votre mobile?",project_updated:"Formulaires mis à jour.",updating_project:"Mise à jour des formulaires.",updating_entries:"Mise à jour des entrées.",check_for_updates:"Recherche de mises à jour de formulaires",checking_for_updates:"Recherche de mises à jour...",loading_projects:"Chargement de Projets",incomplete_entry:"Cette entrée est incomplète",entry_completed:"Entrée complète",unsynced_entries:"Entrées NON synchronisées",unsynced_entry:"entrée NON synchronisée.",sync_now:"Synchroniser",save_entry_and_sync:"Sauvegarder l'entrée et Synchroniser",check_entries:"Vérifier les entrées",connect_to_internet_to_upload:"SVP connectez-vous à internet pour envoyer les entrées.",entries_errors_page:"Entrées avec Erreurs",check_entries_below:"Vérifier les entrées ci-dessous.",branch:"Branche",pattern:"Modèle",required:"* Ce champ est requis",entries_media_errors:"Impossible d'envoyer les médias. SVP veuillez réessayer plus tard.",db_updated:"Base de données mise à jour.",downloading_entries:"Téléchargement des entrées",all_entries_downloaded:"Toutes les entrées téléchargées.",unsaved_branch_entries:"Entrées de branche non sauvées.",save_now:"Sauvegarder",incomplete_entries:"Vous avez des entrées incomplètes qui ne peuvent être envoyées.",load_more:"Charger Plus",take:"Prendre",pick:"Choisir",collected_on:"Collectée le ",dismiss:"Annuler"}},pl:{labels:{address:"Adress",exit:"Exit",editing_branches_pwa:"Uwaga: aby wyświetlić istniejące wpisy oddziałów, można użyć przeglądarki danych Epicollect5.",format:"Format",clear_filters:"Wyczyść filtry",invalid_value:"Niewłaściwa wartość",search:"Szukaj",are_you_sure:"Jesteś pewny?",delete:"Skasuj",share:"Exportuj",locate:"Lokalizować",or:"lub",check_email:"Sprawdź swój email",enter_password:"Wprowadź hasło w celu weryfikacji",code_was_sent:"Kod został wysłany do weryfikacji",account_exists:"Account już istnieje",login_with_email:"Zaloguj się za pomocą e-maila",passwordless_teaser:"Wyślemy ci kod do skrzynki odbiorczej",enter_code:"Wprowadź kod",send:"Wysłać",all:"Wszystko",incomplete:"Niekompletny",has_errors:"Błąd",wrong_range:"Niepoprawny odstęp",invalid_entries:"Nieprawidłowe wpisy",add_branch:"Dodaj Branch",status:"Status",from:"From",to:"To",reset:"Reset",show:"Pokaż",show_filters:"Pokaż filtry na liście wpisów",hide_filters:"Ukryj filtry",filters:"Filtry",filter_by_title:"Filtruj według tytułu",no_hits_found:"Nic nie znaleziono",not_available:"niedostępne",name:"Nazwa",description:"Opis",small_description:"Mały opis",homepage:"Strona główna",project_info:"Informacje o projekcie",version:"Wersja",advanced_settings:"Zaawansowane Ustawienia",ok:"Ok",download_remote_entries:"Pobierz zdalne wpisy",remote_entry:"Zdalne wejść",entry:"Pozycja",download_warning:"To spowoduje usunięcie wszystkich zdalnych wpisów, które już masz na swoim urządzeniu dla tego projektu . Kontynuować?",text_size:"Rozmiar tekstu",accessibility:"Dostępność",type_answer_here:"Wpisz odpowiedź tutaj...",confirm_answer_here:"Potwierdź odpowiedź tutaj...",confirm:"Potwierdź",help:"Pomoc",user_guide:"Podręcznik",hi:"Cześć",prev:"Poprzedni",next:"Następny",quit:"Zrezygnuj",save:"Zapisz",save_entry:"Zapisz wpis",quit_entry:"Zrezygnuj",save_branch_entry:"Zapisz branch",quit_branch:"Zrezygnuj",login:"Zaloguj",logout:"Wyloguj",scan:"Skanuj",entries:"wpisy",branch_entries:"Grupa wpisy",update_location:"Pobierz lokalizację",not_located_yet:"Brak lokalizacji",latitude:"Szerokość",longitude:"Długość",accuracy:"Dokładność",unknown_error:"Nieznany błąd",db_created:"Epicollect5 baza danych gotowa",db_not_created:"Błąd tworzenia bazy danych Epicollect5!",locating:"Lokalizowanie",wait:"Proszę czekać...",saving:"Zapisywanie...",loading:"Ładowanie...",acquiring_position:"Ustalanie pozycji",location_acquired:"Pozycja ustalona",location_fail:"Nie mogę zlokalizować!",location_service_fail:"Aby pobrać położenie Epicollect5 musi mieć przyznane zgody na użycie usługi lokalizacji.",ios_location_permission_denied:"Epicollect5 nie ma dostępu do usługi lokalizacji, prosze zmienić w Ustawieniach",ios_location_permission_restricted:"Epicollect5 ma ograniczony dostęp do usługi lokalizacji jedynie dla obecnego użytkownika",android_location_permission_denied_always:"Epicollect5 nie ma dostępu do usługi lokalizacji. Nie można używać lokalizacji bez nadania odpowiednich uprawnień dla aplikacji",no_projects_found:"Nie znaleziono projektu",date_selected_is:"Wybrana data to: ",time_selected_is:"Wybrany czas to: ",preparing_scanner:"Przygotowanie skanera",failed_because:"Niepowodzenie ponieważ: ",stop:"Stop",play:"Odtwórz",record:"Nagraj",recording:"Nagrywanie",playing:"Odtwarzanie",recording_audio:"Nagrywanie dźwięku...",playing_audio:"Odtwarzanie dźwięku...",shoot:"Migawka",video_saved:"Video zapisane",audio_saved:"Audio zapisane",cannot_save_file:"Nie można zapisać pliku! Proszę powtórz",file_available:"Plik dostępny",uploading:"Przesyłanie",uploading_entries:"Przesyłanie wpisów",loading_project:"Ładowanie projektu",loading_entries:"Ładowanie wpisów",loading_entry:"Ładowanie wpisu",no_entries_found:"Brak wpisów",no_errors_found:"Nie znaleziono błędów",pick_possible_answer:"Wybierz odpowiedź",permission_denied:"Brak dostępu",location_not_available:"Lokalizacja jest niedostępna Epicollect5 nie jest w stanie Cię zlokalizować.",min:"Min",max:"Max",no_answer_given:"Nie udzielono odpowiedzi ",error:"Błąd",delete_project:"Skasuj projekt",delete_entry:"Skasuj wpis",delete_all_entries:"Skasuj wszystkie wpisy",delete_synced_entries:"Skasuj przesłane wpisy",delete_unsynced_entries:"Skasuj nieprzesłane wpisy",bookmark:"Zakładka",bookmark_title:"Dodaj tytuł zakładki",close:"Zamknij",add_bookmark:"Dodaj zakładkę",add_entry:"Dodaj wpis",type_hint:"Wpisz tutaj",menu:"Menu",project_options:"Opcje projektu",upload_entries:"Prześlij wpisy",download_entries:"Pobierz wpisy",unsync_all_entries:"Unsync All Entries",unsync_entry:"Unsync entry",unsynced:"Unsynced All Entries",bookmark_page:"Strona zakładek",remove_bookmark:"Usuń zakładki",sort:"Kolejność",newest:"Najnowsze",oldest:"Najstarsze",sign_in:"Zaloguj",no_bookmarks_found:"Brak zakładek",my_bookmarks:"Moje zakładki",export_entries:"Exportuj wpisy jako JSON",exporting:"Eksportowanie",exporting_success:"Wszystkie wpisy wyeksportowane!",exported_to:"Exportuj do: ",deleting_project:"Kasowanie projektu",deleting_entries:"Kasowanie wpisu",entry_deleted:"Wpis usunięty",file_deleted:"File usunięty",email:"Email",password:"Hasło",ldap_username:"Ldap Login",ldap_password:"Ldap Hasło",google_sign_in:"Zaloguj kontem Google",upload_data:"Wyślij dane",upload_photos:"Wyślij zdjęcia",upload_videos:"Wyślij video",upload_audios:"Wyślij audio",uploading_photos:"Wysyłanie zdjęć",uploading_videos:"Wysyłanie video",uploading_audios:"Wysyłanie audio",all_entries_uploaded:"Wszystkie wpisy wysłane",file_uploaded:"File wysłane",entries_errors:"Niektóre wpisy zawierają błędy",children:"Dziecko",search_for_project:"Szukaj projektu",add_project:"Dodaj projekt",projects:"Projekty",delete_branch_entry:"Usuń grupę wpisów",back:"Powrót",settings:"Ustawienia",server_url:"Adres serwera",server_url_placeholder:"np. http://www.mydomain.com",downloads:"Pobrania",download:"Pobierz",warning:"Uwaga",missing_permission:"Aby wykonać to działanie musisz nadać odpowiednie uprawnienia.",please_wait:"Proszę czekać...",server_url_error:"Nie znaleziono serwera, sprawdź w ustawieniach adres serwera",quitting:"Anulowanie",cancel:"Anuluj",project_outdated:"Formularz zaktualizowany.",update_project:"Czy zaktualizować formularz na Twoim urządzeniu?",project_updated:"Formularze zaktualizowane.",updating_project:"Aktualizacja formularzy.",updating_entries:"Aktualizacja wpisów.",check_for_updates:"Poszukaj aktualizację formularza",checking_for_updates:"Szukam aktualizacji...",loading_projects:"Wgrywanie projektów",incomplete_entry:"Wpis jest niekompletny",entry_completed:"Wpis ukończony",unsynced_entries:"Wpisy do przesłania",unsynced_entry:"Wpis wymaga przesłania.",sync_now:"Prześlij",save_entry_and_sync:"Zapisz wpis i wyślij",check_entries:"Sprawdź wpisy",connect_to_internet_to_upload:"Połącz się z internetem i prześlij wpisy.",entries_errors_page:"Wpisy z błędami",check_entries_below:"Sprawdź błędy w poniższych wpisach.",branch:"Grupa",pattern:"Wzór",required:"* Pole wymagane",entries_media_errors:"Nie udało się przesłać multimediów. Spróbuj później.",db_updated:"Baza danych zaktualizowana.",downloading_entries:"Pobieranie wpisów",all_entries_downloaded:"Wszystkie wpisy pobrane.",unsaved_branch_entries:"Nie zapisano wszystkich wpisów w grupie.",save_now:"Zapisz teraz",incomplete_entries:"Niektóre wpisy są niekompletne i nie mogą być przesłane.",load_more:"Pokaż więcej",take:"Zrób",pick:"Pobierz",collected_on:"Zebrane na/w ",dismiss:"Anuluj"}}},R=(0,s.Q_)("DBStore",{state:()=>({db:{},dbVersion:0,dbEntriesOrder:{field:l.DEFAULT_ORDERING_COLUMN,sortType:l.DEFAULT_ORDERING}}),getters:{},actions:{}}),I={async getRows(e,t){const n=R();return new Promise(((r,s)=>{function o(e,t){s(t)}n.db.transaction((n=>{n.executeSql(e,t,((e,t)=>{r(t)}),o)}),o)}))},async selectSetting(e){const t=[e];return await this.getRows("SELECT value FROM settings WHERE field=?",t)},async getUser(){return await this.getRows("SELECT * FROM users",[])},async selectProject(e){const t=[e];return await this.getRows("SELECT * FROM projects WHERE project_ref = ?",t)},async selectProjects(){return await this.getRows("SELECT project_ref, name FROM projects",[])},async selectOneEntry(e,t,n,r,s){let o="SELECT entry_uuid, parent_entry_uuid, answers, form_ref, parent_form_ref, created_at, title, synced, can_edit, is_remote FROM entries WHERE project_ref = ?";const a=[e];if(t&&(o+=" AND form_ref=?",a.push(t)),null!==n&&(o+=" AND parent_entry_uuid=?",a.push(n)),null!==r){const e=[];o+=" AND synced IN (";for(let t=0;t<r.length;t++)e.push("?"),a.push(r[t]);o+=e.join(",")+") "}return o+=" LIMIT 1 ",null!==s&&(o+=" OFFSET "+s+" "),await this.getRows(o,a)},async selectOneBranchEntry(e,t,n){let r="";r+="SELECT entry_uuid, ",r+="owner_entry_uuid, ",r+="answers, ",r+="form_ref, ",r+="owner_input_ref, ",r+="created_at, ",r+="title, ",r+="synced, ",r+="can_edit, ",r+="is_remote ",r+="FROM branch_entries ",r+="WHERE project_ref = ? ",r+="AND owner_entry_uuid=? ";const s=[e,t];return null!==n&&(r+=" AND synced=?",s.push(n)),r+="LIMIT 1",await this.getRows(r,s)},async selectOneBranchEntryForExport(e,t,n){let r="";r+="SELECT entry_uuid, ",r+="owner_entry_uuid, ",r+="answers, ",r+="form_ref, ",r+="owner_input_ref, ",r+="created_at, ",r+="title, ",r+="synced, ",r+="can_edit, ",r+="is_remote ",r+="FROM branch_entries ",r+="WHERE project_ref = ? ",r+="AND owner_input_ref=? ";const s=[e,t];return r+="LIMIT 1",r+=" OFFSET "+n+" ",await this.getRows(r,s)},async selectBranchEntry(e){let t="";t+="SELECT * ",t+="FROM branch_entries ",t+="WHERE entry_uuid=? ",t+="UNION ",t+="SELECT * ",t+="FROM temp_branch_entries ",t+="WHERE entry_uuid=?",t+="ORDER BY updated_at";const n=[e,e];return await this.getRows("SELECT * FROM branch_entries WHERE entry_uuid=? UNION SELECT * FROM temp_branch_entries WHERE entry_uuid=?ORDER BY updated_at",n)},async countUnsyncedEntries(e){let t="";t+="SELECT ((SELECT COUNT(entry_uuid) as no_entries",t+=" FROM entries ",t+="WHERE project_ref = ? ",t+=") + ",t+="(SELECT COUNT(entry_uuid) as no_entries ",t+="FROM branch_entries ",t+="WHERE project_ref = ? ",t+=")) as total_number_of_entries, ",t+="((SELECT COUNT(entry_uuid) as no_entries ",t+="FROM entries ",t+="WHERE project_ref = ? ",t+="AND synced=?) + ",t+="(SELECT COUNT(entry_uuid) as no_entries ",t+="FROM branch_entries ",t+="WHERE project_ref = ? ",t+="AND synced=?)) as total_number_of_entries_with_errors,",t+="((SELECT COUNT(entry_uuid) as no_entries ",t+="FROM entries ",t+="WHERE project_ref = ? ",t+="AND (synced = ? OR synced = ?)) + ",t+="(SELECT COUNT(entry_uuid) as no_entries ",t+="FROM branch_entries ",t+="WHERE project_ref = ? ",t+="AND synced=?)) as total_number_of_entries_unsynced,",t+="((SELECT COUNT(entry_uuid) as no_entries ",t+="FROM entries ",t+="WHERE project_ref = ? ",t+="AND synced=?) + ",t+="(SELECT COUNT(entry_uuid) as no_entries ",t+="FROM branch_entries ",t+="WHERE project_ref = ? ",t+="AND synced=?)) as total_number_of_incomplete_entries";const n=[e,e,e,l.SYNCED_CODES.SYNCED_WITH_ERROR,e,l.SYNCED_CODES.SYNCED_WITH_ERROR,e,l.SYNCED_CODES.UNSYNCED,l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES,e,l.SYNCED_CODES.UNSYNCED,e,l.SYNCED_CODES.INCOMPLETE,e,l.SYNCED_CODES.INCOMPLETE];return await this.getRows("SELECT ((SELECT COUNT(entry_uuid) as no_entries FROM entries WHERE project_ref = ? ) + (SELECT COUNT(entry_uuid) as no_entries FROM branch_entries WHERE project_ref = ? )) as total_number_of_entries, ((SELECT COUNT(entry_uuid) as no_entries FROM entries WHERE project_ref = ? AND synced=?) + (SELECT COUNT(entry_uuid) as no_entries FROM branch_entries WHERE project_ref = ? AND synced=?)) as total_number_of_entries_with_errors,((SELECT COUNT(entry_uuid) as no_entries FROM entries WHERE project_ref = ? AND (synced = ? OR synced = ?)) + (SELECT COUNT(entry_uuid) as no_entries FROM branch_entries WHERE project_ref = ? AND synced=?)) as total_number_of_entries_unsynced,((SELECT COUNT(entry_uuid) as no_entries FROM entries WHERE project_ref = ? AND synced=?) + (SELECT COUNT(entry_uuid) as no_entries FROM branch_entries WHERE project_ref = ? AND synced=?)) as total_number_of_incomplete_entries",n)},async countUnsyncedBranchEntries(e,t){let n="";n+="SELECT COUNT(entry_uuid) as count ",n+="FROM branch_entries ",n+="WHERE project_ref = ? AND owner_entry_uuid= ? ",n+="AND synced= ?";const r=[e,t,l.SYNCED_CODES.UNSYNCED];return await this.getRows("SELECT COUNT(entry_uuid) as count FROM branch_entries WHERE project_ref = ? AND owner_entry_uuid= ? AND synced= ?",r)},async countUnsyncedMediaEntries(e){let t="";t+="SELECT (SELECT COUNT(entry_uuid) ",t+="FROM media ",t+="WHERE project_ref = ? ",t+="AND synced = ? ",t+="AND file_type = ?) ",t+="as total_number_of_photos,",t+="(SELECT COUNT(entry_uuid) ",t+="FROM media ",t+="WHERE project_ref = ? ",t+="AND synced = ? AND file_type = ?) ",t+="as total_number_of_videos,",t+="(SELECT COUNT(entry_uuid) ",t+="FROM media ",t+="WHERE project_ref = ? ",t+="AND synced = ? ",t+="AND file_type = ?) ",t+="as total_number_of_audio";const n=[e,0,"photo",e,0,"video",e,0,"audio"];return await this.getRows("SELECT (SELECT COUNT(entry_uuid) FROM media WHERE project_ref = ? AND synced = ? AND file_type = ?) as total_number_of_photos,(SELECT COUNT(entry_uuid) FROM media WHERE project_ref = ? AND synced = ? AND file_type = ?) as total_number_of_videos,(SELECT COUNT(entry_uuid) FROM media WHERE project_ref = ? AND synced = ? AND file_type = ?) as total_number_of_audio",n)},async selectEntry(e,t){const n=[e];let r="";return r+="SELECT ",r+="entry_uuid, ",r+="answers, ",r+="form_ref, ",r+="parent_form_ref, ",r+="parent_entry_uuid, ",r+="project_ref, ",r+="created_at, ",r+="title, ",r+="synced, ",r+="synced_error, ",r+="can_edit, ",r+="is_remote ",r+="FROM entries ",r+="WHERE entry_uuid = ?",t&&(r+=" AND parent_entry_uuid = ?",n.push(t)),await this.getRows(r,n)},async selectEntries(e,t,n,r,s,o,a,i){let u="SELECT id, entry_uuid, title, synced, can_edit, is_remote, answers, created_at FROM entries WHERE project_ref = ?";const c=[e];let d,p;if(t&&(u+=" AND form_ref = ?",c.push(t)),n&&(u+=" AND parent_entry_uuid = ?",c.push(n)),a&&(a.title&&(u+=" AND title LIKE '%"+a.title+"%'"),a.from&&a.to)){u+=" AND created_at BETWEEN '"+(a.from+"T00:00:00.000Z")+"' AND '"+(a.to+"T23:59:59.999Z")+"'"}if(i&&i!==l.STATUS.ALL)switch(i){case l.STATUS.INCOMPLETE:u+=" AND synced= ?",c.push(l.SYNCED_CODES.INCOMPLETE);break;case l.STATUS.ERROR:u+=" AND synced= ?",c.push(l.SYNCED_CODES.SYNCED_WITH_ERROR)}return r&&(d=l.ALLOWED_ORDERING_COLUMNS.indexOf(r.field)>-1?r.field:l.DEFAULT_ORDERING_COLUMN,p=l.ALLOWED_ORDERING.indexOf(r.sortType)>-1?r.sortType:l.DEFAULT_ORDERING,u+=" ORDER BY "+d+" "+p),s&&(u+=" LIMIT ? ",c.push(s)),o&&(u+=" OFFSET ? ",c.push(o)),await this.getRows(u,c)},async countEntriesUnsynced(e){let t="SELECT SUM(total) as total from ( ";t+=" SELECT count(id) as total FROM entries ",t+=" WHERE project_ref = ? AND (synced = ? OR synced = ? OR synced = ? ) ",t+=" UNION ALL ",t+=" SELECT count(id) as total FROM branch_entries ",t+=" WHERE project_ref = ? AND (synced = ? OR synced = ? OR synced = ? ) ",t+=" ) ";const n=[e,l.SYNCED_CODES.UNSYNCED,l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES,l.SYNCED_CODES.SYNCED_WITH_ERROR,e,l.SYNCED_CODES.UNSYNCED,l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES,l.SYNCED_CODES.SYNCED_WITH_ERROR];return await this.getRows("SELECT SUM(total) as total from (  SELECT count(id) as total FROM entries  WHERE project_ref = ? AND (synced = ? OR synced = ? OR synced = ? )  UNION ALL  SELECT count(id) as total FROM branch_entries  WHERE project_ref = ? AND (synced = ? OR synced = ? OR synced = ? )  ) ",n)},async countMediaUnsynced(e){const t=[e,l.SYNCED_CODES.UNSYNCED,l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES,l.SYNCED_CODES.SYNCED_WITH_ERROR];return await this.getRows("SELECT count(id) as total FROM media WHERE project_ref = ? AND (synced = ? OR synced = ?  OR synced = ?)",t)},async countEntries(e,t,n,r,s){let o="SELECT COUNT(*) as total, MAX(created_at) as newest, MIN(created_at) as oldest FROM entries WHERE project_ref = ?";const a=[e];if(t&&(o+=" AND form_ref = ?",a.push(t)),n&&(o+=" AND parent_entry_uuid = ?",a.push(n)),r&&(r.title&&(o+=" AND title LIKE '%"+r.title+"%'"),r.from&&r.to)){o+=" AND created_at BETWEEN '"+(r.from+"T00:00:00.000Z")+"' AND '"+(r.to+"T23:59:59.999Z")+"'"}if(s&&s!==l.STATUS.ALL)switch(s){case l.STATUS.INCOMPLETE:o+=" AND synced= ?",a.push(l.SYNCED_CODES.INCOMPLETE);break;case l.STATUS.ERROR:o+=" AND synced= ?",a.push(l.SYNCED_CODES.SYNCED_WITH_ERROR)}return await this.getRows(o,a)},async selectBranchEntries(e,t,n,r){const s=p();let o="SELECT id, entry_uuid, title, synced, can_edit, answers FROM branch_entries WHERE project_ref = ?";const a=[e];let i,u;return t&&(o+=" AND form_ref = ?",a.push(t)),n&&(o+=" AND owner_input_ref = ?",a.push(n)),r&&(i=l.ALLOWED_ORDERING_COLUMNS.indexOf(r.field)>-1?r.field:l.DEFAULT_ORDERING_COLUMN,u=l.ALLOWED_ORDERING.indexOf(r.sortType)>-1?r.sortType:l.DEFAULT_ORDERING,s.device.platform!==l.WEB?o+=" ORDER BY "+i+" COLLATE LOCALIZED "+u:o+=" ORDER BY "+i+" "+u),await this.getRows(o,a)},async selectBranches(e){let t="";t+="SELECT ",t+="entry_uuid, ",t+="owner_entry_uuid, ",t+="title, ",t+="owner_input_ref, ",t+="form_ref, ",t+="answers, ",t+="project_ref, ",t+="synced, ",t+="can_edit, ",t+="is_remote, ",t+="created_at ",t+="FROM branch_entries ",t+="WHERE owner_entry_uuid=?";const n=[e[0]],r=e.slice(0);return 0===e.length?new Promise((e=>{e({rows:{length:0}})})):(e.length>1&&(r.shift(),r.forEach((e=>{n.push(e),t+=" OR owner_entry_uuid = ?"}))),await this.getRows(t,n))},async selectTempBranches(e){const t=[e];return await this.getRows("SELECT entry_uuid FROM temp_branch_entries WHERE owner_entry_uuid = ?",t)},async selectBranchesForQuestion(e,t,n,r,s,o){let a="";const i=[e,t,e,t];if(a+="SELECT * ",a+="FROM (",a+="SELECT entry_uuid, ",a+="title, ",a+="synced, ",a+="1 as temp, ",a+="created_at ",a+="FROM temp_branch_entries ",a+="WHERE owner_entry_uuid = ? ",a+="AND owner_input_ref=? ",s&&(s.title&&(a+=" AND title LIKE '%"+s.title+"%' "),s.from&&s.to)){a+=" AND created_at BETWEEN '"+(s.from+"T00:00:00.000Z")+"' AND '"+(s.to+"T23:59:59.999Z")+"' "}if(o&&o!==l.STATUS.ALL)switch(o){case l.STATUS.INCOMPLETE:a+=" AND synced="+l.SYNCED_CODES.INCOMPLETE.toString()+" ";break;case l.STATUS.ERROR:a+=" AND synced="+l.SYNCED_CODES.SYNCED_WITH_ERROR.toString()+" "}if(a+="ORDER BY created_at DESC) ",a+="ALIAS_ONE ",a+="UNION ALL SELECT * ",a+="FROM ",a+="(SELECT entry_uuid, ",a+="title, ",a+="synced, ",a+="0 as temp, ",a+="created_at ",a+="FROM branch_entries ",a+="WHERE owner_entry_uuid = ? ",a+="AND owner_input_ref=? ",s&&(s.title&&(a+=" AND title LIKE '%"+s.title+"%' "),s.from&&s.to)){a+=" AND created_at BETWEEN '"+(s.from+"T00:00:00.000Z")+"' AND '"+(s.to+"T23:59:59.999Z")+"' "}if(o&&o!==l.STATUS.ALL)switch(o){case l.STATUS.INCOMPLETE:a+=" AND synced="+l.SYNCED_CODES.INCOMPLETE.toString()+" ";break;case l.STATUS.ERROR:a+=" AND synced="+l.SYNCED_CODES.SYNCED_WITH_ERROR.toString()+" "}return a+="ORDER BY created_at DESC) ",a+="ALIAS_TWO",n&&(a+=" LIMIT ? ",i.push(n)),r&&(a+=" OFFSET ? ",i.push(r)),await this.getRows(a,i)},async countBranchesForQuestion(e,t,n,r){const s=[e,t,e,t];let o="";if(o+="SELECT COUNT(DISTINCT(entry_uuid)) as total, MAX(created_at) as newest, MIN(created_at) as oldest FROM ( ",o+="SELECT * ",o+="FROM (",o+="SELECT entry_uuid, ",o+="title, ",o+="created_at, ",o+="synced, ",o+="1 as temp ",o+="FROM temp_branch_entries ",o+="WHERE owner_entry_uuid = ? ",o+="AND owner_input_ref=? ",n&&(n.title&&(o+=" AND title LIKE '%"+n.title+"%' "),n.from&&n.to)){o+=" AND created_at BETWEEN '"+(n.from+"T00:00:00.000Z")+"' AND '"+(n.to+"T23:59:59.999Z")+"' "}if(r&&r!==l.STATUS.ALL)switch(r){case l.STATUS.INCOMPLETE:o+=" AND synced="+l.SYNCED_CODES.INCOMPLETE.toString()+" ";break;case l.STATUS.ERROR:o+=" AND synced="+l.SYNCED_CODES.SYNCED_WITH_ERROR.toString()+" "}if(o+="ORDER BY created_at DESC) ",o+="ALIAS_ONE ",o+="UNION ALL SELECT * ",o+="FROM ",o+="(SELECT entry_uuid, ",o+="title, ",o+="created_at, ",o+="synced, ",o+="0 as temp ",o+="FROM branch_entries ",o+="WHERE owner_entry_uuid = ? ",o+="AND owner_input_ref=? ",n&&(n.title&&(o+=" AND title LIKE '%"+n.title+"%' "),n.from&&n.to)){o+=" AND created_at BETWEEN '"+(n.from+"T00:00:00.000Z")+"' AND '"+(n.to+"T23:59:59.999Z")+"' "}if(r&&r!==l.STATUS.ALL)switch(r){case l.STATUS.INCOMPLETE:o+=" AND synced="+l.SYNCED_CODES.INCOMPLETE.toString()+" ";break;case l.STATUS.ERROR:o+=" AND synced="+l.SYNCED_CODES.SYNCED_WITH_ERROR.toString()+" "}return o+="ORDER BY created_at DESC) ",o+="ALIAS_TWO",o+=" );",await this.getRows(o,s)},async selectEntryMedia(e,t){const n=R(),r=[e,t];let s;const o=[];return new Promise(((e,t)=>{function a(e){t()}n.db.transaction((function(t){t.executeSql("SELECT file_name, input_ref, file_type, file_path, entry_uuid, branch_entry_uuid FROM media WHERE project_ref=? AND entry_uuid=?",r,(function(t,n){for(s=0;s<n.rows.length;s++)o.push(n.rows.item(s));e(o)}),a)}),a)}))},async selectEntryMediaErrors(e,t){let n="SELECT entry_uuid, input_ref, synced_error FROM media WHERE (entry_uuid=? ";if(0===e.length)return new Promise((function(e){e({rows:{length:0}})}));if(e.length>1){for(let t=1;t<e.length;t++)n+="OR entry_uuid=? ";n+=") "}else n+=") ";return n+="AND (ifnull(length(synced_error), 0) > 0)",t&&(n+=" LIMIT "+t),await this.getRows(n,e)},async countCurrentBranchMediaErrors(e){let t='SELECT count(*) as total, input_ref, synced_error FROM media WHERE input_ref LIKE "'+e+'%" ';return t+="AND (ifnull(length(synced_error), 0) > 0)",await this.getRows(t)},async selectProjectMedia(e){const t=R();let n,r="SELECT * FROM media WHERE project_ref=? ";const s=[],o=[],a=[],i=[e.project_ref];return null!==e.synced&&(r+="AND synced=? ",i.push(e.synced)),null!==e.entry_uuid&&(r+="AND entry_uuid IN (?) ",i.push(e.entry_uuid.join(","))),r+="AND file_type=? ",new Promise(((e,u)=>{function c(e){u()}t.db.transaction((function(e){e.executeSql(r,i.concat(l.QUESTION_TYPES.AUDIO),(function(e,t){for(n=0;n<t.rows.length;n++)s.push(t.rows.item(n))}),c),e.executeSql(r,i.concat(l.QUESTION_TYPES.PHOTO),(function(e,t){for(n=0;n<t.rows.length;n++)o.push(t.rows.item(n))}),c),e.executeSql(r,i.concat(l.QUESTION_TYPES.VIDEO),(function(e,t){for(n=0;n<t.rows.length;n++)a.push(t.rows.item(n))}),c)}),c,(function(){e({audios:s,photos:o,videos:a})}))}))},async isUnique(e,t,n){let r="",s="",o=[];switch(t.type){case l.QUESTION_TYPES.DATE:switch(n=n.substring(0,11),t.datetime_format){case l.DATE_FORMAT_4:n=n.substring(0,8);break;case l.DATE_FORMAT_5:n=n.substring(4,11)}r="SELECT answer FROM unique_answers WHERE input_ref=? AND answer LIKE ? AND entry_uuid<>?",s="SELECT answer FROM temp_unique_answers WHERE input_ref=? AND answer LIKE ? AND entry_uuid<>?",o=[t.ref,"%"+n+"%",e.entryUuid];break;case l.QUESTION_TYPES.TIME:{let a=n.substring(10,20);switch(t.datetime_format){case l.TIME_FORMAT_3:case l.TIME_FORMAT_4:a=a.substring(0,7);break;case l.TIME_FORMAT_5:a=a.substring(3,10)}r="SELECT answer FROM unique_answers WHERE input_ref=? AND answer LIKE ? AND entry_uuid<>?",s="SELECT answer FROM temp_unique_answers WHERE input_ref=? AND answer LIKE ? AND entry_uuid<>?",o=[t.ref,"%"+a+"%",e.entryUuid];break}default:r="SELECT answer FROM unique_answers WHERE input_ref=? AND answer=? AND entry_uuid<>?",s="SELECT answer FROM temp_unique_answers WHERE input_ref=? AND answer=? AND entry_uuid<>?",o=[t.ref,n,e.entryUuid]}"hierarchy"===t.uniqueness&&(r+=" AND parent_entry_uuid=?",s+=" AND parent_entry_uuid=?",o.push(e.parentEntryUuid)),e.ownerEntryUuid&&(r+=" AND owner_entry_uuid=?",s+=" AND owner_entry_uuid=?",o.push(e.ownerEntryUuid));const a=r+" UNION "+s;return o=o.concat(o),await this.getRows(a,o)},async getSavedAnswers(e,t,n,r){const s="SELECT answers FROM "+(n?"branch_entries":"entries")+" WHERE project_ref=? AND form_ref=? ORDER BY created_at DESC LIMIT 1 OFFSET "+r,o=[e,t];return await this.getRows(s,o)},async selectUniqueAnswers(e){const t=[e];return await this.getRows("SELECT answer FROM unique_answers WHERE entry_uuid=?",t)},async selectParentEntry(e){const t=[e];return await this.getRows("SELECT parent_entry_uuid FROM entries WHERE entry_uuid=? LIMIT 1",t)},async selectBookmarks(){return await this.getRows("Select * FROM bookmarks",[])},async getHierarchyEntries(e){const t=this;let n,r;const s=[];let o=[];const a=[];let i,l;return new Promise(((u,c)=>{!function e(c){Promise.all([t.selectChildEntries(c),t.selectBranches(c)]).then((function(t){for(r=0;r<t[1].rows.length;r++)l=t[1].rows.item(r).entry_uuid,a.push(l);if(t[0].rows.length>0){for(o=[],n=0;n<t[0].rows.length;n++)i=t[0].rows.item(n).entry_uuid,o.push(i),s.push(i);e(o)}else u({entries:s,branchEntries:a})}),(function(e){}))}([e])}))},async selectChildEntries(e){let t="SELECT entry_uuid FROM entries WHERE parent_entry_uuid=?";const n=e.slice(0),r=[n[0]];return n.length>1&&(n.shift(),n.forEach((e=>{t+=" OR parent_entry_uuid=?",r.push(e)}))),await this.getRows(t,r)},async selectErrorEntries(e,t){if("branch_entries"===e)e="branch_entries";else e="entries";const n="SELECT * FROM "+e+" WHERE project_ref=? AND synced=?",r=[t,-1];return await this.getRows(n,r)},async selectInvalidEntries(e,t){if("branch_entries"===e)e="branch_entries";else e="entries";const n="SELECT * FROM "+e+" WHERE project_ref=? AND (synced=? OR synced=?)",r=[t,l.SYNCED_CODES.INCOMPLETE,l.SYNCED_CODES.SYNCED_WITH_ERROR];return await this.getRows(n,r)},async selectDistinctBranchRefs(e){const t=[e];return await this.getRows("SELECT DISTINCT(owner_input_ref), form_ref FROM branch_entries WHERE project_ref = ?",t)}};var v=n(9895);function P(){return new Promise((e=>{const t=p(),n=[];I.selectProjects().then((function(r){let s;if(r.rows.length>0)for(let e=0;e<r.rows.length;e++)s=t.device.platform===l.WEB?"/assets/images/ec5-placeholder-100x100.jpg":r.rows.item(e).project_ref===c.PROJECT_REF?"./assets/images/ec5-demo-project-logo.jpg":v.dV.convertFileSrc(t.persistentDir+l.LOGOS_DIR+r.rows.item(e).project_ref+"/mobile-logo.jpg?"+(new Date).getTime()),n.push({ref:r.rows.item(e).project_ref,name:r.rows.item(e).name,logo:s});e(n)}),(function(t){e([])}))}))}var D=n(2119);const O={showToast(e,t,n){const r=n||"bottom";setTimeout((async()=>(await i.toastController.create({message:e,position:r,duration:3e3})).present()),t||0)},showToastCenter(e,t){setTimeout((async()=>(await i.toastController.create({message:e,position:"middle",duration:2e3})).present()),t||0)},async showAlert(e,t){const n=p().language,r=await i.alertController.create({header:t,message:e,buttons:[b[n].labels.ok]});await r.present()},async confirmSingle(e,t){const n=p().language;return new Promise(((r,s)=>{(async()=>{(await i.alertController.create({header:t,message:e,buttons:[{text:b[n].labels.cancel,role:"cancel",handler:()=>{r(!1)}},{text:b[n].labels.ok,handler:()=>{r(!0)}}]})).present()})()}))},async confirmMultiple(e,t,n,r){const s=p(),o=s.device.platform.toLowerCase(),a="ios"===o?"ios":"md";return new Promise((u=>{const c=[{text:b[s.language].labels.dismiss,role:"cancel",handler:()=>{u(!1)}},{text:r,handler:()=>{u(l.ACTIONS.ENTRY_QUIT)}},{text:n,handler:()=>{u(l.ACTIONS.ENTRY_SAVE)}}];s.isPWA&&c.pop(),(async()=>{(await i.alertController.create({mode:a,cssClass:"alert-confirm-multiple-"+o,header:t,message:e,buttons:c})).present()})()}))},async showProgressDialog(e,t){const n=p(),r=n.language,s=b[r].labels;let o="";o=t?'<strong class="ec5LoadingTitle">'+t+"</strong><br/><br/>"+e:e?'<strong class="ec5LoadingTitle">'+e+"</strong>":'<strong class="ec5LoadingTitle">'+s.wait+"</strong>",n.ec5LoadingDialog&&(await n.ec5LoadingDialog.dismiss(),n.ec5LoadingDialog=null),n.ec5LoadingDialog=await i.loadingController.create({cssClass:"ec5LoadingDialog",message:o,duration:parseInt(Number.POSITIVE_INFINITY)}),await n.ec5LoadingDialog.present()},setProgress(e){p().progressTransfer=e},hideProgressDialog(e){const t=p(),n=e||l.DELAY_MEDIUM;setTimeout((async function(){null!==t.ec5LoadingDialog&&await t.ec5LoadingDialog.dismiss()}),n)},startForegroundService(){const e=p(),t=e.language,n=b[t].labels;e.device.platform===l.ANDROID&&parseInt(e.device.osVersion)>=9&&cordova.plugins.foregroundService.start(l.APP_NAME,n.working_in_background,"ic_launcher.png",1,10)},stopForegroundService(){const e=p();e.device.platform===l.ANDROID&&parseInt(e.device.osVersion)>=9&&cordova.plugins.foregroundService.stop()}},{App:k}=v.Vn;var U={components:{ListItemProjects:S},setup(){const e=p(),t=e.language,n=b[t].labels,r=(0,D.tv)(),s=(0,D.yj)(),o=(0,m.qj)({isFetching:!0,show:!0,projects:[]});P().then((e=>{o.projects=e,o.isFetching=!1,O.hideProgressDialog()}));const u={addProject(){r.replace({name:"projects-add",params:{}})},async onProjectSelected(t){e.routeParams={projectRef:t.ref,formRef:"",status:null},r.replace({name:l.ROUTES.ENTRIES})}};return(0,a.bv)((async()=>{const t=parseInt(e.selectedTextSize);document.body.classList.add("zoom-"+t)})),(0,i.useBackButton)(10,(async()=>{await O.confirmSingle(n.are_you_sure,n.close+" App")&&k.exitApp()})),(0,a.dl)((()=>{})),(0,a.Yq)((()=>{})),(0,i.onIonViewWillEnter)((()=>{o.show=!0})),(0,i.onIonViewWillLeave)((()=>{o.show=!1})),(0,a.YP)((()=>[{refresh:s.params.refresh}]),(e=>{e[0].refresh&&(o.isFetching=!0,window.setTimeout((function(){P().then((e=>{o.projects=e,o.isFetching=!1,O.hideProgressDialog()}))}),l.DELAY_LONG))})),{labels:n,...u,state:o,add:T.IHx}}};var W=(0,f.Z)(U,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-menu-button"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-title"),p=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-spinner"),_=(0,a.up)("list-item-projects"),f=(0,a.up)("ion-list"),w=(0,a.up)("ion-card-title"),g=(0,a.up)("ion-card-header"),A=(0,a.up)("ion-card"),S=(0,a.up)("base-layout");return(0,a.wy)(((0,a.wg)(),(0,a.j4)(S,{title:"",class:(0,h.C_)(s.state.zoom)},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(l)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(c,{fill:"clear",onClick:t[0]||(t[0]=t=>e.addProject())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.add},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.add_project),1)])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(p,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{size:"small",class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.projects),1)])),_:1})])),_:1})])),content:(0,a.w5)((()=>[s.state.isFetching?((0,a.wg)(),(0,a.j4)(m,{key:0,class:"loader",name:"crescent"})):((0,a.wg)(),(0,a.iD)("div",E,[(0,a.wy)((0,a._)("div",y,[(0,a.Wm)(f,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{projects:s.state.projects,page:"projects",onProjectSelected:e.onProjectSelected},null,8,["projects","onProjectSelected"])])),_:1})],512),[[r.F8,!s.state.isFetching&&s.state.projects.length>0]]),(0,a.wy)((0,a._)("div",null,[(0,a.Wm)(A,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.no_projects_found),1)])),_:1})])),_:1})])),_:1})],512),[[r.F8,!s.state.isFetching&&0===s.state.projects.length]])]))])),_:1},8,["class"])),[[r.F8,s.state.show]])}]]);const N={class:"center-item-content-wrapper"},C=(0,a.Uk)(" 404 ");var j={components:{},setup(){const e=p().language,t=b[e].labels;return(0,a.bv)((()=>{})),{labels:t}}};var L=(0,f.Z)(j,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-toolbar"),u=(0,a.up)("ion-item"),c=(0,a.up)("ion-card-content"),d=(0,a.up)("ion-card"),p=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(p,{title:""},{"actions-start":(0,a.w5)((()=>[])),content:(0,a.w5)((()=>[(0,a.Wm)(l,{color:"danger",mode:"ios",class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a._)("div",N,[(0,a.Wm)(i,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[C])),_:1})])])),_:1}),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"ion-text-center ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{lines:"none",class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.no_hits_found),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}]]);const F={key:2,class:"text-center"},q={key:0},x={key:1},M={key:2};const z={formStructure:{},inputs:{},formRef:"",initialise(e){this.formStructure=e,this.formRef=this.formStructure.details.ref},destroy(){this.formStructure={},this.formRef="",this.inputs={},this.formRef="",this.numInputsThisForm=0},addInputs(e){this.inputs=e},getFormRef(){return this.formRef},getInputs(){return this.inputs},getName(){return this.formStructure.details.name},getBranchHeader(e){let t="";return this.inputs.every((n=>n.ref!==e||(t=n.question,!1))),t}};n(1817);const B={project_extra:{},mapping:{},data:{last_updated:"",server_url:""},initialise(e){this.data=e;try{this.project_extra=JSON.parse(this.data.json_extra),this.mapping=JSON.parse(this.data.mapping)}catch(e){}},initialisePWA(e){this.data=e;try{this.project_extra=this.data.json_extra,this.mapping=this.data.mapping}catch(e){}},loadExtraStructure(e){this.project_extra=e},hasInitialised(){return!!this.project_extra.project},getProjectExtra(){return this.project_extra},getProjectMappings(){return this.mapping},destroy(){this.project_extra={},this.data={},this.mapping={}},getProjectName(){return this.project_extra.project.details.name},getSmallDescription(){return this.project_extra.project.details.small_description},getDescription(){const e=p().language,t=b[e].labels;return this.project_extra.project.details.description||t.not_available},getSlug(){return this.project_extra.project.details.slug},getProjectRef(){return this.project_extra.project?this.project_extra.project.details.ref:""},getInputs(e){return this.project_extra.forms[e].inputs?this.project_extra.forms[e].inputs:{}},getExtraStructure(){return this.project_extra?this.project_extra:{}},getExtraForms(){return this.project_extra.forms?this.project_extra.forms:{}},getExtraForm(e){return this.project_extra.forms[e]?this.project_extra.forms[e]:{}},getFirstFormRef(){return this.project_extra.project.forms[0]?this.project_extra.project.forms[0]:""},getLastFormRef(){return this.project_extra.project.forms[this.project_extra.project.forms.length-1]?this.project_extra.project.forms[this.project_extra.project.forms.length-1]:""},getNextFormRef(e){for(let t=0;t<this.project_extra.project.forms.length;t++)if(e===this.project_extra.project.forms[t])return this.project_extra.project.forms[t+1]?this.project_extra.project.forms[t+1]:""},getParentFormRef(e){for(let t=0;t<this.project_extra.project.forms.length;t++)if(e===this.project_extra.project.forms[t])return this.project_extra.project.forms[t-1]?this.project_extra.project.forms[t-1]:""},getFormIndex(e){for(let t=0;t<this.project_extra.project.forms.length;t++)if(e===this.project_extra.project.forms[t])return t;return 0},getFirstForm(){return this.project_extra.forms[this.getFirstFormRef()]},getFirstFormName(){return this.project_extra.forms[this.getFirstFormRef()].details.name},getFormName(e){return this.project_extra.forms[e].details.name},addFormToExtra(e,t){this.project_extra.forms[e]={details:"branch_entry",inputs:[],cntinputs:0}},getExtraInputs(){return this.project_extra.inputs?this.project_extra.inputs:{}},getFormInputs(e){return this.project_extra.forms[e].inputs?this.project_extra.forms[e].inputs:{}},getInput(e){return this.project_extra.inputs[e]?this.project_extra.inputs[e].data:{}},inputExists(e){return!!this.project_extra.inputs[e]},getInputIndexFromRef(e,t){for(let n=0;n<this.project_extra.forms[e].inputs.length;n++)if(this.project_extra.forms[e].inputs[n]===t)return n;return this.project_extra.forms[e].inputs.length},getBranchInputIndexFromRef(e,t,n){for(let r=0;r<this.project_extra.forms[e].branch[t].length;r++)if(this.project_extra.forms[e].branch[t][r]===n)return r;return this.project_extra.forms[e].branch[t].length},getInputRefFromIndex(e,t){return this.project_extra.forms[e].inputs[t]?this.project_extra.forms[e].inputs[t]:null},getBranchInputRefFromIndex(e,t,n){return this.project_extra.forms[e].branch[t][n]?this.project_extra.forms[e].branch[t][n]:null},getFormBranches(e){return this.project_extra.forms[e].branch?this.project_extra.forms[e].branch:{}},getBranches(e,t){return this.project_extra.forms[e].branch[t]?this.project_extra.forms[e].branch[t]:{}},formHasBranches(e){},getFormGroups(e){return this.project_extra.forms[e].group?this.project_extra.forms[e].group:{}},getGroupInputs(e,t){const n=[];let r,s;if(this.project_extra.forms[e].group[t])for(s=this.project_extra.forms[e].group[t],r=0;r<s.length;r++)n[r]=this.getInput(s[r]);return n},getListForms(){return this.project_extra.listForms?this.project_extra.listForms:[]},getForms(){return this.project_extra.forms?this.project_extra.forms:[]},hasLocation(e){return this.project_extra.forms[e].details.has_location},getEntriesLimit(e){const t=e||this.getFirstFormRef();return this.project_extra.project.entries_limits&&this.project_extra.project.entries_limits[t]?this.project_extra.project.entries_limits[t]:null},getLastUpdated(){return this.data.last_updated},setLastUpdated(e){this.data.last_updated=e},getServerUrl(){return this.data.server_url}};const G={class:"ion-text-center ion-padding"},Y={class:"ion-text-center"},H={class:"ion-text-center ion-padding-top"};var V={props:{projectRef:{type:String,required:!0},entryUuid:{type:String,required:!0},inputRef:{type:String,required:!0},media:{type:Object,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,s=t.tempDir,o=t.persistentDir,{entryUuid:a,media:u,inputRef:c,projectRef:d}=(0,m.OT)(e);let _;""!==u[a][c].cached?_=s+u[a][c].cached:""!==u[a][c].stored&&(_=o+l.AUDIO_DIR+d+"/"+u[a][c].stored);const f=new window.Media(_,(e=>{}),(e=>{}),(function(e){4===e&&(f.release(),i.modalController.dismiss())}));f.play();const w={stop(){f.stop()}};return{labels:r,...e,...w,musicalNote:T.phD,stopCircleSharp:T.mI_}}};var Q=(0,f.Z)(V,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-title"),l=(0,a.up)("ion-toolbar"),u=(0,a.up)("ion-header"),c=(0,a.up)("ion-icon"),d=(0,a.up)("ion-spinner"),p=(0,a.up)("ion-button"),m=(0,a.up)("ion-col"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"ion-text-center",color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.playing_audio),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a._)("div",G,[(0,a.Wm)(c,{color:"dark",class:"audio-note ion-text-center",icon:r.musicalNote},null,8,["icon"])]),(0,a._)("div",Y,[(0,a.Wm)(d,{class:"",name:"dots"})]),(0,a._)("div",H,[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{size:"8",offset:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:t[0]||(t[0]=t=>e.stop()),class:"question-action-button",color:"secondary",expand:"block"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start",icon:r.stopCircleSharp},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.stop),1)])),_:1})])),_:1})])),_:1})])),_:1})])])),_:1})],64)}]]);const Z={class:"ion-text-center ion-padding"},J={class:"ion-text-center"},X={class:"ion-text-center ion-padding-top"};n(8862),n(9575),n(2472),n(8012),n(3105),n(3462),n(3824),n(7380),n(1118),n(3210),n(5827);var K=n(2605),$=n(1304),ee=n.n($),te=n(5278);const ne={uuid(){let e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},getTimeZone(){const e=(new Date).getTimezoneOffset(),t=Math.abs(e);return(e<0?"+":"-")+("00"+Math.floor(t/60)).slice(-2)+":"+("00"+t%60).slice(-2)},getInputFormattedDate(e){return e.slice(0,4)+"-"+e.slice(5,7)+"-"+e.slice(8,10)},getInputFormattedTime(e,t){const n=e.split("T")[1],r=n.slice(0,2),s=n.slice(3,5),o=n.slice(6,8);let a;switch(t){case l.TIME_FORMAT_3:case l.TIME_FORMAT_4:a=r+":"+s;break;default:a=r+":"+s+":"+o}return a},getPickerFormattedTime(e,t){const n=e.split("T")[1],r=n.slice(0,2),s=n.slice(3,5),o=n.slice(6,8);let a;if(t===l.TIME_FORMAT_5)a=s+":"+o;else a=r+":"+s+":"+o;return a},getUserFormattedTime(e,t){const n=e.split("T")[1],r=n.slice(0,2),s=n.slice(3,5),o=n.slice(6,8);let a,i;const u=r>=12?"PM":"AM";switch(parseInt(r,10)>12?(a=(parseInt(r,10)+11)%12+1,a=a<10?"0"+a.toString():a):a=r,t){case l.TIME_FORMAT_1:i=r+":"+s+":"+o;break;case l.TIME_FORMAT_2:i=a+":"+s+":"+o+" "+u;break;case l.TIME_FORMAT_3:i=r+":"+s;break;case l.TIME_FORMAT_4:i=a+":"+s+" "+u;break;case l.TIME_FORMAT_5:i=s+":"+o}return i},getUserFormattedDate(e,t){const n=e.slice(0,4),r=e.slice(5,7),s=e.slice(8,10);let o="";switch(t){case l.DATE_FORMAT_1:o=s+"/"+r+"/"+n;break;case l.DATE_FORMAT_2:o=r+"/"+s+"/"+n;break;case l.DATE_FORMAT_3:o=n+"/"+r+"/"+s;break;case l.DATE_FORMAT_4:o=r+"/"+n;break;case l.DATE_FORMAT_5:o=s+"/"+r}return o},generateMediaFilename(e,t){const n=p();let r;switch(t){case l.QUESTION_TYPES.PHOTO:r=l.PHOTO_EXT;break;case l.QUESTION_TYPES.AUDIO:r=n.device.platform===l.IOS?l.AUDIO_EXT_IOS:l.AUDIO_EXT;break;case l.QUESTION_TYPES.VIDEO:r=l.VIDEO_EXT}return e+"_"+this.generateTimestamp()+r},generateTimestamp(){return Math.floor(Date.now()/1e3)},getISODateTime(e){return e||(e=new Date),this.getISOTime(this.convertDateToUTC(e))+"Z"},getISODateOnly(e){return e.slice(0,4)+"-"+e.slice(5,7)+"-"+e.slice(8,10)+"T00:00:00.000"},getTimezoneOffset(e){const t=e.getTimezoneOffset();let n,r=parseInt(Math.abs(t/60)),s=Math.abs(t%60);return r<10&&(r="0"+r),s<10&&(s="0"+s),t<0?n="+"+r+":"+s:t>0?n="-"+r+":"+s:0===t&&(n="Z"),n},getISOTime(e){let t=e.getDate(),n=e.getMonth()+1;const r=e.getFullYear();let s=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return t=t<10?"0"+t:t,n=n<10?"0"+n:n,s=s<10?"0"+s:s,o=o<10?"0"+o:o,a=a<10?"0"+a:a,r+"-"+n+"-"+t+"T"+s+":"+o+":"+a+".000"},convertDateToUTC(e,t){return t?new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()):new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())},getDateWithCompensatedTimezone(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate());return t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3),t},mapMediaObjectToArray(e){const t=[];return Object.keys(e).map((function(n){const r=e[n];Object.keys(r).map((function(e){""!==r[e].cached&&t.push({entry_uuid:n,input_ref:e,cached:r[e].cached,stored:r[e].stored,type:r[e].type})}))})),t},serializeToUrl(e){const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},stripTrailingSlash(e){return"/"===e.substr(-1)?e.substr(0,e.length-1).toLowerCase():e.toLowerCase()},serializeObj(e){const t=[];return Object.keys(e).forEach((function(n,r){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))})),t.join("&")},htmlDecode(e){let t,n,r="",s="";for(t=document.createElement("div"),t.innerHTML=e,r=0===t.childNodes.length?"":t.childNodes[0].nodeValue,t=document.createElement("div"),t.innerHTML=r,s=t.getElementsByTagName("script"),n=s.length;n--;)s[n].parentNode.removeChild(s[n]);return t.innerHTML},b64toBlob(e,t,n){t=t||"",n=n||512;const r=atob(e),s=[];for(let e=0;e<r.length;e+=n){const t=r.slice(e,e+n),o=new Array(t.length);for(let e=0;e<t.length;e++)o[e]=t.charCodeAt(e);const a=new Uint8Array(o);s.push(a)}return new Blob(s,{type:t})},async hasInternetConnection(){if(p().device.platform===l.WEB)return window.navigator.onLine;return(await K.Z.getStatus()).connected},async triggerBarcode(){const e=p();return new Promise(((t,n)=>{window.setTimeout((function(){e.device.platform===l.WEB&&t(""),window.cordova.plugins.barcodeScanner.scan((function(e){e.cancelled?n(null):t(e)}),(function(e){n(e)}))}),250)}))},async getAppVersion(){const e=p();return new Promise((t=>{e.device.platform===l.WEB&&t(""),t(e.app.version)}))},async getAppName(){const e=p();return new Promise((t=>{e.device.platform===l.WEB&&t("Epicollect5 Beta"),t(e.app.name)}))},getFileType(e){const t=e.split(".");let n;switch("."+t[t.length-1]){case l.PHOTO_EXT:n=l.QUESTION_TYPES.PHOTO;break;case l.AUDIO_EXT:n=l.QUESTION_TYPES.AUDIO;break;case l.VIDEO_EXT:n=l.QUESTION_TYPES.VIDEO}return n},getFilePath(e){let t="";switch(e){case l.QUESTION_TYPES.PHOTO:t=l.PHOTO_DIR;break;case l.QUESTION_TYPES.AUDIO:t=l.AUDIO_DIR;break;case l.QUESTION_TYPES.VIDEO:t=l.VIDEO_DIR}return t},getMIMEType(e){const t=p();let n;switch(e){case l.EC5_AUDIO_TYPE:t.device.platform===l.IOS&&(n="audio/wav"),t.device.platform===l.ANDROID&&(n="audio/mp4");break;case l.EC5_VIDEO_TYPE:n="video/mp4";break;default:n="image/jpeg"}return n},getProjectNameMarkup(e){let t="",n="";const r=p();if(!v.dV.isNativePlatform()){const t=B.getSlug(),s=l.API.ROUTES.PWA.ROOT+l.API.ROUTES.PWA.MEDIA;n='<img class="project-logo" width="32" height="32" src="'+(r.serverUrl+s+t+l.API.PARAMS.PROJECT_LOGO_QUERY_STRING)+'"/>',n+=e?"":"<span>&nbsp;"+B.getProjectName().toUpperCase()+"</span>"}return v.dV.isNativePlatform()&&(B.getProjectRef()===c.PROJECT_REF?(t=r.persistentDir+l.LOGOS_DIR+B.getProjectRef()+"/mobile-logo.jpg?"+(new Date).getTime(),n='<img class="project-logo" width="32" height="32" src="'+t+'" onError="this.src = \'assets/images/ec5-demo-project-logo.jpg\'"/>',n+=e?"":"<span>&nbsp;"+B.getProjectName().toUpperCase()+"</span>"):(t=r.persistentDir+l.LOGOS_DIR+B.getProjectRef()+"/mobile-logo.jpg?"+(new Date).getTime(),t=v.dV.convertFileSrc(t),n='<img class="project-logo" width="32" height="32" src="'+t+'" onError="this.src = \'assets/images/ec5-placeholder-100x100.jpg\'"/>',n+=e?"":"<span >&nbsp;"+B.getProjectName().toUpperCase()+"</span>")),n},trunc(e,t){return e.length>t?e.substr(0,t)+"...":e},hasQuestionError(e){var t,n;return Object.keys(e.error.errors).length>0&&!(null===(t=e.error)||void 0===t||null===(n=t.errors[e.currentInputRef])||void 0===n||!n.message)},objectsMatch(e,t){return Object.keys(t).every((n=>Object.prototype.hasOwnProperty.call(e,n)&&e[n]===t[n]))},buildPossibleAnswersHashMap(e){const t={};return e.forEach((e=>{t[e.answer_ref]=e.answer})),t},getStepPrecision(e){let t="0.";for(let n=0;n<e-1;n++)t+="0";return t+="1",parseFloat(t)},questionHasError(e){var t,n,r,s,o,a,i;return""!==(null===(t=e.error)||void 0===t||null===(n=t.errors)||void 0===n||null===(r=n[e.currentInputRef])||void 0===r||null===(s=r.message)||void 0===s?void 0:s.trim())&&void 0!==(null===(o=e.error)||void 0===o||null===(a=o.errors)||void 0===a||null===(i=a[e.currentInputRef])||void 0===i?void 0:i.message)},filterObjectsByUniqueKey(e,t){const n=[],r=[];return e.forEach((e=>{const s=e[t];-1===r.indexOf(s)&&(r.push(s),n.push(e))})),n},getRandomInt(e){return Math.floor(Math.random()*e)},getSanitisedAnswer(e){let t=e.trim();return t=t.replaceAll(">","﹥"),t=t.replaceAll("<","﹤"),t},getPlatformDownloadFolder(){let e="";switch(p().device.platform){case l.ANDROID:e=l.ANDROID_APP_DOWNLOAD_FOLDER;case l.IOS:}return e},generateFilenameForExport(e,t){return e+"__"+ee()(this.trunc(t.toLowerCase(),100))},async hasGoogleServices(){return new Promise((e=>{window.CheckHuaweiServices.checkHuaweiServicesAvailability((t=>{e(!t.status)}),(()=>{e(!0)}))}))},getHoursColumnPicker(){return Array.from({length:24},((e,t)=>t)).map((e=>({description:e>9?e.toString():"0"+e.toString()})))},getMinutesColumnPicker(){return Array.from({length:60},((e,t)=>t)).map((e=>({description:e>9?e.toString():"0"+e.toString()})))},getSecondsColumnPicker(){return this.getMinutesColumnPicker()},generateUniqID(e,t){let n;void 0===e&&(e="");const r=function(e,t){return t<(e=parseInt(e,10).toString(16)).length?e.slice(e.length-t):t>e.length?Array(t-e.length+1).join("0")+e:e};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,n=e,n+=r(parseInt((new Date).getTime()/1e3,10),8),n+=r(this.php_js.uniqidSeed,5),t&&(n+=(10*Math.random()).toFixed(8).toString()),n},getRandomInRange(e,t,n){return 1*(Math.random()*(t-e)+e).toFixed(n)},getRandomLocation(e,t){function n(e,t){return(Math.random()+Math.random()+Math.random()+Math.random()-2)/2*t+e}const r=n(0,.01),s=n(0,.01);return{longitude:(.1*r+e).toFixed(6),latitude:(.1*s+t).toFixed(6),accuracy:this.getRandomInRange(3,100,0)}},getDataViewerURL(e){return p().serverUrl+l.API.ROUTES.PROJECT+e+l.API.ROUTES.PWA.DATA_VIEWER+l.API.PARAMS.DATA_VIEWER_RESTORE_QUERY_STRING},isValidLatitude(e){return!!e&&(!(e.includes(".")&&e.split(".")[1].length>6)&&(0,te.Z)(e,0))},isValidLongitude(e){return!!e&&(!(e.includes(".")&&e.split(".")[1].length>6)&&(0,te.Z)(0,e))},isValidAccuracy(e){const t=Number(e);return Number.isInteger(t)&&t>0},getBasepath(){const e=new URL(window.location.href).pathname.split("/");return e.pop(),e.pop(),e.pop(),e.join("/")},isValidDecimalDegreesString(e){if(!e.includes(","))return!1;const t=e.split(","),n=t[0].trim(),r=t[1].trim();return ne.isValidLatitude(n)&&ne.isValidLongitude(r)},isObject(e){return"[object Object]"===Object.prototype.toString.call(e)},arrayGroupBy(e,t){return e.reduce(((n,r,s)=>((n[t(r,s,e)]||(n[t(r,s,e)]=[])).push(r),n)),{})}};var re={props:{entryUuid:{type:String,required:!0},inputRef:{type:String,required:!0},media:{type:Object,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,s=t.tempDir;let o={};const{entryUuid:a,media:u,inputRef:c}=(0,m.OT)(e);let d;if(d=""===u[a][c].cached?""===u[a][c].stored?ne.generateMediaFilename(a,l.QUESTION_TYPES.AUDIO):u[a][c].stored:u[a][c].cached,t.device.platform!==l.WEB){const e=t.device.platform===l.IOS?"file://":"";window.resolveLocalFileSystemURL(e+s,(function(e){e.getFile(d,{create:!0},(function(e){o=new window.Media(s+d,(function(){}),(function(e){O.showAlert(e.code,r.error),d="",i.modalController.dismiss(d)})),o.startRecord()}))}),(function(e){}))}const _={async stop(){t.device.platform!==l.WEB?(await O.showProgressDialog(r.saving,r.wait),o.stopRecord(),o.release(),O.hideProgressDialog(),O.showToast(r.audio_saved),i.modalController.dismiss(d)):i.modalController.dismiss(d)}};return{labels:r,...e,..._,micCircleOutline:T.KHU,stopCircleSharp:T.mI_}}};var se=(0,f.Z)(re,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-title"),l=(0,a.up)("ion-toolbar"),u=(0,a.up)("ion-header"),c=(0,a.up)("ion-icon"),d=(0,a.up)("ion-spinner"),p=(0,a.up)("ion-button"),m=(0,a.up)("ion-col"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"ion-text-center",color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.recording_audio),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a._)("div",Z,[(0,a.Wm)(c,{color:"dark",class:"audio-mic ion-text-center",icon:r.micCircleOutline},null,8,["icon"])]),(0,a._)("div",J,[(0,a.Wm)(d,{class:"",name:"dots"})]),(0,a._)("div",X,[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{size:"8",offset:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:t[0]||(t[0]=t=>e.stop()),class:"question-action-button",color:"secondary",expand:"block"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start",icon:r.stopCircleSharp},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.stop),1)])),_:1})])),_:1})])),_:1})])),_:1})])])),_:1})],64)}]]);var oe={setup(){return{}}};var ae=(0,f.Z)(oe,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-col"),l=(0,a.up)("ion-row"),u=(0,a.up)("ion-grid");return(0,a.wg)(),(0,a.j4)(u,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.WI)(e.$slots,"content")])),_:3})])),_:3})])),_:3})}]]);var ie=n(4161);const le={removeFiles(e){return new Promise(((t,n)=>{function r(e){e.remove(o,a)}function s(e){1===e.code?o():n(e)}function o(){e.length>0?i(e.pop()):t()}function a(e){n(e)}function i(e){window.resolveLocalFileSystemURL(e.file_path+e.project_ref+"/"+e.file_name,r,s)}i(e.pop())}))},removeFile(e){return new Promise(((t,n)=>{window.resolveLocalFileSystemURL(e,(e=>{e.remove((()=>{t()}),(e=>{1===e.code?t():n(e)}))}),(e=>{1===e.code?t():n(e)}))}))}};var ue=n(9669),ce=n.n(ue);const de={getXsrfToken(){const e=document.cookie.split(";");let t="";for(let n=0;n<e.length;n++){const r=e[n].split("=");"XSRF-TOKEN"===r[0].trim()&&(t=decodeURIComponent(r[1]))}return t},getProject(e){const t=this;return new Promise(((n,r)=>{t.getHeaders(!0).then((function(s){const o=t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.PROJECT+e;ce()({method:"GET",url:o,headers:s,timeout:3e4}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},getProjectPWA(e){const t=p();return new Promise(((n,r)=>{let s="";s=t.serverUrl+l.API.ROUTES.PWA.ROOT+l.API.ROUTES.PWA.PROJECT+e,ce()({method:"GET",url:s,timeout:3e4}).then((function(r){const s={id:0,name:r.data.data.project.name,slug:e,logo_thumb:null,project_ref:r.data.data.project.ref,server_url:t.serverUrl,json_extra:r.data.meta.project_extra,mapping:r.data.meta.project_mapping,last_updated:r.data.meta.project_stats.structure_last_updated};n(s)}),(function(e){r(e.response)}))}))},searchForProject(e){const t=this;return new Promise((function(n,r){t.getHeaders().then((function(s){ce()({method:"GET",url:t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.PROJECTS+e,headers:s}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},uploadEntry(e,t){const n=this,r=p();return new Promise(((s,o)=>{n.getHeaders(!0).then((function(a){r.device.platform!==l.WEB&&l.MOBILE_DEBUG,ce()({method:"POST",url:n.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.UPLOAD+e,headers:a,data:{data:t}}).then((function(e){s(e)}),(function(e){o(e.response)}))}))}))},uploadEntryPWA(e,t){const n=this;return new Promise(((r,s)=>{const o=l.API.ROUTES.PWA.ROOT,a=l.API.ROUTES.PWA.ROOT_DEBUG;let i=n.getServerUrl();l.DEBUG?i+=a+l.API.ROUTES.PWA.UPLOAD_DEBUG+e:i+=o+l.API.ROUTES.PWA.UPLOAD+e,ce()({method:"POST",url:i,data:{data:t}}).then((function(e){r(e)}),(function(e){s(e.response)}))}))},downloadEntryPWA(e,t,n,r,s){const o=this;return new Promise(((a,i)=>{const u=l.API.ROUTES.PWA.ROOT,c=l.API.ROUTES.PWA.ROOT_DEBUG;let d=o.getServerUrl();l.DEBUG?d+=c+l.API.ROUTES.PWA.ENTRIES_DEBUG+e:d+=u+l.API.ROUTES.PWA.ENTRIES+e,d+="?form_ref="+t+"&uuid="+n,r&&s&&(d+="&branch_ref="+r,d+="&branch_owner_uuid="+s),ce()({method:"GET",url:d}).then((function(e){a(e)}),(function(e){i(e.response)}))}))},uploadFilePWA(e,t){const n=this;return new Promise(((r,s)=>{const o=l.API.ROUTES.PWA.ROOT,a=l.API.ROUTES.PWA.ROOT_DEBUG;let i=n.getServerUrl();l.DEBUG?i+=a+l.API.ROUTES.PWA.UPLOAD_FILE_DEBUG+e:i+=o+l.API.ROUTES.PWA.UPLOAD_FILE+e,ce()({method:"POST",url:i,data:t}).then((function(e){r(e)}),(function(e){s(e.response)}))}))},deleteTempMediaFile(e,t,n,r){return new Promise(((s,o)=>{const a={data:{type:"delete",id:t,delete:{filetype:n,filename:r}}},i=l.API.ROUTES.PWA.ROOT,u=l.API.ROUTES.PWA.ROOT_DEBUG;let c=B.getServerUrl();l.DEBUG?c+=u+l.API.ROUTES.PWA.TEMP_MEDIA_DELETE_DEBUG+e:c+=i+l.API.ROUTES.PWA.TEMP_MEDIA_DELETE+e,ce()({method:"POST",url:c,data:a}).then((function(e){s(e)}),(function(e){o(e)}))}))},checkUniquenessPWA(e,t){const n=this;return new Promise(((r,s)=>{const o=l.API.ROUTES.PWA.ROOT,a=l.API.ROUTES.PWA.ROOT_DEBUG;let i=n.getServerUrl();l.DEBUG?i+=a+l.API.ROUTES.PWA.UNIQUE_ANSWER_DEBUG+e:i+=o+l.API.ROUTES.PWA.UNIQUE_ANSWER+e,ce()({method:"POST",url:i,data:{data:t}}).then((function(e){r(e)}),(function(e){s(e.response)}))}))},geocodeAddressPWA(e){const t=this;return new Promise(((n,r)=>{const s=l.API.ROUTES.PWA.ROOT,o=l.API.ROUTES.PWA.ROOT_DEBUG;let a=t.getServerUrl();l.DEBUG?a+=o+l.API.ROUTES.PWA.OPENCAGE_DEBUG:a+=s+l.API.ROUTES.PWA.OPENCAGE,a+=e,ce()({method:"GET",url:a}).then((function(e){const t=e.data;if(200===t.status.code&&t.results.length>0){const e={longitude:t.results[0].geometry.lng.toFixed(6),latitude:t.results[0].geometry.lat.toFixed(6),accuracy:l.GEOLOCATION_DEFAULT_ACCURACY};n(e)}else r()}),(function(e){r()}))}))},downloadEntries(e,t,n){const r=this,s=n||r.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.ENTRIES+e+"?form_ref="+t+"&per_page="+l.ENTRIES_REMOTE_PER_PAGE;return new Promise((function(e,t){r.getHeaders(!0).then((function(n){ce()({method:"GET",url:s,headers:n}).then((function(t){e(t)}),(function(e){t(e.response)}))}))}))},uploadMediaEntry(e,t){const n=this;return new Promise((function(r,s){n.getHeaders(!0).then((function(o){return ce()({method:"POST",url:n.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.UPLOAD+e,headers:o,data:{data:t}}).then((function(e){r(e)}),(function(e){s(e.response)}))}))}))},login(e,t){const n=this;return new Promise((function(r,s){n.getHeaders().then((function(o){ce()({method:"POST",url:n.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.LOGIN+t,headers:o,data:{username:e.email,password:e.password}}).then((function(e){r(e)}),(function(e){s(e.response)}))}))}))},authGoogleUser(e){const t=this;return new Promise((function(n,r){t.getHeaders().then((function(s){ce()({method:"POST",url:t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.HANDLE_GOOGLE,headers:s,data:{code:e,grant_type:"authorization_code"}}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},authAppleUser(e,t){const n=this;return new Promise((function(r,s){n.getHeaders().then((function(o){ce()({method:"POST",url:n.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.HANDLE_APPLE,headers:o,data:{identityToken:e,user:t}}).then((function(e){r(e)}),(function(e){s(e.response)}))}))}))},getLoginMethods(){const e=this;return new Promise((function(t,n){e.getHeaders().then((function(r){ce()({method:"GET",url:e.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.GET_LOGIN,headers:r}).then((function(e){t(e)}),(function(e){n(e.response)}))}))}))},getProjectVersion(e){const t=this;return new Promise((function(n,r){t.getHeaders(!0).then((function(s){ce()({method:"GET",url:t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.PROJECT_VERSION+e,headers:s}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},getHeaders(e){const t={"Content-Type":"application/vnd.api+json"};return new Promise((function(n,r){e?I.getUser().then((function(e){let r;e.rows.length>0&&(r=e.rows.item(0).jwt),r&&(t.Authorization="Bearer "+r),n(t)})):n(t)}))},getServerUrl(){const e=p();return B.getServerUrl()?B.getServerUrl():e.serverUrl},getProjectImageUrl(e){return this.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.MEDIA+e+l.API.PARAMS.PROJECT_LOGO_QUERY_STRING},passwordlessLogin(e){const t=this;return new Promise((function(n,r){t.getHeaders().then((function(s){ce()({method:"POST",url:t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.LOGIN+"passwordless",headers:s,data:{email:e.email,code:e.code}}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},getPasswordlessCode(e){const t=this;return new Promise((function(n,r){t.getHeaders().then((function(s){ce()({method:"POST",url:t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.PASSWORDLESS_CODE,headers:s,data:{email:e}}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},getEmailConfirmationCode(e){const t=this;return new Promise((function(n,r){t.getHeaders().then((function(s){ce()({method:"POST",url:t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.PASSWORDLESS_CODE,headers:s,data:{email:e}}).then((function(e){n(e)}),(function(e){r(e.response)}))}))}))},verifyUserEmail(e){const t=this,n=e.provider.toUpperCase(),r=t.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.VERIFY[n];return new Promise((function(n,s){t.getHeaders().then((function(t){ce()({method:"POST",url:r,headers:t,data:{email:e.email,code:e.code,user:e.user}}).then((function(e){n(e)}),(function(e){s(e.response)}))}))}))}};var pe={props:{entryUuid:{type:String,required:!0},projectRef:{type:String,required:!0},inputRef:{type:String,required:!0},media:{type:Object,required:!0},mediaFolder:{type:String,required:!0},mediaType:{type:String,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,{entryUuid:s,inputRef:o,projectRef:a,mediaFolder:u}=(0,m.OT)(e),c=t.tempDir,d=t.persistentDir;let _="";const f=(0,m.OT)(e.media[s][o].cached),w=(0,m.OT)(e.media[s][o].stored),g=(0,m.OT)(e.media[s][o].filenamePWA.cached),h=(0,m.OT)(e.media[s][o].filenamePWA.stored);""!==f?_=c+f:""!==w&&(_=d+u+a+"/"+w);const E={share(){ie.m.share({title:"",text:"",url:"file://"+_,dialogTitle:""}),i.popoverController.dismiss()},async removePWA(){await O.showProgressDialog(r.wait);const o=B.getSlug();if(""!==g)try{await de.deleteTempMediaFile(o,s,e.mediaType,g),O.showToast(r.file_deleted),i.popoverController.dismiss(l.ACTIONS.FILE_DELETED)}catch(e){O.showAlert(b[n].status_codes.ec5_103),i.popoverController.dismiss(null)}finally{O.hideProgressDialog()}else{if(""===h)return O.hideProgressDialog(),!1;t.queueRemoteFilesToDeletePWA.push({type:e.mediaType,filename:h}),O.showToast(r.file_deleted),i.popoverController.dismiss(l.ACTIONS.FILE_DELETED),O.hideProgressDialog()}},async removeNative(){if(await O.showProgressDialog(r.wait),""!==f)t.device.platform===l.IOS&&(_.startsWith("file://")||(_="file://"+_)),le.removeFile(_).then((()=>{O.hideProgressDialog(),i.popoverController.dismiss(l.ACTIONS.FILE_DELETED)}),(e=>{O.hideProgressDialog(),i.popoverController.dismiss(),O.showAlert(e.code,r.error)}));else{if(""===w)return O.hideProgressDialog(),!1;{let e=d+u;t.device.platform===l.IOS&&(e.startsWith("file://")||(e="file://"+e)),t.queueFilesToDelete.push({inputRef:o,filenameStored:w,file_path:e,project_ref:a,file_name:w}),O.hideProgressDialog(),i.popoverController.dismiss(l.ACTIONS.FILE_QUEUED)}}},async remove(){await O.confirmSingle(r.are_you_sure,r.delete)&&(t.isPWA?E.removePWA():E.removeNative())}},y={isPWA:(0,m.Fl)((()=>t.isPWA))};return{labels:r,...E,...y,trash:T._Ij,shareSocial:T.xgT}}};var me=(0,f.Z)(pe,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-label"),u=(0,a.up)("ion-item"),c=(0,a.up)("ion-list"),d=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.j4)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"ion-no-padding ion-no-margin"},{default:(0,a.w5)((()=>[e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,lines:"full",onClick:t[0]||(t[0]=t=>e.share())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:r.shareSocial},null,8,["icon"]),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.share),1)])),_:1})])),_:1})),(0,a.Wm)(u,{lines:"full",onClick:t[1]||(t[1]=t=>e.remove())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:r.trash,color:"danger"},null,8,["icon"]),(0,a.Wm)(l,{color:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.delete),1)])),_:1})])),_:1})])),_:1})])),_:1})}]]);async function _e({media:e,entryUuid:t,state:n,e:r,mediaType:s}){const o=p(),a=B.getProjectRef(),u=n.inputDetails.ref;let c="";switch(s){case l.QUESTION_TYPES.AUDIO:c=l.AUDIO_DIR;break;case l.QUESTION_TYPES.PHOTO:c=l.PHOTO_DIR;break;case l.QUESTION_TYPES.VIDEO:c=l.VIDEO_DIR}const d=await i.popoverController.create({event:r,component:me,componentProps:{projectRef:a,media:e,entryUuid:t,inputRef:u,mediaFolder:c,mediaType:s},cssClass:"popover-question-media",animated:!1,reference:"trigger",side:"left"});return d.onDidDismiss().then((r=>{[l.ACTIONS.FILE_DELETED,l.ACTIONS.FILE_QUEUED].includes(r.data)&&(n.filename="",n.fileSource="",s===l.QUESTION_TYPES.PHOTO&&(n.imageSource=""),e[t][u].cached="",e[t][u].stored="",o.isPWA&&(e[t][u].filenamePWA.cached="",e[t][u].filenamePWA.stored="")),r.data===l.ACTIONS.FILE_DELETED&&(n.answer.answer="")})),d.present()}const fe={class:""};var we={props:{questionText:{type:String,required:!0},action:{type:String,required:!0},disabled:{type:Boolean,required:!0}},emit:["on-label-button-click"],setup(e,t){const n={onLabelButtonClick(e){t.emit("on-label-button-click",e)}},r={actionIcon:(0,m.Fl)((()=>{const{action:t}=e;switch(t){case"media":return T.LHl;case"search":return T.yC4;case"filter":default:return T.hXT;case"help":return T.pvH;case"edit":return T.Ue8}}))};return{...e,...n,...r}}};var ge=(0,f.Z)(we,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-col"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-ripple-effect"),c=(0,a.up)("ion-row"),d=(0,a.up)("ion-grid");return(0,a.wg)(),(0,a.j4)(d,{class:"question-label-grid"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{"size-xs":"10","size-sm":"11","size-md":"11","size-lg":"11","size-xl":"11"},{default:(0,a.w5)((()=>[(0,a._)("div",fe,(0,h.zw)(n.questionText),1)])),_:1}),(0,a.Wm)(i,{"size-xs":"2","size-sm":"1","size-md":"1","size-lg":"1","size-xl":"1"},{default:(0,a.w5)((()=>[(0,a._)("div",{class:"question-label-button ion-activatable ripple-parent ion-text-center",onClick:t[0]||(t[0]=t=>e.onLabelButtonClick(t))},[n.disabled?((0,a.wg)(),(0,a.j4)(l,{key:0,class:"disabled",icon:e.actionIcon},null,8,["icon"])):((0,a.wg)(),(0,a.j4)(l,{key:1,icon:e.actionIcon},null,8,["icon"])),(0,a.Wm)(u,{class:"question-label-button-ripple",type:"unbounded"})])])),_:1})])),_:1})])),_:1})}]]);const he={key:0,class:"dropzone-preview ion-text-center"},Ee={slot:"start",class:"question-photo-thumbnail animate__animated animate__fadeIn ion-margin-top"},ye=["src"],Ae=["src"],Se=["src"],Te={key:1};var be=n(9118),Re=n(9492);const Ie={makeJsonEntry(e,t){const n=p();switch(t.last_updated=B.getLastUpdated(),n.isPWA?t.device_id="":t.device_id=n.device.uuid,t.platform=v.dV.isNativePlatform()?t.platform=n.device.platform:t.platform=l.WEB,t.platform){case l.ANDROID:t.platform=l.LEGACY_ANDROID;break;case l.IOS:t.platform=l.LEGACY_IOS;break;default:t.platform=l.LEGACY_WEB}return t.entry_type=e,function(e){const t=p();let n={},r={};e.parent_entry_uuid&&(r={data:{parent_form_ref:e.parent_form_ref,parent_entry_uuid:e.parent_entry_uuid}}),e.owner_entry_uuid&&(n={data:{owner_input_ref:e.owner_input_ref,owner_entry_uuid:e.owner_entry_uuid}});const s={type:e.entry_type,id:e.entry_uuid,attributes:{form:{ref:e.form_ref,type:"hierarchy"}},relationships:{parent:r,branch:n}};try{s[e.entry_type]={entry_uuid:e.entry_uuid,created_at:e.created_at,device_id:e.device_id,platform:e.platform,title:e.title,answers:JSON.parse(e.answers),project_version:e.last_updated},t.isPWA&&(s[e.entry_type].files_to_delete=t.queueRemoteFilesToDeletePWA)}catch(t){s[e.entry_type]={}}return s}(t)},makeJsonFileEntry(e){const t=p();switch(e.structure_last_updated=B.getLastUpdated(),e.device_id=t.device.uuid,e.platform=v.dV.isNativePlatform()?t.device.platform:e.platform=l.WEB,e.platform){case l.ANDROID:e.platform=l.LEGACY_ANDROID;break;case l.IOS:e.platform=l.LEGACY_IOS;break;default:e.platform=l.LEGACY_WEB}return function(e){return{type:"file_entry",id:e.entry_uuid,attributes:{form:{ref:e.form_ref,type:"hierarchy"}},relationships:{parent:{},branch:{}},file_entry:{entry_uuid:e.entry_uuid,name:e.file_name,type:e.file_type,input_ref:e.input_ref,project_version:e.structure_last_updated,created_at:e.created_at||(new Date).toISOString(),device_id:e.device_id||"",platform:e.platform||""}}}(e)},flattenJsonEntry(e,t,n){return{entryUuid:e.id,parentEntryUuid:e.relationships.parent.data?e.relationships.parent.data.parent_entry_uuid:"",projectRef:e.projectRef,formRef:e.attributes.form.ref,parentFormRef:e.relationships.parent.data?e.relationships.parent.data.parent_form_ref:"",answers:e.entry.answers,synced:1,synced_error:"",canEdit:t,isRemote:n,createdAt:e.entry.created_at,updatedAt:e.entry.created_at,title:e.entry.title,titles:JSON.stringify({})}},getBranchCSVHeaders(e,t){const n=B.getProjectExtra(),r={details:{ref:e.formRef,inputs:[],ownerInputRef:e.branchRef}};let s;Object.values(n.forms).every((t=>!t.branch[e.branchRef]||(s=t.branch[e.branchRef],!1))),s.forEach((e=>{r.details.inputs.push(n.inputs[e].data)}));const o=this.getFormCSVHeaders(r,t,!1,0,!0);return o.splice(0,1,"ec5_branch_owner_uuid","ec5_branch_uuid"),o},getFormCSVHeaders(e,t,n,r,s){const o=n?e.headers:["ec5_uuid","created_at","title"],a=e.details.ref,i=t.filter((e=>{if(e.is_default)return e.forms}));return r>0&&!n&&o.splice(1,0,"parent_entry_uuid"),e.details.inputs.forEach((r=>{if(r.type!==l.QUESTION_TYPES.README){let p;if(s){var u;const t=e.details.ownerInputRef;p=null===(u=i[0].forms[a][t].branch[r.ref])||void 0===u?void 0:u.map_to}else if(n){var c;const t=e.groupRef;p=null===(c=i[0].forms[a][t].group[r.ref])||void 0===c?void 0:c.map_to}else{var d;p=null===(d=i[0].forms[a][r.ref])||void 0===d?void 0:d.map_to}switch(r.type){case l.QUESTION_TYPES.LOCATION:o.push("lat_"+p),o.push("long_"+p),o.push("acc_"+p),o.push("UTM_Northing_"+p),o.push("UTM_Easting_"+p),o.push("UTM_Zone_"+p);break;case l.QUESTION_TYPES.README:break;case l.QUESTION_TYPES.BRANCH:o.push(p);break;case l.QUESTION_TYPES.GROUP:{const e=this.getGroupCSVHeaders(a,r.group,t,r.ref,o);o.concat(e);break}default:o.push(p)}}})),o},getGroupCSVHeaders(e,t,n,r,s){const o={details:{ref:e,inputs:t},groupRef:r,headers:s};return this.getFormCSVHeaders(o,n,!0,1,!1)},async getFormCSVRow(e,t,n,r){const s=r?t.row:[e.entry_uuid,e.created_at,e.title],o=[];let a;return e.parent_entry_uuid&&!r&&s.splice(1,0,e.parent_entry_uuid),t.details.inputs.forEach((async(t,r)=>{if(t.type!==l.QUESTION_TYPES.README){let a="";switch(void 0!==n[t.ref]&&(a=n[t.ref].answer),t.type){case l.QUESTION_TYPES.DATE:{const e=t.datetime_format;""===a?s.push(""):s.push(ne.getUserFormattedDate(a,e));break}case l.QUESTION_TYPES.TIME:{const e=t.datetime_format;""===a?s.push(""):s.push(ne.getUserFormattedTime(a,e));break}case l.QUESTION_TYPES.LOCATION:if(a.latitude&&a.longitude){const e=this.utmConverter(a.latitude,a.longitude);s.push(a.latitude.toString()),s.push(a.longitude.toString()),s.push(a.accuracy.toString()),s.push(e.northing.toString()),s.push(e.easting.toString()),s.push(e.zone)}else s.push(""),s.push(""),s.push(""),s.push(""),s.push(""),s.push("");break;case l.QUESTION_TYPES.DROPDOWN:case l.QUESTION_TYPES.RADIO:t.possible_answers.every((e=>e.answer_ref!==a||(a.includes(",")?s.push('"'+e.answer+'"'):s.push(e.answer),!1)));break;case l.QUESTION_TYPES.CHECKBOX:case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCHMULTIPLE:{const e=[];if(a.length>0){a.forEach((n=>{t.possible_answers.every((t=>t.answer_ref!==n||(e.push(t.answer),!1)))}));const n=e.map((e=>e.includes(",")?'"'+e+'"':e));s.push(n.join(", "))}else s.push("");break}case l.QUESTION_TYPES.GROUP:{const r=this.getGroupCSVRow(e,t.group,n,s);s.concat(r);break}case l.QUESTION_TYPES.README:break;case l.QUESTION_TYPES.BRANCH:o.push({ownerEntryUuid:e.entry_uuid,inputRef:t.ref,inputIndex:r});break;default:a=a.toString().trim(),a.includes(",")?s.push('"'+a+'"'):s.push(a)}}})),o.length>0&&(a=await Promise.all(o.map((async t=>{const n=await I.countBranchesForQuestion(t.ownerEntryUuid,t.inputRef,null,null);let s=3;return e.parent_entry_uuid&&!r&&s++,{total:n.rows.item(0).total.toString(),placeAtIndex:t.inputIndex+s}}))),a.forEach((e=>{s.splice(e.placeAtIndex,0,e.total)}))),s},async getBranchCSVRow(e,t,n,r){const s=B.getProjectExtra(),o={details:{ref:t.formRef,inputs:[],ownerInputRef:t.branchRef}};let a;Object.values(s.forms).every((e=>!e.branch[t.branchRef]||(a=e.branch[t.branchRef],!1))),a.forEach((e=>{o.details.inputs.push(s.inputs[e].data)}));const i=await this.getFormCSVRow(e,o,n,r);return i.unshift(e.owner_entry_uuid),i},getGroupCSVRow(e,t,n,r){const s={details:{inputs:t},row:r};return this.getFormCSVRow(e,s,n,!0,1)},utmConverter(e,t){function n(e,t){return e>55&&e<64&&t>2&&t<6?32:e>71&&t>=6&&t<9?31:e>71&&(t>=9&&t<12||t>=18&&t<21)?33:e>71&&(t>=21&&t<24||t>=30&&t<33)?35:parseInt((t+180)/6%60)+1}const r=n(e,t);Re.Z.defs([["EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"],["EPSG:AUTO",function(e,t){return`+proj=utm +zone=${n(e,t)} +datum=WGS84 +units=m +no_defs`}(e,t)]]);const s=(0,Re.Z)("EPSG:4326","EPSG:AUTO",[t,e]),o=Math.floor(s[0]),a=Math.floor(s[1]);let i;e>-80&&e<72&&(i=Math.floor((e+80)/8)+2),e>72&&e<84&&(i=21),e>84&&(i=23);const l="ABCDEFGHJKLMNPQRSTUVWXYZ".charAt(i);(0,Re.Z)("EPSG:AUTO","EPSG:4326",s);return{northing:a,easting:o,zone:r+l}},makeUniqueEntry(e,t,n,r,s){const o=t.isBranch?l.BRANCH_ENTRY:l.ENTRY,a={parent:{},branch:{}};return t.parentEntryUuid&&(a.parent={data:{parent_form_ref:t.parentFormRef,parent_entry_uuid:t.parentEntryUuid}}),t.ownerEntryUuid&&(a.branch={data:{owner_input_ref:t.ownerInputRef,owner_entry_uuid:t.ownerEntryUuid}}),{id:t.entryUuid,type:o,attributes:{form:{ref:e,type:"hierarchy"}},relationships:a,[o]:{entry_uuid:t.entryUuid,input_ref:n,answer:r,project_version:s,platform:l.LEGACY_WEB}}}},ve={getEC5Errors(e){if(e&&e.constructor===Array&&e.length>0)for(let t=0;t<e.length;t++)if(Object.prototype.hasOwnProperty.call(e,t)&&Object.prototype.hasOwnProperty.call(e[t],"code"))return e[0].code},getStatusError(e){switch(e){case 0:return"ec5_103";case 404:return"ec5_142";default:return"ec5_116"}},getWebErrorCode(e){if(e)if(Object.prototype.hasOwnProperty.call(e,"data")&&null!==e.data){if(Object.prototype.hasOwnProperty.call(e.data,"errors"))return this.getEC5Errors(e.data.errors)}else if(Object.prototype.hasOwnProperty.call(e,"status"))return this.getStatusError(e.status);return"ec5_116"},async handleWebError(e){const t=p().language;let n;return n=await ne.hasInternetConnection()?this.getWebErrorCode(e):"ec5_135",O.showAlert(b[t].status_codes[n],b[t].labels.error),b[t].status_codes[n]},handleAuthError(e){},handleEntryErrors(e,t,n){const r=p().language;let s;for(s in this.resetEntryErrors(t,n),e)if(Object.prototype.hasOwnProperty.call(e,s)&&""!==e[s].message){t.hasError=!0,t.errors[s]=e[s],O.showAlert(t.errors[s].message,b[r].labels.error);break}},resetEntryErrors(e,t){let n;for(n in e.hasError=!1,e.errors)Object.prototype.hasOwnProperty.call(e.errors,n)&&(t.indexOf(n)>-1&&(e.errors[n].message=""),""!==e.errors[n].message&&(e.hasError=!0))},needsToLogin(e){return l.AUTH_ERROR_CODES.indexOf(e)>-1}};var Pe={props:{filename:{type:String,required:!0},filestate:{type:String,required:!0},fileError:{type:String,required:!0},inputRef:{type:String,required:!0},type:{type:String,required:!0},uuid:{type:String,required:!0}},emits:["file-dropped","file-loaded","file-error"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=B.getFirstFormRef(),a=B.getSlug();let i=(0,m.IU)(e.filename);const u=(0,m.qj)({type:e.type,isDraggingOver:!1,dropMessage:"",filesource:"",previewLoaded:!1,loadingError:!1,acceptedFormats:l.PWA_FILE_ACCEPTED_FORMATS[e.type.toUpperCase()]});u.filesource=""===e.filename?"":w(e.filename,e.type,e.filestate),i=""===e.filename?"":e.filename;const c={onDrop:async function(n,r){if(0===n.length){const e=r[0].errors[0].message;return O.showAlert(e,s.error),u.isDraggingOver=!1,!1}{await O.showProgressDialog(s.wait,s.uploading);const r=n[0];let c=n[0].name.split(".").pop();u.type===l.QUESTION_TYPES.PHOTO&&(c="jpg"),i=""===e.filename?ne.generateMediaFilename(e.uuid,u.type):e.filename;const d=new FormData,p=Ie.makeJsonFileEntry({entry_uuid:e.uuid,form_ref:o,file_name:i,file_type:e.type,input_ref:e.inputRef,structure_last_updated:B.getLastUpdated(),created_at:(new Date).toISOString(),platform:l.WEB,device_id:""});d.append("data",JSON.stringify(p)),d.append("file",r),de.uploadFilePWA(a,d).then((t=>{O.showToast(s.file_uploaded),u.filesource=w(i,e.type,l.PWA_FILE_STATE.CACHED),u.loadingError=!1}),(async e=>{const n=await ve.handleWebError(e);t.emit("file-error",n)})).finally((()=>{O.hideProgressDialog(),u.isDraggingOver=!1,t.emit("file-dropped",i)}))}},onDragEnter:function(){u.isDraggingOver=!0},onDragLeave:function(){u.isDraggingOver=!1},multiple:!1,accept:l.PWA_MIMETYPES[e.type.toUpperCase()],maxSize:l.PWA_UPLOAD_MAX_SIZE[e.type.toUpperCase()],maxFiles:1},{getRootProps:d,getInputProps:_}=(0,be.u)(c),f={onImageLoaded(){u.previewLoaded=!0,t.emit("file-loaded",i)},onError(e){u.previewLoaded=!0,u.loadingError=!0},onAudioLoaded(){u.previewLoaded=!0,t.emit("file-loaded",i)},onVideoLoaded(){u.previewLoaded=!0,t.emit("file-loaded",i)}};function w(e,t,r){const s=ne.generateTimestamp(),o=l.API.ROUTES.PWA.ROOT,i=l.API.ROUTES.PWA.ROOT_DEBUG;let u=n.serverUrl;switch(l.DEBUG?r===l.PWA_FILE_STATE.CACHED?u+=i+l.API.ROUTES.PWA.TEMP_MEDIA+a:u+=i+l.API.ROUTES.PWA.MEDIA+a:r===l.PWA_FILE_STATE.CACHED?u+=o+l.API.ROUTES.PWA.TEMP_MEDIA+a:u+=o+l.API.ROUTES.PWA.MEDIA+a,t){case l.QUESTION_TYPES.AUDIO:u+="?format=audio";break;case l.QUESTION_TYPES.PHOTO:u+="?format=entry_original";break;case l.QUESTION_TYPES.VIDEO:u+="?format=video"}return u+="&name="+e,u+="&type="+t,u+="&timestamp="+s,u}return{getRootProps:d,getInputProps:_,labels:s,state:u,PARAMETERS:l,props:e,...f}}};var De=(0,f.Z)(Pe,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-spinner"),u=(0,a.up)("ion-label"),c=(0,a.up)("ion-item");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",{class:(0,h.C_)(["dropzone",{"dropzone-active":s.state.isDraggingOver}])},[(0,a._)("div",(0,h.vs)((0,a.F4)(s.getRootProps())),[(0,a._)("input",(0,h.vs)((0,a.F4)(s.getInputProps())),null,16),(0,a._)("div",null,"Drop "+(0,h.zw)(s.state.type)+" file or click here.",1),(0,a._)("p",null,[(0,a._)("strong",null,(0,h.zw)(s.state.acceptedFormats),1)])],16)],2),""===s.state.filesource||s.state.loadingError?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",he,[(0,a._)("div",Ee,[(0,a.wy)((0,a.Wm)(l,{class:"spinner ion-margin-top",name:"crescent"},null,512),[[r.F8,!s.state.previewLoaded]]),s.state.type===s.PARAMETERS.QUESTION_TYPES.PHOTO?(0,a.wy)(((0,a.wg)(),(0,a.iD)("img",{key:0,class:"animate__animated animate__fadeIn",src:s.state.filesource,onLoad:t[0]||(t[0]=t=>e.onImageLoaded()),onError:t[1]||(t[1]=(...t)=>e.onError&&e.onError(...t))},null,40,ye)),[[r.F8,s.state.previewLoaded]]):(0,a.kq)("",!0),s.state.type===s.PARAMETERS.QUESTION_TYPES.AUDIO?(0,a.wy)(((0,a.wg)(),(0,a.iD)("audio",{key:1,controls:"",class:"animate__animated animate__fadeIn full-width",src:s.state.filesource,onLoadeddata:t[2]||(t[2]=t=>e.onAudioLoaded()),onError:t[3]||(t[3]=(...t)=>e.onError&&e.onError(...t))},null,40,Ae)),[[r.F8,s.state.previewLoaded]]):(0,a.kq)("",!0),s.state.type===s.PARAMETERS.QUESTION_TYPES.VIDEO?(0,a.wy)(((0,a.wg)(),(0,a.iD)("video",{key:2,controls:"",class:"pwa-video animate__animated animate__fadeIn full-width",src:s.state.filesource,onLoadeddata:t[4]||(t[4]=t=>e.onVideoLoaded()),onError:t[5]||(t[5]=(...t)=>e.onError&&e.onError(...t))},null,40,Se)),[[r.F8,s.state.previewLoaded]]):(0,a.kq)("",!0)])])),s.state.loadingError?((0,a.wg)(),(0,a.iD)("div",Te,[(0,a.Wm)(c,{lines:"none",class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.props.fileError),1)])),_:1})])),_:1})])):(0,a.kq)("",!0)],64)}]]);const Oe={initialise(e){this.entryUuid=e.entry_uuid,this.parentEntryUuid=e.parent_entry_uuid,this.isRemote=e.is_remote,this.synced=e.synced,this.canEdit=e.can_edit,this.createdAt=e.created_at,this.title=e.title?e.title:"",this.formRef=e.form_ref,this.parentFormRef=e.parent_form_ref,this.projectRef=e.project_ref,this.branchEntries=e.branchEntries?e.branchEntries:{},this.media=e.media?e.media:{},this.uniqueAnswers={},this.syncedError=e.synced_error,this.isBranch=!1,this.verifyAnswers={};try{this.answers="object"==typeof e.answers?e.answers:JSON.parse(e.answers)}catch(e){this.answers={}}}},ke={setUpInputParams(e,t,n){const r=B.getExtraInputs();e.inputDetails=r[t].data,e.currentInputRef=t,e.error=n.error,e.required=e.inputDetails.is_required,e.question=e.inputDetails.question,e.pattern=e.inputDetails.regex,e.answer=(0,m.IU)(n.answers[t]),e.confirmAnswer=(0,m.IU)(n.confirmAnswer[t])},getNavigationParamsPWA(e){const t=p();let n="";const r={projectRef:B.getProjectRef(),formRef:e.entry.formRef};switch(e.action){case l.ENTRY_EDIT:r.entryUuid=e.entry.entryUuid,e.entry.isBranch?t.branchEditType===l.PWA_BRANCH_REMOTE?n=l.ROUTES.PWA_QUIT:(n=l.ROUTES.ENTRIES_ADD,r.entryUuid=e.entry.entryUuid,r.ownerEntryUuid=e.entry.ownerEntryUuid,r.ownerInputRef=e.entry.ownerInputRef,r.inputRef=e.entry.ownerInputRef,r.inputIndex=B.getInputIndexFromRef(e.entry.formRef,r.inputRef),r.isBranch=!1):n=l.ROUTES.PWA_QUIT;break;case l.ENTRY_ADD:if(e.entry.isBranch)if(t.branchEditType===l.PWA_BRANCH_REMOTE)n=l.ROUTES.PWA_QUIT;else{if(t.providedSegment===l.PWA_EDIT_ENTRY){n=l.ROUTES.ENTRIES_EDIT,r.entryUuid=e.entry.ownerEntryUuid;const t=Oe;t.parentEntryUuid&&t.parentFormRef&&(r.parentFormRef=t.parentFormRef,r.parentEntryUuid=t.parentEntryUuid)}else n=l.ROUTES.ENTRIES_ADD;r.inputRef=e.entry.ownerInputRef,r.inputIndex=B.getInputIndexFromRef(e.form.formRef,e.entry.ownerInputRef),r.isBranch=!1}else n=l.ROUTES.PWA_QUIT}return{routeName:n,routeParams:r}},getNavigationParams(e){const t=p(),n=this;let r="";const s={projectRef:B.getProjectRef(),formRef:e.entry.formRef};if(t.isPWA)return n.getNavigationParamsPWA(e);switch(e.action){case l.ENTRY_EDIT:s.entryUuid=e.entry.entryUuid,e.entry.isBranch?(r=l.ROUTES.ENTRIES_VIEW_BRANCH,s.entryUuid=e.entry.entryUuid,s.ownerEntryUuid=e.entry.ownerEntryUuid,s.ownerInputRef=e.entry.ownerInputRef):(r=l.ROUTES.ENTRIES_VIEW,s.parentEntryUuid=e.entry.parentEntryUuid);break;case l.ENTRY_UPLOAD:r=l.ROUTES.ENTRIES_UPLOAD;break;default:e.entry.isBranch?(r=l.ROUTES.ENTRIES_ADD,s.inputRef=e.entry.ownerInputRef,s.inputIndex=B.getInputIndexFromRef(e.form.formRef,e.entry.ownerInputRef),s.isBranch=!1):r=l.ROUTES.ENTRIES}return{routeName:r,routeParams:s}}};var Ue={components:{GridQuestionNarrow:ae,QuestionLabelAction:ge,Dropzone:De},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,required:!0}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),u=n.entriesAddScope,c=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},filename:"",ongoingAction:"",pwaFileState:l.PWA_FILE_STATE.CACHED});ke.setUpInputParams(c,e.inputRef,o);const d={hasError:(0,m.Fl)((()=>ne.hasQuestionError(c))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(c.error.errors).length>0?null===(e=c.error)||void 0===e||null===(t=e.errors[c.currentInputRef])||void 0===t?void 0:t.message:""})),isFileAvailable:(0,m.Fl)((()=>{const e=w[g][c.inputDetails.ref];return""!==e.cached||""!==e.stored||""!==e.filenamePWA})),isPWA:(0,m.Fl)((()=>n.isPWA))};(0,a.bv)((()=>{t.emit("question-mounted")}));const _={modalPlayAudio:{},modalAudioRecord:{}},f=u.entryService.entry.projectRef,w=u.entryService.entry.media,g=o.isBranch?o.branchEntryService.entry.entryUuid:u.entryService.entry.entryUuid;w[g]=w[g]||{},Object.prototype.hasOwnProperty.call(w[g],c.inputDetails.ref)?n.isPWA&&(""!==w[g][c.inputDetails.ref].filenamePWA.cached?(c.answer.answer=w[g][c.inputDetails.ref].filenamePWA.cached,c.pwaFileState=l.PWA_FILE_STATE.CACHED):""!==w[g][c.inputDetails.ref].filenamePWA.stored&&(c.answer.answer=w[g][c.inputDetails.ref].filenamePWA.stored,c.pwaFileState=l.PWA_FILE_STATE.STORED)):(w[g][c.inputDetails.ref]={},w[g][c.inputDetails.ref].cached="",w[g][c.inputDetails.ref].stored="",w[g][c.inputDetails.ref].type=c.inputDetails.type,n.isPWA&&(w[g][c.inputDetails.ref].filenamePWA={},w[g][c.inputDetails.ref].filenamePWA.cached="",w[g][c.inputDetails.ref].filenamePWA.stored=""));const h={async openPopover(e){const t=w[g][c.inputDetails.ref];if(n.isPWA){if(""===t.filenamePWA.cached&&""===t.filenamePWA.stored)return!1}else if(""===t.cached&&""===t.stored)return!1;_e({media:w,entryUuid:g,state:c,e:e,mediaType:l.QUESTION_TYPES.AUDIO})},record(){n.device.platform!==l.WEB&&(n.device.platform===l.ANDROID?cordova.plugins.diagnostic.requestRuntimePermission((e=>{e===cordova.plugins.diagnostic.runtimePermissionStatus.GRANTED?E():O.showAlert(b[r].labels.missing_permission,b[r].labels.warning)}),(function(e){}),cordova.plugins.diagnostic.runtimePermission.RECORD_AUDIO):window.cordova.plugins.diagnostic.requestMicrophoneAuthorization((function(e){"authorized"===e||1===e?E():O.showAlert(b[r].labels.missing_permission,b[r].labels.warning)}),(function(e){})))},async play(){return _.ModalAudioPlay=await i.modalController.create({cssClass:"modal-audio-play",component:Q,showBackdrop:!0,backdropDismiss:!1,componentProps:{projectRef:f,inputRef:c.inputDetails.ref,entryUuid:g,media:w}}),_.ModalAudioPlay.onDidDismiss().then((()=>{n.isAudioModalActive=!1})),n.isAudioModalActive=!0,_.ModalAudioPlay.present()},onFileLoadedPWA(e){c.answer.answer=e},onFileDroppedPWA(e){w[g][c.inputDetails.ref].filenamePWA.cached=e,c.pwaFileState=l.PWA_FILE_STATE.CACHED,c.answer.answer=e},onFileErrorPWA(e){c.fileError=e}};async function E(){return _.modalAudioRecord=await i.modalController.create({cssClass:"modal-audio-record",component:se,showBackdrop:!0,backdropDismiss:!1,componentProps:{inputRef:c.inputDetails.ref,entryUuid:g,media:w}}),_.modalAudioRecord.onDidDismiss().then((e=>{const t=e.data;c.answer.answer=t,w[g][c.inputDetails.ref].cached=t,n.isAudioModalActive=!1})),n.isAudioModalActive=!0,_.modalAudioRecord.present()}return{labels:s,state:c,entryUuid:g,...d,...h,...e,mic:T.ymr,playSharp:T.IoO}}};var We=(0,f.Z)(Ue,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-action"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("dropzone"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-button"),m=(0,a.up)("grid-question-narrow"),_=(0,a.up)("ion-card-content"),f=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(f,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{disabled:!e.isFileAvailable,action:"media",questionText:r.state.question,answer:r.state.answer.answer,onOnLabelButtonClick:e.openPopover},null,8,["disabled","questionText","answer","onOnLabelButtonClick"])])),_:1})])),_:1}),(0,a.Wm)(_,{class:(0,h.C_)(["ion-text-center",{"ion-margin":n.isGroupInput}])},{default:(0,a.w5)((()=>[e.isPWA?((0,a.wg)(),(0,a.j4)(c,{filestate:r.state.pwaFileState,filename:r.state.answer.answer,fileError:r.state.fileError,key:r.state.answer.answer,type:r.state.inputDetails.type,inputRef:r.state.inputDetails.ref,uuid:r.entryUuid,onFileLoaded:e.onFileLoadedPWA,onFileDropped:e.onFileDroppedPWA,onFileError:e.onFileErrorPWA},null,8,["filestate","filename","fileError","type","inputRef","uuid","onFileLoaded","onFileDropped","onFileError"])):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:1},{content:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.record())},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start",icon:r.mic},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.record),1)])),_:1})])),_:1})),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:2},{content:(0,a.w5)((()=>[(0,a.Wm)(p,{disabled:!e.isFileAvailable,class:"question-action-button",color:"secondary",expand:"block",onClick:t[1]||(t[1]=t=>e.play())},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start",icon:r.playSharp},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.play),1)])),_:1},8,["disabled"])])),_:1}))])),_:1},8,["class"])])),_:1},8,["class"])}]]);const Ne={key:0,class:"question-required"},Ce={key:1,class:"question-error"},je={class:"ion-margin-top"},Le=["value"],Fe={key:0,class:"question-error"};var qe={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),i=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},fileSource:"",isScanningBarcode:!1});ke.setUpInputParams(i,e.inputRef,o),(0,a.bv)((async()=>{t.emit("question-mounted")}));const u={hasPattern:(0,m.Fl)((()=>""!==i.pattern&&null!==i.pattern)),hasError:(0,m.Fl)((()=>ne.hasQuestionError(i))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(i.error.errors).length>0?null===(e=i.error)||void 0===e||null===(t=e.errors[i.currentInputRef])||void 0===t?void 0:t.message:""})),isPWA:(0,m.Fl)((()=>n.isPWA))},c={onInputValueChange(e){const t=e.target.value;i.answer.answer=ne.getSanitisedAnswer(t)},async scan(){await O.showProgressDialog(b[r].labels.preparing_scanner,b[r].labels.wait),O.hideProgressDialog(),O.startForegroundService(),n.device.platform===l.ANDROID?cordova.plugins.diagnostic.requestRuntimePermission((function(e){cordova.plugins.diagnostic.runtimePermissionStatus.GRANTED===e?ne.triggerBarcode().then((function(e){O.stopForegroundService(),e.cancelled||(i.answer.answer=ne.getSanitisedAnswer(e.text))}),(function(e){O.stopForegroundService(),null!==e&&O.showAlert(b[r].labels.failed_because+e)})):(O.showAlert(b[r].labels.missing_permission,b[r].labels.warning),O.stopForegroundService())}),(function(e){O.stopForegroundService()}),cordova.plugins.diagnostic.runtimePermission.CAMERA):cordova.plugins.diagnostic.isCameraAuthorized((function(e){e?ne.triggerBarcode().then((function(e){e.cancelled||(i.answer.answer=ne.getSanitisedAnswer(e.text))}),(function(e){O.showAlert(b[r].labels.failed_because+e)})):cordova.plugins.diagnostic.requestCameraAuthorization((function(e){e?ne.triggerBarcode().then((function(e){e.cancelled||(i.answer.answer=ne.getSanitisedAnswer(e.text))}),(function(e){O.showAlert(b[r].labels.failed_because+e)})):O.showAlert(b[r].labels.missing_permission,b[r].labels.warning)}),(function(){O.showAlert(b[r].labels.missing_permission,b[r].labels.warning)}))}),(function(e){}))}};return{labels:s,state:i,...u,...c,...e,scanSharp:T.uYt}}};var xe=(0,f.Z)(qe,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-subtitle"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("ion-icon"),d=(0,a.up)("ion-button"),p=(0,a.up)("ion-col"),m=(0,a.up)("ion-row"),_=(0,a.up)("ion-grid"),f=(0,a.up)("ion-card-content"),w=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(w,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.question),1)])),_:1}),e.hasPattern?((0,a.wg)(),(0,a.j4)(l,{key:0,class:"question-properties ion-text-right ion-padding"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.pattern)+": ",1),(0,a._)("span",null,"  "+(0,h.zw)(r.state.pattern),1)])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(f,{class:(0,h.C_)(["ion-text-center",{"ion-margin":n.isGroupInput}])},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",Ne,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),e.hasError?((0,a.wg)(),(0,a.iD)("div",Ce,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(_,{key:2,class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.scan())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start",icon:r.scanSharp},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.scan),1)])),_:1})])),_:1})])),_:1})])),_:1})),(0,a.Wm)(_,{class:(0,h.C_)(["ion-no-padding",{"pwa-margin-fix":e.isPWA}])},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{"size-xs":"12","offset-xs":"0","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a._)("div",je,[(0,a._)("input",{type:"text",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),value:r.state.answer.answer,onInput:t[1]||(t[1]=t=>e.onInputValueChange(t))},null,42,Le),e.hasError?((0,a.wg)(),(0,a.iD)("div",Fe,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])])),_:1})])),_:1})])),_:1},8,["class"])])),_:1},8,["class"])])),_:1},8,["class"])}]]);const Me={key:1,class:"list-entries-branch"},ze={key:1,class:"list-entries-branch"},Be={class:"text-left collected-on"};var Ge=n(8582);async function Ye(e){const t=p(),{inputRef:n,uuid:r,entriesOffset:s,filters:o}=e,a=[],i=[];let u=!1;if(t.isPWA){let e=[];return Object.prototype.hasOwnProperty.call(t.queueTempBranchEntriesPWA,n)&&(e=t.queueTempBranchEntriesPWA[n].slice(s,s+l.ENTRIES_PER_PAGE)),{branchEntries:e,hasUnsavedBranches:u}}{const e=await I.selectBranchesForQuestion(r,n,l.ENTRIES_PER_PAGE,s,o,o.status);if(e.rows.length>0)for(let t=0;t<e.rows.length;t++){const n=e.rows.item(t).entry_uuid;1===e.rows.item(t).temp&&(u=!0),i.indexOf(n)<0&&(a.push({title:e.rows.item(t).title,entry_uuid:n,synced:e.rows.item(t).synced,created_at:e.rows.item(t).created_at}),i.push(n))}const t=await I.selectEntryMediaErrors(i);if(a.length>0)for(let e=0;e<t.rows.length;e++){const n=t.rows.item(e).entry_uuid;for(let e=0;e<a.length;e++)a[e].entry_uuid===n&&(a[e].hasMediaError=!0)}return{branchEntries:a,hasUnsavedBranches:u}}}const He={class:"center-item-content-wrapper half-padding"},Ve=["min","max"],Qe=["min","max"],Ze=(0,a._)("div",{class:"line-divider"},null,-1);var Je={props:{countNoFilters:{type:Number,required:!0},countWithFilters:{type:Number,required:!0},filters:{type:Object,required:!0},ownerInputRef:{type:String,required:!0},ownerEntryUuid:{type:String,required:!0}},setup(e){const t=p().language,n=b[t].labels,{ownerInputRef:r,ownerEntryUuid:s}=(0,m.OT)(e);let o;const a=(0,m.qj)({isFetching:!1,count:e.countWithFilters,filters:e.filters,searchbarInitialValue:e.filters.title});function u(e){const{filters:t,ownerInputRef:n,ownerEntryUuid:r}=e;return new Promise((e=>{let s={total:0,newest:(new Date).toISOString().split("T")[0],oldest:(new Date).toISOString().split("T")[0]};(async()=>{const o=await I.countBranchesForQuestion(r,n,t,t.status);o.rows.length>0&&o.rows.item(0).total>0&&(s={total:o.rows.item(0).total,oldest:o.rows.item(0).oldest.split("T")[0],newest:o.rows.item(0).newest.split("T")[0]}),e(s)})()}))}const c={countNoFilters:(0,m.Fl)((()=>e.countNoFilters)),countWithFilters:(0,m.Fl)((()=>a.count))},d={dismiss(){i.modalController.dismiss({filters:a.filters,count:a.count})},filterByTitle(e){const t=e.target.value;a.isFetching=!0,clearTimeout(o),o=window.setTimeout((async()=>{a.filters.title=t;const e=await u({ownerEntryUuid:s,ownerInputRef:r,filters:a.filters});a.count=e.total,a.filters.oldest=e.oldest,a.filters.newest=e.newest,a.isFetching=!1}),l.DELAY_LONG)},async filterByStatus(e){const t=e.target.value;a.isFetching=!0,a.filters.status=t,setTimeout((async()=>{const e=await u({ownerEntryUuid:s,ownerInputRef:r,filters:a.filters});a.count=e.total,a.filters.oldest=e.oldest,a.filters.newest=e.newest,a.isFetching=!1}),l.DELAY_LONG)},resetFilters(){a.isFetching=!0,a.filters={...l.FILTERS_DEFAULT},setTimeout((async()=>{const e=await u({ownerEntryUuid:s,ownerInputRef:r,filters:a.filters});a.count=e.total,a.filters.oldest=e.oldest,a.filters.newest=e.newest,a.filters.from=e.oldest,a.filters.to=e.newest,a.isFetching=!1}),l.DELAY_LONG)},filterByDate(){a.isFetching=!0,setTimeout((async()=>{const e=await u({ownerEntryUuid:s,ownerInputRef:r,filters:a.filters});a.count=e.total,a.filters.oldest=e.oldest,a.filters.newest=e.newest,a.isFetching=!1}),l.DELAY_LONG)}};return{labels:n,state:a,PARAMETERS:l,...c,...d,closeOutline:T.fID,filter:T.hXT,cloud:T.pzc,removeCircle:T.Dhl,cloudOutline:T.EIt}}};var Xe=(0,f.Z)(Je,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-header"),m=(0,a.up)("ion-spinner"),_=(0,a.up)("ion-item"),f=(0,a.up)("ion-searchbar"),w=(0,a.up)("ion-label"),g=(0,a.up)("ion-title"),E=(0,a.up)("ion-segment-button"),y=(0,a.up)("ion-segment"),A=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:s.state.isFetching,class:"button-close",onClick:t[0]||(t[0]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:s.closeOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.close),1)])),_:1},8,["disabled"])])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:s.state.isFetching,class:"button-close",onClick:t[1]||(t[1]=t=>e.resetFilters())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:s.filter},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.reset),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(A,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{lines:"none",class:"filter-by-title"},{default:(0,a.w5)((()=>[(0,a._)("div",He,[s.state.isFetching?((0,a.wg)(),(0,a.j4)(m,{key:0,name:"crescent",class:"spinner-filter"})):((0,a.wg)(),(0,a.j4)(u,{key:1,color:"secondary",size:"default",expand:"block",class:"animate__animated animate__fadeIn",onClick:t[2]||(t[2]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.show)+" "+(0,h.zw)(s.state.count)+" "+(0,h.zw)(s.labels.entries),1)])),_:1}))])])),_:1}),(0,a.Wm)(_,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{animated:"",debounce:"500",placeholder:s.labels.filter_by_title,onIonChange:e.filterByTitle,value:s.state.searchbarInitialValue},null,8,["placeholder","onIonChange","value"])])),_:1}),(0,a.Wm)(d,{class:"filter-by-date-from"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"ion-text-end"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.from),1)])),_:1}),(0,a.wy)((0,a._)("input",{type:"date",min:s.state.filters.oldest,max:s.state.filters.newest,"onUpdate:modelValue":t[3]||(t[3]=e=>s.state.filters.from=e),onChange:t[4]||(t[4]=t=>e.filterByDate())},null,40,Ve),[[r.nr,s.state.filters.from]])])])),_:1})])),_:1}),(0,a.Wm)(d,{class:"filter-by-date-to"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"ion-text-end"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.to),1)])),_:1}),(0,a.wy)((0,a._)("input",{type:"date",min:s.state.filters.oldest,max:s.state.filters.newest,"onUpdate:modelValue":t[5]||(t[5]=e=>s.state.filters.to=e),onChange:t[6]||(t[6]=t=>e.filterByDate())},null,40,Qe),[[r.nr,s.state.filters.to]])])])),_:1})])),_:1}),Ze,(0,a.Wm)(_,{lines:"none",class:"filter-by-status"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{onIonChange:t[7]||(t[7]=t=>e.filterByStatus(t)),color:"tertiary",value:s.state.filters.status},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{value:s.PARAMETERS.STATUS.ALL,layout:"icon-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.cloudOutline},null,8,["icon"]),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.all),1)])),_:1})])),_:1},8,["value"]),(0,a.Wm)(E,{value:s.PARAMETERS.STATUS.INCOMPLETE,layout:"icon-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.removeCircle,class:"entry-incomplete"},null,8,["icon"]),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.incomplete),1)])),_:1})])),_:1},8,["value"]),(0,a.Wm)(E,{value:s.PARAMETERS.STATUS.ERROR,layout:"icon-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.cloud,class:"entry-sync-error"},null,8,["icon"]),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.error),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["value"])])),_:1})])),_:1})],64)}]]);const Ke={key:0,slot:"end",class:"filters-count ion-text-uppercase ion-padding-end"},$e={key:1,slot:"end",class:"filters-count ion-text-uppercase ion-padding-end"};var et={emit:["filters-clear"],props:{countNoFilters:{type:Number,required:!0},countWithFilters:{type:Number,required:!0}},setup(e,t){const n=p().language;return{labels:b[n].labels,...e,...{filtersClear(){t.emit("filters-clear")}},close:T.xvD}}};var tt=(0,f.Z)(et,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-item-divider");return(0,a.wg)(),(0,a.j4)(c,{sticky:"",class:"list-entries-filters"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{class:"filters-clear",fill:"clear",color:"primary",onClick:t[0]||(t[0]=t=>e.filtersClear())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.clear_filters)+" ",1),(0,a.Wm)(l,{icon:s.close},null,8,["icon"])])),_:1},512),[[r.F8,n.countWithFilters!==n.countNoFilters]]),n.countWithFilters!==n.countNoFilters?((0,a.wg)(),(0,a.iD)("div",Ke,[(0,a.Uk)((0,h.zw)(s.labels.entries)+" ",1),(0,a._)("span",null,(0,h.zw)(n.countWithFilters)+"/"+(0,h.zw)(n.countNoFilters),1)])):((0,a.wg)(),(0,a.iD)("div",$e,[(0,a.Uk)((0,h.zw)(s.labels.entries)+" ",1),(0,a._)("span",null,(0,h.zw)(n.countNoFilters),1)]))])),_:1})}]]);var nt={props:{entry:{type:Object,required:!0}},setup(e){return{...e,bug:T.jIG,cloudOutline:T.EIt,removeCircle:T.Dhl,cloud:T.pzc,cloudDone:T.Hfv,desktopOutline:T.xWY}}};var rt=(0,f.Z)(nt,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon");return(0,a.wg)(),(0,a.iD)(a.HY,null,[1===n.entry.is_remote?((0,a.wg)(),(0,a.j4)(i,{key:0,icon:r.desktopOutline,class:"entry-not-synced"},null,8,["icon"])):(0,a.kq)("",!0),0===n.entry.synced?((0,a.wg)(),(0,a.j4)(i,{key:1,slot:"start",icon:r.cloudOutline,class:"entry-not-synced"},null,8,["icon"])):(0,a.kq)("",!0),1===n.entry.synced?((0,a.wg)(),(0,a.j4)(i,{key:2,icon:r.cloudDone,class:"entry-synced"},null,8,["icon"])):(0,a.kq)("",!0),-1===n.entry.synced?((0,a.wg)(),(0,a.j4)(i,{key:3,icon:r.cloud,class:"entry-sync-error"},null,8,["icon"])):(0,a.kq)("",!0),2===n.entry.synced?((0,a.wg)(),(0,a.j4)(i,{key:4,icon:r.removeCircle,class:"entry-incomplete"},null,8,["icon"])):(0,a.kq)("",!0),3===n.entry.synced?((0,a.wg)(),(0,a.j4)(i,{key:5,icon:r.cloudOutline,class:"entry-not-synced"},null,8,["icon"])):(0,a.kq)("",!0),n.entry.hasMediaError?((0,a.wg)(),(0,a.j4)(i,{key:6,icon:r.bug,class:"entry-sync-error"},null,8,["icon"])):(0,a.kq)("",!0)],64)}]]);const st={async insertRows(e,t){const n=R();return new Promise(((r,s)=>{function o(e,t){s(t)}n.db.transaction((function(n){n.executeSql(e,t,(function(e,t){r(t)}),o)}),o)}))},async insertProject(e,t,n,r,s,o,a){const i=[e,t,n,r,s,o,a];return await this.insertRows("INSERT INTO projects (slug, name, project_ref, json_extra, server_url, last_updated, mapping) VALUES (?,?,?,?,?,?,?)",i)},async insertUser(e,t,n){const r=[e,t,n];return await this.insertRows("INSERT INTO users (jwt, name, email) VALUES (?,?,?)",r)},async insertEntry(e,t){let n=[],r="";return r+="INSERT OR REPLACE INTO entries (",r+="entry_uuid, ",r+="parent_entry_uuid, ",r+="project_ref, ",r+="form_ref, ",r+="parent_form_ref, ",r+="answers, ",r+="synced, ",r+="synced_error, ",r+="can_edit, ",r+="is_remote, ",r+="created_at, ",r+="updated_at, ",r+="title) ",r+="VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)",n=[e.entryUuid,e.parentEntryUuid,e.projectRef,e.formRef,e.parentFormRef,JSON.stringify(e.answers),t,"",e.canEdit,e.isRemote?e.isRemote:0,e.createdAt?e.createdAt:ne.getISODateTime(),e.updatedAt?e.updatedAt:ne.getISODateTime(),""!==e.title?e.title.trim():e.entryUuid],await this.insertRows("INSERT OR REPLACE INTO entries (entry_uuid, parent_entry_uuid, project_ref, form_ref, parent_form_ref, answers, synced, synced_error, can_edit, is_remote, created_at, updated_at, title) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)",n)},async insertMedia(e,t,n){const r=R();let s="";s+="INSERT OR REPLACE INTO media (",s+="entry_uuid, ",s+="branch_entry_uuid, ",s+="input_ref, ",s+="project_ref, ",s+="form_ref, ",s+="file_name, ",s+="file_path, ",s+="file_type, ",s+="synced,",s+="synced_error) ",s+="VALUES (?,?,?,?,?,?,?,?,?,?)";let o="SELECT id, COUNT(id) as count FROM media ";o+="WHERE project_ref=? ",o+="AND entry_uuid=? ",o+="AND file_name=? ";return new Promise(((s,o)=>{const a=p();r.db.transaction((function(r){t.forEach((t=>{const i=""===t.stored?t.cached:t.stored,l=a.persistentDir+ne.getFilePath(t.type);r.executeSql("SELECT id, COUNT(id) as count FROM media WHERE project_ref=? AND entry_uuid=? AND file_name=? ",[e.projectRef,e.entryUuid,i],(function(r,a){0===a.rows.item(0).count?r.executeSql("INSERT OR REPLACE INTO media (entry_uuid, branch_entry_uuid, input_ref, project_ref, form_ref, file_name, file_path, file_type, synced,synced_error) VALUES (?,?,?,?,?,?,?,?,?,?)",[e.entryUuid,t.entry_uuid!==e.entryUuid?t.entry_uuid:"",t.input_ref,e.projectRef,e.formRef,i,l,t.type,n,""],(function(e,t){s(t)}),(function(e,t){o(t)})):r.executeSql("UPDATE media SET synced=?, synced_error=? WHERE file_name = ?",[0,"",i],(function(e,t){s(t)}),(function(e,t){o(t)}))}),(function(e,t){o(t)}))}))}),(function(e){o(e)}),(function(e){s(e)}))}))},async moveBranchEntries(){let e="";return e+="INSERT OR REPLACE INTO branch_entries (",e+="entry_uuid, ",e+="owner_entry_uuid, ",e+="owner_input_ref, ",e+="project_ref, ",e+="form_ref, ",e+="answers, ",e+="synced, ",e+="synced_error, ",e+="can_edit, ",e+="is_remote, ",e+="created_at, ",e+="updated_at, ",e+="title) ",e+="SELECT ",e+="entry_uuid, ",e+="owner_entry_uuid, ",e+="owner_input_ref, ",e+="project_ref, ",e+="form_ref, ",e+="answers, ",e+="synced, ",e+="synced_error, ",e+="can_edit, ",e+="is_remote, ",e+="created_at, ",e+="updated_at, ",e+="title ",e+="FROM temp_branch_entries",new Promise(((t,n)=>{this.insertRows(e,[]).then((()=>{e="DELETE FROM temp_branch_entries",this.insertRows(e,[]).then((e=>{t(e)}))}))}))},async insertTempBranchEntry(e,t){let n=[],r="";return r+="INSERT OR REPLACE INTO temp_branch_entries (",r+="entry_uuid, ",r+="owner_entry_uuid, ",r+="owner_input_ref, ",r+="project_ref, ",r+="form_ref, ",r+="answers, ",r+="synced, ",r+="synced_error, ",r+="can_edit, ",r+="is_remote, ",r+="created_at, ",r+="updated_at, ",r+="title) ",r+="VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)",n=[e.entryUuid,e.ownerEntryUuid,e.ownerInputRef,e.projectRef,e.formRef,JSON.stringify(e.answers),t,"",1,0,e.createdAt?e.createdAt:ne.getISODateTime(),ne.getISODateTime(),""!==e.title?e.title.trim():e.entryUuid],await this.insertRows("INSERT OR REPLACE INTO temp_branch_entries (entry_uuid, owner_entry_uuid, owner_input_ref, project_ref, form_ref, answers, synced, synced_error, can_edit, is_remote, created_at, updated_at, title) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)",n)},async insertUniqueAnswers(e,t){const n=R();let r="";return r+="INSERT OR REPLACE INTO "+(t?"temp_unique_answers":"unique_answers")+" (",r+="project_ref, ",r+="form_ref, ",r+="entry_uuid, ",r+="input_ref, ",r+="parent_entry_uuid, ",r+="owner_entry_uuid, ",r+="answer )",r+="VALUES (?,?,?,?,?,?,?)",new Promise(((t,s)=>{n.db.transaction((n=>{for(const[o,a]of Object.entries(e.uniqueAnswers))n.executeSql(r,[e.projectRef,e.formRef,e.entryUuid,o,e.parentEntryUuid,e.ownerEntryUuid,a],((e,n)=>{t(n)}),((e,t)=>{s(t)}))}),(e=>{s(e)}),(e=>{t(e)}))}))},async moveUniqueAnswers(){let e="";return e+="INSERT OR REPLACE INTO unique_answers (",e+="project_ref, ",e+="form_ref, ",e+="entry_uuid, ",e+="input_ref, ",e+="parent_entry_uuid, ",e+="owner_entry_uuid, ",e+="answer) ",e+="SELECT ",e+="project_ref, ",e+="form_ref, ",e+="entry_uuid, ",e+="input_ref, ",e+="parent_entry_uuid, ",e+="owner_entry_uuid, answer ",e+="FROM temp_unique_answers",new Promise((t=>{this.insertRows(e,[]).then((()=>{e="DELETE FROM temp_unique_answers",this.insertRows(e,[]).then((e=>{t(e)}))}))}))},async insertSetting(e,t){const n=[e,t];return await this.insertRows("INSERT OR REPLACE INTO settings (field, value) VALUES (?,?)",n)},async insertBookmark(e,t,n,r,s){s||(s="");const o=[e,t,s,n,r];return await this.insertRows("INSERT OR REPLACE INTO bookmarks (project_ref, form_ref, parent_entry_uuid, title, bookmark) VALUES (?,?,?,?,?)",o)}},ot={async deleteRowsFromMultipleTables(e,t,n){const r=R();return new Promise(((e,s)=>{function o(e,t){s(t)}r.db.transaction((function(r){n.forEach((n=>{const s=[];let a="DELETE FROM "+n;null!==t.project_ref?(a+=" WHERE project_ref=?",s.push(t.project_ref),null!==t.entry_uuid&&(a+=" AND entry_uuid=?",s.push(t.entry_uuid)),null!==t.form_ref&&(a+=" AND form_ref=?",s.push(t.form_ref))):null!==t.entry_uuid&&(a+=" WHERE entry_uuid=?",s.push(t.entry_uuid)),r.executeSql(a,s,((t,n)=>{e(n)}),o)}))}),o)}))},async deleteRows(e,t){const n=R();return new Promise(((r,s)=>{function o(e,t){s(t)}n.db.transaction((n=>{n.executeSql(e,t,((e,t)=>{r(t)}),o)}),o)}))},async deleteProject(e){const t={project_ref:e,form_ref:null,entry_uuid:null};return await this.deleteRowsFromMultipleTables("",t,["projects","entries","branch_entries","temp_branch_entries","temp_unique_answers","unique_answers","media","bookmarks"])},async deleteEntries(e){const t={project_ref:e,form_ref:null,entry_uuid:null};return await this.deleteRowsFromMultipleTables("",t,["entries","branch_entries","temp_branch_entries","unique_answers","media","bookmarks"])},async deleteFormEntries(e,t){const n=["entries","branch_entries","temp_branch_entries","unique_answers","media","bookmarks"],r={project_ref:e,entry_uuid:null,form_ref:null};return new Promise((function(e,s){0===t.length?e():function s(o){o?(r.form_ref=o,this.deleteRowsFromMultipleTables("",r,n).then((()=>{s(t.pop())}))):e()}(t.pop())}))},async deleteSyncedEntries(e){},async deleteEntry(e){const t=R();let n="";const r={entries:["entry_uuid=?",[e]],branch_entries:["owner_entry_uuid=?",[e]],unique_answers:["entry_uuid=? OR owner_entry_uuid=?",[e,e]],bookmarks:["parent_entry_uuid=?",[e]]};return new Promise(((e,s)=>{t.db.transaction((t=>{for(const[o,a]of Object.entries(r))n="DELETE FROM "+o+" WHERE "+a[0],t.executeSql(n,a[1],((t,n)=>{e(n)}),((e,t)=>{s(t)}))}),(e=>{s(e)}))}))},async deleteBranchEntry(e){const t={project_ref:null,form_ref:null,entry_uuid:e};return await this.deleteRowsFromMultipleTables("",t,["branch_entries","temp_branch_entries","unique_answers","temp_unique_answers"])},async deleteToken(){return await this.deleteRows("DELETE FROM users",[])},async removeUniqueAnswers(e){const t=R();return new Promise(((n,r)=>{t.db.transaction((t=>{const s=[];let o="";for(let t=0;t<e.rows.length;t++)s.push(e.rows.item(t).entry_uuid);0===s.length&&n(),o="DELETE FROM unique_answers WHERE entry_uuid IN (",s.forEach(((e,t)=>{t===s.length-1?o+=" ? )":o+=" ?,"})),t.executeSql(o,s,((e,t)=>{n(t)}),((e,t)=>{r(t)}))}),(e=>{r(e)}))}))},async deleteTempBranchEntries(){return await this.deleteRows("DELETE FROM temp_branch_entries",[])},async deleteTempUniqueAnswers(){return await this.deleteRows("DELETE FROM temp_unique_answers",[])},async deleteBookmark(e){const t=[e];return await this.deleteRows("DELETE FROM bookmarks WHERE id=?",t)},async deleteEntryMedia(e){const t=[e];return await this.deleteRows("DELETE FROM media WHERE entry_uuid=?",t)},async deleteMediaFile(e,t){const n=[e,t];return await this.deleteRows("DELETE FROM media WHERE entry_uuid=? AND file_name=?",n)},async deleteMediaFiles(e,t){const n="DELETE FROM media WHERE entry_uuid=? AND file_name IN ("+t.join(",")+")",r=[e];return await this.deleteRows(n,r)}},at={updateRows(e,t){const n=R();return new Promise(((r,s)=>{function o(e,t){s(t)}n.db.transaction((function(n){n.executeSql(e,t,(function(e,t){r(t)}),o)}),o)}))},async updateSynced(e,t,n,r){let s="entries";e===l.BRANCH_ENTRY&&(s="branch_entries");let o="UPDATE "+s+" SET synced=?";const a=[n];return r&&(o+=",synced_error=?",a.push(JSON.stringify(r))),o+=" WHERE entry_uuid = ?",a.push(t),await this.updateRows(o,a)},async updateEntrySynced(e,t,n){let r="UPDATE entries SET synced=?";const s=[t];return n&&(r+=",synced_error=?",s.push(JSON.stringify(n))),r+=" WHERE entry_uuid = ?",s.push(e),await this.updateRows(r,s)},async updateBranchEntrySynced(e,t,n){let r="UPDATE branch_entries SET synced=?";const s=[t];return n&&(r+=",synced_error=?",s.push(JSON.stringify(n))),r+=" WHERE entry_uuid = ?",s.push(e),await this.updateRows(r,s)},async updateFileEntrySynced(e,t,n){let r="UPDATE media SET synced=?";const s=[t];return n&&(r+=",synced_error=?",s.push(n)),r+=" WHERE id = ?",s.push(e),await this.updateRows(r,s)},async updateFileEntryIncomplete(e){let t="UPDATE media SET synced=?";const n=[l.SYNCED_CODES.UNSYNCED];return t+=" WHERE entry_uuid=? and synced=?",n.push(e,l.SYNCED_CODES.INCOMPLETE),await this.updateRows("UPDATE media SET synced=? WHERE entry_uuid=? and synced=?",n)},async unsyncAllEntries(e){const t=[0,"",e,l.SYNCED_CODES.INCOMPLETE];return await this.updateRows("UPDATE entries SET synced=?, synced_error=? WHERE project_ref=? AND synced <?",t)},async unsyncAllFileEntries(e){const t=[0,"",e];return await this.updateRows("UPDATE media SET synced=?, synced_error=? WHERE project_ref=?",t)},async unsyncParentEntry(e,t){const n=[l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES,"",e,t,l.SYNCED_CODES.SYNCED];return await this.updateRows("UPDATE entries SET synced=?, synced_error=? WHERE project_ref=? AND entry_uuid=? AND synced =?",n)},async unsyncAllBranchEntries(e){const t=[0,"",e,l.SYNCED_CODES.INCOMPLETE];return await this.updateRows("UPDATE branch_entries SET synced=?, synced_error=? WHERE project_ref=? AND synced <?",t)},async updateProject(e,t,n,r){const s=[t,n,r,e];return await this.updateRows("UPDATE projects SET json_extra=?, mapping=?, last_updated=? WHERE project_ref=?",s)},async updateEntryAnswers(e,t,n){if(e===l.BRANCH_ENTRIES_TABLE)e=l.BRANCH_ENTRIES_TABLE;else e=l.ENTRIES_TABLE;const r="UPDATE "+e+" SET answers=? WHERE id=?",s=[n,t];return await this.updateRows(r,s)}},it={requestLocationPermission(){const e=p(),t=e.language;e.device.platform!==l.WEB&&cordova.plugins.diagnostic.isLocationAuthorized((n=>{n?(e.geolocationPermission=!0,this.startWatching()):cordova.plugins.diagnostic.getLocationAuthorizationStatus((n=>{e.device.platform===l.IOS&&(n===cordova.plugins.diagnostic.permissionStatus.DENIED&&(O.showAlert(b[t].labels.ios_location_permission_denied,b[t].labels.error),e.geolocationPermission=!1),n===cordova.plugins.diagnostic.permissionStatus.RESTRICTED&&(O.showAlert(b[t].labels.ios_location_permission_restricted,b[t].labels.error),e.geolocationPermission=!1)),cordova.plugins.diagnostic.requestLocationAuthorization((n=>{switch(n){case cordova.plugins.diagnostic.permissionStatus.NOT_REQUESTED:break;case cordova.plugins.diagnostic.permissionStatus.GRANTED:e.geolocationPermission=!0,this.startWatching();break;case cordova.plugins.diagnostic.permissionStatus.DENIED:case cordova.plugins.diagnostic.permissionStatus.DENIED_ALWAYS:O.showAlert(b[t].labels.location_service_fail,b[t].labels.error),e.geolocationPermission=!1}}),(function(e){}))}),(function(e){}))}),(function(e){}))},getWatchTimeout(){const e=p();let t=l.GEOLOCATION_TIMEOUT;return e.device.platform!==l.WEB&&(t=e.device.platform===l.IOS?1/0:l.GEOLOCATION_TIMEOUT),t},startWatching(){const e=p(),t=e.language,n=this;async function r(){const r={maximumAge:0,timeout:n.getWatchTimeout(),enableHighAccuracy:!0};function s(r){switch(e.deviceGeolocation={...e.deviceGeolocation,error:r.code},r.code){case 1:e.device.platform===l.IOS&&O.showAlert(b[t].labels.error,b[t].labels.location_service_fail),n.stopWatching(),e.geolocationPermission=!1;break;case 2:n.stopWatching(),e.geolocationPermission=!1;break;case 3:break;default:n.stopWatching(),e.geolocationPermission=!1,O.showAlert(b[t].labels.error,b[t].labels.unknown_error)}}const o=navigator.geolocation.watchPosition((function(t,n){null===t?s(n):e.deviceGeolocation={...e.deviceGeolocation,position:t.coords}}),s,r);e.deviceGeolocation={...e.deviceGeolocation,watchId:o}}e.device.platform!==l.WEB?cordova.plugins.diagnostic.isLocationAvailable((function(n){n?(e.geolocationPermission=!0,r()):(e.geolocationPermission=!1,O.showAlert(b[t].labels.location_not_available,b[t].labels.error))}),(function(n){e.geolocationPermission=!1,O.showAlert(b[t].labels.location_fail,b[t].labels.error)})):(e.geolocationPermission=!0,r())},stopWatching(){const e=p();e.geolocationPermission&&navigator.geolocation.clearWatch(e.deviceGeolocation.watchId)}},lt={validators:{},errors:{},answerTooLong(e,t){const n=l.QUESTION_ANSWER_MAX_LENGTHS[t.toUpperCase()];return!(!n||!e)&&e.toString().length>n},possibleAnswerNotMatched(e,t){let n,r=!0;if(t.possible_answers.length>0)for(n in t.possible_answers)Object.prototype.hasOwnProperty.call(t.possible_answers,n)&&t.possible_answers[n].answer_ref===e&&(r=!1);return r},setValidators(e){this.validators=e},getErrors(){return this.errors},hasErrors(){return Object.keys(this.errors).length>0},resetErrors(){this.errors={}},answerChecks(e){let t=!0;const n=this.validators[e.input_details.type];return n&&(n.errors={},t=n.check(e),t||(this.errors=n.errors)),t},checkRequired(e,t){return!0!==e.is_required||!(""===t||null==t||Array.isArray(t)&&0===t.length)||(this.errors[e.ref]=["ec5_21"],!1)},checkRegex(e,t){if(null!==e.regex&&""!==e.regex){if(!1===new RegExp(e.regex).test(t))return this.errors[e.ref]=["ec5_23"],!1}return!0},checkConfirmed(e,t,n){switch(e.type){case l.QUESTION_TYPES.INTEGER:case l.QUESTION_TYPES.DECIMAL:if(t!=n)return this.errors[e.ref]=["ec5_124"],!1;break;default:if(t!==n)return this.errors[e.ref]=["ec5_124"],!1}return!0},isValidUuid(e){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e)}},ut={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},ct={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return""!==n&&null!==n&&lt.possibleAnswerNotMatched(n,t)?(this.errors[t.ref]=["ec5_25"],!1):!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},dt={errors:{},check(e){const t=e.input_details,n=e.answer.answer;if(""!==n&&null!==n){if(!this.isInteger(n))return this.errors[t.ref]=["ec5_29"],!1;if(this.outOfBounds(n,t))return this.errors[t.ref]=["ec5_28"],!1}return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)},isInteger(e){return/^[-]?[0-9]+$/.test(e)},outOfBounds(e,t){if(!isNaN(e)){if(""!==t.min&&parseInt(e)<parseInt(t.min))return!0;if(""!==t.max&&parseInt(e)>parseInt(t.max))return!0}return!1}},pt={errors:{},check(e){const t=e.input_details,n=e.answer.answer;if(""!==n&&null!==n){if(!this.isDecimal(n))return this.errors[t.ref]=["ec5_29"],!1;if(this.outOfBounds(n,t))return this.errors[t.ref]=["ec5_28"],!1}return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)},isDecimal(e){return/^[-]?[0-9]+\.?[0-9]*$/.test(e)},outOfBounds(e,t){if(!isNaN(e)){if(""!==t.min&&parseFloat(e)<parseFloat(t.min))return!0;if(""!==t.max&&parseFloat(e)>parseFloat(t.max))return!0}return!1}},mt={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return""!==n&&null!==n&&lt.possibleAnswerNotMatched(n,t)?(this.errors[t.ref]=["ec5_25"],!1):!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},_t={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},ft={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},wt={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},gt={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},ht={errors:{},check(e){const t=e.input_details,n=[...e.answer.answer];let r=!0;return n.forEach((e=>{r&&(""!==e&&null!==e&&lt.possibleAnswerNotMatched(e,t)&&(this.errors[t.ref]=["ec5_25"],r=!1),lt.answerTooLong(e,t.type)&&(this.errors[t.ref]=["ec5_214"],r=!1))})),r}},Et={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return!lt.answerTooLong(n,t.type)||(this.errors[t.ref]=["ec5_214"],!1)}},yt={errors:{},check(e){const t=e.input_details,n=e.answer.answer;return Object.prototype.hasOwnProperty.call(n,"latitude")&&Object.prototype.hasOwnProperty.call(n,"longitude")&&Object.prototype.hasOwnProperty.call(n,"accuracy")&&(""===n.latitude||ne.isValidLatitude(n.latitude))&&(""===n.longitude||ne.isValidLongitude(n.longitude))&&(""===n.accuracy||ne.isValidAccuracy(n.accuracy))&&(""===n.latitude||""!==n.longitude&&""!==n.accuracy)&&(""===n.longitude||""!==n.latitude&&""!==n.accuracy)&&(""===n.accuracy||""!==n.latitude&&""!==n.longitude)||(this.errors[t.ref]=["ec5_30"],!1)}},At={errors:{},check(e){const t=e.input_details,n=[...e.answer.answer];let r=!0;return n.length>1?(this.errors[t.ref]=["ec5_340"],!1):(n.forEach((e=>{r&&(""!==e&&null!==e&&lt.possibleAnswerNotMatched(e,t)&&(this.errors[t.ref]=["ec5_25"],r=!1),lt.answerTooLong(e,t.type)&&(this.errors[t.ref]=["ec5_214"],r=!1))})),r)}},St={errors:{},check(e){const t=e.input_details,n=[...e.answer.answer];let r=!0;return n.forEach((e=>{r&&(""!==e&&null!==e&&lt.possibleAnswerNotMatched(e,t)&&(this.errors[t.ref]=["ec5_25"],r=!1),lt.answerTooLong(e,t.type)&&(this.errors[t.ref]=["ec5_214"],r=!1))})),r}},Tt={errors:{},inputRef:"",async validate(e,t){var n;const r=this;lt.setValidators({text:ut,phone:gt,integer:dt,decimal:pt,radio:mt,dropdown:ct,date:_t,time:ft,textarea:wt,checkbox:ht,barcode:Et,searchsingle:At,searchmultiple:St,location:yt}),this.resetErrors();const s=t.answer.answer,o=null===(n=t.confirmAnswer)||void 0===n?void 0:n.answer;return new Promise(((n,a)=>{r.isUnique(e,t.input_details,s).then((function(e){return r.inputRef=t.input_details.ref,e?t.input_details.verify&&null!==s&&null!==o&&!lt.checkConfirmed(t.input_details,s,o)?(r.errors=lt.getErrors(),void a()):lt.checkRequired(t.input_details,s)&&(""===s||null==s||lt.checkRegex(t.input_details,s))&&lt.answerChecks(t)?void n():(r.errors=lt.getErrors(),void a()):(r.errors[r.inputRef]=["ec5_22"],void a())}),(function(e){a(e)}))}))},getErrors(){return this.errors},hasErrors(){return Object.keys(this.errors).length>0},resetErrors(){this.errors={},lt.resetErrors()},isUnique(e,t,n){const r=p();let s=!0;switch(t.type){case l.QUESTION_TYPES.TEXT:case l.QUESTION_TYPES.BARCODE:case l.QUESTION_TYPES.PHONE:case l.QUESTION_TYPES.TEXTAREA:n=n.toLowerCase();break;case l.QUESTION_TYPES.INTEGER:case l.QUESTION_TYPES.DECIMAL:case l.QUESTION_TYPES.DATE:case l.QUESTION_TYPES.TIME:break;default:s=!1}return new Promise((function(o,a){if(s&&"none"!==t.uniqueness&&""!==n)if(r.isPWA){const s=r.routeParams.formRef,i=t.ref,u=B.getLastUpdated(),c=B.getSlug(),d=Ie.makeUniqueEntry(s,e,i,n,u);let p=!1;if(l.BYPASS_UNIQUENESS&&l.IS_LOCALHOST)O.showToast("bypassed uniqueness check!",0,"top"),o(!0);else{if(e.isBranch){(r.queueTempBranchEntriesPWA[e.ownerInputRef]||[]).every((t=>t.branch_entry.answers[i].answer!==n||e.entryUuid===t.id||(o(!1),p=!0,!1)))}p||de.checkUniquenessPWA(c,d).then((e=>{"ec5_249"===e.data.data.code?o(!0):o(!1)}),(e=>{var t,n;"ec5_22"===(null===(t=e.data)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.code)?o(!1):a(e)}))}}else I.isUnique(e,t,n).then((function(e){e.rows.length>0?o(!1):o(!0)}),(function(e){a(e)}));else o(!0)}))}},bt={validateAnswer(e,t){return new Promise(((n,r)=>{this.validateAndRetrieveAnswer(e,t).then((function(e){ve.resetEntryErrors(t.error,e.inputRefs),n()}),(function(e){r({error:e.error,inputRefs:e.inputRefs})}))}))},validateAndRetrieveAnswer(e,t){const n=p().language,r=t.answers,s=t.confirmAnswer,o=t.mainInputDetails;let a;const i=[],u=B.getExtraInputs(),c=[];return new Promise(((t,d)=>{if(o.type===l.QUESTION_TYPES.GROUP){B.getFormGroups(e.formRef)[o.ref].forEach((t=>{const n=u[t].data,o={input_details:n,answer:r[n.ref],confirmAnswer:s?s[n.ref]:{}};i.push(this.validate(e,o)),c.push(n.ref)}))}i.push(this.validate(e,{input_details:o,answer:r[o.ref],confirmAnswer:s?s[o.ref]:{}})),c.push(o.ref),Promise.all(i).then((n=>{for(a=0;a<n.length;a++)this.checkUniqueness(e,n[a].input_details,n[a].answer.answer),e.answers[n[a].input_details.ref]=this.parseAnswer(n[a].answer);t({inputRefs:c})}),(function(e){const t={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){t[r]={message:b[n].status_codes[e[r]]};break}d({error:t,inputRefs:c})}))}))},validate(e,t){return new Promise(((n,r)=>{Tt.validate(e,t).then((function(){n(t)}),(function(e){if(e){const e=t.input_details.ref;Tt.errors[e]=["ec5_104"]}const n=Tt.getErrors();r(n)}))}))},parseAnswerForViewing(e,t){const n=p().language;switch(e.type){case l.QUESTION_TYPES.RADIO:case l.QUESTION_TYPES.DROPDOWN:e.possible_answers.forEach(((n,r)=>{t===n.answer_ref&&(t=e.possible_answers[r].answer)}));break;case l.QUESTION_TYPES.CHECKBOX:case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCH_MULTIPLE:{const n=[];e.possible_answers.forEach(((r,s)=>{t.indexOf(r.answer_ref)>-1&&n.push(e.possible_answers[s].answer)})),t=n.join(", ");break}case l.QUESTION_TYPES.AUDIO:case l.QUESTION_TYPES.PHOTO:case l.QUESTION_TYPES.VIDEO:t=""!==t?b[n].labels.file_available:" ";break;case l.QUESTION_TYPES.TIME:t=t?ne.getUserFormattedTime(t,e.datetime_format):" ";break;case l.QUESTION_TYPES.DATE:t=t?ne.getUserFormattedDate(t,e.datetime_format):" ";break;case l.QUESTION_TYPES.BRANCH:t=t[e.ref]?t[e.ref]+" "+(t[e.ref]>1?b[n].labels.entries:b[n].labels.entry):"0 "+b[n].labels.entries}return t},generateAnswer(e,t){const n=p(),r=B.getExtraInputs(),s=r[t].data;if(e.answers[s.ref]=this.createDefaultAnswer(s),s.type===l.QUESTION_TYPES.GROUP){const t=B.getFormGroups(e.formRef);for(let o=0;o<t[s.ref].length;o++){const a=r[t[s.ref][o]].data;n.isPWA&&e.answers[a.ref]||(e.answers[a.ref]=this.createDefaultAnswer(a))}}},createDefaultAnswer(e){const t={was_jumped:!1};let n,r;switch(e.type){case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCH_MULTIPLE:case l.QUESTION_TYPES.CHECKBOX:if(n=[],""!==e.default)for(r=0;r<e.possible_answers.length;r++)e.default===e.possible_answers[r].answer_ref&&(n=[e.default]);t.answer=n;break;case l.QUESTION_TYPES.RADIO:case l.QUESTION_TYPES.DROPDOWN:if(n="",""!==e.default)for(r=0;r<e.possible_answers.length;r++)e.default===e.possible_answers[r].answer_ref&&(n=e.default);t.answer=n;break;case l.QUESTION_TYPES.LOCATION:t.answer={latitude:"",longitude:"",accuracy:""};break;default:n="",null!==e.default&&""!==e.default&&(n=e.default),t.answer=n}return t},checkUniqueness(e,t,n){"none"!==t.uniqueness&&""!==n&&(e.uniqueAnswers[t.ref]="string"==typeof n?n.toLowerCase():n)},parseAnswer(e){return null!=e&&void 0!==e.answer&&null!==e.answer||(e.answer=""),e.was_jumped=!1,e},getAnswersTitles(e,t,n,r,s){s||(s=this.parseAnswerForViewing);const o=[];let a,i,u,c,d,p,m;const _=function(t){switch(t.type){case l.QUESTION_TYPES.GROUP:for(u=0;u<n[t.ref].length;u++)i=n[t.ref][u],c=r[i].data,_(c);break;case l.QUESTION_TYPES.README:break;case l.QUESTION_TYPES.CHECKBOX:case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCH_MULTIPLE:e.answers[t.ref]&&(a=e.answers[t.ref].answer,t.is_title&&Array.isArray(a)&&0!==a.length&&o.push(s(t,a)));break;default:e.answers[t.ref]&&(a=e.answers[t.ref].answer,t.is_title&&""!==a&&o.push(s(t,a)))}};for(p=0;p<t.length;p++)d=t[p],m=r[d].data,_(m);return o}},Rt={processJumpsNext(e,t,n,r,s){let o=r;return n.jumps.length>0&&(s=this.getNextInputRef(t.answer,n,s),o=this.getInputIndexFromRef(e,s),r<o&&this.jumpQuestions(e,r,o)),{next_input_ref:s,next_input_index:o}},jumpQuestions(e,t,n){let r,s,o,a,i;for(;t<n;t++)if(s=this.getInputRefFromIndex(e,t),r=B.getInput(s),this.setJumped(e,s),r.type===l.QUESTION_TYPES.GROUP)for(a=B.getGroupInputs(e.formRef,s),o=0;o<a.length;o++)i=B.getInput(a[o].ref),this.setJumped(e,i.ref)},setJumped(e,t){void 0===e.answers[t]&&bt.generateAnswer(e,t),e.answers[t].was_jumped=!0},processJumpsPrevious(e,t,n){let r=n[t];for(;!0===e.answers[r].was_jumped;)r=n[t-=1];return{previous_input_ref:r,previous_input_index:t}},getNextInputRef(e,t,n){let r;for(r=0;r<t.jumps.length;r++){const n=t.jumps[r];if(this.shouldJump(n,t,e))return n.to===l.JUMPS.END_OF_FORM?null:n.to}return n},shouldJump(e,t,n){switch(t.type){case l.QUESTION_TYPES.CHECKBOX:case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCH_MULTIPLE:switch(e.when){case l.JUMPS.IS:for(const t of n)if(t===e.answer_ref)return!0;break;case l.JUMPS.IS_NOT:for(const t of n)if(t===e.answer_ref)return!1;return!0;case l.JUMPS.NO_ANSWER_GIVEN:for(const e of n)if(e)return!1;return!0;case l.JUMPS.ALL:return!0}break;default:switch(e.when){case l.JUMPS.IS:if(n===e.answer_ref)return!0;break;case l.JUMPS.IS_NOT:if(n!==e.answer_ref)return!0;break;case l.JUMPS.NO_ANSWER_GIVEN:if(""===n)return!0;break;case l.JUMPS.ALL:return!0}}return!1},getInputIndexFromRef(e,t){return e.isBranch?B.getBranchInputIndexFromRef(e.formRef,e.ownerInputRef,t):B.getInputIndexFromRef(e.formRef,t)},getInputRefFromIndex(e,t){return e.isBranch?B.getBranchInputRefFromIndex(e.formRef,e.ownerInputRef,t):B.getInputRefFromIndex(e.formRef,t)}},It={addDefaultAnswers(e,t){for(let n=0;n<t.length;n++){const r=B.getExtraInputs(),s=r[t[n]].data;if(e.answers[s.ref]=bt.createDefaultAnswer(s),s.type===l.QUESTION_TYPES.GROUP){const t=B.getFormGroups(e.formRef);for(let n=0;n<t[s.ref].length;n++){const o=r[t[s.ref][n]].data;e.answers[o.ref]=bt.createDefaultAnswer(o)}}}},async addFakeAnswers(e,t,n){const r=await Promise.resolve().then((function(){var e=new Error("Cannot find module '@/services/entry/fake-answer-service'");throw e.code="MODULE_NOT_FOUND",e}));return new Promise(((s,o)=>{it.stopWatching(),function o(a){const i=B.getExtraInputs(),u=i[a].data;r.createFakeAnswer(u,e,n).then((function(a){let c,d;function p(a){const l=i[a].data;r.createFakeAnswer(l,e,n).then((function(n){e.answers[l.ref]=n,d.length>0?p(d.shift()):t.length>0?o(t.shift()):s()}))}e.answers[u.ref]=a,u.type===l.QUESTION_TYPES.GROUP?(c=B.getFormGroups(e.formRef),d=c[u.ref].slice(0),p(d.shift())):t.length>0?o(t.shift()):s()}))}(t.shift())}))},getAnswers(e,t){return void 0===e.answers[t]&&bt.generateAnswer(e,t),e.answers},validateAnswer(e,t){return new Promise(((n,r)=>{bt.validateAndRetrieveAnswer(e,t).then((function(e){ve.resetEntryErrors(t.error,e.inputRefs),n()}),(function(e){r({error:e.error,inputRefs:e.inputRefs})}))}))},setEntryTitle(e,t,n,r){let s=[];n.title="",s=r?bt.getAnswersTitles(n,e.branch[n.ownerInputRef],e.group,t):bt.getAnswersTitles(n,e.inputs,e.group,t),0===s.length?n.title=n.entryUuid:n.title=s.join(" ")},processJumpsNext(e,t,n,r,s){const o=r+1,a=s[o]?s[o]:null;return Rt.processJumpsNext(e,t,n,o,a)},processJumpsPrevious(e,t,n){const r=t-1;return Rt.processJumpsPrevious(e,r,n)}};function vt(e,t){let n=!1;if(e.action===l.ENTRY_EDIT&&t.mainInputDetails.jumps.length>0&&void 0!==e.entry.answers[t.mainInputDetails.ref]){const r=e.entry.answers[t.mainInputDetails.ref].answer;switch(t.mainInputDetails.type){case l.QUESTION_TYPES.CHECKBOX:case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCH_MULTIPLE:n=!(t.existingAnswer.length===r.length&&t.existingAnswer.every((e=>r.includes(e))));break;default:n=t.existingAnswer!==r}}return n}const Pt={type:l.ENTRY,allowSave:!0,form:{},entry:{},setUpNew(e,t,n){const r=p();this.action=l.ENTRY_ADD,this.allowSave=!0,this.form=z,this.entry=Oe,this.entry.initialise({entry_uuid:ne.uuid(),parent_entry_uuid:t,form_ref:e,parent_form_ref:n,answers:{},project_ref:B.getProjectRef(),title:"",titles:[],is_remote:0,synced:2,synced_error:"",can_edit:1,created_at:"",unique_answers:{}}),z.initialise(B.getExtraForm(e)),this.formIndex=B.getFormIndex(e),this.formName=z.getName(),this.form.inputs=B.getFormInputs(e),B.hasLocation(e)&&v.dV.isNativePlatform()&&(r.deviceGeolocation={...r.deviceGeolocation,error:null,position:null},it.requestLocationPermission())},setUpExisting(e){const t=this,n=p();return t.form=z,t.entry=Oe,new Promise(((r,s)=>{t.action=l.ENTRY_EDIT,t.allowSave=!0,t.entry=e,z.initialise(B.getExtraForm(t.entry.formRef)),t.formIndex=B.getFormIndex(t.entry.formRef),t.formName=z.getName(),z.inputs=B.getFormInputs(t.entry.formRef),B.hasLocation(t.entry.formRef)&&v.dV.isNativePlatform()&&n.device.platform!==l.WEB&&(n.deviceGeolocation={error:null,position:null,watchId:0},it.requestLocationPermission()),v.dV.isNativePlatform()?Ot.getEntryStoredMedia(t.entry.entryUuid).then((function(e){t.entry.media=e,r()})):(n.isPWA?Ot.getEntryStoredMediaPWA(t.entry.entryUuid).then((function(e){t.entry.media=e,r()})):t.entry.media={},r())}))},saveEntry(e){const t=p(),n=this;return new Promise(((r,s)=>{function o(e){s(e)}1===n.entry.canEdit&&It.setEntryTitle(B.getExtraForm(n.entry.formRef),B.getExtraInputs(),n.entry,!1),t.queueFilesToDelete.forEach((e=>{e.filenameStored===n.entry.answers[e.inputRef].answer&&(n.entry.answers[e.inputRef].answer="")})),this.unsyncParentEntries(B.getProjectRef(),n.entry.parentEntryUuid).then((function(){st.insertEntry(n.entry,e).then((function(t){st.insertUniqueAnswers(n.entry,!1).then((function(){st.moveBranchEntries(n.entry).then((function(t){st.moveUniqueAnswers().then((function(t){Ot.saveMedia(n.entry,e).then((function(){r(t)}),o)}),o)}),o)}),o)}),o)}))}))},saveEntryPWA(){const e=p(),t=this,n=B.getSlug();let r=[];async function s(t){return new Promise((o=>{const a=t.pop();de.uploadEntryPWA(n,a).then((e=>{t.length>0?o(s(t)):o(r)}),(n=>{const i=n.data.errors.map((e=>(e.uuid=a.id,e)));if(r=[...new Set([...r,...i])],t.length>0)o(s(t));else{e.queueBranchUploadErrorsPWA=ne.arrayGroupBy(r,(e=>e.source));const t=B.getExtraInputs();for(const[n,r]of Object.entries(e.queueBranchUploadErrorsPWA))t[n]||e.queueGlobalUploadErrorsPWA.push(...r);o(r)}}))}))}return e.queueBranchUploadErrorsPWA={},e.queueGlobalUploadErrorsPWA=[],new Promise(((r,o)=>{It.setEntryTitle(B.getExtraForm(t.entry.formRef),B.getExtraInputs(),t.entry,!1);const a={entry_uuid:t.entry.entryUuid,parent_entry_uuid:t.entry.parentEntryUuid,answers:JSON.stringify(t.entry.answers),form_ref:t.entry.formRef,parent_form_ref:t.entry.parentFormRef,created_at:ne.getISODateTime(),title:t.entry.title,synced:0,can_edit:1,is_remote:0,last_updated:B.getLastUpdated(),device_id:"",platform:l.WEB,entry_type:l.ENTRY},i=Ie.makeJsonEntry(l.ENTRY,a);de.uploadEntryPWA(n,i).then((async t=>{const n=(0,m.IU)(e.queueTempBranchEntriesPWA);if(Object.keys(n).length>0){const t=[];Object.values(n).forEach((e=>{e.forEach((async e=>{t.push(e)}))}));const a=await s(t);a.length>0?o({data:{errors:a}}):(r(),e.queueTempBranchEntriesPWA={})}else r(t)}),(t=>{if(t.data.errors){const n=B.getExtraInputs();t.data.errors.forEach((t=>{const r=t.source;n[r]||e.queueGlobalUploadErrorsPWA.push(t)}))}o(t)}))}))},getAnswers(e){return It.getAnswers(this.entry,e)},wasJumpEdited(e){return vt(this,e)},validateAnswer(e){return It.validateAnswer(this.entry,e)},processJumpsNext(e,t,n){return It.processJumpsNext(this.entry,e,t,n,this.form.inputs)},processJumpsPrevious(e){return It.processJumpsPrevious(this.entry,e,this.form.inputs)},unsyncParentEntries(e,t){return new Promise((n=>{function r(t){at.unsyncParentEntry(e,t).then((function(){!function(e){I.selectParentEntry(e).then((function(e){e.rows.length>0?r(e.rows.item(0).parent_entry_uuid):n(e)}))}(t)}))}r(t)}))},removeTempBranches(){const e=this,t=p();return new Promise((n=>{t.isPWA?(t.queueTempBranchEntriesPWA={},n()):I.selectTempBranches(e.entry.entryUuid).then((function(e){e.rows.length>0?ot.removeUniqueAnswers(e).then((function(){ot.deleteTempBranchEntries().then((function(){n()}))})):n()}))}))}},Dt={getProtocol(e){let t;return t=e.indexOf("file://")>-1?"":"file://",t},moveVideoToCache(e,t){const n=p();return new Promise(((r,s)=>{let o="";function a(e){s()}o=n.device.platform===l.IOS?this.getProtocol(e):"",window.resolveLocalFileSystemURL(o+e,(function(e){function s(n){e.moveTo(n,t,(function(e){r()}),a)}switch(n.device.platform){case l.ANDROID:window.resolveLocalFileSystemURL(cordova.file.cacheDirectory,s,a);break;case l.IOS:window.resolveLocalFileSystemURL(cordova.file.tempDirectory,s,a)}}),a)}))},moveToAppTemporaryDir(e,t){const n=p();return new Promise(((r,s)=>{function o(e){s()}function a(e){function s(n){e.moveTo(n,t,(function(e){r()}),o)}switch(n.device.platform){case l.ANDROID:window.resolveLocalFileSystemURL(cordova.file.cacheDirectory,s,o);break;case l.IOS:window.resolveLocalFileSystemURL(cordova.file.tempDirectory,s,o)}}n.device.platform===l.ANDROID&&window.resolveLocalFileSystemURL(e,a,o),n.device.platform===l.IOS&&window.resolveLocalFileSystemURL(this.getProtocol(e)+e,a,o)}))},moveToAppPrivateDir(e,t,n,r){const s=p();return new Promise(((o,a)=>{const i=ne.getFilePath(n);function u(e){a()}const c=s.device.platform===l.IOS?this.getProtocol(e):"";window.resolveLocalFileSystemURL(c+e,(function(e){window.resolveLocalFileSystemURL(cordova.file.dataDirectory+i,(function(n){n.getDirectory(r,{create:!0,exclusive:!1},(function(){e.moveTo(n,"/"+r+"/"+t,(function(e){o()}),u)}),u)}),u)}),u)}))},copyDemoProjectLogoToPrivateDir(){const e=p(),t=c.PROJECT_REF,n=l.LOGOS_DIR,r=c.PROJECT_LOGO_STORED_FILENAME,s=c.PROJECT_LOGO_IMG_FILENAME;return new Promise(((o,a)=>{function i(e){a()}function u(e){window.resolveLocalFileSystemURL(cordova.file.dataDirectory+n,(function(n){n.getDirectory(t,{create:!0,exclusive:!1},(function(){e.copyTo(n,t+"/"+r,(function(e){o()}),i)}),i)}),i)}if(e.device.platform!==l.WEB){let t=cordova.file.applicationDirectory+"www/assets/images";const n="";e.device.platform===l.IOS?(t=v.dV.convertFileSrc(t),window.resolveLocalFileSystemURL(t+s,u,i)):window.resolveLocalFileSystemURL(n+t+s,u,i)}else o()}))}},Ot={saveMedia(e,t){const n=p(),r=n.language,s=b[r].labels;return new Promise(((r,o)=>{(async()=>{const a=ne.mapMediaObjectToArray(e.media),i=[...n.queueFilesToDelete];let u;if(n.queueFilesToDelete.length>0){try{await le.removeFiles(i)}catch(e){o(e)}try{const t=n.queueFilesToDelete.map((e=>'"'+e.file_name+'"'));await ot.deleteMediaFiles(e.entryUuid,t),n.queueFilesToDelete=[]}catch(e){o(e.message||s.unknown_error)}}function c(e){o(e)}a.length>0?st.insertMedia(e,a,t).then((function(s){!function s(o){""!==o.cached&&(u=""===o.stored?o.cached:o.stored,Dt.moveToAppPrivateDir(n.tempDir+o.cached,u,o.type,B.getProjectRef()).then((function(){a.length>0?s(a.pop()):t===l.SYNCED_CODES.UNSYNCED?at.updateFileEntryIncomplete(e.entryUuid).then((function(){r()}),c):r()}),c))}(a.pop())}),c):t===l.SYNCED_CODES.UNSYNCED?at.updateFileEntryIncomplete(e.entryUuid).then((function(e){r()}),c):r()})()}))},getEntryStoredMedia(e){return new Promise(((t,n)=>{const r={},s=B.getProjectRef();I.selectEntryMedia(s,e).then((function(e){e.forEach((e=>{const t=e.branch_entry_uuid?e.branch_entry_uuid:e.entry_uuid;r[t]=r[t]||{},r[t][e.input_ref]={},r[t][e.input_ref].cached="",r[t][e.input_ref].stored=e.file_name,r[t][e.input_ref].type=e.file_type})),t(r)}),(function(e){n(e)}))}))},getEntryStoredMediaPWA(e){return new Promise(((t,n)=>{const r=[l.QUESTION_TYPES.PHOTO,l.QUESTION_TYPES.AUDIO,l.QUESTION_TYPES.VIDEO],s={},o=Object.values(B.getExtraInputs()).filter((e=>r.includes(e.data.type))),a=Pt.entry.answers;o.forEach((t=>{var n;const r=t.data.ref,o=(null===(n=a[r])||void 0===n?void 0:n.answer)||"";s[e]=s[e]||{},s[e][t.data.ref]={},s[e][t.data.ref].filenamePWA={},s[e][t.data.ref].filenamePWA.cached="",s[e][t.data.ref].filenamePWA.stored=o})),t(s)}))},getProjectStoredMedia(e){return new Promise(((t,n)=>{I.selectProjectMedia(e).then((function(e){t(e)}),(function(e){n(e)}))}))}},kt={initialise(e){this.entryUuid=e.entry_uuid,this.ownerEntryUuid=e.owner_entry_uuid,this.ownerInputRef=e.owner_input_ref,this.isRemote=e.is_remote,this.synced=e.synced,this.canEdit=e.can_edit,this.createdAt=e.created_at,this.title=e.title?e.title:"",this.formRef=e.form_ref,this.parentFormRef=e.parent_form_ref,this.projectRef=e.project_ref,this.media=e.media?e.media:{},this.uniqueAnswers={},this.syncedError=e.synced_error,this.isBranch=!0;try{this.answers="object"==typeof e.answers?e.answers:JSON.parse(e.answers)}catch(e){this.answers={}}}},Ut={type:l.BRANCH_ENTRY,allowSave:!0,form:{},entry:{},branchInputs:{},setUpNew(e,t,n){this.form=z,this.entry=kt,this.action=l.ENTRY_ADD,this.entry.initialise({entry_uuid:ne.uuid(),owner_entry_uuid:n,owner_input_ref:t,form_ref:e,answers:{},project_ref:B.getProjectRef(),title:"",titles:[],is_remote:0,synced:2,synced_error:"",can_edit:1,created_at:"",unique_answers:{}}),this.branchInputs=B.getBranches(this.entry.formRef,this.entry.ownerInputRef);const r=B.getExtraInputs();this.branchInput=r[this.entry.ownerInputRef].data},setUpExisting(e){p();const t=this;return t.form=z,t.entry=kt,new Promise(((n,r)=>{this.action=l.ENTRY_EDIT,this.entry=e,this.branchInputs=B.getBranches(this.entry.formRef,this.entry.ownerInputRef);const s=B.getExtraInputs();this.branchInput=s[this.entry.ownerInputRef].data,v.dV.isNativePlatform()?Ot.getEntryStoredMedia(t.entry.entryUuid).then((function(e){t.entry.media=e,n()})):(t.entry.media={},n())}))},saveEntry(e){const t=this;return t.form=z,t.entry=kt,new Promise(((n,r)=>{function s(e){r(e)}It.setEntryTitle(B.getExtraForm(t.entry.formRef),B.getExtraInputs(),t.entry,!0),st.insertTempBranchEntry(t.entry,e).then((function(r){st.insertUniqueAnswers(t.entry,!0).then((function(){Ot.saveMedia(t.entry,e).then((function(){n(r)}),s)}),s)}),s)}))},async saveEntryPWA(){const e=p(),t=B.getSlug(),n=this,r=n.entry.ownerInputRef;return new Promise(((s,o)=>{It.setEntryTitle(B.getExtraForm(n.entry.formRef),B.getExtraInputs(),n.entry,!0);const a={entry_uuid:n.entry.entryUuid,parent_entry_uuid:n.entry.parentEntryUuid,answers:JSON.stringify(n.entry.answers),form_ref:n.entry.formRef,parent_form_ref:n.entry.parentFormRef,created_at:ne.getISODateTime(),title:n.entry.title,synced:0,can_edit:1,is_remote:0,last_updated:B.getLastUpdated(),device_id:"",platform:l.WEB,entry_type:l.BRANCH_ENTRY,owner_input_ref:r,owner_entry_uuid:n.entry.ownerEntryUuid};if(Object.keys(e.queueBranchUploadErrorsPWA).length>0)for(const[t,r]of Object.entries(e.queueBranchUploadErrorsPWA))for(let s=0;s<r.length;s++)r[s].uuid===n.entry.entryUuid&&e.queueBranchUploadErrorsPWA[t].splice(s,1);const i=Ie.makeJsonEntry(l.BRANCH_ENTRY,a);if(e.branchEditType===l.PWA_BRANCH_REMOTE)e.queueGlobalUploadErrorsPWA=[],de.uploadEntryPWA(t,i).then((e=>{s(e)}),(e=>{o(e)}));else{if(Object.prototype.hasOwnProperty.call(e.queueTempBranchEntriesPWA,r)||(e.queueTempBranchEntriesPWA[r]=[]),Ut.action===l.ENTRY_EDIT){const t=e.queueTempBranchEntriesPWA[r].findIndex((e=>e.id===n.entry.entryUuid));e.queueTempBranchEntriesPWA[r][t]=i}else e.queueTempBranchEntriesPWA[r].push(i);s()}}))},wasJumpEdited(e){return vt(this,e)},validateAnswer(e){return It.validateAnswer(this.entry,e)},getAnswers(e){return It.getAnswers(this.entry,e)},processJumpsNext(e,t,n){return It.processJumpsNext(this.entry,e,t,n,this.branchInputs)},processJumpsPrevious(e){return It.processJumpsPrevious(this.entry,e,this.branchInputs)},removeTempBranches(){const e=this,t=p();return new Promise((n=>{if(e.action===l.ENTRY_EDIT)return n(),!1;if(t.isPWA)t.queueTempBranchEntriesPWA={},n();else{if(e.type===l.BRANCH_ENTRY)return n(),!1;I.selectTempBranches(e.entry.entryUuid).then((function(e){e.rows.length>0?ot.removeUniqueAnswers(e).then((function(){ot.deleteTempBranchEntries().then((function(){n()}))})):n()}))}}))}};var Wt={components:{QuestionLabelAction:ge,ToolbarEntriesFilters:tt,IconEntry:rt},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},parentEntryName:{type:String,required:!0},currentFormName:{type:String,required:!0}},emits:["question-mounted","save-branch-entry"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(0,D.tv)(),u=(0,D.yj)(),{type:c,inputRef:d}=(0,m.OT)(e),_=(0,a.f3)("entriesAddState"),f=n.entriesAddScope,w=B.getProjectRef(),g=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",answer:[],branchEntries:[],hasUnsavedBranches:!1,isFetching:!0,countNoFilters:0,countWithFilters:0,entriesOffset:0,limit:1/0,filters:{...l.FILTERS_DEFAULT},isInfiniteScrollDisabled:!1}),h={};function E(){let e,t;return new Promise((n=>{(async()=>{const r=f.entryService.entry.entryUuid,s=await I.countBranchesForQuestion(r,d,l.FILTERS_DEFAULT,l.STATUS.ALL);g.countNoFilters=s.rows.item(0).total;const o=await I.countBranchesForQuestion(r,d,g.filters,g.filters.status);o.rows.length>0&&(o.rows.item(0).total>0?(g.countWithFilters=o.rows.item(0).total,e=o.rows.item(0).oldest.split("T")[0],t=o.rows.item(0).newest.split("T")[0],null===g.filters.oldest&&null===g.filters.newest&&(g.filters.oldest=e,g.filters.newest=t,g.filters.from=e,g.filters.to=t)):g.countWithFilters=0),n(o.rows.item(0).total)})()}))}ke.setUpInputParams(g,e.inputRef,_),(0,a.bv)((async()=>{t.emit("question-mounted")}));const y={isOwnerEntryRemote:(0,m.Fl)((()=>f.entryService.entry.isRemote)),isPWAEntryEdit:(0,m.Fl)((()=>f.entryService.action===l.ENTRY_EDIT)),parentEntryName:e.parentEntryName,currentFormName:e.currentFormName,isPWA:(0,m.Fl)((()=>n.isPWA)),hasPWABranchUploadError(e){return Object.values(n.queueBranchUploadErrorsPWA).some((t=>t.some((t=>t.uuid===e))))},pwaEntryEditWarning:(0,m.Fl)((()=>b[r].labels.editing_branches_pwa)),isEntriesLimitReached:(0,m.Fl)((()=>(g.limit=parseInt(B.getEntriesLimit(d),10),null!==g.limit&&g.countNoFilters>=g.limit))),warningEntriesLimitReached:(0,m.Fl)((()=>b[r].status_codes.ec5_250.split(".")[0]))},A={addBranch(){Ut.setUpNew(f.entryService.entry.formRef,_.questionParams.currentInputRef,f.entryService.entry.entryUuid),n.routeParams={projectRef:w,formRef:f.entryService.entry.formRef,inputRef:"",inputIndex:0,isBranch:!0,error:{}},o.replace({name:l.ROUTES.ENTRIES_BRANCH_ADD})},utcToLocal(e){return(0,Ge.Z)(new Date(e),"dd MMM, yyyy @ h:mma")},saveBranchEntry(){t.emit("save-branch-entry")},viewBranch(e){n.routeParams={projectRef:w,formRef:f.entryService.entry.formRef,ownerInputRef:d,ownerEntryUuid:f.entryService.entry.entryUuid,entryUuid:e},o.replace({name:l.ROUTES.ENTRIES_VIEW_BRANCH})},async openModalEntriesBranchFilter(){const e=g.countWithFilters,t=g.countNoFilters,n={...g.filters};return h.ModalEntriesBranchFilter=await i.modalController.create({cssClass:"modal-entries-filter",component:Xe,showBackdrop:!0,backdropDismiss:!1,componentProps:{ownerInputRef:d,ownerEntryUuid:f.entryService.entry.entryUuid,countWithFilters:e,countNoFilters:t,filters:n}}),h.ModalEntriesBranchFilter.onWillDismiss().then((e=>{if(!ne.objectsMatch(g.filters,e.data.filters)){g.isFetching=!0,g.filters=e.data.filters,g.countWithFilters=e.data.count;const{entriesOffset:t,filters:n}=g,r=f.entryService.entry.entryUuid;Ye({inputRef:d,uuid:r,entriesOffset:t,filters:n}).then((e=>{g.branchEntries=e.branchEntries,g.hasUnsavedBranches=e.hasUnsavedBranches,g.isFetching=!1,O.hideProgressDialog(l.DELAY_LONG)}))}})),h.ModalEntriesBranchFilter.present()},filtersClear(){g.filters={...l.FILTERS_DEFAULT},g.isFetching=!0,E().then((()=>{const{entriesOffset:e,filters:t}=g,n=f.entryService.entry.entryUuid;Ye({inputRef:d,uuid:n,entriesOffset:e,filters:t}).then((e=>{g.branchEntries=e.branchEntries,g.hasUnsavedBranches=e.hasUnsavedBranches,g.isFetching=!1}))}))},loadEntriesChunk(e){setTimeout((async()=>{await async function(){return new Promise((e=>{const t=l.ENTRIES_PER_PAGE,n=g.branchEntries.length+t-t,{filters:r}=g,s=f.entryService.entry.entryUuid;Ye({inputRef:d,uuid:s,entriesOffset:n,filters:r}).then((t=>{t.branchEntries.length>0?g.branchEntries.push(...t.branchEntries):g.isInfiniteScrollDisabled=!0,e()}))}))}(),e&&e.target.complete(),g.isInfiniteScrollDisabled&&(e.target.disabled=!0)}),l.DELAY_MEDIUM)},async removeBranchPWA(t){await O.confirmSingle(s.are_you_sure,s.delete)&&(g.branchEntries=g.branchEntries.filter((e=>e.id!==t)),g.branchEntries.length>0?n.queueTempBranchEntriesPWA[e.inputRef]=g.branchEntries:delete n.queueTempBranchEntriesPWA[e.inputRef])},async editBranchPWA(e){const t=f.entryService.entry.formRef,s=g.branchEntries.find((t=>t.id===e)),a={entryUuid:s.id,ownerEntryUuid:s.relationships.branch.data.owner_entry_uuid,ownerInputRef:s.relationships.branch.data.owner_input_ref,isRemote:0,synced:0,canEdit:1,createdAt:s.branch_entry.created_at,title:s.branch_entry.title,formRef:t,projectRef:w,media:{},uniqueAnswers:{},syncedError:"",isBranch:!0,answers:s.branch_entry.answers};await O.showProgressDialog(b[r].labels.wait),await Ut.setUpExisting(a),n.routeParams={formRef:t,inputRef:"",inputIndex:0,error:g.error,isBranch:!0,branchEntryUuid:e},o.replace({name:l.ROUTES.ENTRIES_BRANCH_ADD})}};function S(){const{entriesOffset:e,filters:t}=g,n=f.entryService.entry.entryUuid;Ye({inputRef:d,uuid:n,entriesOffset:e,filters:t}).then((e=>{g.branchEntries=e.branchEntries,g.hasUnsavedBranches=e.hasUnsavedBranches,g.isFetching=!1,O.hideProgressDialog(l.DELAY_LONG)}))}return n.device.platform!==l.PWA?E().then((()=>{S()})):S(),(0,a.YP)((()=>[{refreshBranchEntries:u.params.refreshBranchEntries,timestamp:u.params.timestamp}]),(e=>{"true"===e[0].refreshBranchEntries&&(g.isFetching=!0,window.setTimeout((async function(){const{entriesOffset:e,filters:t}=g,n=f.entryService.entry.entryUuid;Ye({inputRef:d,uuid:n,entriesOffset:e,filters:t}).then((e=>{g.branchEntries=e.branchEntries,g.hasUnsavedBranches=e.hasUnsavedBranches,g.isFetching=!1,O.hideProgressDialog(l.DELAY_LONG)}))}),l.DELAY_LONG))})),{labels:s,state:g,...y,...A,PARAMETERS:l,trash:T._Ij,cloudUpload:T.RH0,create:T.Ue8,add:T.IHx,archive:T.nwB,cloudy:T.K2q,alertCircle:T.no6}}};var Nt=(0,f.Z)(Wt,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-label"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-item"),p=(0,a.up)("ion-item-divider"),m=(0,a.up)("question-label-action"),_=(0,a.up)("ion-card-title"),f=(0,a.up)("ion-card-header"),w=(0,a.up)("ion-col"),g=(0,a.up)("ion-row"),E=(0,a.up)("ion-spinner"),y=(0,a.up)("ion-list"),A=(0,a.up)("ion-infinite-scroll-content"),S=(0,a.up)("ion-infinite-scroll"),T=(0,a.up)("toolbar-entries-filters"),b=(0,a.up)("icon-entry"),R=(0,a.up)("ion-grid"),I=(0,a.up)("ion-card-content"),v=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.iD)(a.HY,null,[e.isOwnerEntryRemote&&s.state.hasUnsavedBranches?((0,a.wg)(),(0,a.j4)(d,{key:0,class:"item-warning ion-text-center animate__animated animate__fadeIn",lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"ion-text-uppercase ion-text-start"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.unsaved_branch_entries),1)])),_:1}),(0,a.Wm)(c,{color:"warning",size:"default",onClick:t[0]||(t[0]=t=>e.saveBranchEntry())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{icon:s.archive,slot:"start"},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.save),1)])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(p,{class:"entry-name",color:"light",sticky:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"entry-name-label ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(n.parentEntryName)+" "+(0,h.zw)(n.currentFormName),1)])),_:1})])),_:1}),(0,a.Wm)(v,{class:"question-card animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{disabled:e.isPWA,action:"filter",questionText:s.state.question,answer:" ",onOnLabelButtonClick:e.openModalEntriesBranchFilter},null,8,["disabled","questionText","onOnLabelButtonClick"])])),_:1})])),_:1}),(0,a.Wm)(I,{class:"ion-text-center question-branch"},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[e.isPWA&&e.isPWAEntryEdit?((0,a.wg)(),(0,a.j4)(g,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"warning"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"item-divider-label-centered ion-text-wrap"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.pwaEntryEditWarning),1)])),_:1})])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(g,{class:"ion-padding-top ion-padding-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{"size-xs":"10","offset-xs":"1","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:e.isEntriesLimitReached,class:"question-action-button",color:"secondary",expand:"block",onClick:t[1]||(t[1]=t=>e.addBranch())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.add},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.add_branch),1)])),_:1},8,["disabled"]),e.isEntriesLimitReached?((0,a.wg)(),(0,a.j4)(l,{key:0,color:"warning",class:"ion-text-wrap"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.warningEntriesLimitReached),1)])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1}),e.isPWA?((0,a.wg)(),(0,a.j4)(g,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{"size-xs":"10","offset-xs":"1","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[s.state.isFetching?((0,a.wg)(),(0,a.j4)(E,{key:0,class:"ion-margin",name:"crescent"})):(0,a.kq)("",!0),!s.state.isFetching&&s.state.branchEntries.length>0?((0,a.wg)(),(0,a.iD)("div",Me,[(0,a.Wm)(y,{class:"animate__animated animate__fadeIn",lines:"none",mode:"md"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.state.branchEntries,(t=>((0,a.wg)(),(0,a.j4)(d,{lines:"full",class:"list-entries-item",key:t.id},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"icon-primary",icon:s.create,slot:"start",onClick:n=>e.editBranchPWA(t.id)},null,8,["icon","onClick"]),e.hasPWABranchUploadError(t.id)?((0,a.wg)(),(0,a.j4)(l,{key:0,color:"danger"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"icon-danger pwa-branch-upload-error",icon:s.alertCircle},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(t.branch_entry.title),1)])),_:2},1024)):((0,a.wg)(),(0,a.j4)(l,{key:1},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(t.branch_entry.title),1)])),_:2},1024)),(0,a.Wm)(u,{class:"icon-primary",icon:s.trash,slot:"end",onClick:n=>e.removeBranchPWA(t.id)},null,8,["icon","onClick"])])),_:2},1024)))),128))])),_:1}),(0,a.wy)((0,a.Wm)(S,{disabled:s.state.branchEntries.length<=s.PARAMETERS.ENTRIES_PER_PAGE,onIonInfinite:t[2]||(t[2]=t=>e.loadEntriesChunk(t)),threshold:"100px",class:"ion-padding-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{"loading-spinner":"crescent","loading-text":s.labels.loading},null,8,["loading-text"])])),_:1},8,["disabled"]),[[r.F8,s.state.branchEntries.length>0]])])):(0,a.kq)("",!0)])),_:1})])),_:1})):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(g,{key:2},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[s.state.isFetching?((0,a.wg)(),(0,a.j4)(E,{key:0,class:"ion-margin",name:"crescent"})):(0,a.kq)("",!0),!s.state.isFetching&&s.state.countNoFilters>0?((0,a.wg)(),(0,a.iD)("div",ze,[(0,a.Wm)(y,{class:"animate__animated animate__fadeIn",lines:"full",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{countWithFilters:s.state.countWithFilters,countNoFilters:s.state.countNoFilters,onFiltersClear:t[3]||(t[3]=t=>e.filtersClear())},null,8,["countWithFilters","countNoFilters"]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.state.branchEntries,(t=>((0,a.wg)(),(0,a.j4)(d,{class:"list-entries-item",key:t.uuid,onClick:n=>e.viewBranch(t.entry_uuid)},{default:(0,a.w5)((()=>[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,{entry:t},null,8,["entry"]),(0,a.Uk)(" "+(0,h.zw)(t.title),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a._)("small",Be,(0,h.zw)(s.labels.collected_on+e.utcToLocal(t.created_at)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),(0,a.wy)((0,a.Wm)(S,{disabled:s.state.countNoFilters<=s.PARAMETERS.ENTRIES_PER_PAGE,onIonInfinite:t[4]||(t[4]=t=>e.loadEntriesChunk(t)),threshold:"100px",class:"ion-padding-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{"loading-spinner":"crescent","loading-text":s.labels.loading},null,8,["loading-text"])])),_:1},8,["disabled"]),[[r.F8,s.state.countWithFilters>0]])])):(0,a.kq)("",!0)])),_:1})])),_:1})),e.isPWA||s.state.isFetching||0!==s.state.branchEntries.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(g,{key:3},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{"size-xs":"10","offset-xs":"1","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"ion-text-center ion-margin-bottom",lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.no_entries_found),1)])),_:1})])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1})],64)}]]);const Ct={key:0,class:"question-required half-padding"},jt={key:1,class:"question-error half-padding-bottom"};const Lt={class:""},Ft={class:"question-label-button ion-activatable ripple-parent ion-text-center"};const qt={key:2},xt={key:3,class:"animate__animated animate__fadeIn"};const Mt=["checked"];var zt={props:{possibleAnswers:{type:Array,required:!0},selectedAnswers:{type:Array,required:!0},isGroupInput:{type:Boolean,required:!0},hasError:{type:Boolean,default:!1}},emits:["on-selected-answers"],setup(e,t){const n=p().language,r=b[n].labels,{possibleAnswers:s,isGroupInput:o}=(0,m.OT)(e),{selectedAnswers:i}=(0,m.BK)(e),u=(0,m.qj)({currentSelectedAnswers:i.value,possibleAnswersChunk:[]});u.possibleAnswersChunk=o?s.slice(0):s.slice(0,l.POSSIBLE_ANSWERS_PER_PAGE);const c={showInfiniteLoader:(0,m.Fl)((()=>u.possibleAnswersChunk.length<s.length)),disableInfiniteLoader:(0,m.Fl)((()=>o||s.length<=l.POSSIBLE_ANSWERS_LAZY_THRESHOLD))},d={onChange(){},isChecked(e){return u.currentSelectedAnswers.indexOf(e)>-1},toggleCheckbox(e){const n=u.currentSelectedAnswers.indexOf(e);n>-1?u.currentSelectedAnswers.splice(n,1):u.currentSelectedAnswers.push(e),t.emit("on-selected-answers",u.currentSelectedAnswers)},loadPossibleAnswersChunk(e){setTimeout((()=>{const t=l.POSSIBLE_ANSWERS_LIMIT;!function(){const e=l.POSSIBLE_ANSWERS_PER_PAGE,t=u.possibleAnswersChunk.length+e;for(let n=t-e;n<t&&void 0!==s[n];n++)u.possibleAnswersChunk.push(s[n])}(),e&&e.target.complete(),u.possibleAnswersChunk.length===t&&(e.target.disabled=!0)}),l.DELAY_MEDIUM)}};return o||d.loadPossibleAnswersChunk(),(0,a.bv)((()=>{})),(0,a.ic)((()=>{})),{labels:r,state:u,...d,...c,publicPath:"/"}}};var Bt=(0,f.Z)(zt,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-label"),u=(0,a.up)("ion-col"),c=(0,a.up)("ion-row"),d=(0,a.up)("ion-grid"),p=(0,a.up)("ion-list"),m=(0,a.up)("ion-infinite-scroll-content"),_=(0,a.up)("ion-infinite-scroll");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{class:(0,h.C_)(["possible-answers-list ion-no-padding",{"has-error":n.hasError}])},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.state.possibleAnswersChunk,(t=>((0,a.wg)(),(0,a.iD)("div",{class:(0,h.C_)(["possible-answer-item animate__animated animate__fadeIn",s.state.currentSelectedAnswers.indexOf(t.answer_ref)>-1?"checkbox-checked":""]),key:t.answer_ref},[(0,a.Wm)(d,{class:"half-padding checkbox-padding",onClick:n=>e.toggleCheckbox(t.answer_ref)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"ion-align-items-start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{"size-xs":"10","size-sm":"11","size-md":"11","size-lg":"11","size-xl":"11"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"possible-answer-label"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(t.answer),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(u,{"size-xs":"2","size-sm":"1","size-md":"1","size-lg":"1","size-xl":"1",class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("input",{class:"possible-answer-checkbox",type:"checkbox",checked:e.isChecked(t.answer_ref)},null,8,Mt)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])],2)))),128))])),_:1},8,["class"]),(0,a.wy)((0,a.Wm)(_,{class:"ion-margin-top",disabled:e.disableInfiniteLoader,onIonInfinite:t[0]||(t[0]=t=>e.loadPossibleAnswersChunk(t)),threshold:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"loading-spinner":"crescent","loading-text":s.labels.loading},null,8,["loading-text"])])),_:1},8,["disabled"]),[[r.F8,e.showInfiniteLoader]])],64)}]]);const Gt=["checked"];var Yt={props:{possibleAnswers:{type:Array,required:!0},selectedAnswers:{type:Array,required:!0},isGroupInput:{type:Boolean,required:!0},hasError:{type:Boolean,default:!1}},emits:["on-selected-answers"],setup(e,t){const n=p().language,r=b[n].labels,{possibleAnswers:s,isGroupInput:o}=(0,m.OT)(e),{selectedAnswers:i}=(0,m.BK)(e),u=(0,m.qj)({currentSelectedAnswers:i.value,possibleAnswersChunk:[],isFetching:!1});u.possibleAnswersChunk=o?s.slice(0):s.slice(0,l.POSSIBLE_ANSWERS_PER_PAGE);const c={isChecked(e){return u.currentSelectedAnswers.indexOf(e)>-1},toggleRadio(e){const n=u.currentSelectedAnswers.indexOf(e);n>-1?u.currentSelectedAnswers.splice(n,1):u.currentSelectedAnswers.splice(0,1,e),t.emit("on-selected-answers",u.currentSelectedAnswers)},loadPossibleAnswersChunk(e){u.isFetching=!0,setTimeout((()=>{const t=l.POSSIBLE_ANSWERS_LIMIT;!function(){const e=l.POSSIBLE_ANSWERS_PER_PAGE,t=u.possibleAnswersChunk.length+e;for(let n=t-e;n<t&&void 0!==s[n];n++)u.possibleAnswersChunk.push(s[n])}(),e&&e.target.complete(),u.possibleAnswersChunk.length===t&&(e.target.disabled=!0),u.isFetching=!1}),l.DELAY_MEDIUM)}},d={showInfiniteLoader:(0,m.Fl)((()=>u.possibleAnswersChunk.length<s.length)),disableInfiniteLoader:(0,m.Fl)((()=>o||s.length<=l.POSSIBLE_ANSWERS_LAZY_THRESHOLD))};return o||c.loadPossibleAnswersChunk(),(0,a.YP)(i,(()=>{})),{labels:r,state:u,...e,...c,...d}}};var Ht=(0,f.Z)(Yt,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-label"),u=(0,a.up)("ion-col"),c=(0,a.up)("ion-row"),d=(0,a.up)("ion-grid"),p=(0,a.up)("ion-list"),m=(0,a.up)("ion-infinite-scroll-content"),_=(0,a.up)("ion-infinite-scroll");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{class:(0,h.C_)(["possible-answers-list ion-no-padding",{"has-error":n.hasError}])},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.state.possibleAnswersChunk,(t=>((0,a.wg)(),(0,a.iD)("div",{class:(0,h.C_)(["possible-answer-item animate__animated animate__fadeIn",s.state.currentSelectedAnswers.indexOf(t.answer_ref)>-1?"checkbox-checked":""]),key:t.answer_ref},[(0,a.Wm)(d,{class:"half-padding-start radio-padding",onClick:n=>e.toggleRadio(t.answer_ref)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"ion-align-items-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{"size-xs":"10","size-sm":"11","size-md":"11","size-lg":"11","size-xl":"11"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"possible-answer-label"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(t.answer),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(u,{"size-xs":"2","size-sm":"1","size-md":"1","size-lg":"1","size-xl":"1",class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("input",{class:"possible-answer-radio",type:"checkbox",checked:e.isChecked(t.answer_ref)},null,8,Gt)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])],2)))),128))])),_:1},8,["class"]),(0,a.wy)((0,a.Wm)(_,{class:"ion-margin-top",disabled:e.disableInfiniteLoader,onIonInfinite:t[0]||(t[0]=t=>e.loadPossibleAnswersChunk(t)),threshold:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"loading-spinner":"crescent","loading-text":s.labels.loading},null,8,["loading-text"])])),_:1},8,["disabled"]),[[r.F8,e.showInfiniteLoader]])],64)}]]);var Vt={emit:["on-dismiss"],setup(e,t){const n=p().language;return{labels:b[n].labels,...{dismiss(){t.emit("on-dismiss")}},closeOutline:T.fID}}};var Qt=(0,f.Z)(Vt,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-button"),u=(0,a.up)("ion-buttons"),c=(0,a.up)("ion-toolbar"),d=(0,a.up)("ion-header");return(0,a.wg)(),(0,a.j4)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"button-close",onClick:t[0]||(t[0]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:r.closeOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.close),1)])),_:1})])),_:1})])),_:1})])),_:1})}]]),Zt={components:{ListPossibleAnswersCheckbox:Bt,ListPossibleAnswersRadio:Ht,HeaderModal:Qt},props:{possibleAnswers:{type:Array,required:!0},selectedAnswers:{type:Array,required:!0},questionType:{type:String,required:!0},isGroupInput:{type:Boolean,required:!0}},setup(e){const t=p().language,n=b[t].labels,{possibleAnswers:r,questionType:s}=(0,m.OT)(e),{selectedAnswers:o}=(0,m.BK)(e);let a;const u=(0,m.qj)({isFetching:!1,selectedAnswers:o.value,searchTerm:"",hits:[]});u.hits=[...r];const c={onSelectedAnswers(e){u.selectedAnswers=e,s===l.QUESTION_TYPES.DROPDOWN&&c.dismiss()},dismiss(){i.modalController.dismiss(u.selectedAnswers)},filterPossibleAnswers(e){u.searchTerm=e.target.value,u.isFetching=!0,clearTimeout(a),""===u.searchTerm&&(u.hits=[],setTimeout((()=>(u.hits=[...r],u.isFetching=!1,!1)),l.DELAY_FAST)),a=setTimeout((function(){u.hits=[],r.forEach((e=>{e.answer.toLowerCase().indexOf(u.searchTerm.toLowerCase())>=0&&u.hits.push(e)})),u.isFetching=!1}),l.DELAY_LONG)}},d={isSingleSelectionType:(0,m.Fl)((()=>s===l.QUESTION_TYPES.DROPDOWN||s===l.QUESTION_TYPES.RADIO||s===l.QUESTION_TYPES.SEARCH_SINGLE)),showFilters:(0,m.Fl)((()=>s!==l.QUESTION_TYPES.DROPDOWN||r.length>=l.POSSIBLE_ANSWERS_FILTER_THRESHOLD))};return{labels:n,state:u,...e,...d,...c}}};var Jt=(0,f.Z)(Zt,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("ion-searchbar"),u=(0,a.up)("ion-item-divider"),c=(0,a.up)("ion-spinner"),d=(0,a.up)("list-possible-answers-radio"),p=(0,a.up)("list-possible-answers-checkbox"),m=(0,a.up)("ion-card-title"),_=(0,a.up)("ion-card-header"),f=(0,a.up)("ion-card"),w=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[e.showFilters?((0,a.wg)(),(0,a.j4)(u,{key:0,sticky:"",color:"dark",class:"possible-answers-serchbar-wrapper"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{animated:"",debounce:"500",placeholder:r.labels.type_hint,onIonChange:e.filterPossibleAnswers},null,8,["placeholder","onIonChange"])])),_:1})):(0,a.kq)("",!0),r.state.isFetching?((0,a.wg)(),(0,a.j4)(c,{key:1,class:"spinner-search-possible-answers",name:"crescent"})):(0,a.kq)("",!0),!r.state.isFetching&&r.state.hits.length>0?((0,a.wg)(),(0,a.iD)("div",qt,[e.isSingleSelectionType?((0,a.wg)(),(0,a.j4)(d,{key:0,possibleAnswers:r.state.hits,selectedAnswers:n.selectedAnswers,isGroupInput:n.isGroupInput,onOnSelectedAnswers:e.onSelectedAnswers},null,8,["possibleAnswers","selectedAnswers","isGroupInput","onOnSelectedAnswers"])):(0,a.kq)("",!0),e.isSingleSelectionType?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(p,{key:1,possibleAnswers:r.state.hits,selectedAnswers:n.selectedAnswers,isGroupInput:n.isGroupInput,onOnSelectedAnswers:e.onSelectedAnswers},null,8,["possibleAnswers","selectedAnswers","isGroupInput","onOnSelectedAnswers"]))])):(0,a.kq)("",!0),r.state.isFetching||0!==r.state.hits.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",xt,[(0,a.Wm)(f,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.no_hits_found),1)])),_:1})])),_:1})])),_:1})]))])),_:1})],64)}]]),Xt={props:{questionText:{type:String,required:!0},questionType:{type:String,required:!0},possibleAnswers:{type:Array,required:!0},selectedAnswers:{type:Array,required:!0},isGroupInput:{type:Boolean,required:!0}},emit:["on-selected-answers"],setup(e,t){const n=p(),{questionType:r,possibleAnswers:s,isGroupInput:o}=(0,m.OT)(e),{selectedAnswers:a}=(0,m.BK)(e),u=n.language,c={},d={async openModalPossibleAnswers(){await O.showProgressDialog(b[u].labels.wait),c.ModalPossibleAnswers=await i.modalController.create({cssClass:"modal-search",component:Jt,showBackdrop:!0,backdropDismiss:!1,componentProps:{selectedAnswers:a.value,isGroupInput:o,questionType:r,possibleAnswers:s}}),c.ModalPossibleAnswers.onWillDismiss().then((e=>{t.emit("on-selected-answers",e.data)})),c.ModalPossibleAnswers.present().then(setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_FAST))}};return{...e,...d,filter:T.hXT}}};var Kt=(0,f.Z)(Xt,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-col"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-ripple-effect"),c=(0,a.up)("ion-row"),d=(0,a.up)("ion-grid");return(0,a.wg)(),(0,a.j4)(d,{class:"question-label-grid"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{"size-xs":"10","size-sm":"11","size-md":"11","size-lg":"11","size-xl":"11"},{default:(0,a.w5)((()=>[(0,a._)("div",Lt,(0,h.zw)(n.questionText),1)])),_:1}),(0,a.Wm)(i,{"size-xs":"2","size-sm":"1","size-md":"1","size-lg":"1","size-xl":"1"},{default:(0,a.w5)((()=>[(0,a._)("div",Ft,[(0,a.Wm)(l,{icon:r.filter,onClick:t[0]||(t[0]=t=>e.openModalPossibleAnswers())},null,8,["icon"]),(0,a.Wm)(u,{class:"question-label-button-ripple",type:"unbounded"})])])),_:1})])),_:1})])),_:1})}]]),$t={components:{QuestionLabelPossibleAnswers:Kt,ListPossibleAnswersCheckbox:Bt},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean}},emits:["question-mounted"],setup(e,t){const n=p(),{isGroupInput:r}=(0,m.OT)(e),s=(0,m.OT)(e.type),o=(0,a.f3)("entriesAddState"),i=n.language,l=b[i].labels,u=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}}),c={questionType:s,isGroupInput:r};ke.setUpInputParams(u,e.inputRef,o),(0,a.bv)((async()=>{t.emit("question-mounted")}));const d={hasError:(0,m.Fl)((()=>ne.hasQuestionError(u))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(u.error.errors).length>0?null===(e=u.error)||void 0===e||null===(t=e.errors[u.currentInputRef])||void 0===t?void 0:t.message:""}))},_={onSelectedAnswers(e){u.answer.answer=e}};return{labels:l,state:u,...d,...c,..._,...e}}};var en=(0,f.Z)($t,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-possible-answers"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("list-possible-answers-checkbox"),d=(0,a.up)("ion-card-content"),p=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(p,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{questionText:r.state.question,questionType:e.questionType,possibleAnswers:r.state.inputDetails.possible_answers,selectedAnswer:String(),selectedAnswers:r.state.answer.answer,isGroupInput:n.isGroupInput,onOnSelectedAnswers:e.onSelectedAnswers},null,8,["questionText","questionType","possibleAnswers","selectedAnswer","selectedAnswers","isGroupInput","onOnSelectedAnswers"])])),_:1})])),_:1}),(0,a.Wm)(d,{class:"question-checkbox-card-content"},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",Ct,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),(0,a.Wm)(c,{possibleAnswers:r.state.inputDetails.possible_answers,selectedAnswers:r.state.answer.answer,isGroupInput:n.isGroupInput,onOnSelectedAnswers:e.onSelectedAnswers,hasError:e.hasError},null,8,["possibleAnswers","selectedAnswers","isGroupInput","onOnSelectedAnswers","hasError"]),e.hasError?((0,a.wg)(),(0,a.iD)("div",jt,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])),_:1})])),_:1},8,["class"])}]]);const tn={class:"datetime-value"},nn={key:1,class:"question-error"};var rn={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),i=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},date:{answer:""},userFormattedDate:null,inputFormattedDate:null});ke.setUpInputParams(i,e.inputRef,o);let l="";""===i.answer.answer?i.userFormattedDate="":(i.userFormattedDate=ne.getUserFormattedDate(i.answer.answer,i.inputDetails.datetime_format),i.inputFormattedDate=ne.getInputFormattedDate(i.answer.answer),i.date.answer=i.answer.answer.substring(0,10)),i.inputDetails.set_to_current_datetime&&""===i.answer.answer&&(l=new Date,i.inputFormattedDate=ne.getInputFormattedDate(l.toISOString()),i.answer.answer=ne.getISODateOnly(l.toISOString(),i.inputDetails.datetime_format),i.date.answer=i.inputFormattedDate,i.userFormattedDate=ne.getUserFormattedDate(l.toISOString(),i.inputDetails.datetime_format));const u={hasError:(0,m.Fl)((()=>ne.hasQuestionError(i))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(i.error.errors).length>0?null===(e=i.error)||void 0===e||null===(t=e.errors[i.currentInputRef])||void 0===t?void 0:t.message:""})),isPWA:(0,m.Fl)((()=>n.isPWA))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const c={showDatePicker(){const e=document.querySelector(".question-datetimepicker");e.addEventListener("click",(()=>{}));const t=new Event("click");e.dispatchEvent(t)},clearDate(){i.answer.answer="",i.answer.was_jumped=!1,i.date.answer=null,i.userFormattedDate=null,i.inputFormattedDate=null},getDate(){""===i.date.answer?(i.answer.answer="",i.answer.was_jumped=!1,i.inputFormattedDate=null,i.userFormattedDate="---"):(i.answer.answer=ne.getISODateOnly(i.date.answer,i.inputDetails.datetime_format),i.inputFormattedDate=ne.getInputFormattedDate(i.answer.answer),i.userFormattedDate=ne.getUserFormattedDate(i.date.answer,i.inputDetails.datetime_format))}};return{labels:s,state:i,...u,...c,...e,calendarClearOutline:T.l3U,closeOutline:T.fID}}};var sn=(0,f.Z)(rn,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-subtitle"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-chip"),m=(0,a.up)("ion-col"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("ion-card-content"),g=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(g,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.state.question),1)])),_:1}),(0,a.Wm)(u,{class:"ion-text-right"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.format)+": "+(0,h.zw)(s.state.inputDetails.datetime_format),1)])),_:1})])),_:1}),(0,a.Wm)(w,{class:(0,h.C_)([{"ion-margin":n.isGroupInput},"ion-text-center"])},{default:(0,a.w5)((()=>[s.state.required?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,h.C_)(["question-required",{"ion-padding-start":n.isGroupInput}])},(0,h.zw)(s.labels.required),3)):(0,a.kq)("",!0),(0,a.Wm)(f,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"size-xs":"12","offset-xs":"0","size-sm":"10","offset-sm":"1","size-md":"8","offset-md":"2","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:(0,h.C_)(["chip-datetimepicker",{"has-error":e.hasError,"web-picker":e.isPWA}]),outline:"",mode:"ios"},{default:(0,a.w5)((()=>[(0,a._)("div",tn,[e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(d,{key:0,class:"date-icon-left",size:"small",icon:s.calendarClearOutline},null,8,["icon"])),(0,a.wy)((0,a._)("input",{type:"date",class:"question-input question-datetimepicker","onUpdate:modelValue":t[0]||(t[0]=e=>s.state.date.answer=e),onChange:t[1]||(t[1]=t=>e.getDate())},null,544),[[r.nr,s.state.date.answer,void 0,{trim:!0}]])]),(0,a.Wm)(d,{size:"large",icon:s.closeOutline,onClick:t[2]||(t[2]=t=>e.clearDate())},null,8,["icon"])])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),(0,a._)("div",null,[(0,a._)("div",null,[(0,a.Uk)((0,h.zw)(s.labels.date_selected_is)+" ",1),(0,a._)("strong",null,(0,h.zw)(""===s.state.userFormattedDate?" --- ":s.state.userFormattedDate),1)])]),e.hasError?((0,a.wg)(),(0,a.iD)("div",nn,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const on={key:0},an={key:1},ln={key:2},un={key:0,class:"question-required"},cn=["step"],dn={key:1,class:"question-error"},pn=["step"];var mn={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){e.type.toUpperCase();const n=(0,a.f3)("entriesAddState"),r=p(),s=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},inputStep:.1});let o=0;ke.setUpInputParams(s,e.inputRef,n),""!==s.answer.answer&&(s.answer.answer.toString().indexOf(".")>-1&&(o=s.answer.answer.toString().split(".")[1].length),s.answer.answer=parseFloat(s.answer.answer,10).toFixed(o)),""!==s.confirmAnswer.answer&&(s.confirmAnswer.answer.toString().indexOf(".")>-1&&(o=s.confirmAnswer.answer.toString().split(".")[1].length),s.confirmAnswer.answer=parseFloat(s.confirmAnswer.answer,10).toFixed(o));const i={hasPattern:(0,m.Fl)((()=>""!==s.pattern&&null!==s.pattern)),hasMin:(0,m.Fl)((()=>""!==s.inputDetails.min)),hasMax:(0,m.Fl)((()=>""!==s.inputDetails.max)),hasError:(0,m.Fl)((()=>ne.questionHasError((0,m.OT)(s)))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(s.error.errors).length>0?null===(e=s.error)||void 0===e||null===(t=e.errors[s.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const u={plusDotOne(){let e=1;s.answer.answer=s.answer.answer.toString(),s.answer.answer.includes(".")&&(e=s.answer.answer.split(".")[1].length),s.inputStep=ne.getStepPrecision(e),s.answer.answer=""===s.answer.answer?.1:(parseFloat(s.answer.answer,10)+s.inputStep).toFixed(e)},minusDotOne(){let e=1;s.answer.answer=s.answer.answer.toString(),s.answer.answer.includes(".")&&(e=s.answer.answer.split(".")[1].length),s.inputStep=ne.getStepPrecision(e),s.answer.answer=""===s.answer.answer?-.1:(parseFloat(s.answer.answer,10)-s.inputStep).toFixed(e)},plusDotOneVerify(){let e=1;s.confirmAnswer.answer=s.confirmAnswer.answer.toString(),s.confirmAnswer.answer.includes(".")&&(e=s.confirmAnswer.answer.split(".")[1].length),s.inputStep=ne.getStepPrecision(e),s.confirmAnswer.answer=""===s.confirmAnswer.answer?.1:(parseFloat(s.confirmAnswer.answer,10)+s.inputStep).toFixed(e)},minusDotOneVerify(){let e=1;s.confirmAnswer.answer=s.confirmAnswer.answer.toString(),s.confirmAnswer.answer.includes(".")&&(e=s.confirmAnswer.answer.split(".")[1].length),s.inputStep=ne.getStepPrecision(e),s.confirmAnswer.answer=""===s.confirmAnswer.answer?-.1:(parseFloat(s.confirmAnswer.answer,10)-s.inputStep).toFixed(e)},filterAnswerInvalidChars(){},isIOS:(0,m.Fl)((()=>r.device.platform===l.IOS))};return{labels:b[r.language].labels,state:s,...i,...u,addSharp:T.Vw6,removeSharp:T.gfl}}};var _n=(0,f.Z)(mn,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-subtitle"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-label"),m=(0,a.up)("ion-chip"),_=(0,a.up)("ion-card-content"),f=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(f,{class:(0,h.C_)(["question-card question-numeric",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.state.question),1)])),_:1}),e.hasPattern||e.hasMin||e.hasMax?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"question-properties ion-text-right"},{default:(0,a.w5)((()=>[e.hasPattern?((0,a.wg)(),(0,a.iD)("div",on,[(0,a.Uk)((0,h.zw)(s.labels.pattern)+": ",1),(0,a._)("span",null," "+(0,h.zw)(s.state.pattern),1)])):(0,a.kq)("",!0),e.hasMin?((0,a.wg)(),(0,a.iD)("span",an,[(0,a.Uk)((0,h.zw)(s.labels.min)+":  ",1),(0,a._)("span",null,(0,h.zw)(s.state.inputDetails.min)+"  ",1)])):(0,a.kq)("",!0),e.hasMax?((0,a.wg)(),(0,a.iD)("span",ln,[(0,a.Uk)((0,h.zw)(s.labels.max)+":  ",1),(0,a._)("span",null,(0,h.zw)(s.state.inputDetails.max)+"  ",1)])):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(_,{class:(0,h.C_)([{"ion-margin":n.isGroupInput},"ion-text-center"])},{default:(0,a.w5)((()=>[s.state.required?((0,a.wg)(),(0,a.iD)("div",un,(0,h.zw)(s.labels.required),1)):(0,a.kq)("",!0),(0,a.Wm)(m,{mode:"ios",outline:"",color:"dark",class:"chip-numeric",lang:"en-US"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-left",icon:s.removeSharp,onClick:t[0]||(t[0]=t=>e.minusDotOne())},null,8,["icon"]),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[e.isIOS?(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:0,type:"text",class:(0,h.C_)(["question-input question-numeric ion-text-center",{"has-error":e.hasError}]),"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.answer.answer=e)},null,2)),[[r.nr,s.state.answer.answer]]):(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:1,type:"number",inputmode:"decimal",step:s.state.inputStep,lang:"en-US",class:(0,h.C_)(["question-input question-numeric ion-text-center",{"has-error":e.hasError}]),"onUpdate:modelValue":t[2]||(t[2]=e=>s.state.answer.answer=e)},null,10,cn)),[[r.nr,s.state.answer.answer,void 0,{number:!0}]])])),_:1}),(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-right",icon:s.addSharp,onClick:t[3]||(t[3]=t=>e.plusDotOne())},null,8,["icon"])])),_:1}),e.hasError?((0,a.wg)(),(0,a.iD)("div",dn,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),s.state.confirmAnswer.verify?((0,a.wg)(),(0,a.j4)(m,{key:2,mode:"ios",outline:"",color:"dark",class:"chip-numeric"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-left",icon:s.removeSharp,onClick:t[4]||(t[4]=t=>e.minusDotOneVerify())},null,8,["icon"]),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[e.isIOS?(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:0,type:"text",class:(0,h.C_)(["question-input question-numeric ion-text-center",{"has-error":e.hasError}]),"onUpdate:modelValue":t[5]||(t[5]=e=>s.state.confirmAnswer.answer=e)},null,2)),[[r.nr,s.state.confirmAnswer.answer]]):(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:1,type:"number",inputmode:"decimal",lang:"en-US",step:s.state.inputStep,class:(0,h.C_)(["question-input question-numeric ion-text-center",{"has-error":e.hasError}]),"onUpdate:modelValue":t[6]||(t[6]=e=>s.state.confirmAnswer.answer=e)},null,10,pn)),[[r.nr,s.state.confirmAnswer.answer,void 0,{number:!0}]])])),_:1}),(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-right",icon:s.addSharp,onClick:t[7]||(t[7]=t=>e.plusDotOneVerify())},null,8,["icon"])])),_:1})):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const fn={key:0,class:"question-required"},wn={key:0,class:"question-error"};var gn={setup(){return{}}};var hn=(0,f.Z)(gn,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-col"),l=(0,a.up)("ion-row"),u=(0,a.up)("ion-grid");return(0,a.wg)(),(0,a.j4)(u,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{"size-xs":"12","offset-xs":"0","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.WI)(e.$slots,"content")])),_:3})])),_:3})])),_:3})}]]),En={components:{GridQuestionWide:hn},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(0,m.OT)(e.type),u=(0,m.OT)(e.isGroupInput),c=(0,a.f3)("entriesAddState"),d=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},selectedAnswers:[]}),_={};ke.setUpInputParams(d,e.inputRef,c);const f=n.device.platform===l.IOS?"ios":"md",w=ne.buildPossibleAnswersHashMap(d.inputDetails.possible_answers);""!==d.answer.answer&&(d.selectedAnswers=[d.answer.answer]);const g={dropdownActionSheetOptions:{cssClass:"question-dropdown-action-sheet",mode:f},hasError:(0,m.Fl)((()=>ne.hasQuestionError(d))),dropdownButtonLabel:(0,m.Fl)((()=>""===d.answer.answer?s.pick_possible_answer:w[d.answer.answer])),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(d.error.errors).length>0?null===(e=d.error)||void 0===e||null===(t=e.errors[d.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const h={async openModalPossibleAnswers(){await O.showProgressDialog(b[r].labels.wait),_.ModalPossibleAnswers=await i.modalController.create({cssClass:"modal-search",component:Jt,showBackdrop:!0,backdropDismiss:!1,componentProps:{selectedAnswers:d.selectedAnswers,questionType:o,possibleAnswers:d.inputDetails.possible_answers,isGroupInput:u}}),_.ModalPossibleAnswers.onWillDismiss().then((e=>{d.answer.answer=e.data[0]||"",d.selectedAnswers=[...e.data]})),_.ModalPossibleAnswers.present().then(setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_FAST))}};return{labels:b[n.language].labels,state:d,...g,...h,...e,caretDown:T.WgW}}};var yn=(0,f.Z)(En,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-header"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-label"),d=(0,a.up)("ion-item"),p=(0,a.up)("grid-question-wide"),m=(0,a.up)("ion-card-content"),_=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(_,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.question),1)])),_:1})])),_:1}),(0,a.Wm)(m,{class:(0,h.C_)({"ion-margin":n.isGroupInput})},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",fn,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),(0,a.Wm)(p,null,{content:(0,a.w5)((()=>[(0,a.Wm)(d,{button:"",class:(0,h.C_)(["question-dropdown-item",{"has-error":e.hasError}]),onClick:t[0]||(t[0]=t=>e.openModalPossibleAnswers()),color:"secondary"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"end",icon:r.caretDown},null,8,["icon"]),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.dropdownButtonLabel),1)])),_:1})])),_:1},8,["class"]),e.hasError?((0,a.wg)(),(0,a.iD)("div",wn,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])),_:1})])),_:1},8,["class"])])),_:1},8,["class"])}]]);const An={key:0};const Sn={key:0,class:"ion-text-right ion-padding"},Tn={key:1},bn={key:2},Rn={key:0,class:"question-required"},In={key:1,class:"question-error"},vn={key:2};var Pn={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p(),r=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),s=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}});ke.setUpInputParams(s,e.inputRef,r),""!==s.answer.answer&&(s.answer.answer=parseInt(s.answer.answer,10)),""!==s.confirmAnswer.answer&&(s.confirmAnswer.answer=parseInt(s.confirmAnswer.answer,10));const o={hasPattern:(0,m.Fl)((()=>""!==s.pattern&&null!==s.pattern)),hasMin:(0,m.Fl)((()=>""!==s.inputDetails.min)),hasMax:(0,m.Fl)((()=>""!==s.inputDetails.max)),hasError:(0,m.Fl)((()=>ne.questionHasError((0,m.OT)(s)))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(s.error.errors).length>0?null===(e=s.error)||void 0===e||null===(t=e.errors[s.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const i={plusOne(){s.answer.answer=""===s.answer.answer?1:Number(s.answer.answer)+1},minusOne(){s.answer.answer=""===s.answer.answer?-1:Number(s.answer.answer)-1},plusOneVerify(){s.confirmAnswer.answer=""===s.confirmAnswer.answer?1:Number(s.confirmAnswer.answer)+1},minusOneVerify(){s.confirmAnswer.answer=""===s.confirmAnswer.answer?-1:Number(s.confirmAnswer.answer)-1},filterAnswerInvalidChars(){}};return{labels:b[n.language].labels,state:s,...o,...i,addSharp:T.Vw6,removeSharp:T.gfl}}};var Dn=(0,f.Z)(Pn,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-subtitle"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-label"),m=(0,a.up)("ion-chip"),_=(0,a.up)("ion-card-content"),f=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(f,{class:(0,h.C_)(["question-card question-numeric",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.state.question),1)])),_:1}),e.hasPattern||e.hasMin||e.hasMax?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"question-properties ion-text-right"},{default:(0,a.w5)((()=>[e.hasPattern?((0,a.wg)(),(0,a.iD)("div",Sn,[(0,a.Uk)((0,h.zw)(s.labels.pattern)+": ",1),(0,a._)("span",null," "+(0,h.zw)(s.state.pattern),1)])):(0,a.kq)("",!0),e.hasMin?((0,a.wg)(),(0,a.iD)("span",Tn,[(0,a.Uk)((0,h.zw)(s.labels.min)+":  ",1),(0,a._)("span",null,(0,h.zw)(s.state.inputDetails.min)+"  ",1)])):(0,a.kq)("",!0),e.hasMax?((0,a.wg)(),(0,a.iD)("span",bn,[(0,a.Uk)((0,h.zw)(s.labels.max)+":  ",1),(0,a._)("span",null,(0,h.zw)(s.state.inputDetails.max)+"  ",1)])):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(_,{class:(0,h.C_)([{"ion-margin":n.isGroupInput},"ion-text-center"])},{default:(0,a.w5)((()=>[s.state.required?((0,a.wg)(),(0,a.iD)("div",Rn,(0,h.zw)(s.labels.required),1)):(0,a.kq)("",!0),(0,a.Wm)(m,{class:"chip-numeric",mode:"ios",outline:"",color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-left",icon:s.removeSharp,onClick:t[0]||(t[0]=t=>e.minusOne())},null,8,["icon"]),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("input",{type:"number",inputmode:"numeric",lang:"en-US",class:(0,h.C_)(["question-input question-numeric ion-text-center",{"has-error":e.hasError}]),"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.answer.answer=e)},null,2),[[r.nr,s.state.answer.answer,void 0,{number:!0}]])])),_:1}),(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-right",icon:s.addSharp,onClick:t[2]||(t[2]=t=>e.plusOne())},null,8,["icon"])])),_:1}),e.hasError?((0,a.wg)(),(0,a.iD)("div",In,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),s.state.confirmAnswer.verify?((0,a.wg)(),(0,a.iD)("div",vn,[(0,a.Wm)(m,{class:"chip-numeric",mode:"ios",outline:"",color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-left",icon:s.removeSharp,onClick:t[3]||(t[3]=t=>e.minusOneVerify())},null,8,["icon"]),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("input",{type:"number",inputmode:"numeric",lang:"en-US",class:(0,h.C_)(["question-input question-numeric ion-text-center",{"has-error":e.hasError}]),"onUpdate:modelValue":t[4]||(t[4]=e=>s.state.confirmAnswer.answer=e)},null,2),[[r.nr,s.state.confirmAnswer.answer,void 0,{number:!0}]])])),_:1}),(0,a.Wm)(d,{size:"large",class:"chip-numeric--icon-right",icon:s.addSharp,onClick:t[5]||(t[5]=t=>e.plusOneVerify())},null,8,["icon"])])),_:1})])):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const On={class:"ion-text-end"},kn={class:"ion-text-start"},Un={class:"ion-text-end"},Wn={class:"ion-text-start"},Nn={class:"ion-text-end"},Cn={class:"ion-text-start"},jn={key:3,class:"question-error"};const Ln=(0,a.Uk)("Lat:"),Fn=(0,a.Uk)("Long:"),qn=(0,a.Uk)("Lat:"),xn=(0,a.Uk)("Long:"),Mn=(0,a.Uk)("   "),zn=["id"];var Bn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAYAAAAWy4frAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0NTdDQzBEQkNERTgxMUU3QjdFN0EzRDNBQ0U5MkI3MyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0NTdDQzBEQ0NERTgxMUU3QjdFN0EzRDNBQ0U5MkI3MyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ1N0NDMEQ5Q0RFODExRTdCN0U3QTNEM0FDRTkyQjczIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ1N0NDMERBQ0RFODExRTdCN0U3QTNEM0FDRTkyQjczIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+3WqdgAAABI1JREFUeNrcm11IFVEQx083IcQeQpIiE6qHipIgejAiCKqXEkykJHqLHnqpJHoJKUn7ILXSQohAC6nQoq4oGYhRKtmHQfhgmqFYaRYSIobBhbw2g7OwrXfv3d0zZz3bwB/x3j1n9zdzvmZWF8zMzIj/wZI6Dj3h7nMlKJ1+ojJAC0GfQSOkb6DvoGk2EKZ+skAHQPn04E5sHNQAqge9kIUKSXr+Cugr6A3olAsItFTQEVAraAxUDVrrJ0gKqAT0ycPDJ4LqJuekqgY5DOoDnQUlK5izyeScj6ACmlusIIso9LeZIpDI0kCVoCYaASwgGOYWCr3fthf0iuajFAhOvnegHfO4RWwCvaeV0RMIeuElaI0G+10aLdGZbkFwXDZTB7oYLgSNdiuaHcg9CqluhqMjHGs1iwWCe0SuxscqnK/liUBwchcG4Ix4wnoKsIKUutmE5tHwGSvsQLI0H1Kx9pjdsUAqA5iGXLUe4zEaWxXc6JHl9/0KNkt89rcGSDZj52FKonAf6gX9oM+X0LjeCdoMymO630EzSD4jxH36abUJOjehtoH+0IiQBdoDOplE2/46pmF03BSBeGYA3WG4Lz57ZohpWGEEah1CmK3cJnpuLRtBljN0hHPCSxWjlw6DsrYaQVYxdNQg0baeISoZIYaMDx+iR6L9TwZHLkOQdIaOJiTbj0i2Tw85zYnj2G8NHJGCIKOSnSxmAFkv2X4UQQYlO4mCNkj2IVvxHESQYclO8iTPaduFXMUTbRg7GOLYkEBLPbY9ypA+DCHIawYQjEqxh3ZnmOZYN4J0gn4xdLYCdN7F9cdAWxiigatmG4JgOf85A0guHUAf01HdzvCau6BdTBlpGyhirBZYL9rHBGOsQgW00fWR1zZSOQedl8OY/zSbl71W5swtR/hnTeacHT33NIA5e6NxvDGv3zcCCHIzVhXlGehLgCD6xezrjjkg02bCANg/I8h6NMAcOhIAiElKrW1B8O3qwwCA4D40FQ8ErUpzCDxtz6mKxgLpErOvunQ13PMGnICgVWgMcinWh3YgdaAPGkK0gzrcgOBSXKQhiO0zxcvMwprNlRa7aCQCQdPpNdzpeF+GHHihU5PDYbcMiA5RiVJKLGRBOsyHs3mwB8JBSTYku1r4EA1H93YK0kXj1G+rjbWLy4AIGqdRHyEidru4LEgPjVe/rNppNNyCGHMl6lM0Lrtp4BZkwJrQKLIq4fKdiZficZHiLBKzvzK3jbyAjND4VWXXKVNVDoJWoigqk8Lj38R4BRlTlBJjNMb9BDEytUlGCHROqdfGMiDj5EEuu2atjPgFIsiDY0zRkBqqsiBT5ElZK5aJBgeIsXnJRAXrzTWyD8EBMiW8vT80rIxjKQ8xTdQa4a2Sj21ucTwAF0jEy7GCUoNpnUAEebbfxfV4bR3XzTlB0LMXXFxfKBj/640TRAjnpVYs/IU5b8wN4rTUepH7kMYNIkTiUit7NFSBGOPfy3fagdiVWtuFomKfKhA7zysr9KkEsZZa474W0BnEGgGlZdckxSDmUmtXkEHQzvlwD/FXgAEAh2LrTPEI05AAAAAASUVORK5CYII=",Gn={props:{inputRef:{type:String,required:!0},latitude:{type:String,required:!0},longitude:{type:String,required:!0},accuracy:{type:Number,required:!0}},emits:["on-pwa-location-update"],setup(e,t){const n=p().language,r=b[n].labels;let s=null,o=null,i=null;const u=(0,m.qj)({latitude:e.latitude,longitude:e.longitude,accuracy:e.accuracy,address:""}),c={async geocodeAddress(){if(""!==u.address){O.showProgressDialog(b[n].labels.acquiring_position,b[n].labels.wait);try{const e=await de.geocodeAddressPWA(u.address);u.latitude=e.latitude,u.longitude=e.longitude,u.accuracy=e.accuracy,d(!1)}catch(e){O.showAlert(r.location_fail)}finally{O.hideProgressDialog()}}else O.showAlert(r.no_hits_found)},updateLocation(e){""!==u.latitude||""!==u.longitude?ne.isValidLatitude(u.latitude)&&ne.isValidLongitude(u.longitude)?d(e):e&&O.showAlert(r.location_fail):f()},onLatValueChange(e){const t=e.target.value;t.length>l.PWA_MAX_LATLONG_LENGTH-1?u.latitude=t.slice(0,l.PWA_MAX_LATLONG_LENGTH):u.latitude=t},onLongValueChange(e){const t=e.target.value;t.length>l.PWA_MAX_LATLONG_LENGTH-1?u.longitude=t.slice(0,l.PWA_MAX_LATLONG_LENGTH):u.longitude=t}};function d(e){null!==o?(e&&O.showProgressDialog(b[n].labels.acquiring_position,b[n].labels.wait),o.setLatLng(new i.LatLng(u.latitude,u.longitude)),s.setView([u.latitude,u.longitude],10),e&&O.showToast(r.location_acquired),_(),setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_MEDIUM)):function(e){e&&O.showProgressDialog(b[n].labels.acquiring_position,b[n].labels.wait),i.Marker.prototype.setIcon(i.icon({iconUrl:Bn,shadowUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",iconSize:[25,41],shadowAnchor:[12,20]})),o=i.marker([u.latitude,u.longitude],{draggable:!0}),o.on("dragend",(e=>{const t=e.target._latlng;u.latitude=t.lat.toFixed(6),u.longitude=t.lng.toFixed(6),u.accuracy=4,s.setView([u.latitude,u.longitude],s.getZoom()),_()})),o.addTo(s),s.setView([u.latitude,u.longitude],10),e&&O.showToast(r.location_acquired),_(),setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_MEDIUM)}(e)}function _(){t.emit("on-pwa-location-update",{latitude:u.latitude,longitude:u.longitude,accuracy:u.accuracy})}function f(){const e={enableHighAccuracy:!1,maximumAge:0,timeout:l.GEOLOCATION_TIMEOUT};O.showProgressDialog(b[n].labels.acquiring_position,b[n].labels.wait),"geolocation"in navigator?navigator.geolocation.getCurrentPosition((e=>{u.longitude=e.coords.longitude.toFixed(6),u.latitude=e.coords.latitude.toFixed(6),u.accuracy=Math.round(e.coords.accuracy),O.hideProgressDialog(),d(!1)}),(e=>{O.showAlert(e.message,b[n].labels.error),O.hideProgressDialog()}),e):(O.showAlert(b[n].labels.location_not_available,b[n].labels.error),O.hideProgressDialog())}return(0,a.wF)((()=>{window.L})),(0,a.bv)((async()=>{i=window.L,s=i.map(e.inputRef).setView([0,0],1);const t=i.tileLayer(l.CARTO_LIGHT_TILES_PROVIDER,{attribution:l.CARTO_TILES_ATTRIBUTION,maxNativeZoom:20}),n=i.tileLayer(l.ESRI_TILES_PROVIDER_SATELLITE,{attribution:l.ESRI_TILES_PROVIDER_ATTRIBUTION,maxNativeZoom:20}),r=i.tileLayer(l.STAMEN_HIGH_CONTRAST_TILES_PROVIDER,{attribution:l.STAMEN_TILES_ATTRIBUTION,maxNativeZoom:20}),o=i.tileLayer(l.MAPBOX_TILES_PROVIDER_OUTDOOR,{attribution:l.MAPBOX_TILES_ATTRIBUTION,maxNativeZoom:20}),a=i.tileLayer(l.OSM_TILES_PROVIDER,{attribution:l.OSM_TILES_ATTRIBUTION,maxNativeZoom:20});t.addTo(s);const d={Satellite:n,Terrain:o,Contrast:r,Carto:t,OpenStreetMap:a};i.control.layers(d).addTo(s),i.control.fullscreen({position:"topleft"}).addTo(s),i.Control.Locate=i.Control.extend({onAdd(){const e=i.DomUtil.create("a","leaflet-control-locate-me leaflet-bar");return i.DomEvent.on(e,"click",(e=>{i.DomEvent.stopPropagation(e),f()})),e},onRemove(){}}),i.control.Locate=e=>new i.Control.Locate(e),i.control.Locate({position:"topleft"}).addTo(s),setTimeout((()=>{s.invalidateSize(),""!==u.latitude&&""!==u.longitude&&c.updateLocation(!1)}),100)})),(0,a.Jd)((()=>{s&&s.remove()})),{mapId:e.inputRef,labels:r,state:u,...l,...c,search:T.yC4,locate:T.jt2}}};var Yn=(0,f.Z)(Gn,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-input"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-item");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a.Wm)(d,{class:"lat-long-controls ion-hide-sm-up"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{position:"stacked"},{default:(0,a.w5)((()=>[Ln])),_:1}),(0,a.Wm)(l,{type:"number",inputmode:"decimal",placeholder:"###.######",maxlength:e.PWA_MAX_LATLONG_LENGTH,value:r.state.latitude,onKeyup:t[0]||(t[0]=t=>e.onLatValueChange(t))},null,8,["maxlength","value"]),(0,a.Wm)(i,{position:"stacked"},{default:(0,a.w5)((()=>[Fn])),_:1}),(0,a.Wm)(l,{type:"number",inputmode:"decimal",placeholder:"###.######",maxlength:e.PWA_MAX_LATLONG_LENGTH,value:r.state.longitude,onKeyup:t[1]||(t[1]=t=>e.onLongValueChange(t))},null,8,["maxlength","value"]),(0,a.Wm)(c,{size:"default",color:"secondary",slot:"end",onClick:t[2]||(t[2]=t=>e.updateLocation(!0))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{icon:r.locate},null,8,["icon"])])),_:1})])),_:1}),(0,a.Wm)(d,{class:"lat-long-controls ion-hide-sm-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[qn])),_:1}),(0,a.Wm)(l,{type:"number",inputmode:"decimal",placeholder:"###.######",maxlength:e.PWA_MAX_LATLONG_LENGTH,value:r.state.latitude,onKeyup:t[3]||(t[3]=t=>e.onLatValueChange(t))},null,8,["maxlength","value"]),(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[xn])),_:1}),(0,a.Wm)(l,{type:"number",inputmode:"decimal",placeholder:"###.######",maxlength:e.PWA_MAX_LATLONG_LENGTH,value:r.state.longitude,onKeyup:t[4]||(t[4]=t=>e.onLongValueChange(t))},null,8,["maxlength","value"]),(0,a.Wm)(c,{color:"secondary",slot:"end",onClick:t[5]||(t[5]=t=>e.updateLocation(!0))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{icon:r.locate},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.update_location),1)])),_:1})])),_:1}),(0,a.Wm)(d,{class:"address-controls"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.address),1)])),_:1}),(0,a.Wm)(l,{modelValue:r.state.address,"onUpdate:modelValue":t[6]||(t[6]=e=>r.state.address=e),placeholder:"i.e. London"},null,8,["modelValue"]),(0,a.Wm)(c,{class:"ion-hide-sm-down",color:"secondary",slot:"end",onClick:e.geocodeAddress},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{icon:r.search},null,8,["icon"]),Mn,(0,a._)("span",null,(0,h.zw)(r.labels.search),1)])),_:1},8,["onClick"]),(0,a.Wm)(c,{class:"ion-hide-sm-up",color:"secondary",slot:"end",size:"default",onClick:e.geocodeAddress},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{icon:r.search},null,8,["icon"])])),_:1},8,["onClick"])])),_:1})]),(0,a._)("div",{id:r.mapId,class:"leaflet-map-wrapper"},null,8,zn)],64)}]]);const Hn=(0,a.Uk)("How to get a location"),Vn=(0,a._)("h2",null,"Type in any address and click  ",-1),Qn=(0,a._)("h2",null,"Type in a latitude and longitude value and click  ",-1),Zn=(0,a._)("h2",null,"Click the target icon pon the map to locate your current position",-1),Jn=(0,a._)("img",{class:"locate-me-icon",alt:"target",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGODYxNjc2NTNFMjMxMUU3QjU1MDkwRjNERDQ2NjQ2MyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGODYxNjc2NjNFMjMxMUU3QjU1MDkwRjNERDQ2NjQ2MyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkY4NjE2NzYzM0UyMzExRTdCNTUwOTBGM0RENDY2NDYzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY4NjE2NzY0M0UyMzExRTdCNTUwOTBGM0RENDY2NDYzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jSL05wAAAxBJREFUeNqclk1PE1EUhu/Ulo9SaYGRVhMTF7pRBPxsiEtDCLEaEwghkT9AWKsxYhf8BiM7EzVRYzGaRl1IIBZqjXSDOw34VbW1QEtpQwguqO+p55I7QzuN3ORJZ+6c856Ze885t1qxWBRWY3NzU+TzebrUQBNP58CWtPF4PMLhcJQXoABWTExMCK/XS7jBR7AAmniuxMzMTEV/u6gyyCidTtMl2R7kX4f5KysNQ4BsNiumpqYMBrOzs734GQB+4OTpCHgPQuCl0+m0fkMJxNRHbYCiFRXyjDr3ZmxsrCMcDgsik8kYNA03sVhMip8HqyzwA9wCZ8F+5jS4Cb6zzRroIcfp6emqAY5ylpDjQ7DPYotawH22LYDjkUikcoD5+Xkbry85PC4j6AJ7y8w/YJ9YPB63GwIUCgUxMjIihoaGRA8GG/5Scp7GMd7Qn/zsKWhXnjfK5eru7g6Q1vDwsMjlsBBLS0uioaFBGt7jAKOKMy3ZsmljiawpyDWef0Q3tbW1IplMwnN5WUOxeDCng09sdFJxfFZGXPJCsWvnuS+gVdf1plQqZaMAzVShnAlys7zKmqctAmSoU7CtriTHGgIsIkCrTSm4PWU2T2P+d2zr2TgqVelhsMBvfYAN6WveWQjNsb/g+nCDb6x1BqzYuCvSp/7m8qfRq4iMctGZBy3pDeW+h39JI0XiJW3KIpfLJRRhWb1uxbkDPOeXIMKmRCCBr+x7iSbq6upKWWSni76+vn85K8RrFMpbPDiH6zvgCgt8AJeVDc2ZvuY2OOTz+eb8fv+rUmE0Nor6+vqd58Hg4GCb0tCoDTRb7AEFvMu263jRTrPejgD9/f1yPWXa0qdfBycov7k3dYKr4LOS2heoEVQNEAgE5Nt1Kn1Jsqp0WUk0GAyeopOPmqVZTzOfydFoVCQSie06wP3F8fHxAW7XR3h+EcTBE9pwCG91dXXt7kwOhULSlJZmnU5I4FM1Jicnd38ml3qATl1A/AFJrlLDIVxTU1PRV6v2t2VjY0OmsI0PGG27iOSp09JSMchfAQYAK2MGODb+Xx8AAAAASUVORK5CYII="},null,-1),Xn=(0,a._)("h2",null,"Drag the marker anywhere you want ",-1),Kn=(0,a._)("img",{width:"20",class:"marker-icon",alt:"target",src:Bn},null,-1);var $n={setup(e){const t=p().language;return{labels:b[t].labels,state:(0,m.qj)({}),...{dismiss(){i.modalController.dismiss()}},closeOutline:T.fID,locate:T.jt2}}};var er=(0,f.Z)($n,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-button"),u=(0,a.up)("ion-buttons"),c=(0,a.up)("ion-toolbar"),d=(0,a.up)("ion-header"),p=(0,a.up)("ion-title"),m=(0,a.up)("ion-card-content"),_=(0,a.up)("ion-card"),f=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"button-close",onClick:t[0]||(t[0]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:r.closeOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.close),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(f,{class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"dark",mode:"md",class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[Hn])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center"},{default:(0,a.w5)((()=>[Vn,(0,a.Wm)(l,{size:"small",color:"secondary",slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{icon:r.locate},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.update_location),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center"},{default:(0,a.w5)((()=>[Qn,(0,a.Wm)(l,{size:"small",color:"secondary",slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{icon:r.locate},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.update_location),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center"},{default:(0,a.w5)((()=>[Zn,Jn])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center"},{default:(0,a.w5)((()=>[Xn,Kn])),_:1})])),_:1})])),_:1})],64)}]]);var tr={components:{HeaderModal:Qt,GridQuestionWide:hn},props:{latitude:{type:String,required:!0},longitude:{type:String,required:!0}},setup(e){const t=p().language,n=b[t].labels,r=e.latitude&&e.latitude?[e.latitude,e.longitude].join(", "):"",s=(0,m.qj)({value:r}),o={dismiss(){i.modalController.dismiss()},updateLocation(){ne.isValidDecimalDegreesString(s.value)?i.modalController.dismiss({latitude:s.value.split(",")[0],longitude:s.value.split(",")[1]}):O.showAlert(n.invalid_value)}};return{labels:n,state:s,...o,closeOutline:T.fID,locate:T.jt2}}};var nr=(0,f.Z)(tr,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("header-modal"),u=(0,a.up)("ion-title"),c=(0,a.up)("ion-toolbar"),d=(0,a.up)("ion-card-subtitle"),p=(0,a.up)("ion-card-header"),m=(0,a.up)("ion-icon"),_=(0,a.up)("ion-button"),f=(0,a.up)("grid-question-wide"),w=(0,a.up)("ion-card-content"),g=(0,a.up)("ion-card"),E=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(l,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(E,{class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"dark",mode:"md",class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.update_location),1)])),_:1})])),_:1}),(0,a.Wm)(g,{class:"ion-margin"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"question-label ion-margin-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"ion-text-left"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.format)+": lat, long",1)])),_:1})])),_:1}),(0,a.Wm)(w,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("input",{type:"text",class:"question-input ion-margin-bottom",placeholder:"i.e. 51.509865, -0.118092","onUpdate:modelValue":t[1]||(t[1]=e=>s.state.value=e)},null,512),[[r.nr,s.state.value]]),(0,a.Wm)(f,null,{content:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[2]||(t[2]=t=>e.updateLocation())},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{slot:"start",icon:s.locate},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.update_location),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})],64)}]]),rr={components:{GridQuestionWide:hn,QuestionLabelAction:ge,LocationPwa:Yn},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,required:!0}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),u=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}}),c={};ke.setUpInputParams(u,e.inputRef,o);const d={hasError:(0,m.Fl)((()=>ne.hasQuestionError(u))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(u.error.errors).length>0?null===(e=u.error)||void 0===e||null===(t=e.errors[u.currentInputRef])||void 0===t?void 0:t.message:""})),latitude:(0,m.Fl)((()=>{var e,t;return null!==(e=u.answer)&&void 0!==e&&null!==(t=e.answer)&&void 0!==t&&t.latitude?""===u.answer.answer.latitude?s.not_located_yet:u.answer.answer.latitude:s.not_located_yet})),longitude:(0,m.Fl)((()=>{var e,t;return null!==(e=u.answer)&&void 0!==e&&null!==(t=e.answer)&&void 0!==t&&t.longitude?""===u.answer.answer.longitude?s.not_located_yet:u.answer.answer.longitude:s.not_located_yet})),accuracy:(0,m.Fl)((()=>{var e,t;return null!==(e=u.answer)&&void 0!==e&&null!==(t=e.answer)&&void 0!==t&&t.accuracy?""===u.answer.answer.accuracy?s.not_located_yet:u.answer.answer.accuracy:s.not_located_yet})),isPWA:(0,m.Fl)((()=>n.isPWA))};function _(){const e=setInterval((function(){n.deviceGeolocation.error?(clearInterval(e),navigator.geolocation.getCurrentPosition((function(e){n.deviceGeolocation={...n.deviceGeolocation,position:e.coords},O.hideProgressDialog(),n.isLocationModalActive=!1}),(function(e){O.hideProgressDialog(),n.isLocationModalActive=!1,O.showAlert(b[r].labels.location_fail,e.message)}),{maximumAge:0,timeout:it.getWatchTimeout(),enableHighAccuracy:!1})):n.deviceGeolocation.position&&(u.answer.answer.latitude=n.deviceGeolocation.position.latitude.toFixed(6),u.answer.answer.longitude=n.deviceGeolocation.position.longitude.toFixed(6),u.answer.answer.accuracy=Math.round(n.deviceGeolocation.position.accuracy),clearInterval(e),O.hideProgressDialog(),n.isLocationModalActive=!1)}),l.DELAY_MEDIUM)}(0,a.bv)((async()=>{t.emit("question-mounted")}));const f={async openModalLocationHelp(){return c.ModalLocationHelp=await i.modalController.create({cssClass:"modal-location-help",component:er,showBackdrop:!0,backdropDismiss:!0,componentProps:{}}),c.ModalLocationHelp.present()},async openModalLocationEdit(){return c.ModalLocationEdit=await i.modalController.create({cssClass:"modal-location-edit",component:nr,showBackdrop:!0,backdropDismiss:!1,componentProps:{latitude:u.answer.answer.latitude,longitude:u.answer.answer.longitude}}),c.ModalLocationEdit.onWillDismiss().then((e=>{e.data&&(u.answer.answer={latitude:e.data.latitude,longitude:e.data.longitude,accuracy:l.GEOLOCATION_DEFAULT_ACCURACY})})),c.ModalLocationEdit.present()},onPWALocationUpdate(e){u.answer.answer.latitude=e.latitude,u.answer.answer.longitude=e.longitude,u.answer.answer.accuracy=e.accuracy},async updateLocation(){if(n.deviceGeolocation={...n.deviceGeolocation,error:null},n.device.platform===l.WEB&&l.DEBUG)O.showAlert("Not availble on web debug.");else if(n.geolocationPermission){if(n.device.platform===l.WEB)return await O.showProgressDialog(b[r].labels.acquiring_position,b[r].labels.wait),n.isLocationModalActive=!0,void _();cordova.plugins.diagnostic.isLocationAvailable((async function(e){e?(await O.showProgressDialog(b[r].labels.acquiring_position,b[r].labels.wait),n.isLocationModalActive=!0,_()):(n.geolocationPermission=!1,O.showAlert(b[r].labels.location_not_available,b[r].labels.error))}),(function(e){O.showAlert(b[r].labels.location_fail,b[r].labels.error)}))}else n.device.platform!==l.WEB&&cordova.plugins.diagnostic.isLocationAvailable((function(e){e?(n.deviceGeolocation={...n.deviceGeolocation,location:!0,error:void 0,position:void 0},it.startWatching(),f.updateLocation()):(n.geolocationPermission=!1,O.showAlert(b[r].labels.location_not_available,b[r].labels.error))}),(function(e){O.showAlert(b[r].labels.location_fail,b[r].labels.error)}))}};return{labels:s,state:u,...d,...f,...e,locate:T.jt2}}};var sr=(0,f.Z)(rr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-action"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("location-pwa"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-button"),m=(0,a.up)("grid-question-wide"),_=(0,a.up)("ion-col"),f=(0,a.up)("ion-row"),w=(0,a.up)("ion-grid"),g=(0,a.up)("ion-card-content"),E=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(E,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[e.isPWA?((0,a.wg)(),(0,a.j4)(l,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{disabled:!1,action:"help",questionText:r.state.question,onOnLabelButtonClick:e.openModalLocationHelp},null,8,["questionText","onOnLabelButtonClick"])])),_:1})):((0,a.wg)(),(0,a.j4)(l,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{disabled:!1,action:"edit",questionText:r.state.question,onOnLabelButtonClick:e.openModalLocationEdit},null,8,["questionText","onOnLabelButtonClick"])])),_:1}))])),_:1}),(0,a.Wm)(g,{class:(0,h.C_)(["ion-text-center",{"ion-margin":n.isGroupInput}])},{default:(0,a.w5)((()=>[e.isPWA?((0,a.wg)(),(0,a.j4)(c,{key:0,inputRef:n.inputRef,latitude:String(r.state.answer.answer.latitude),longitude:String(r.state.answer.answer.longitude),accuracy:r.state.answer.answer.accuracy||0,onOnPwaLocationUpdate:e.onPWALocationUpdate},null,8,["inputRef","latitude","longitude","accuracy","onOnPwaLocationUpdate"])):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:1},{content:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.updateLocation())},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start",icon:r.locate},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.update_location),1)])),_:1})])),_:1})),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(w,{key:2,class:"question-location-grid"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"ion-align-items-center border-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",On,[(0,a._)("strong",null,(0,h.zw)(r.labels.latitude),1)])])),_:1}),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",kn,(0,h.zw)(e.latitude),1)])),_:1})])),_:1}),(0,a.Wm)(f,{class:"ion-align-items-center border-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",Un,[(0,a._)("strong",null,(0,h.zw)(r.labels.longitude),1)])])),_:1}),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",Wn,(0,h.zw)(e.longitude),1)])),_:1})])),_:1}),(0,a.Wm)(f,{class:"ion-align-items-center border-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",Nn,[(0,a._)("strong",null,(0,h.zw)(r.labels.accuracy),1)])])),_:1}),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",Cn,(0,h.zw)(e.accuracy),1)])),_:1})])),_:1})])),_:1})),e.hasError?((0,a.wg)(),(0,a.iD)("div",jn,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const or={key:0,class:"question-required"},ar=["placeholder","value"],ir={key:1,class:"question-error"},lr={key:2},ur=(0,a._)("hr",null,null,-1),cr=["placeholder","value"];var dr={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p(),r=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),s=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}});ke.setUpInputParams(s,e.inputRef,r);const o={hasPattern:(0,m.Fl)((()=>""!==s.pattern&&null!==s.pattern)),hasError:(0,m.Fl)((()=>ne.questionHasError((0,m.OT)(s)))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(s.error.errors).length>0?null===(e=s.error)||void 0===e||null===(t=e.errors[s.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const i={onInputValueChange(e){const t=e.target.value;s.answer.answer=ne.getSanitisedAnswer(t)},onInputValueChangeConfirm(e){const t=e.target.value;s.confirmAnswer.answer=ne.getSanitisedAnswer(t)}};return{labels:b[n.language].labels,state:s,...e,...o,...i}}};var pr=(0,f.Z)(dr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-subtitle"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("ion-card-content"),d=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(d,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.question),1)])),_:1}),e.hasPattern?((0,a.wg)(),(0,a.j4)(l,{key:0,class:"ion-text-right ion-padding"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.pattern)+": ",1),(0,a._)("span",null,"  "+(0,h.zw)(r.state.pattern),1)])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(c,{class:(0,h.C_)({"ion-margin":n.isGroupInput})},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",or,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),(0,a._)("input",{type:"tel",inputmode:"tel",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),placeholder:r.labels.type_answer_here,value:r.state.answer.answer,onInput:t[0]||(t[0]=t=>e.onInputValueChange(t))},null,42,ar),e.hasError?((0,a.wg)(),(0,a.iD)("div",ir,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),r.state.confirmAnswer.verify?((0,a.wg)(),(0,a.iD)("div",lr,[ur,(0,a._)("input",{type:"tel",inputmode:"tel",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),placeholder:r.labels.confirm_answer_here,value:r.state.confirmAnswer.answer,onInput:t[1]||(t[1]=t=>e.onInputValueChangeConfirm(t))},null,42,cr)])):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const mr={key:3,class:"question-photo-thumbnail animate__animated animate__fadeIn ion-margin-top"},_r=["src"];const fr={class:"swiper-zoom-container"},wr=["src"];var gr={props:{imageSource:{type:String,required:!0},fileSource:{type:String,required:!0}},setup(e){const t={dismiss(){i.modalController.dismiss()},share(){ie.m.share({title:"",text:"",url:"file://"+e.fileSource,dialogTitle:""})}};return{...e,sliderOptions:{zoom:!0},...t,shareSocialSharp:T.Fj6,closeOutline:T.fID}}};var hr=(0,f.Z)(gr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-button"),u=(0,a.up)("ion-buttons"),c=(0,a.up)("ion-toolbar"),d=(0,a.up)("ion-header"),p=(0,a.up)("ion-slide"),m=(0,a.up)("ion-slides"),_=(0,a.up)("ion-content"),f=(0,a.up)("ion-footer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{onClick:t[0]||(t[0]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"icon-only",icon:r.closeOutline},null,8,["icon"])])),_:1})])),_:1}),(0,a.Wm)(u,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{onClick:t[1]||(t[1]=t=>e.share())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"icon-only",icon:r.shareSocialSharp},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{options:r.sliderOptions},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",fr,[(0,a._)("img",{src:n.imageSource},null,8,wr)])])),_:1})])),_:1},8,["options"])])),_:1}),(0,a.Wm)(f)],64)}]]),Er=n(6826);async function yr({media:e,entryUuid:t,state:n,filename:r,action:s}){const o=p(),a=o.language,i=b[a].labels,u=o.tempDir;let c={},d="";async function m(){O.startForegroundService();try{const s=await Er.V1.getPhoto(c);O.stopForegroundService(),""===e[t][n.inputDetails.ref].cached?(r=""===e[t][n.inputDetails.ref].stored?ne.generateMediaFilename(t,l.QUESTION_TYPES.PHOTO):e[t][n.inputDetails.ref].stored,e[t][n.inputDetails.ref].cached=r):r=e[t][n.inputDetails.ref].cached,n.answer.answer=r,Dt.moveToAppTemporaryDir(s.path,r).then((function(){!function(e){const t=ne.generateTimestamp();n.fileSource=e,e=v.dV.convertFileSrc(e),n.imageSource=e+"?t="+t}(u+r)}))}catch(e){O.stopForegroundService(),O.hideProgressDialog(),O.showToast(e)}}await O.showProgressDialog(i.wait),o.device.platform!==l.WEB?(d="gallery"===s?Er.oK.Photos:Er.oK.Camera,c={quality:50,source:d,resultType:Er.dk.Uri,width:1024,height:1024,format:"jpeg",correctOrientation:!0},window.cordova.plugins.diagnostic.isCameraAuthorized((function(e){e?m():cordova.plugins.diagnostic.requestCameraAuthorization((function(e){o.device.platform===l.ANDROID?e===cordova.plugins.diagnostic.runtimePermissionStatus.GRANTED&&m():e&&m()}),(function(e){O.hideProgressDialog()}))}),(function(e){}))):O.hideProgressDialog()}var Ar={components:{GridQuestionNarrow:ae,QuestionLabelAction:ge,Dropzone:De},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,required:!0}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),u=n.entriesAddScope,c=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},imageSource:"",fileSource:"",pwaFileState:l.PWA_FILE_STATE.CACHED,fileError:s.unknown_error});ke.setUpInputParams(c,e.inputRef,o),(0,a.bv)((async()=>{t.emit("question-mounted")}));const d=n.tempDir,_=n.persistentDir;let f="";const w=u.entryService.entry.projectRef,g=u.entryService.entry.media,h=o.isBranch?o.branchEntryService.entry.entryUuid:u.entryService.entry.entryUuid;function E(e){const t=ne.generateTimestamp();c.fileSource=e,e=v.dV.convertFileSrc(e),c.imageSource=e+"?t="+t}g[h]=g[h]||{},Object.prototype.hasOwnProperty.call(g[h],c.inputDetails.ref)?n.isPWA?""!==g[h][c.inputDetails.ref].filenamePWA.cached?(f=g[h][c.inputDetails.ref].filenamePWA.cached,c.pwaFileState=l.PWA_FILE_STATE.CACHED):""!==g[h][c.inputDetails.ref].filenamePWA.stored&&(f=g[h][c.inputDetails.ref].filenamePWA.stored,c.pwaFileState=l.PWA_FILE_STATE.STORED):""!==g[h][c.inputDetails.ref].cached?(f=g[h][c.inputDetails.ref].cached,E(d+f)):""!==g[h][c.inputDetails.ref].stored&&(f=g[h][c.inputDetails.ref].stored,E(_+l.PHOTO_DIR+w+"/"+f)):(g[h][c.inputDetails.ref]={},g[h][c.inputDetails.ref].cached="",g[h][c.inputDetails.ref].stored="",g[h][c.inputDetails.ref].type=c.inputDetails.type,n.isPWA&&(g[h][c.inputDetails.ref].filenamePWA={},g[h][c.inputDetails.ref].filenamePWA.cached="",g[h][c.inputDetails.ref].filenamePWA.stored="")),c.answer.answer=f;const y={async openPopover(e){const t=g[h][c.inputDetails.ref];if(n.isPWA){if(""===t.filenamePWA.cached&&""===t.filenamePWA.stored)return!1}else if(""===t.cached&&""===t.stored)return!1;_e({media:g,entryUuid:h,state:c,e:e,mediaType:l.QUESTION_TYPES.PHOTO})},takePicture(e){n.device.platform!==l.WEB&&yr({media:g,entryUuid:h,state:c,filename:f,action:e})},async openViewer(){return(await i.modalController.create({component:hr,componentProps:{imageSource:c.imageSource,fileSource:c.fileSource}})).present()},onImageLoad(){O.hideProgressDialog()},onImageError(e){O.hideProgressDialog()},onFileLoadedPWA(e){c.answer.answer=e},onFileDroppedPWA(e){g[h][c.inputDetails.ref].filenamePWA.cached=e,c.pwaFileState=l.PWA_FILE_STATE.CACHED,c.answer.answer=e},onFileErrorPWA(e){c.fileError=e}},A={isFileAvailable:(0,m.Fl)((()=>{const e=g[h][c.inputDetails.ref];return""!==e.cached||""!==e.stored||""!==e.filenamePWA})),isPWA:(0,m.Fl)((()=>n.isPWA))};return{labels:s,state:c,entryUuid:h,...y,...e,...A,camera:T.nSy,images:T.WcA}}};var Sr=(0,f.Z)(Ar,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-action"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("dropzone"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-button"),m=(0,a.up)("grid-question-narrow"),_=(0,a.up)("ion-card-content"),f=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(f,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{disabled:!e.isFileAvailable,action:"media",questionText:r.state.question,answer:r.state.answer.answer,onOnLabelButtonClick:e.openPopover},null,8,["disabled","questionText","answer","onOnLabelButtonClick"])])),_:1})])),_:1}),(0,a.Wm)(_,{class:(0,h.C_)(["ion-text-center",{"ion-margin":n.isGroupInput}])},{default:(0,a.w5)((()=>[e.isPWA?((0,a.wg)(),(0,a.j4)(c,{filestate:r.state.pwaFileState,filename:r.state.answer.answer,key:r.state.answer.answer,type:r.state.inputDetails.type,inputRef:r.state.inputDetails.ref,uuid:r.entryUuid,fileError:r.state.fileError,onFileLoaded:e.onFileLoadedPWA,onFileDropped:e.onFileDroppedPWA,onFileError:e.onFileErrorPWA},null,8,["filestate","filename","type","inputRef","uuid","fileError","onFileLoaded","onFileDropped","onFileError"])):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:1},{content:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.takePicture("camera"))},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start",icon:r.camera},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.take),1)])),_:1})])),_:1})),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:2},{content:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[1]||(t[1]=t=>e.takePicture("gallery"))},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start",icon:r.images},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.pick),1)])),_:1})])),_:1})),""!==r.state.imageSource?((0,a.wg)(),(0,a.iD)("div",mr,[(0,a._)("img",{src:r.state.imageSource,onClick:t[2]||(t[2]=t=>e.openViewer()),onLoad:t[3]||(t[3]=t=>e.onImageLoad())},null,40,_r)])):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const Tr={key:0,class:"question-required half-padding"},br={key:1,class:"question-error half-padding-bottom"};var Rr={components:{QuestionLabelPossibleAnswers:Kt,ListPossibleAnswersRadio:Ht},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean}},emits:["question-mounted"],setup(e,t){const n=p(),{isGroupInput:r}=(0,m.OT)(e),s=(0,m.OT)(e.type),o=(0,a.f3)("entriesAddState"),i=(0,m.qj)({selectedAnswers:[],inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}}),l={questionType:s,isGroupInput:r};ke.setUpInputParams(i,e.inputRef,o),""!==i.answer.answer&&(i.selectedAnswers=[i.answer.answer]);const u={hasError:(0,m.Fl)((()=>ne.questionHasError((0,m.OT)(i)))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(i.error.errors).length>0?null===(e=i.error)||void 0===e||null===(t=e.errors[i.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const c={onSelectedAnswers(e){e.length>0?(i.answer.answer=e[0],i.selectedAnswers=e):(i.answer.answer="",i.selectedAnswers=[])}};return{labels:b[n.language].labels,state:i,...u,...l,...c}}};var Ir=(0,f.Z)(Rr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-possible-answers"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-header"),c=(0,a.up)("list-possible-answers-radio"),d=(0,a.up)("ion-card-content"),p=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(p,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{questionText:r.state.question,questionType:e.questionType,isGroupInput:n.isGroupInput,possibleAnswers:r.state.inputDetails.possible_answers,selectedAnswers:r.state.selectedAnswers,onOnSelectedAnswers:e.onSelectedAnswers},null,8,["questionText","questionType","isGroupInput","possibleAnswers","selectedAnswers","onOnSelectedAnswers"])])),_:1})])),_:1}),(0,a.Wm)(d,{class:"force-no-padding"},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",Tr,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),(0,a.Wm)(c,{possibleAnswers:r.state.inputDetails.possible_answers,selectedAnswers:r.state.selectedAnswers,isGroupInput:n.isGroupInput,hasError:e.hasError,onOnSelectedAnswers:e.onSelectedAnswers},null,8,["possibleAnswers","selectedAnswers","isGroupInput","hasError","onOnSelectedAnswers"]),e.hasError?((0,a.wg)(),(0,a.iD)("div",br,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])),_:1})])),_:1},8,["class"])}]]);const vr=["innerHTML"];var Pr={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p(),r=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),s=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}});ke.setUpInputParams(s,e.inputRef,r);const o={html:(0,m.Fl)((()=>ne.htmlDecode(s.question)))};(0,a.bv)((async()=>{t.emit("question-mounted")}));return{labels:b[n.language].labels,state:s,...e,...o}}};var Dr=(0,f.Z)(Pr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-content"),l=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(l,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"question-readme-content"},{default:(0,a.w5)((()=>[(0,a._)("div",{innerHTML:e.html,class:(0,h.C_)({"readme-padding":n.isGroupInput})},null,10,vr)])),_:1})])),_:1},8,["class"])}]]);const Or={key:0,class:"question-required"},kr={key:1,class:"question-error"},Ur={class:"ion-activatable ripple-parent"};var Wr={components:{GridQuestionNarrow:ae},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p().language,r=b[n].labels,{type:s,isGroupInput:o}=(0,m.OT)(e),u=(0,a.f3)("entriesAddState"),c=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:[],picks:[]}),d={ModalSearch:{}};ke.setUpInputParams(c,e.inputRef,u);const _=ne.buildPossibleAnswersHashMap(c.inputDetails.possible_answers);c.answer.answer.length>0&&(c.picks=[],c.answer.answer.forEach((e=>{c.picks.push({ref:e,answer:_[e]})}))),(0,a.bv)((async()=>{t.emit("question-mounted")}));const f={hasPattern:(0,m.Fl)((()=>""!==c.pattern&&null!==c.pattern)),hasError:(0,m.Fl)((()=>ne.hasQuestionError(c))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(c.error.errors).length>0?null===(e=c.error)||void 0===e||null===(t=e.errors[c.currentInputRef])||void 0===t?void 0:t.message:""}))},w={test(){},async openSearch(){await O.showProgressDialog(b[n].labels.wait),d.ModalPossibleAnswers=await i.modalController.create({cssClass:"modal-search",component:Jt,showBackdrop:!0,backdropDismiss:!1,componentProps:{selectedAnswers:c.answer.answer,questionType:s,isGroupInput:o,possibleAnswers:c.inputDetails.possible_answers}}),d.ModalPossibleAnswers.onWillDismiss().then((e=>{c.answer.answer=e.data,c.picks=[],c.answer.answer.forEach((e=>{c.picks.push({ref:e,answer:_[e]})}))})),d.ModalPossibleAnswers.present().then(setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_FAST))},removePick(e){setTimeout((()=>{s===l.QUESTION_TYPES.SEARCH_SINGLE?(c.answer.answer=[],c.picks=[]):(c.picks.splice(e,1),c.answer.answer.splice(e,1))}),l.DELAY_FAST)}};return{labels:r,state:c,...f,...w,...e,trash:T._Ij,search:T.yC4}}};var Nr=(0,f.Z)(Wr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-header"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("grid-question-narrow"),p=(0,a.up)("ion-label"),m=(0,a.up)("ion-ripple-effect"),_=(0,a.up)("ion-item"),f=(0,a.up)("ion-col"),w=(0,a.up)("ion-row"),g=(0,a.up)("ion-grid"),E=(0,a.up)("ion-card-content"),y=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(y,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.question),1)])),_:1})])),_:1}),(0,a.Wm)(E,{class:(0,h.C_)(["ion-text-center",{"ion-margin":n.isGroupInput}])},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",Or,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),e.hasError?((0,a.wg)(),(0,a.iD)("div",kr,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),(0,a.Wm)(d,null,{content:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.openSearch())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:r.search},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.search),1)])),_:1})])),_:1}),(0,a.Wm)(g,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[r.state.answer.answer.length>0?((0,a.wg)(),(0,a.j4)(w,{key:0,class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{"size-xs":"12","offset-xs":"0","size-sm":"10","offset-sm":"1","size-md":"8","offset-md":"2","size-lg":"8","offset-lg":"2",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.picks,((t,n)=>((0,a.wg)(),(0,a.j4)(_,{key:t.ref},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(t.answer),1)])),_:2},1024),(0,a._)("div",Ur,[(0,a.Wm)(u,{onClick:t=>e.removePick(n),class:"icon-danger question-search-remove-pick",icon:r.trash,slot:"end"},null,8,["onClick","icon"]),(0,a.Wm)(m,{type:"unbounded"})])])),_:2},1024)))),128))])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1},8,["class"])])),_:1},8,["class"])}]]);const Cr=(0,a.Uk)(" > "),jr=["placeholder","value"],Lr={key:1,class:"question-error"},Fr={key:2},qr=(0,a._)("hr",null,null,-1),xr=["placeholder","value"];const Mr={key:1,class:"saved-answers-list"},zr={key:2,class:"animate__animated animate__fadeIn"},Br={key:3,class:"animate__animated animate__fadeIn"};const Gr=["onClick"],Yr=["checked"];var Hr={props:{savedAnswers:{type:Array,required:!0}},emits:["on-selected-answer"],setup(e,t){const n=p().language,r=b[n].labels,{savedAnswers:s}=(0,m.BK)(e),o=(0,m.qj)({selectedAnswer:"",savedAnswersChunk:s.value}),a={toggleCheckbox(e){o.selectedAnswer===e?o.selectedAnswer="":o.selectedAnswer=e,t.emit("on-selected-answer",o.selectedAnswer)},loadSavedAnswersChunk(e){function t(){const e=l.ANSWERS_PER_PAGE,t=o.savedAnswersChunk.length+e;for(let n=t-e;n<t&&void 0!==s[n];n++)o.savedAnswersChunk.push(s[n])}0===o.savedAnswersChunk.length?t():setTimeout((()=>{t(),e&&e.target.complete(),o.savedAnswersChunk.length===s.length&&e&&(e.target.disabled=!0)}),l.DELAY_MEDIUM)}};return a.loadSavedAnswersChunk(),{labels:r,state:o,...e,...a,PARAMETERS:l}}};var Vr={components:{ListSavedAnswers:(0,f.Z)(Hr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-col"),u=(0,a.up)("ion-row"),c=(0,a.up)("ion-grid"),d=(0,a.up)("ion-list"),p=(0,a.up)("ion-infinite-scroll-content"),m=(0,a.up)("ion-infinite-scroll");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(d,{class:"saved-answers-list ion-no-padding"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.savedAnswersChunk,((t,n)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,h.C_)(["saved-answer-item animate__animated animate__fadeIn",r.state.selectedAnswer===t?"checkbox-checked":""]),key:n,onClick:n=>e.toggleCheckbox(t)},[(0,a.Wm)(c,{class:"half-padding-start radio-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"ion-align-items-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{"size-xs":"10","size-sm":"11","size-md":"11","size-lg":"11","size-xl":"11"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"saved-answer-label"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(t),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(l,{"size-xs":"2","size-sm":"1","size-md":"1","size-lg":"1","size-xl":"1",class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("input",{type:"checkbox",class:"saved-answer-checkbox",color:"secondary",checked:r.state.selectedAnswer===t},null,8,Yr)])])),_:2},1024)])),_:2},1024)])),_:2},1024)],10,Gr)))),128))])),_:1}),(0,a.Wm)(m,{class:"ion-margin-top",onIonInfinite:t[0]||(t[0]=t=>e.loadSavedAnswersChunk(t)),threshold:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{disabled:n.savedAnswers.length<=r.PARAMETERS.ANSWERS_PER_PAGE,"loading-spinner":"crescent","loading-text":r.labels.loading},null,8,["disabled","loading-text"])])),_:1})],64)}]]),HeaderModal:Qt},props:{projectRef:{type:String,required:!0},formRef:{type:String,required:!0},inputRef:{type:String,required:!0},isBranch:{type:Boolean,required:!0}},setup(e){const t=p().language,n=b[t].labels,{projectRef:r,formRef:s,inputRef:o,isBranch:a}=(0,m.OT)(e);let u;const c=(0,m.qj)({isFetching:!1,selectedAnswer:"",searchTerm:"",hits:[]}),d={onSelectedAnswer(e){c.selectedAnswer=e},dismiss(){i.modalController.dismiss(c.selectedAnswer)},filterSavedAnswers(e){c.searchTerm=e.target.value.toLowerCase().trim(),c.searchTerm.length<3||(c.isFetching=!0,clearTimeout(u),""===c.searchTerm&&(c.hits=[],setTimeout((()=>(c.hits=[],c.isFetching=!1,!1)),l.DELAY_FAST)),u=setTimeout((function(){c.hits=[];let e=-1;!function t(){if(e++,e>l.MAX_SAVED_ANSWERS)return setTimeout((()=>{c.isFetching=!1}),l.DELAY_MEDIUM),!1;I.getSavedAnswers(r,s,a,e).then((e=>{if(0===e.rows.length)return setTimeout((()=>{c.isFetching=!1}),l.DELAY_MEDIUM),!1;{const n=JSON.parse(e.rows.item(0).answers)[o];n.answer.toLowerCase().includes(c.searchTerm)&&(c.hits.includes(n.answer)||c.hits.push(n.answer)),t()}}))}()}),l.DELAY_LONG))},loadSavedAnswers(){let e=-1;!function t(){if(e++,e>l.MAX_SAVED_ANSWERS)return setTimeout((()=>{c.isFetching=!1}),l.DELAY_MEDIUM),!1;I.getSavedAnswers(r,s,a,e).then((e=>{if(0===e.rows.length)return setTimeout((()=>{c.isFetching=!1}),l.DELAY_MEDIUM),!1;{const n=JSON.parse(e.rows.item(0).answers)[o];""!==n.answer.trim()&&(c.hits.includes(n.answer)||c.hits.push(n.answer)),t()}}))}()}};return d.loadSavedAnswers(),{labels:n,state:c,...e,...d}}};var Qr=(0,f.Z)(Vr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("ion-searchbar"),u=(0,a.up)("ion-item-divider"),c=(0,a.up)("ion-spinner"),d=(0,a.up)("list-saved-answers"),p=(0,a.up)("ion-card-title"),m=(0,a.up)("ion-card-header"),_=(0,a.up)("ion-card"),f=(0,a.up)("ion-label"),w=(0,a.up)("ion-item"),g=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{sticky:"",color:"dark",class:"saved-answers-serchbar-wrapper"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{animated:"",debounce:"500",placeholder:r.labels.type_hint,onIonChange:e.filterSavedAnswers},null,8,["placeholder","onIonChange"])])),_:1}),r.state.isFetching?((0,a.wg)(),(0,a.j4)(c,{key:0,class:"spinner-search-saved-answers",name:"crescent"})):(0,a.kq)("",!0),!r.state.isFetching&&r.state.hits.length>0?((0,a.wg)(),(0,a.iD)("div",Mr,[(0,a.Wm)(d,{savedAnswers:r.state.hits,onOnSelectedAnswer:e.onSelectedAnswer},null,8,["savedAnswers","onOnSelectedAnswer"])])):(0,a.kq)("",!0),!r.state.isFetching&&0===r.state.hits.length&&r.state.searchTerm.length>=3?((0,a.wg)(),(0,a.iD)("div",zr,[(0,a.Wm)(_,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.no_hits_found),1)])),_:1})])),_:1})])),_:1})])):(0,a.kq)("",!0),r.state.isFetching||0!==r.state.hits.length||0!==r.state.searchTerm.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Br,[(0,a.Wm)(w,{class:"ion-text-center ion-margin-bottom",lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.no_entries_found),1)])),_:1})])),_:1})]))])),_:1})],64)}]]),Zr={components:{QuestionLabelAction:ge},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p().language,r=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),s=b[n].labels,o=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}}),u={};ke.setUpInputParams(o,e.inputRef,r);const c={hasPattern:(0,m.Fl)((()=>""!==o.pattern&&null!==o.pattern)),hasError:(0,m.Fl)((()=>ne.questionHasError(o))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(o.error.errors).length>0?null===(e=o.error)||void 0===e||null===(t=e.errors[o.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const d={async openModalSavedAnswer(){const e=B.getProjectRef(),t=z.formRef,s=o.inputDetails.ref,a=r.questionParams.isBranch;await O.showProgressDialog(b[n].labels.wait),u.ModalSavedAnswers=await i.modalController.create({cssClass:"modal-search",component:Qr,showBackdrop:!0,backdropDismiss:!1,componentProps:{projectRef:e,formRef:t,inputRef:s,isBranch:a}}),u.ModalSavedAnswers.onWillDismiss().then((e=>{""!==e.data&&(o.answer.answer=e.data)})),u.ModalSavedAnswers.present().then(setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_FAST))},onInputValueChange(e){const t=e.target.value;o.answer.answer=ne.getSanitisedAnswer(t)},onInputValueChangeConfirm(e){const t=e.target.value;o.confirmAnswer.answer=ne.getSanitisedAnswer(t)}};return{labels:s,state:o,...e,...c,...d}}};var Jr=(0,f.Z)(Zr,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-action"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-subtitle"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("ion-card-content"),p=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(p,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{disabled:!1,action:"search",questionText:r.state.question,answer:r.state.answer.answer,onOnLabelButtonClick:e.openModalSavedAnswer},null,8,["questionText","answer","onOnLabelButtonClick"])])),_:1}),e.hasPattern?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"ion-text-right ion-padding"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.pattern)+": ",1),(0,a._)("span",null,"  "+(0,h.zw)(r.state.pattern),1),Cr])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(d,{class:(0,h.C_)({"ion-margin":n.isGroupInput})},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,h.C_)(["question-required",{"ion-padding-start":n.isGroupInput}])},(0,h.zw)(r.labels.required),3)):(0,a.kq)("",!0),(0,a._)("input",{type:"text",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),placeholder:r.labels.type_answer_here,value:r.state.answer.answer,onInput:t[0]||(t[0]=t=>e.onInputValueChange(t))},null,42,jr),e.hasError?((0,a.wg)(),(0,a.iD)("div",Lr,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),r.state.confirmAnswer.verify?((0,a.wg)(),(0,a.iD)("div",Fr,[qr,(0,a._)("input",{type:"text",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),placeholder:r.labels.confirm_answer_here,value:r.state.confirmAnswer.answer,onInput:t[1]||(t[1]=t=>e.onInputValueChangeConfirm(t))},null,42,xr)])):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const Xr=(0,a.Uk)(" > "),Kr={key:0,class:"question-required"},$r=["placeholder","value"],es={key:1,class:"question-error"},ts={key:2},ns=(0,a._)("hr",null,null,-1),rs=["placeholder","value"];var ss={components:{QuestionLabelAction:ge},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,required:!0}},emits:["question-mounted"],setup(e,t){const n=p(),r=(e.type.toUpperCase(),b[n.language].labels),s=(0,a.f3)("entriesAddState"),o=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""}}),u={};ke.setUpInputParams(o,e.inputRef,s);const c={hasPattern:(0,m.Fl)((()=>""!==o.pattern&&null!==o.pattern)),hasError:(0,m.Fl)((()=>ne.hasQuestionError(o))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(o.error.errors).length>0?null===(e=o.error)||void 0===e||null===(t=e.errors[o.currentInputRef])||void 0===t?void 0:t.message:""}))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const d={async openModalSavedAnswer(){const e=B.getProjectRef(),t=z.formRef,n=o.inputDetails.ref,a=s.questionParams.isBranch;await O.showProgressDialog(r.wait),u.ModalSavedAnswers=await i.modalController.create({cssClass:"modal-search",component:Qr,showBackdrop:!0,backdropDismiss:!1,componentProps:{projectRef:e,formRef:t,inputRef:n,isBranch:a}}),u.ModalSavedAnswers.onWillDismiss().then((e=>{""!==e.data&&(o.answer.answer=e.data)})),u.ModalSavedAnswers.present().then(setTimeout((()=>{O.hideProgressDialog()}),l.DELAY_FAST))},onInputValueChange(e){const t=e.target.value;o.answer.answer=ne.getSanitisedAnswer(t)},onInputValueChangeConfirm(e){const t=e.target.value;o.confirmAnswer.answer=ne.getSanitisedAnswer(t)}};return{labels:r,state:o,...c,...d,...e}}};var os=(0,f.Z)(ss,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("question-label-action"),l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-subtitle"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("ion-card-content"),p=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(p,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{disabled:!1,action:"search",questionText:r.state.question,answer:r.state.answer.answer,onOnLabelButtonClick:e.openModalSavedAnswer},null,8,["questionText","answer","onOnLabelButtonClick"])])),_:1}),e.hasPattern?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"ion-text-right ion-padding"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.pattern)+" ",1),(0,a._)("span",null,(0,h.zw)(r.state.pattern),1),Xr])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(d,{class:(0,h.C_)({"ion-margin":n.isGroupInput})},{default:(0,a.w5)((()=>[r.state.required?((0,a.wg)(),(0,a.iD)("div",Kr,(0,h.zw)(r.labels.required),1)):(0,a.kq)("",!0),(0,a._)("textarea",{rows:"5",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),placeholder:r.labels.type_answer_here,value:r.state.answer.answer,onInput:t[0]||(t[0]=t=>e.onInputValueChange(t))},null,42,$r),e.hasError?((0,a.wg)(),(0,a.iD)("div",es,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0),r.state.confirmAnswer.verify?((0,a.wg)(),(0,a.iD)("div",ts,[ns,(0,a._)("textarea",{rows:"5",class:(0,h.C_)(["question-input",{"has-error":e.hasError}]),placeholder:r.labels.confirm_answer_here,value:r.state.confirmAnswer.answer,onInput:t[1]||(t[1]=t=>e.onInputValueChangeConfirm(t))},null,42,rs)])):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const as={key:0,class:"question-required"},is={class:"datetime-value"},ls={class:"datetime-value"},us={key:3,class:"question-error"};var cs={props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,default:!1}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),i=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},time:{answer:"",answerPicker:""},userFormattedTime:"",inputFormattedTime:null,pickerFormattedTime:""});let u;ke.setUpInputParams(i,e.inputRef,o),i.datetime_format=i.inputDetails.datetime_format,i.time.answer="",i.time.answerPicker="",""===i.answer.answer?i.userFormattedTime="":(i.userFormattedTime=ne.getUserFormattedTime(i.answer.answer,i.inputDetails.datetime_format),i.inputFormattedTime=ne.getInputFormattedTime(i.answer.answer,i.inputDetails.datetime_format),i.pickerFormattedTime=ne.getPickerFormattedTime(i.answer.answer,i.inputDetails.datetime_format),i.time.answer=i.inputFormattedTime,i.time.answerPicker=i.pickerFormattedTime),i.inputDetails.set_to_current_datetime&&""===i.answer.answer&&(u=new Date,i.inputFormattedTime=ne.getInputFormattedTime(u.toISOString(),i.inputDetails.datetime_format),i.pickerFormattedTime=ne.getPickerFormattedTime(u.toISOString(),i.inputDetails.datetime_format),i.answer.answer=ne.getISOTime(u,i.inputDetails.datetime_format),i.time.answer=i.inputFormattedTime,i.time.answerPicker=i.pickerFormattedTime,i.userFormattedTime=ne.getUserFormattedTime(i.answer.answer,i.inputDetails.datetime_format));const c={hasError:(0,m.Fl)((()=>ne.hasQuestionError(i))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(i.error.errors).length>0?null===(e=i.error)||void 0===e||null===(t=e.errors[i.currentInputRef])||void 0===t?void 0:t.message:""})),hasSeconds:(0,m.Fl)((()=>[l.TIME_FORMAT_1,l.TIME_FORMAT_2,l.TIME_FORMAT_5].includes(i.inputDetails.datetime_format))),displayFormat:(0,m.Fl)((()=>i.inputDetails.datetime_format===l.TIME_FORMAT_2?i.inputDetails.datetime_format.replace("hh","HH"):i.inputDetails.datetime_format)),isANDROID:(0,m.Fl)((()=>n.device.platform===l.ANDROID)),isIOS:(0,m.Fl)((()=>n.device.platform===l.IOS)),isPWA:(0,m.Fl)((()=>n.isPWA))};(0,a.bv)((async()=>{t.emit("question-mounted")}));const d={openTimePicker(){let e,t,n,r,o;const a={hours:ne.getHoursColumnPicker(),minutes:ne.getMinutesColumnPicker(),seconds:ne.getSecondsColumnPicker()};i.time.answerPicker?i.inputDetails.datetime_format===l.TIME_FORMAT_5?(t=parseInt(i.time.answerPicker.slice(0,2)),n=parseInt(i.time.answerPicker.slice(3,5))):(e=parseInt(i.time.answerPicker.slice(0,2)),t=parseInt(i.time.answerPicker.slice(3,5)),n=parseInt(i.time.answerPicker.slice(6,8))):(u=new Date,e=u.getHours(),t=u.getMinutes(),n=u.getSeconds()),i.inputDetails.datetime_format===l.TIME_FORMAT_5?(o=[[a.minutes],[a.seconds]],r={0:a.minutes[t].description,1:a.seconds[n].description}):(o=[[a.hours],[a.minutes],[a.seconds]],r={0:a.hours[e].description,1:a.minutes[t].description,2:a.seconds[n].description});const c={title:i.inputDetails.datetime_format,items:o,wrapWheelText:!0,positiveButtonText:s.confirm,negativeButtonText:s.dismiss,defaultItems:r};window.SelectorCordovaPlugin.showSelector(c,(function(r){i.inputDetails.datetime_format===l.TIME_FORMAT_5?(e=0,t=r[0].description,n=r[1].description):(e=r[0].description,t=r[1].description,n=r[2].description);const s=new Date;s.setHours(e,t,n),i.answer.answer=ne.getISOTime(s,i.inputDetails.datetime_format),i.userFormattedTime=ne.getUserFormattedTime(i.answer.answer,i.inputDetails.datetime_format),i.inputDetails.datetime_format===l.TIME_FORMAT_5?i.time.answerPicker=t+":"+n:i.time.answerPicker=e+":"+t+":"+n}),(function(){}))},clearTime(){i.answer.answer="",i.answer.was_jumped=!1,i.userFormattedTime="",i.inputFormattedTime=null,i.pickerFormattedTime="",i.time.answer="",i.time.answerPicker=""},getTime(){if(""===i.time.answer)return d.clearTime(),!1;const e=new Date,t=i.time.answer.substring(0,2),n=i.time.answer.substring(3,5),r=i.time.answer.substring(6,8);e.setHours(t,n,r),i.answer.answer=ne.getISOTime(e,i.inputDetails.datetime_format),i.inputFormattedTime=ne.getInputFormattedTime(i.answer.answer),i.userFormattedTime=ne.getUserFormattedTime(i.answer.answer,i.inputDetails.datetime_format)}};return{labels:s,state:i,...c,...d,...e,closeOutline:T.fID,timeOutline:T.bdY}}};var ds=(0,f.Z)(cs,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-card-title"),u=(0,a.up)("ion-card-subtitle"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-chip"),m=(0,a.up)("ion-card-content"),_=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(_,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.state.question),1)])),_:1}),(0,a.Wm)(u,{class:"ion-text-right"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.format)+": "+(0,h.zw)(s.state.inputDetails.datetime_format),1)])),_:1})])),_:1}),(0,a.Wm)(m,{class:(0,h.C_)([{"ion-margin":n.isGroupInput},"ion-text-center"])},{default:(0,a.w5)((()=>[s.state.required?((0,a.wg)(),(0,a.iD)("div",as,(0,h.zw)(s.labels.required),1)):(0,a.kq)("",!0),e.isPWA||(e.isANDROID||e.isIOS)&&!e.hasSeconds?((0,a.wg)(),(0,a.j4)(p,{key:1,class:(0,h.C_)(["chip-datetimepicker web-datetime",{"has-error":e.hasError,"web-picker":e.isPWA,"device-picker":!e.isPWA}]),outline:"",mode:"ios"},{default:(0,a.w5)((()=>[(0,a._)("div",is,[e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(d,{key:0,class:"time-icon",size:"small",icon:s.timeOutline},null,8,["icon"])),e.hasSeconds?(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:1,type:"time",step:"1",class:"question-input question-datetimepicker","onUpdate:modelValue":t[0]||(t[0]=e=>s.state.time.answer=e),onChange:t[1]||(t[1]=t=>e.getTime())},null,544)),[[r.nr,s.state.time.answer,void 0,{trim:!0}]]):(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:2,type:"time",class:"question-input question-datetimepicker","onUpdate:modelValue":t[2]||(t[2]=e=>s.state.time.answer=e),onChange:t[3]||(t[3]=t=>e.getTime())},null,544)),[[r.nr,s.state.time.answer,void 0,{trim:!0}]])]),(0,a.Wm)(d,{size:"large",icon:s.closeOutline,onClick:t[4]||(t[4]=t=>e.clearTime(!1))},null,8,["icon"])])),_:1},8,["class"])):(0,a.kq)("",!0),(e.isANDROID||e.isIOS)&&e.hasSeconds?((0,a.wg)(),(0,a.j4)(p,{key:2,class:(0,h.C_)(["chip-datetimepicker device-datetime",{"has-error":e.hasError}]),outline:"",mode:"ios"},{default:(0,a.w5)((()=>[(0,a._)("div",ls,[(0,a.Wm)(d,{class:"time-icon",size:"small",icon:s.timeOutline},null,8,["icon"]),(0,a.wy)((0,a._)("input",{readonly:"",type:"text",class:"question-input question-datetimepicker question-datetimepicker-native","onUpdate:modelValue":t[5]||(t[5]=e=>s.state.time.answerPicker=e),onClick:t[6]||(t[6]=t=>e.openTimePicker())},null,512),[[r.nr,s.state.time.answerPicker,void 0,{trim:!0}]])]),(0,a.Wm)(d,{size:"large",icon:s.closeOutline,onClick:t[7]||(t[7]=t=>e.clearTime(!0))},null,8,["icon"])])),_:1},8,["class"])):(0,a.kq)("",!0),(0,a._)("div",null,[(0,a._)("div",null,[(0,a.Uk)((0,h.zw)(s.labels.time_selected_is)+" ",1),(0,a._)("strong",null,(0,h.zw)(""===s.state.userFormattedTime?" --- ":s.state.userFormattedTime),1)])]),e.hasError?((0,a.wg)(),(0,a.iD)("div",us,(0,h.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])),_:1},8,["class"])])),_:1},8,["class"])}]]);const ps=["src"];var ms={components:{GridQuestionNarrow:ae,QuestionLabelAction:ge,Dropzone:De},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0},isGroupInput:{type:Boolean,required:!0}},emits:["question-mounted"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),i=n.entriesAddScope,u=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},fileSource:"",pwaFileState:l.PWA_FILE_STATE.CACHED});ke.setUpInputParams(u,e.inputRef,o),(0,a.bv)((async()=>{t.emit("question-mounted")}));const c=n.tempDir,d=n.persistentDir;let _="",f="";const w=i.entryService.entry.projectRef,g=i.entryService.entry.media,h=o.isBranch?o.branchEntryService.entry.entryUuid:i.entryService.entry.entryUuid;g[h]=g[h]||{},Object.prototype.hasOwnProperty.call(g[h],u.inputDetails.ref)?n.isPWA?""!==g[h][u.inputDetails.ref].filenamePWA.cached?(_=g[h][u.inputDetails.ref].filenamePWA.cached,u.pwaFileState=l.PWA_FILE_STATE.CACHED):""!==g[h][u.inputDetails.ref].filenamePWA.stored&&(_=g[h][u.inputDetails.ref].filenamePWA.stored,u.pwaFileState=l.PWA_FILE_STATE.STORED):""!==g[h][u.inputDetails.ref].cached?(_=g[h][u.inputDetails.ref].cached,f=c+_,u.fileSource=v.dV.convertFileSrc(f)):""!==g[h][u.inputDetails.ref].stored&&(_=g[h][u.inputDetails.ref].stored,f=d+l.VIDEO_DIR+w+"/"+_,u.fileSource=v.dV.convertFileSrc(f)):(g[h][u.inputDetails.ref]={},g[h][u.inputDetails.ref].cached="",g[h][u.inputDetails.ref].stored="",g[h][u.inputDetails.ref].type=u.inputDetails.type,n.isPWA&&(g[h][u.inputDetails.ref].filenamePWA={},g[h][u.inputDetails.ref].filenamePWA.cached="",g[h][u.inputDetails.ref].filenamePWA.stored="")),u.answer.answer=_;const E={async openPopover(e){const t=g[h][u.inputDetails.ref];if(n.isPWA){if(""===t.filenamePWA.cached&&""===t.filenamePWA.stored)return!1}else if(""===t.cached&&""===t.stored)return!1;_e({media:g,entryUuid:h,state:u,e:e,mediaType:l.QUESTION_TYPES.VIDEO})},shoot(){n.device.platform!==l.WEB&&async function({media:e,entryUuid:t,state:n,filename:r}){const s=p(),o=s.language,a=b[o].labels,i=s.tempDir;function u(e){const t=e[0].fullPath;O.stopForegroundService(),Dt.moveToAppTemporaryDir(t,r).then((function(){const e=ne.generateTimestamp();n.fileSource=v.dV.convertFileSrc(i+r)+"?t="+e,O.hideProgressDialog(),O.showToast(b[o].labels.video_saved)}),(function(){O.hideProgressDialog(),O.showAlert(b[o].labels.cannot_save_file)}))}function c(r){O.stopForegroundService(),3!==r.code&&(e[t][n.inputDetails.ref].cached="",n.answer.answer=""),O.showToast(r.message),O.hideProgressDialog()}if(s.device.platform!==l.WEB){await O.showProgressDialog(a.wait);const i={limit:1};""===e[t][n.inputDetails.ref].cached?(r=""===e[t][n.inputDetails.ref].stored?ne.generateMediaFilename(t,l.QUESTION_TYPES.VIDEO):e[t][n.inputDetails.ref].stored,e[t][n.inputDetails.ref].cached=r,n.answer.answer=r):r=e[t][n.inputDetails.ref].cached,s.device.platform===l.ANDROID?(O.startForegroundService(),cordova.plugins.diagnostic.requestRuntimePermission((function(e){e===cordova.plugins.diagnostic.runtimePermissionStatus.GRANTED?cordova.plugins.diagnostic.requestRuntimePermission((function(e){e===cordova.plugins.diagnostic.runtimePermissionStatus.GRANTED?window.navigator.device.capture.captureVideo(u,c,i):(O.showAlert(b[o].labels.permission_denied),O.hideProgressDialog())}),(function(e){O.hideProgressDialog()}),cordova.plugins.diagnostic.runtimePermission.WRITE_EXTERNAL_STORAGE):(O.showAlert(b[o].labels.permission_denied),O.stopForegroundService(),O.hideProgressDialog())}),(function(e){O.stopForegroundService(),O.hideProgressDialog()}),cordova.plugins.diagnostic.runtimePermission.CAMERA)):window.cordova.plugins.diagnostic.isCameraAuthorized((function(){window.navigator.device.capture.captureVideo(u,c,i)}),(function(e){O.showToast(e.message),O.hideProgressDialog()}))}}({media:g,entryUuid:h,state:u,filename:_})},onFileLoadedPWA(e){u.answer.answer=e},onFileDroppedPWA(e){g[h][u.inputDetails.ref].filenamePWA.cached=e,u.pwaFileState=l.PWA_FILE_STATE.CACHED,u.answer.answer=e},onFileErrorPWA(e){u.fileError=e}},y={isFileAvailable:(0,m.Fl)((()=>{const e=g[h][u.inputDetails.ref];return""!==e.cached||""!==e.stored||""!==e.filenamePWA})),isPWA:(0,m.Fl)((()=>n.isPWA))};return{labels:s,state:u,entryUuid:h,...E,...e,...y,videocam:T.HIy}}};var _s=(0,f.Z)(ms,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("question-label-action"),u=(0,a.up)("ion-card-title"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("dropzone"),p=(0,a.up)("ion-icon"),m=(0,a.up)("ion-button"),_=(0,a.up)("grid-question-narrow"),f=(0,a.up)("ion-card-content"),w=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(w,{class:(0,h.C_)(["question-card",{"animate__animated animate__fadeIn":!n.isGroupInput}])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label force-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{disabled:!e.isFileAvailable,action:"media",questionText:s.state.question,answer:s.state.answer.answer,onOnLabelButtonClick:e.openPopover},null,8,["disabled","questionText","answer","onOnLabelButtonClick"])])),_:1})])),_:1}),(0,a.Wm)(f,{class:(0,h.C_)(["ion-text-center",{"ion-margin":n.isGroupInput}])},{default:(0,a.w5)((()=>[e.isPWA?((0,a.wg)(),(0,a.j4)(d,{filename:s.state.answer.answer,filestate:s.state.pwaFileState,fileError:s.state.fileError,key:s.state.answer.answer,type:s.state.inputDetails.type,inputRef:s.state.inputDetails.ref,uuid:s.entryUuid,onFileLoaded:e.onFileLoadedPWA,onFileDropped:e.onFileDroppedPWA,onFileError:e.onFileErrorPWA},null,8,["filename","filestate","fileError","type","inputRef","uuid","onFileLoaded","onFileDropped","onFileError"])):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(_,{key:1},{content:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.shoot())},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{slot:"start",icon:s.videocam},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.shoot),1)])),_:1})])),_:1})),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(_,{key:2},{content:(0,a.w5)((()=>[(0,a.wy)((0,a._)("video",{class:"question-video-player",src:s.state.fileSource,controls:""},null,8,ps),[[r.F8,""!==s.state.fileSource]])])),_:1}))])),_:1},8,["class"])])),_:1},8,["class"])}]]),fs={components:{questionAudio:We,questionBarcode:xe,questionBranch:Nt,questionCheckbox:en,questionDate:sn,questionDecimal:_n,questionDropdown:yn,questionInteger:Dn,questionLocation:sr,questionPhone:pr,questionPhoto:Sr,questionRadio:Ir,questionReadme:Dr,questionSearch:Nr,questionText:Jr,questionTextarea:os,questionTime:ds,questionVideo:_s},props:{inputRef:{type:String,required:!0},type:{type:String,required:!0}},emits:["question-mounted"],setup(e,t){const n=p(),r=(e.type.toUpperCase(),(0,a.f3)("entriesAddState")),s=n.entriesAddScope,o=n.language,i=b[o].labels,l=b[o].status_codes,u=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},groupHasError:!1,groupInputs:[],groupInputDetails:[]});ke.setUpInputParams(u,e.inputRef,r),u.confirmAnswer=r.confirmAnswer,u.groupInputs=B.getGroupInputs(s.entryService.form.formRef,e.inputRef),u.groupInputs.forEach((e=>{var t,n;u.groupInputDetails.push(r.inputsExtra[e.ref].data),null!==(t=u.error.errors[e.ref])&&void 0!==t&&t.message&&(u.groupHasError=!0),u.confirmAnswer[e.ref]={verify:e.verify,answer:(null===(n=r.confirmAnswer[e.ref])||void 0===n?void 0:n.answer)||""}}));const c={hasError:(0,m.Fl)((()=>ne.hasQuestionError(u))),errorMessage:(0,m.Fl)((()=>{var e,t;return Object.keys(u.error.errors).length>0?null===(e=u.error)||void 0===e||null===(t=e.errors[u.currentInputRef])||void 0===t?void 0:t.message:""})),isGroupInput:!0};(0,a.bv)((async()=>{t.emit("question-mounted")}));return(0,a.JJ)("questionGroupState",u),{labels:i,state:u,statusCodes:l,...c}}};var ws=(0,f.Z)(fs,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-item-divider"),u=(0,a.up)("ion-card-title"),c=(0,a.up)("ion-card-header"),d=(0,a.up)("question-text"),p=(0,a.up)("question-integer"),m=(0,a.up)("question-decimal"),_=(0,a.up)("question-location"),f=(0,a.up)("question-group",!0),w=(0,a.up)("question-photo"),g=(0,a.up)("question-phone"),E=(0,a.up)("question-barcode"),y=(0,a.up)("question-audio"),A=(0,a.up)("question-video"),S=(0,a.up)("question-radio"),T=(0,a.up)("question-dropdown"),b=(0,a.up)("question-checkbox"),R=(0,a.up)("question-branch"),I=(0,a.up)("question-textarea"),v=(0,a.up)("question-readme"),P=(0,a.up)("question-date"),D=(0,a.up)("question-time"),O=(0,a.up)("question-search"),k=(0,a.up)("ion-card-content"),U=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.iD)(a.HY,null,[r.state.groupHasError?((0,a.wg)(),(0,a.iD)("div",An,[(0,a.Wm)(l,{color:"danger",class:"entry-error",sticky:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"entry-title-label ion-text-wrap"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.statusCodes.ec5_128),1)])),_:1})])),_:1})])):(0,a.kq)("",!0),(0,a.Wm)(U,{class:"question-card animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"question-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.question),1)])),_:1})])),_:1}),(0,a.Wm)(k,{class:"question-group animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.groupInputs,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t.ref},["text"===t.type?((0,a.wg)(),(0,a.j4)(d,{key:0,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"integer"===t.type?((0,a.wg)(),(0,a.j4)(p,{key:1,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"decimal"===t.type?((0,a.wg)(),(0,a.j4)(m,{key:2,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"location"===t.type?((0,a.wg)(),(0,a.j4)(_,{key:3,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"group"===t.type?((0,a.wg)(),(0,a.j4)(f,{key:4,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"photo"===t.type?((0,a.wg)(),(0,a.j4)(w,{key:5,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"phone"===t.type?((0,a.wg)(),(0,a.j4)(g,{key:6,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"barcode"===t.type?((0,a.wg)(),(0,a.j4)(E,{key:7,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"audio"===t.type?((0,a.wg)(),(0,a.j4)(y,{key:8,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"video"===t.type?((0,a.wg)(),(0,a.j4)(A,{key:9,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"radio"===t.type?((0,a.wg)(),(0,a.j4)(S,{key:10,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"dropdown"===t.type?((0,a.wg)(),(0,a.j4)(T,{key:11,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"checkbox"===t.type?((0,a.wg)(),(0,a.j4)(b,{key:12,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"branch"===t.type?((0,a.wg)(),(0,a.j4)(R,{key:13,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"textarea"===t.type?((0,a.wg)(),(0,a.j4)(I,{key:14,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"readme"===t.type?((0,a.wg)(),(0,a.j4)(v,{key:15,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"date"===t.type?((0,a.wg)(),(0,a.j4)(P,{key:16,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"time"===t.type?((0,a.wg)(),(0,a.j4)(D,{key:17,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"searchsingle"===t.type?((0,a.wg)(),(0,a.j4)(O,{key:18,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0),"searchmultiple"===t.type?((0,a.wg)(),(0,a.j4)(O,{key:19,isGroupInput:e.isGroupInput,type:t.type,inputRef:t.ref},null,8,["isGroupInput","type","inputRef"])):(0,a.kq)("",!0)])))),128))])),_:1})])),_:1})],64)}]]);var gs={props:{type:{type:String,required:!0}},emits:["question-mounted","question-save"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(0,a.f3)("entriesAddState"),i=(0,m.qj)({inputDetails:{},currentInputRef:null,error:{errors:[]},required:!1,question:"",pattern:null,answer:{answer:"",was_jumped:!1},confirmAnswer:{verify:!1,answer:""},fileSource:""});(0,a.bv)((async()=>{t.emit("question-mounted")}));return{labels:s,entriesAddState:o,state:i,...{save(){t.emit("question-save")}},...{isPWA:(0,m.Fl)((()=>n.isPWA))},archive:T.nwB,cloudUpload:T.RH0}}};var hs=(0,f.Z)(gs,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-button"),u=(0,a.up)("ion-col"),c=(0,a.up)("ion-row"),d=(0,a.up)("ion-grid"),p=(0,a.up)("ion-card-content"),m=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(m,{class:"question-card animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{"size-xs":"12","offset-xs":"0","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[r.entriesAddState.questionParams.isBranch?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(l,{key:0,class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.save())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:e.isPWA?r.cloudUpload:r.archive},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.save_entry),1)])),_:1})),r.entriesAddState.questionParams.isBranch?((0,a.wg)(),(0,a.j4)(l,{key:1,class:"question-action-button",color:"secondary",expand:"block",onClick:t[1]||(t[1]=t=>e.save())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:e.isPWA?r.cloudUpload:r.archive},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.save_branch_entry),1)])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}]]);var Es={props:{type:{type:String,required:!0},saved:{type:Boolean,required:!0},failed:{type:Boolean,required:!0},action:{type:String,required:!0}},emits:["question-mounted","add-entry-pwa","go-back-pwa"],setup(e,t){const n=p(),r=n.language,s=b[r].labels,o=(0,a.f3)("entriesAddState"),i=(0,m.qj)({saved:e.saved,failed:e.failed,action:e.action});(0,a.bv)((async()=>{t.emit("question-mounted")}));const u={addEntry(){t.emit("add-entry-pwa")},goBack(){t.emit("go-back-pwa")}};return{labels:s,entriesAddState:o,state:i,...{showAddEntryButton:(0,m.Fl)((()=>n.entriesAddScope.entryService.action===l.ENTRY_ADD))},...u,addOutline:T.s6O,arrowBackOutline:T.Pjk}}};var ys=(0,f.Z)(Es,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-header"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-col"),p=(0,a.up)("ion-row"),m=(0,a.up)("ion-grid"),_=(0,a.up)("ion-card-content"),f=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(f,{class:"question-card animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"ion-text-center"},{default:(0,a.w5)((()=>[r.state.saved?((0,a.wg)(),(0,a.j4)(i,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.entry_completed),1)])),_:1})):(0,a.kq)("",!0),r.state.failed?((0,a.wg)(),(0,a.j4)(i,{key:1},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.has_errors),1)])),_:1})):(0,a.kq)("",!0)])),_:1}),e.showAddEntryButton||r.state.failed?((0,a.wg)(),(0,a.j4)(_,{key:0,class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{"size-xs":"12","offset-xs":"0","size-sm":"8","offset-sm":"2","size-md":"6","offset-md":"3","size-lg":"6","offset-lg":"3",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[r.state.saved?((0,a.wg)(),(0,a.j4)(c,{key:0,class:"question-action-button",color:"secondary",expand:"block",onClick:t[0]||(t[0]=t=>e.addEntry())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:r.addOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.add_entry),1)])),_:1})):(0,a.kq)("",!0),r.state.failed?((0,a.wg)(),(0,a.j4)(c,{key:1,class:"question-action-button",color:"danger",expand:"block",onClick:t[1]||(t[1]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:r.arrowBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.back),1)])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})}]]);async function As(e,t){e.questionParams.isBranch?(t.entryService=Ut,e.inputs=t.entryService.branchInputs):(t.entryService=Pt,e.inputs=t.entryService.form.inputs),0===e.questionParams.currentInputIndex&&(e.questionParams.currentInputRef=e.inputs[e.questionParams.currentInputIndex]),null!==e.questionParams.currentInputRef&&(e.inputsExtra=B.getExtraInputs(),e.inputDetails=e.inputsExtra[e.questionParams.currentInputRef].data,e.questionParams.type=e.inputDetails.type,function(){switch(e.answers=t.entryService.getAnswers(e.questionParams.currentInputRef),e.questionParams.type){case l.QUESTION_TYPES.CHECKBOX:case l.QUESTION_TYPES.SEARCH_SINGLE:case l.QUESTION_TYPES.SEARCH_MULTIPLE:e.existingAnswer=[...e.answers[e.questionParams.currentInputRef].answer];break;default:e.existingAnswer=e.answers[e.questionParams.currentInputRef].answer}e.confirmAnswer={},e.confirmAnswer[e.questionParams.currentInputRef]={verify:e.inputDetails.verify,answer:e.answers[e.questionParams.currentInputRef].answer},e.questionParams.type===l.QUESTION_TYPES.GROUP&&t.entryService.form.formStructure.group[e.questionParams.currentInputRef].forEach((t=>{e.confirmAnswer[t]={verify:e.inputsExtra[t].data.verify,answer:e.answers[t].answer}}))}()),e.progress=Math.round(e.questionParams.currentInputIndex/e.inputs.length*100),e.showSave=null===e.questionParams.currentInputRef,e.showSave&&(e.isFetching=!1),window.setTimeout((function(){e.disableNext=null===e.questionParams.currentInputRef||0===t.entryService.entry.canEdit,e.disablePrevious=0===e.questionParams.currentInputIndex||0===t.entryService.entry.canEdit}),l.DELAY_MEDIUM)}async function Ss(e,t){return new Promise(((n,r)=>{let s,o,a,i="",u="";const c=p(),d=c.searchParams;if(d.has("form_ref")&&d.has("parent_form_ref")&&d.has("parent_uuid")?(s=d.get("form_ref"),o=d.get("parent_form_ref"),a=d.get("parent_uuid")):(s=B.getFirstFormRef(),o="",a=""),t&&(i=d.get("branch_ref"),u=d.get("branch_owner_uuid")),e===l.PWA_ADD_ENTRY)return t?(Ut.setUpNew(s,i,u),c.branchEditType=l.PWA_BRANCH_REMOTE):Pt.setUpNew(s,a,o),z.initialise(B.getExtraForm(s)),n(s),!1;!async function(){const e=B.getSlug(),p=B.getProjectRef(),m=d.get("uuid");let _=null;try{const t=await de.downloadEntryPWA(e,s,m,i,u);if(!(t.data.data.entries.length>0))return r(),!1;_=t.data.data.entries[0]}catch(e){return ve.handleWebError(e),r(e),!1}const f=_.type,w={entryUuid:m,parentEntryUuid:a,isRemote:0,synced:0,canEdit:1,createdAt:_[f].createdAt,title:_[f].title,formRef:s,parentFormRef:o,projectRef:p,branchEntries:{},media:{},uniqueAnswers:{},syncedError:"",isBranch:t,verifyAnswers:{},answers:_[f].answers},g={entry_uuid:m,answers:JSON.stringify(_[f].answers),form_ref:s,parent_form_ref:o,parent_entry_uuid:a,project_ref:p,created_at:_[f].createdAt,title:_[f].title,synced:0,synced_error:"",can_edit:1,is_remote:0};z.initialise(B.getExtraForm(s)),Oe.initialise(g),t?(w.ownerInputRef=i,w.ownerEntryUuid=u,await Ut.setUpExisting(w),c.branchEditType=l.PWA_BRANCH_REMOTE):Pt.setUpExisting(w),n(s)}()}))}var Ts={props:{message:{type:String,required:!0}},setup(e){return{props:e}}};var bs=(0,f.Z)(Ts,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-item-divider");return(0,a.wg)(),(0,a.j4)(l,{color:"danger",class:"entry-error-global ion-text-center",sticky:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"entry-title-label ion-text-center ion-text-wrap"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.props.message),1)])),_:1})])),_:1})}]]);const Rs={class:"question-progress-bar"};var Is={emit:["prev-clicked","next-clicked"],props:{disablePrevious:{type:Boolean,required:!0},disableNext:{type:Boolean,required:!0},progressBarWidth:{type:[Number,String],required:!0}},setup(e,t){const n=p().language;return{labels:b[n].labels,props:e,...{prev(){t.emit("prev-clicked")},next(){t.emit("next-clicked")}},chevronForwardOutline:T.Dji,chevronBackOutline:T.ZY4}}};var vs={components:{questionAudio:We,questionBarcode:xe,questionBranch:Nt,questionCheckbox:en,questionDate:sn,questionDecimal:_n,questionDropdown:yn,questionGroup:ws,questionInteger:Dn,questionLocation:sr,questionPhone:pr,questionPhoto:Sr,questionRadio:Ir,questionReadme:Dr,questionSearch:Nr,questionText:Jr,questionTextarea:os,questionTime:ds,questionVideo:_s,questionSave:hs,questionSaved:ys,NotFound:L,ItemDividerError:bs,ToolbarEntriesAddNavigation:(0,f.Z)(Is,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-button"),u=(0,a.up)("ion-buttons"),c=(0,a.up)("ion-toolbar");return(0,a.wg)(),(0,a.j4)(c,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{disabled:r.props.disablePrevious,onClick:t[0]||(t[0]=t=>e.prev())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:r.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.prev),1)])),_:1},8,["disabled"])])),_:1}),(0,a._)("div",null,[(0,a._)("div",Rs,[(0,a._)("div",{style:(0,h.j5)({width:r.props.progressBarWidth})},null,4)])]),(0,a.Wm)(u,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{disabled:r.props.disableNext,onClick:t[1]||(t[1]=t=>e.next())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.next)+" ",1),(0,a.Wm)(i,{slot:"end",icon:r.chevronForwardOutline},null,8,["icon"])])),_:1},8,["disabled"])])),_:1})])),_:1})}]])},setup(e){var t;const n=p(),r=n.language,s=b[r].labels,o=(0,D.tv)();if(n.notFound&&n.isPWA)return{notFound:!0};const u=ne.getProjectNameMarkup(),c=(0,m.qj)({isFetching:!0,progress:0,disableNext:!0,disablePrevious:!0,questionParams:{},inputs:[],inputsExtra:{},inputDetails:{},existingAnswer:{},answers:[],confirmAnswer:{},error:{errors:{}},errorGlobal:"",allowSave:!0,action:null,entrySavedPWA:!1,entryFailedPWA:!1,showSaved:!1}),d=n.hierarchyNavigation.length-1,_=n.hierarchyNavigation[d],f={parentEntryName:(0,m.Fl)((()=>_?'"'+_.parentEntryName+'"':"")),currentFormName:(0,m.Fl)((()=>z.getName())),progressBarWidth:(0,m.Fl)((()=>c.progress>0?c.progress+"%":0)),pageId:(0,m.Fl)((()=>c.questionParams.isBranch?"entries-branch-add":"entries-add")),isPWA:(0,m.Fl)((()=>n.isPWA)),hasGlobalError:(0,m.Fl)((()=>n.queueGlobalUploadErrorsPWA.length>0&&(c.errorGlobal=n.queueGlobalUploadErrorsPWA[0].title,!0)))};function w(){c.entrySavedPWA=!0,c.entryFailedPWA=!1,c.showSave=!1,c.showSaved=!0,c.disablePrevious=!0,c.disableNext=!0,O.hideProgressDialog()}const g={async saveEntry(e){n.isPWA?(await O.showProgressDialog(s.wait,s.saving),n.entriesAddScope.entryService.allowSave=!0,c.action=n.entriesAddScope.entryService.action,n.entriesAddScope.entryService.saveEntryPWA().then((()=>{n.entriesAddScope.entryService.type===l.BRANCH_ENTRY?n.branchEditType===l.PWA_BRANCH_REMOTE?w():h(ke.getNavigationParams(n.entriesAddScope.entryService)):w()}),(e=>{var t;if(null===(t=e.data)||void 0===t||!t.errors)return O.hideProgressDialog(),ve.handleWebError(e),!1;n.routeParams={error:{errors:e.data.errors}},c.error={errors:e.data.errors},c.entrySavedPWA=!1,c.entryFailedPWA=!0,c.showSave=!1,c.showSaved=!0,c.disablePrevious=!1,c.disableNext=!0,ve.handleWebError(e),O.hideProgressDialog()}))):g.saveEntryToDatabase(e)},async saveEntryToDatabase(e){e=e||l.SYNCED_CODES.UNSYNCED,await O.showProgressDialog(s.wait,s.saving),n.entriesAddScope.entryService.saveEntry(e).then((function(){h(ke.getNavigationParams(n.entriesAddScope.entryService))}),(function(e){O.hideProgressDialog(),e.error&&c.error?ve.handleEntryErrors(e.error,c.error,e.inputRefs):e.message?O.showAlert(e.message,s.error):O.showAlert(e,s.error)}))},async addEntryPWA(){await O.showProgressDialog(b[r].labels.wait);const e=n.entriesAddScope.entryService,t=e.entry.isBranch,s=await Ss(l.PWA_ADD_ENTRY,t);let o=B.getInputs(s)[0];if(t){const t=e.entry.ownerInputRef;o=B.getBranches(s,t)[0]}n.routeParams={formRef:s,inputRef:null,inputIndex:0,isBranch:t,error:{}},c.questionParams.currentInputIndex=1,e.entry.answers[o]={answer:"",was_jumped:!1},c.entrySavedPWA=!1,c.entryFailedPWA=!1,c.showSave=!1,c.disablePrevious=!0,c.disableNext=!1,g.prev()},async quitEntry(){let e=l.SYNCED_CODES.UNSYNCED,t=b[r].status_codes.ec5_100;n.isPWA&&(t=s.are_you_sure);switch(await O.confirmMultiple(t,s.quit,s.save,s.quit)){case l.ACTIONS.ENTRY_QUIT:await O.showProgressDialog(s.wait,s.quitting);try{await n.entriesAddScope.entryService.removeTempBranches(),h(ke.getNavigationParams(n.entriesAddScope.entryService))}catch(e){}break;case l.ACTIONS.ENTRY_SAVE:if(null===c.questionParams.currentInputRef)g.saveEntry(e);else try{if(await n.entriesAddScope.entryService.validateAnswer({existingAnswer:c.existingAnswer,answers:c.answers,confirmAnswer:c.confirmAnswer,mainInputDetails:c.inputDetails,error:c.error}),n.entriesAddScope.entryService.wasJumpEdited({existingAnswer:c.existingAnswer,mainInputDetails:c.inputDetails})&&(n.entriesAddScope.entryService.allowSave=!1),!n.entriesAddScope.entryService.allowSave)return void O.showAlert(b[r].status_codes.ec5_140);n.entriesAddScope.entryService.processJumpsNext(c.answers[c.questionParams.currentInputRef],c.inputDetails,c.questionParams.currentInputIndex),e=n.entriesAddScope.entryService.entry.synced<l.SYNCED_CODES.INCOMPLETE?e:l.SYNCED_CODES.INCOMPLETE,g.saveEntry(e)}catch(e){ve.handleEntryErrors(e.error,c.error,e.inputRefs)}break;default:return!1}},prev(){c.showSaved=!1;0===c.questionParams.currentInputIndex?g.quitEntry():async function(e,t){e.isFetching=!0,e.disableNext=!0,e.disablePrevious=!0,e.questionParams.type=null;const n=t.entryService.processJumpsPrevious(e.questionParams.currentInputIndex);setTimeout((function(){e.questionParams.currentInputRef=n.previous_input_ref,e.questionParams.currentInputIndex=n.previous_input_index,As(e,t)}),l.DELAY_SHORT)}(c,n.entriesAddScope)},async next(){!async function(e,t){e.disableNext=!0,e.disablePrevious=!0,e.questionParams.type=null,e.isFetching=!0,window.localStorage.removeItem("is_dismissing_barcode");const n=e.questionParams.currentInputRef;try{await t.entryService.validateAnswer({existingAnswer:e.existingAnswer,answers:e.answers,confirmAnswer:e.confirmAnswer,mainInputDetails:e.inputDetails,error:e.error});const r=t.entryService.processJumpsNext(e.answers[n],e.inputDetails,e.questionParams.currentInputIndex);window.setTimeout((()=>{t.entryService.wasJumpEdited({existingAnswer:e.existingAnswer,mainInputDetails:e.inputDetails})&&(t.entryService.allowSave=!1),e.questionParams.currentInputRef=r.next_input_ref,e.questionParams.currentInputIndex=r.next_input_index,As(e,t)}),l.DELAY_SHORT)}catch(t){window.setTimeout((()=>{e.disableNext=!1,e.disablePrevious=!1,e.questionParams.type=e.inputDetails.type,ve.handleEntryErrors(t.error,e.error,t.inputRefs)}),l.DELAY_SHORT)}}(c,n.entriesAddScope)},onQuestionMounted(){c.isFetching=!1,O.hideProgressDialog()}};function h(e){const t=n.entriesAddScope.entryService.form.formRef,r=n.entriesAddScope.entryService.entry.isBranch,s=e.routeName===l.ROUTES.ENTRIES_VIEW,a=e.routeName===l.ROUTES.ENTRIES_VIEW_BRANCH,i=e.routeName===l.ROUTES.ENTRIES,u=r?e.routeParams.ownerInputRef:null,c=B.getSlug();n.device.platform!==l.PWA&&B.hasLocation(t)&&!r&&it.stopWatching(),setTimeout((function(){const d={};if(n.routeParams={projectRef:B.getProjectRef(),formRef:t,inputRef:e.routeParams.inputRef,ownerInputRef:u,inputIndex:e.routeParams.inputIndex,isBranch:e.routeParams.isBranch,entryUuid:e.routeParams.entryUuid,parentEntryUuid:e.routeParams.parentEntryUuid},n.isPWA){if(e.routeName===l.ROUTES.PWA_QUIT)return window.location.href=ne.getDataViewerURL(c),!1;e.routeName===l.ROUTES.ENTRIES_EDIT&&(d.form_ref=t,d.uuid=e.routeParams.entryUuid,d.parent_form_ref=e.routeParams.parentFormRef||"",d.parent_uuid=e.routeParams.parentEntryUuid||"")}o.replace({name:e.routeName,query:d,params:{refreshBranchEntries:r&&!s?"true":null,refreshEntries:!r&&i?"true":null,refreshEntriesView:s,refreshEntriesViewBranch:a,timestamp:Date.now()}})}),l.DELAY_LONG)}n.entriesAddScope.projectName=ne.getProjectNameMarkup();const E=n.routeParams;if(c.questionParams={currentInputRef:E.inputRef,currentInputIndex:E.inputIndex,previousInputIndex:E.inputIndex-1,isBranch:E.isBranch,branchEntryUuid:E.branchEntryUuid},null!==(t=E.error)&&void 0!==t&&t.errors&&E.error.errors.length>0){const e=E.error.errors;for(let t=0;t<e.length;t++)c.error.errors[e[t].source]={message:b[r].status_codes[e[t].code]}}return n.isPWA&&Object.keys(n.queueBranchUploadErrorsPWA).length>0&&c.questionParams.isBranch&&c.questionParams.branchEntryUuid&&Object.values(n.queueBranchUploadErrorsPWA).forEach((e=>{e.forEach((e=>{c.questionParams.branchEntryUuid===e.uuid&&(c.error.errors[e.source]={message:b[r].status_codes[e.code],uuid:e.uuid})}))})),As(c,n.entriesAddScope),(0,a.JJ)("entriesAddState",c),n.isPWA&&(Pt.type===l.BRANCH_ENTRY?(n.entriesAddScope.entryService.allowSave=Ut.allowSave,c.action=Ut.action):(n.entriesAddScope.entryService.allowSave=Pt.allowSave,c.action=Pt.action)),(0,i.useBackButton)(10,(()=>{if(c.isFetching)return!1;switch(c.questionParams.type){case l.QUESTION_TYPES.AUDIO:n.isAudioModalActive||g.prev();break;case l.QUESTION_TYPES.LOCATION:n.isLocationModalActive||g.prev();break;default:g.prev()}})),{labels:s,state:c,...g,...f,projectName:u,notFound:!1,closeOutline:T.fID,power:T.qux,chevronBackOutline:T.ZY4,chevronForwardOutline:T.Dji}}};var Ps=(0,f.Z)(vs,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("not-found"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("toolbar-entries-add-navigation"),d=(0,a.up)("item-divider-error"),p=(0,a.up)("ion-label"),m=(0,a.up)("ion-item-divider"),_=(0,a.up)("ion-spinner"),f=(0,a.up)("question-text"),w=(0,a.up)("question-integer"),g=(0,a.up)("question-decimal"),E=(0,a.up)("question-location"),y=(0,a.up)("question-group"),A=(0,a.up)("question-photo"),S=(0,a.up)("question-phone"),T=(0,a.up)("question-barcode"),b=(0,a.up)("question-audio"),R=(0,a.up)("question-video"),I=(0,a.up)("question-radio"),v=(0,a.up)("question-dropdown"),P=(0,a.up)("question-checkbox"),D=(0,a.up)("question-branch"),O=(0,a.up)("question-textarea"),k=(0,a.up)("question-readme"),U=(0,a.up)("question-date"),W=(0,a.up)("question-time"),N=(0,a.up)("question-search"),C=(0,a.up)("question-save"),j=(0,a.up)("question-saved"),L=(0,a.up)("ion-col"),z=(0,a.up)("ion-row"),B=(0,a.up)("ion-grid"),G=(0,a.up)("base-layout");return r.notFound?((0,a.wg)(),(0,a.j4)(i,{key:0})):((0,a.wg)(),(0,a.j4)(G,{key:1,title:r.projectName,id:e.pageId,onExitApp:t[8]||(t[8]=t=>e.quitEntry())},{"actions-start":(0,a.w5)((()=>[e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"button-quit",onClick:t[0]||(t[0]=t=>e.quitEntry())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.closeOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.quit),1)])),_:1}))])),"actions-end":(0,a.w5)((()=>[e.isPWA?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"button-quit",onClick:t[1]||(t[1]=t=>e.quitEntry())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.power},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.exit),1)])),_:1})):(0,a.kq)("",!0),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:1,disabled:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"icon-only"})])),_:1})),e.isPWA?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:2,disabled:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"icon-only"})])),_:1}))])),subheader:(0,a.w5)((()=>[(0,a.Wm)(c,{progressBarWidth:e.progressBarWidth,disablePrevious:r.state.disablePrevious,disableNext:r.state.disableNext,onPrevClicked:t[2]||(t[2]=t=>e.prev()),onNextClicked:t[3]||(t[3]=t=>e.next())},null,8,["progressBarWidth","disablePrevious","disableNext"])])),content:(0,a.w5)((()=>[(0,a._)("div",null,[e.isPWA&&e.hasGlobalError?((0,a.wg)(),(0,a.j4)(d,{key:0,message:r.state.errorGlobal},null,8,["message"])):(0,a.kq)("",!0),"branch"!==r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(m,{key:1,class:"entry-name",color:"light",sticky:""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"entry-name-label ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.parentEntryName)+" "+(0,h.zw)(e.currentFormName),1)])),_:1})])),_:1})):(0,a.kq)("",!0),r.state.isFetching?((0,a.wg)(),(0,a.iD)("div",F,[(0,a.Wm)(_,{class:"loader loader-questions",name:"crescent"})])):(0,a.kq)("",!0),(0,a.Wm)(B,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,{"size-md":"10","offset-md":"1","size-lg":"8","offset-lg":"2","size-xl":"6","offset-xl":"3"},{default:(0,a.w5)((()=>[r.state.showSave?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",q,["text"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(f,{key:0,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"integer"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(w,{key:1,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"decimal"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(g,{key:2,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"location"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(E,{key:3,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"group"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(y,{key:4,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"photo"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(A,{key:5,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"phone"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(S,{key:6,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"barcode"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(T,{key:7,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"audio"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(b,{key:8,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"video"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(R,{key:9,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"radio"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(I,{key:10,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"dropdown"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(v,{key:11,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"checkbox"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(P,{key:12,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"branch"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(D,{key:13,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,parentEntryName:e.parentEntryName,currentFormName:e.currentFormName,onSaveBranchEntry:t[4]||(t[4]=t=>e.saveEntry())},null,8,["type","inputRef","onQuestionMounted","parentEntryName","currentFormName"])):(0,a.kq)("",!0),"textarea"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(O,{key:14,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"readme"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(k,{key:15,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"date"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(U,{key:16,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"time"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(W,{key:17,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"searchsingle"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(N,{key:18,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0),"searchmultiple"===r.state.questionParams.type?((0,a.wg)(),(0,a.j4)(N,{key:19,type:r.state.questionParams.type,inputRef:r.state.questionParams.currentInputRef,onQuestionMounted:e.onQuestionMounted,isGroupInput:!1},null,8,["type","inputRef","onQuestionMounted"])):(0,a.kq)("",!0)])),r.state.showSave&&!r.state.isFetching?((0,a.wg)(),(0,a.iD)("div",x,[(0,a.Wm)(C,{type:"save",onQuestionMounted:e.onQuestionMounted,onQuestionSave:t[5]||(t[5]=t=>e.saveEntry())},null,8,["onQuestionMounted"])])):(0,a.kq)("",!0),r.state.showSaved&&!r.state.isFetching?((0,a.wg)(),(0,a.iD)("div",M,[(0,a.Wm)(j,{type:"saved",saved:r.state.entrySavedPWA,failed:r.state.entryFailedPWA,action:r.state.action,onQuestionMounted:e.onQuestionMounted,onAddEntryPwa:t[6]||(t[6]=t=>e.addEntryPWA()),onGoBackPwa:t[7]||(t[7]=t=>e.prev())},null,8,["saved","failed","action","onQuestionMounted"])])):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title","id"]))}]]);const Ds={key:0,class:"ion-text-center ion-margin"},Os={key:1,class:"animate__animated animate__fadeIn"},ks={class:"projects-list"};var Us=n(9461);const Ws=(0,a.Uk)("CGPS Staff"),Ns={class:"center-item-content-wrapper ion-padding-top ion-padding-bottom"};const Cs={getGoogleCodeNatively(e){return new Promise(((t,n)=>{window.plugins.googleplus.login({webClientId:e.google.CLIENT_ID,offline:!0},(function(e){e.serverAuthCode?t({code:e.serverAuthCode,email:e.email,family_name:e.familyName,given_name:e.givenName}):n()}),(function(e){n()}))}))},storeUser(e,t,n){return new Promise(((r,s)=>{e?st.insertUser(e,t,n).then((function(){r()}),(function(e){s(e)})):s()}))},validateResponse(e){var t,n;return!(null==e||null===(t=e.data)||void 0===t||null===(n=t.data)||void 0===n||!n.jwt)},async loginUser(e){const t=p(),n=t.language;return new Promise(((r,s)=>{var o,a,i,l,u;const c=null===(o=e.data.data)||void 0===o?void 0:o.jwt,d=(null===(a=e.data.meta)||void 0===a||null===(i=a.user)||void 0===i?void 0:i.name)||"",p=(null===(l=e.data.meta)||void 0===l||null===(u=l.user)||void 0===u?void 0:u.email)||"";this.storeUser(c,d,p).then((()=>{t.user={name:d,email:p,action:b[n].labels.logout},r()}),(()=>{s("ec5_12")}))}))}},js={async authLocalUser(e){const t=p().language;return new Promise(((n,r)=>{(async()=>{await ne.hasInternetConnection()||r(b[t].status_codes.ec5_118);try{const t=await de.login(e,"local");Cs.validateResponse(t)||r("ec5_210");try{await Cs.loginUser(t),n()}catch(e){r(e)}}catch(e){const t=ve.getWebErrorCode(e);r(t)}})()}))}},Ls={modals:{login:null,passwordlessSend:null,passwordlessLogin:null,confirmPassword:null,confirmEmail:null},set login(e){this.modals.login=e},get login(){return this.modals.login},set passwordlessSend(e){this.modals.passwordlessSend=e},get passwordlessSend(){return this.modals.passwordlessSend},set passwordlessLogin(e){this.modals.passwordlessLogin=e},get passwordlessLogin(){return this.modals.passwordlessLogin},set confirmPassword(e){this.modals.confirmPassword=e},get confirmPassword(){return this.modals.confirmPassword},set confirmEmail(e){this.modals.confirmEmail=e},get confirmEmail(){return this.modals.confirmEmail},dismissAll(){Object.values(this.modals).forEach((e=>{e&&e.dismiss()}))}};async function Fs(e){const t=p(),n=t.language,r=b[n].labels;await O.showProgressDialog(r.sign_in+"...");try{if(await js.authLocalUser(e),O.showToast(b[n].status_codes.ec5_115),Ls.dismissAll(),null!==t.afterUserIsLoggedIn.callback){const e=t.afterUserIsLoggedIn.callback,n=t.afterUserIsLoggedIn.params;n?await e(...n):await e(),t.afterUserIsLoggedIn={callback:null,params:null}}else O.hideProgressDialog()}catch(e){O.showAlert(b[n].status_codes[e]),O.hideProgressDialog()}O.hideProgressDialog()}var qs={setup(e){const t=p().language,n=b[t].labels,r=(0,m.qj)({account:{email:"",provider:null,code:null},authLocalCredentials:{email:"",password:""},eyeIcon:T.iyy,authLocalInputPasswordType:"password"}),s={async performLoginLocal(){Us.m.close(),Fs(r.authLocalCredentials)},toggleInputType(){r.eyeIcon===T.iyy?(r.eyeIcon=T.YaL,r.authLocalInputPasswordType="text"):(r.eyeIcon=T.iyy,r.authLocalInputPasswordType="password")}},o={isDebug:(0,m.Fl)((()=>l.DEBUG)),areAuthLocalCredentialsEmpty:(0,m.Fl)((()=>""===r.authLocalCredentials.email||""===r.authLocalCredentials.password))};return{labels:n,state:r,...o,...s,eye:T.iyy,eyeOff:T.YaL}}};var xs=(0,f.Z)(qs,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-header"),u=(0,a.up)("ion-input"),c=(0,a.up)("ion-item"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-button"),m=(0,a.up)("ion-col"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("ion-card-content"),g=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(g,{class:"login-local"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"question-label ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[Ws])),_:1})])),_:1}),(0,a.Wm)(w,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a._)("form",null,[(0,a.Wm)(c,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"email",placeholder:r.labels.email,required:"true",modelValue:r.state.authLocalCredentials.email,"onUpdate:modelValue":t[0]||(t[0]=e=>r.state.authLocalCredentials.email=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),(0,a.Wm)(c,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",type:r.state.authLocalInputPasswordType,placeholder:r.labels.password,required:"true",modelValue:r.state.authLocalCredentials.password,"onUpdate:modelValue":t[1]||(t[1]=e=>r.state.authLocalCredentials.password=e),modelModifiers:{trim:!0}},null,8,["type","placeholder","modelValue"]),(0,a.Wm)(d,{slot:"end",icon:r.state.eyeIcon,onClick:t[2]||(t[2]=t=>e.toggleInputType())},null,8,["icon"])])),_:1}),(0,a.Wm)(c,{lines:"none"},{default:(0,a.w5)((()=>[(0,a._)("div",Ns,[(0,a.Wm)(p,{class:"local-login-btn",expand:"full",mode:"md",size:"default",color:"secondary",disabled:e.areAuthLocalCredentialsEmpty,onClick:t[3]||(t[3]=t=>e.performLoginLocal())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.login),1)])),_:1},8,["disabled"])])])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}]]);const Ms=(0,a.Uk)("LDAP Staff"),zs={class:"center-item-content-wrapper ion-padding-top ion-padding-bottom"};var Bs={setup(){const e=p().language;return{labels:b[e].labels,state:(0,m.qj)({account:{email:"",provider:null,code:null},authLdapCredentials:{},eyeIcon:T.iyy,authLdapInputPasswordType:"password"}),...{isDebug:(0,m.Fl)((()=>l.DEBUG))},eye:T.iyy}}};var Gs=(0,f.Z)(Bs,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-card-title"),l=(0,a.up)("ion-card-header"),u=(0,a.up)("ion-input"),c=(0,a.up)("ion-item"),d=(0,a.up)("ion-button"),p=(0,a.up)("ion-col"),m=(0,a.up)("ion-row"),_=(0,a.up)("ion-grid"),f=(0,a.up)("ion-card-content"),w=(0,a.up)("ion-card");return e.isDebug?((0,a.wg)(),(0,a.j4)(w,{key:0,class:"login-ldap"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"question-label ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[Ms])),_:1})])),_:1}),(0,a.Wm)(f,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("form",null,[(0,a.Wm)(c,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"email",placeholder:r.labels.email,modelValue:r.state.authLdapCredentials.email,"onUpdate:modelValue":t[0]||(t[0]=e=>r.state.authLdapCredentials.email=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),(0,a.Wm)(c,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"password",placeholder:r.labels.password,modelValue:r.state.authLdapCredentials.password,"onUpdate:modelValue":t[1]||(t[1]=e=>r.state.authLdapCredentials.password=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),(0,a.Wm)(c,{lines:"none"},{default:(0,a.w5)((()=>[(0,a._)("div",zs,[(0,a.Wm)(d,{class:"local-login-btn",expand:"full",mode:"md",size:"default",color:"secondary",type:"submit"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.login),1)])),_:1})])])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0)}]]);const Ys={class:"ion-text-center"},Hs=["src"],Vs={class:"ion-text-center"},Qs=["src"],Zs={class:"hr-divider-wrapper"},Js={class:"hr-divider"},Xs={class:"ion-text-center"},Ks=["src"];const $s={class:"center-item-content-wrapper"},eo={class:"ion-padding-top ion-padding-bottom",slot:"end"};const to={class:"ion-padding-top ion-padding-bottom",slot:"end"};const no={async getCode(e){const t=p().language;return new Promise(((n,r)=>{e||r("ec5_42"),(async()=>{await ne.hasInternetConnection()?(await O.showProgressDialog(b[t].labels.wait+"..."),de.getPasswordlessCode(e).then((function(e){if(O.hideProgressDialog(),"ec5_372"===e.data.data.code)n();else{O.hideProgressDialog();const t=ve.getWebErrorCode(e);r(t)}}),(function(e){O.hideProgressDialog();const t=ve.getWebErrorCode(e);r(t)}))):r("ec5_118")})()}))},async authPasswordlessUser(e){const t=p().language;return new Promise(((n,r)=>{(async()=>{await ne.hasInternetConnection()?(await O.showProgressDialog(b[t].labels.sign_in+"..."),de.passwordlessLogin(e).then((e=>{n(e)}),(e=>{O.hideProgressDialog();const t=ve.getWebErrorCode(e);r(t)}))):r("ec5_118")})()}))}};var ro={components:{HeaderModal:Qt},props:{email:{type:String,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,{email:s}=(0,m.OT)(e),o=(0,m.qj)({authPasswordlessCredentials:{email:s,code:""}});return{labels:r,state:o,...{dismiss(){i.modalController.dismiss()},async performPasswordlessLogin(){const e=(0,m.OT)(o.authPasswordlessCredentials);try{const r=await no.authPasswordlessUser(e);if(await Cs.loginUser(r),Ls.dismissAll(),null!==t.afterUserIsLoggedIn.callback){const e=t.afterUserIsLoggedIn.callback,n=t.afterUserIsLoggedIn.params;n?await e(...n):await e(),t.afterUserIsLoggedIn={callback:null,params:null}}else O.hideProgressDialog();O.showToast(b[n].status_codes.ec5_115)}catch(e){O.hideProgressDialog(),O.showAlert(b[n].status_codes[e])}}}}}};var so=(0,f.Z)(ro,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("ion-title"),u=(0,a.up)("ion-toolbar"),c=(0,a.up)("ion-input"),d=(0,a.up)("ion-item"),p=(0,a.up)("ion-button"),m=(0,a.up)("ion-col"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("ion-card-content"),g=(0,a.up)("ion-card"),E=(0,a.up)("ion-content"),y=(0,a.up)("ion-footer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.enter_code),1)])),_:1})])),_:1}),(0,a.Wm)(g,{class:"login-passwordless"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a._)("form",null,[(0,a.Wm)(d,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{inputmode:"numeric",pattern:"[0-9]*",modelValue:r.state.authPasswordlessCredentials.code,"onUpdate:modelValue":t[1]||(t[1]=e=>r.state.authPasswordlessCredentials.code=e),modelModifiers:{trim:!0},maxlength:"6",minlength:"6",placeholder:r.labels.type_hint},null,8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(d,{lines:"none",class:"passwordless-send-item"},{default:(0,a.w5)((()=>[(0,a._)("div",to,[(0,a.Wm)(p,{class:"passwordless-send-btn",mode:"md",size:"default",color:"secondary",disabled:6!==r.state.authPasswordlessCredentials.code.length,onClick:t[2]||(t[2]=t=>e.performPasswordlessLogin())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.login),1)])),_:1},8,["disabled"])])])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(y)],64)}]]),oo={components:{HeaderModal:Qt},setup(e){const t=p().language,n=b[t].labels,r=(0,m.qj)({account:{email:"",provider:null,code:null},authMethods:[],authPasswordlessCredentials:{email:""}});return{labels:n,state:r,...{dismiss(){Ls.passwordlessSend.dismiss()},async requestPasswordlessCode(){const e=(0,m.OT)(r.authPasswordlessCredentials.email);no.getCode(e).then((async()=>{Ls.passwordlessLogin=await i.modalController.create({cssClass:"modal-passwordless-login",component:so,showBackdrop:!0,backdropDismiss:!1,componentProps:{email:r.authPasswordlessCredentials.email}}),Ls.passwordlessLogin.onDidDismiss().then((e=>{var t;null!=e&&null!==(t=e.data)&&void 0!==t&&t.closeAllModals&&i.modalController.dismiss({closeAllModals:!0})})),Ls.passwordlessLogin.present()}),(e=>{O.showAlert(b[t].status_codes[e])}))}}}}};var ao=(0,f.Z)(oo,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("ion-title"),u=(0,a.up)("ion-toolbar"),c=(0,a.up)("ion-input"),d=(0,a.up)("ion-item"),p=(0,a.up)("ion-label"),m=(0,a.up)("ion-button"),_=(0,a.up)("ion-col"),f=(0,a.up)("ion-row"),w=(0,a.up)("ion-grid"),g=(0,a.up)("ion-card-content"),E=(0,a.up)("ion-card"),y=(0,a.up)("ion-content"),A=(0,a.up)("ion-footer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.login_with_email),1)])),_:1})])),_:1}),(0,a.Wm)(E,{class:"login-passwordless"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("form",null,[(0,a.Wm)(d,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{type:"email",inputmode:"email",placeholder:r.labels.email,required:"true",modelValue:r.state.authPasswordlessCredentials.email,"onUpdate:modelValue":t[1]||(t[1]=e=>r.state.authPasswordlessCredentials.email=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),(0,a.Wm)(d,{lines:"none"},{default:(0,a.w5)((()=>[(0,a._)("div",$s,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("small",null,(0,h.zw)(r.labels.passwordless_teaser),1)])),_:1})])])),_:1}),(0,a.Wm)(d,{lines:"none",class:"passwordless-send-item"},{default:(0,a.w5)((()=>[(0,a._)("div",eo,[(0,a.Wm)(m,{class:"passwordless-send-btn",mode:"md",size:"default",color:"secondary",disabled:""===r.state.authPasswordlessCredentials.email,onClick:t[2]||(t[2]=t=>e.requestPasswordlessCode())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.send),1)])),_:1},8,["disabled"])])])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(A)],64)}]]);const io={class:"center-item-content-wrapper"},lo={class:"ion-padding-top ion-padding-bottom",slot:"end"};var uo={components:{HeaderModal:Qt},props:{email:{type:String,required:!0}},setup(e){const t=p().language,n=b[t].labels,r=(0,m.qj)({password:"",eyeIcon:T.iyy,authLocalInputPasswordType:"password"}),s={dismiss(){i.modalController.dismiss()},async performLoginLocal(){const{email:t}=(0,m.OT)(e);Fs({email:t,password:r.password})},toggleInputType(){r.eyeIcon===T.iyy?(r.eyeIcon=T.YaL,r.authLocalInputPasswordType="text"):(r.eyeIcon=T.iyy,r.authLocalInputPasswordType="password")}};return{labels:n,state:r,...e,...s,eye:T.iyy,eyeOff:T.YaL}}};var co=(0,f.Z)(uo,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("ion-title"),u=(0,a.up)("ion-toolbar"),c=(0,a.up)("ion-label"),d=(0,a.up)("ion-item-group"),p=(0,a.up)("ion-input"),m=(0,a.up)("ion-icon"),_=(0,a.up)("ion-item"),f=(0,a.up)("ion-button"),w=(0,a.up)("ion-col"),g=(0,a.up)("ion-row"),E=(0,a.up)("ion-grid"),y=(0,a.up)("ion-card-content"),A=(0,a.up)("ion-card"),S=(0,a.up)("ion-content"),T=(0,a.up)("ion-footer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.account_exists),1)])),_:1})])),_:1}),(0,a.Wm)(A,{class:"login-passowrd-confirm"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("div",io,[(0,a.Wm)(c,{color:"dark"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,h.zw)(n.email),1)])),_:1}),(0,a.Wm)(c,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.enter_password),1)])),_:1})])])),_:1}),(0,a._)("form",null,[(0,a.Wm)(_,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{slot:"start",type:r.state.authLocalInputPasswordType,placeholder:r.labels.password,required:"true",modelValue:r.state.password,"onUpdate:modelValue":t[1]||(t[1]=e=>r.state.password=e),modelModifiers:{trim:!0}},null,8,["type","placeholder","modelValue"]),(0,a.Wm)(m,{slot:"end",icon:r.state.eyeIcon,onClick:t[2]||(t[2]=t=>e.toggleInputType())},null,8,["icon"])])),_:1}),(0,a.Wm)(_,{lines:"none",class:"password-confirm-item"},{default:(0,a.w5)((()=>[(0,a._)("div",lo,[(0,a.Wm)(f,{class:"passwordless-send-btn",mode:"md",size:"default",color:"secondary",disabled:0===r.state.password.length,onClick:t[3]||(t[3]=t=>e.performLoginLocal())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.login),1)])),_:1},8,["disabled"])])])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(T)],64)}]]);const po={class:"center-item-content-wrapper"},mo={class:"ion-padding-top ion-padding-bottom",slot:"end"};const _o={async verifyUser(e){const t=p().language;return new Promise(((n,r)=>{(async()=>{await ne.hasInternetConnection()?(await O.showProgressDialog(b[t].labels.sign_in+"..."),de.verifyUserEmail(e).then((e=>{n(e)}),(e=>{O.hideProgressDialog();const t=ve.getWebErrorCode(e);r(t)}))):O.showAlert(b[t].status_codes.ec5_118)})()}))}};var fo={components:{HeaderModal:Qt},props:{account:{type:Object,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,{account:s}=(0,m.OT)(e),o=(0,m.qj)({code:""}),a={dismiss(){i.modalController.dismiss()},async performUserVerification(){const e={email:s.email,code:o.code,user:s.user,provider:s.provider};try{const r=await _o.verifyUser(e);if(await Cs.loginUser(r),Ls.dismissAll(),null!==t.afterUserIsLoggedIn.callback){const e=t.afterUserIsLoggedIn.callback,n=t.afterUserIsLoggedIn.params;n?await e(...n):await e(),t.afterUserIsLoggedIn={callback:null,params:null}}else O.hideProgressDialog();O.showToast(b[n].status_codes.ec5_115)}catch(e){O.hideProgressDialog(),O.showAlert(b[n].status_codes[e])}}};return{labels:r,state:o,...e,...a}}};var wo=(0,f.Z)(fo,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("ion-title"),u=(0,a.up)("ion-toolbar"),c=(0,a.up)("ion-label"),d=(0,a.up)("ion-item-group"),p=(0,a.up)("ion-input"),m=(0,a.up)("ion-item"),_=(0,a.up)("ion-button"),f=(0,a.up)("ion-col"),w=(0,a.up)("ion-row"),g=(0,a.up)("ion-grid"),E=(0,a.up)("ion-card-content"),y=(0,a.up)("ion-card"),A=(0,a.up)("ion-content"),S=(0,a.up)("ion-footer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(A,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.check_email),1)])),_:1})])),_:1}),(0,a.Wm)(y,{class:"login-confirm-email"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("div",po,[(0,a.Wm)(c,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.account_exists),1)])),_:1}),(0,a.Wm)(c,{color:"dark"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,h.zw)(n.account.email),1)])),_:1}),(0,a.Wm)(c,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.code_was_sent),1)])),_:1})])])),_:1}),(0,a._)("form",null,[(0,a.Wm)(m,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{inputmode:"numeric",pattern:"[0-9]*",modelValue:r.state.code,"onUpdate:modelValue":t[1]||(t[1]=e=>r.state.code=e),modelModifiers:{trim:!0},maxlength:"6",minlength:"6",placeholder:r.labels.type_hint},null,8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(m,{lines:"none",class:"email-confirm-item"},{default:(0,a.w5)((()=>[(0,a._)("div",mo,[(0,a.Wm)(_,{class:"email-confirm-btn",mode:"md",size:"default",color:"secondary",disabled:6!==r.state.code.length,onClick:t[2]||(t[2]=t=>e.performUserVerification())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.login),1)])),_:1},8,["disabled"])])])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(S)],64)}]]);const go={getGoogleCodeNatively(e){return new Promise((function(t,n){window.plugins.googleplus.login({webClientId:e.google.CLIENT_ID,offline:!0},(function(e){e.serverAuthCode?t({code:e.serverAuthCode,email:e.email,family_name:e.familyName,given_name:e.givenName}):n()}),(function(e){n(e)}))}))},async authGoogleUser(e){const t=p(),n=t.language,r={};await ne.hasInternetConnection()?(await O.showProgressDialog(b[n].labels.sign_in+"..."),this.getGoogleCodeNatively(e).then((function(e){r.email=e.email,r.provider=l.PROVIDERS.GOOGLE,r.user={given_name:e.given_name,family_name:e.family_name},de.authGoogleUser(e.code).then((async function(e){try{if(await Cs.loginUser(e),Ls.dismissAll(),O.showToast(b[n].status_codes.ec5_115),null!==t.afterUserIsLoggedIn.callback){const e=t.afterUserIsLoggedIn.callback,n=t.afterUserIsLoggedIn.params;n?await e(...n):await e(),t.afterUserIsLoggedIn={callback:null,params:null}}else O.hideProgressDialog()}catch(e){O.showAlert(b[n].status_codes.ec5_103),O.hideProgressDialog()}}),(async function(e){const t=e.data.errors;if("ec5_383"===t[0].code&&(r.code=null,de.getEmailConfirmationCode(r.email).then((async function(){return O.hideProgressDialog(),Ls.confirmEmail=await i.modalController.create({cssClass:"modal-confirm-email",component:wo,showBackdrop:!0,backdropDismiss:!1,componentProps:{account:r}}),Ls.confirmEmail.onDidDismiss().then((e=>{})),Ls.confirmEmail.present()}),(function(e){Ls.dismissAll(),O.hideProgressDialog(),ve.handleWebError(e)}))),"ec5_390"===t[0].code)return O.hideProgressDialog(),Ls.confirmPassword=await i.modalController.create({cssClass:"modal-confirm-password",component:co,showBackdrop:!0,backdropDismiss:!1,componentProps:{email:r.email}}),Ls.confirmPassword.onDidDismiss().then((e=>{})),Ls.confirmPassword.present();"ec5_390"!==t[0].code&&"ec5_383"!==t[0].code&&(Ls.dismissAll(),O.hideProgressDialog(),ve.handleWebError(e))}))}),(function(e){"12501"!=e&&O.showAlert(e),O.hideProgressDialog()}))):O.showAlert(b[n].status_codes.ec5_118)}},ho={async authAppleUser(){const e=p(),t=e.language,n={};let r;await ne.hasInternetConnection()?window.cordova.plugins.SignInWithApple.signin({requestedScopes:[0,1]},(async function(s){await O.showProgressDialog(b[t].labels.sign_in+"..."),r=s.identityToken,de.authAppleUser(r,s.fullName).then((async function(n){try{if(await Cs.loginUser(n),Ls.dismissAll(),O.showToast(b[t].status_codes.ec5_115),null!==e.afterUserIsLoggedIn.callback){const t=e.afterUserIsLoggedIn.callback,n=e.afterUserIsLoggedIn.params;n?await t(...n):await t(),e.afterUserIsLoggedIn={callback:null,params:null}}else O.hideProgressDialog()}catch(e){O.showAlert(b[t].status_codes.ec5_103),O.hideProgressDialog()}}),(async function(e){const t=e.data.errors,s=window.jwt_decode(r);if("ec5_384"===t[0].code&&(n.code=null,de.getEmailConfirmationCode(s.email).then((async function(){return O.hideProgressDialog(),n.email=s.email,n.provider=l.PROVIDERS.APPLE,O.hideProgressDialog(),Ls.confirmEmail=await i.modalController.create({cssClass:"modal-confirm-email",component:wo,showBackdrop:!0,backdropDismiss:!1,componentProps:{account:n}}),Ls.confirmEmail.onDidDismiss().then((e=>{})),Ls.confirmEmail.present()}),(function(e){Ls.dismissAll(),O.hideProgressDialog(),ve.handleWebError(e)}))),"ec5_390"===t[0].code)return O.hideProgressDialog(),Ls.confirmPassword=await i.modalController.create({cssClass:"modal-confirm-password",component:co,showBackdrop:!0,backdropDismiss:!1,componentProps:{email:n.email}}),Ls.confirmPassword.onDidDismiss().then((e=>{})),Ls.confirmPassword.present();"ec5_390"!==t[0].code&&"ec5_384"!==t[0].code&&(Ls.dismissAll(),O.hideProgressDialog(),ve.handleWebError(e))}))}),(function(e){O.hideProgressDialog(),O.showToast(b[t].status_codes.ec5_103)})):O.showAlert(b[t].status_codes.ec5_118)}};var Eo={props:{authMethods:{type:Array,required:!0},authIds:{type:Object,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,s=(0,m.qj)({account:{email:"",provider:null,code:null},showAppleSignIn:!1});t.device.platform===l.IOS&&parseInt(t.device.osVersion)>=13?s.showAppleSignIn=!0:s.showAppleSignIn=!1;const o={dismiss(){i.modalController.dismiss()},getGoogleSigninButtonImage(){return l.GOOGLE_SIGNIN_BUTTON_IMAGE},getAppleSigninButtonImage(){return l.APPLE_SIGNIN_BUTTON_IMAGE},getEmailSigninButtonImage(){return l.EMAIL_SIGNIN_BUTTON_IMAGE},async openModalPasswordlessSend(){return Ls.passwordlessSend=await i.modalController.create({cssClass:"modal-passwordless-send",component:ao,showBackdrop:!0,backdropDismiss:!1,componentProps:{}}),Ls.passwordlessSend.onDidDismiss().then((e=>{})),Ls.passwordlessSend.present()},async performLoginGoogle(){const{authIds:t}=e;go.authGoogleUser(t)},async performLoginApple(){ho.authAppleUser()}},a={isDebug:(0,m.Fl)((()=>l.DEBUG)),isAppleAuthEnabled:(0,m.Fl)((()=>e.authMethods.includes(l.PROVIDERS.APPLE)&&s.showAppleSignIn)),isGoogleAuthEnabled:(0,m.Fl)((()=>!!t.hasGoogleServices&&e.authMethods.includes(l.PROVIDERS.GOOGLE))),isPasswordlessAuthEnabled:(0,m.Fl)((()=>e.authMethods.includes(l.PROVIDERS.PASSWORDLESS)))};return{labels:r,state:s,...a,...o}}};var yo={components:{HeaderModal:Qt,CardLoginLocal:xs,CardLoginLdap:Gs,CardLoginDefault:(0,f.Z)(Eo,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-col"),l=(0,a.up)("ion-row"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-grid"),d=(0,a.up)("ion-card-content"),p=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.j4)(p,{class:"login-default"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[e.isGoogleAuthEnabled||e.isDebug?((0,a.wg)(),(0,a.j4)(l,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a._)("div",Ys,[(0,a._)("img",{src:e.getGoogleSigninButtonImage(),width:"210",height:"50",onClick:t[0]||(t[0]=t=>e.performLoginGoogle())},null,8,Hs)])])),_:1})])),_:1})):(0,a.kq)("",!0),e.isAppleAuthEnabled||e.isDebug?((0,a.wg)(),(0,a.j4)(l,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a._)("div",Vs,[(0,a._)("img",{src:e.getAppleSigninButtonImage(),width:"210",height:"50",onClick:t[1]||(t[1]=t=>e.performLoginApple())},null,8,Qs)])])),_:1})])),_:1})):(0,a.kq)("",!0),e.isPasswordlessAuthEnabled&&(e.isAppleAuthEnabled||e.isGoogleAuthEnabled)||e.isDebug?((0,a.wg)(),(0,a.j4)(l,{key:2},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a._)("div",Zs,[(0,a._)("span",Js,(0,h.zw)(r.labels.or),1)])])),_:1})])),_:1})):(0,a.kq)("",!0),e.isPasswordlessAuthEnabled||e.isDebug?((0,a.wg)(),(0,a.j4)(l,{key:3},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a._)("div",Xs,[(0,a.Wm)(u,{class:"email-login-btn",mode:"md",fill:"outline",size:"default",color:"dark",onClick:t[2]||(t[2]=t=>e.openModalPasswordlessSend())},{default:(0,a.w5)((()=>[(0,a._)("img",{slot:"start",src:e.getEmailSigninButtonImage(),width:"24",height:"24"},null,8,Ks),(0,a.Uk)("   "+(0,h.zw)(r.labels.login_with_email),1)])),_:1})])])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-7f2f369e"]])},props:{authMethods:{type:Array,required:!0},authIds:{type:Object,required:!0}},setup(e){const t=p().language,n={dismiss(){i.modalController.dismiss()}};return{labels:b[t].labels,state:(0,m.qj)({}),...{isDebug:(0,m.Fl)((()=>l.DEBUG)),isLocalAuthEnabled:(0,m.Fl)((()=>e.authMethods.includes(l.PROVIDERS.LOCAL))),isLdpaAuthEnabled:(0,m.Fl)((()=>e.authMethods.includes(l.PROVIDERS.LDAP)))},...n,...e}}};var Ao=(0,f.Z)(yo,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("header-modal"),l=(0,a.up)("card-login-default"),u=(0,a.up)("card-login-local"),c=(0,a.up)("card-login-ldap"),d=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(i,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(d,{class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{authMethods:n.authMethods,authIds:n.authIds},null,8,["authMethods","authIds"]),e.isLocalAuthEnabled?((0,a.wg)(),(0,a.j4)(u,{key:0})):(0,a.kq)("",!0),e.isLdpaAuthEnabled?((0,a.wg)(),(0,a.j4)(c,{key:1})):(0,a.kq)("",!0)])),_:1})],64)}]]);function So(){const e=p(),t=e.language,n=b[t].labels;de.getLoginMethods().then((async function(r){var s,o,a;if(!Array.isArray(null==r||null===(s=r.data)||void 0===s||null===(o=s.data)||void 0===o||null===(a=o.login)||void 0===a?void 0:a.methods))return O.hideProgressDialog(),O.showAlert(b[t].status_codes.ec5_142),!1;const l=r.data.data.login.methods;return e.user={name:"",email:"",action:n.login},O.hideProgressDialog(),Ls.login=await i.modalController.create({cssClass:"modal-login",component:Ao,showBackdrop:!0,backdropDismiss:!1,componentProps:{authMethods:l,authIds:{google:{CLIENT_ID:"382323059951-uvbq4p9vkeivoi92c8022abqmhf5f67g.apps.googleusercontent.com",SCOPE:"https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/plus.profile.emails.read"}}}}),Ls.login.onDidDismiss().then((e=>{})),Us.m.close(),Ls.login.present()}),(function(e){O.hideProgressDialog(),ve.handleWebError(e)}))}const To={downloadProjectLogo(e,t){const n=p();return new Promise((function(r,s){n.device.platform!==l.WEB?de.getHeaders(!0).then((function(o){const a=new window.FileTransfer,i=encodeURI(de.getProjectImageUrl(e)),u=n.persistentDir+l.LOGOS_DIR+t+"/mobile-logo.jpg?"+(new Date).getTime();a.download(i,u,(function(e){r()}),(function(e){s()}),!1,{headers:o})})):r()}))}};async function bo(e,t){let n;const r=l.AUTH_ERROR_CODES,s=p();return await O.showProgressDialog(b[s.language].labels.wait,b[s.language].labels.loading_project),new Promise(((o,a)=>{(async()=>{try{const r=(await de.getProject(e.slug)).data;if(r.meta.project_extra)if(B.loadExtraStructure(r.meta.project_extra),n=0===B.getExtraInputs().length,B.destroy(),n)O.hideProgressDialog(),O.showAlert(b[s.language].status_codes.ec5_133);else try{await st.insertProject(e.slug,e.name,e.ref,JSON.stringify(r.meta.project_extra),s.serverUrl,r.meta.project_stats.structure_last_updated,JSON.stringify(r.meta.project_mapping));try{await To.downloadProjectLogo(e.slug,e.ref),window.setTimeout((function(){O.showToast(b[s.language].status_codes.ec5_112),t.replace({name:l.ROUTES.PROJECTS,params:{refresh:!0}}),o()}),l.DELAY_MEDIUM)}catch(e){O.showToast(b[s.language].status_codes.ec5_138),window.setTimeout((function(){O.showToast(b[s.language].status_codes.ec5_112),t.replace({name:"projects",params:{refresh:!1}}),o()}),l.DELAY_MEDIUM)}}catch(e){let t=d[e.code];"ec5_109"===t&&(t="ec5_111"),O.hideProgressDialog(),O.showAlert(b[s.language].status_codes[t]),o()}else O.hideProgressDialog(),ve.handleWebError({data:"ec5_116"}),o()}catch(n){var a,i;O.hideProgressDialog();const l=n.data.errors[0].code;if(r.indexOf(null==n||null===(a=n.data)||void 0===a||null===(i=a.errors[0])||void 0===i?void 0:i.code)>=0){await O.confirmSingle(b[s.language].status_codes[n.data.errors[0].code])&&"ec5_78"!==l&&(s.afterUserIsLoggedIn={callback:bo,params:[e,t]},So())}else ve.handleWebError(n);o()}})()}))}var Ro={components:{ListItemProjects:S},setup(){const e=p(),t=(0,D.tv)(),n=(0,m.qj)({isFetching:!1,projects:[],searchTerm:""}),r={goToProjectsList(){t.replace({name:"projects",params:{}})},onProjectSelected(e){bo(e,t)},async fetchProjects(t){if(n.searchTerm=t.target.value.trimStart(),n.searchTerm.length<3)return!1;if(!await ne.hasInternetConnection())return O.showAlert(b[e.language].status_codes.ec5_135+"!",b[e.language].labels.error),!1;n.isFetching=!0,function(e){let t;return new Promise(((n,r)=>{clearTimeout(t),t=window.setTimeout((function(){let t=[];de.searchForProject(e).then((function(e){e.data.data.length>0?(e.data.data.forEach((e=>{const n=e.project;n.logo=de.getProjectImageUrl(n.slug),t.push(n)})),t=ne.filterObjectsByUniqueKey(t,"ref"),n(t)):n([])}),(function(e){r(e)}))}),l.DELAY_LONG)}))}((0,m.OT)(n.searchTerm)).then((e=>{e.length>0?n.projects=e:n.projects=[],n.isFetching=!1}),(e=>{ve.handleWebError(e);try{null===(null==e?void 0:e.data)&&(n.projects=[])}catch(e){n.projects=[]}n.isFetching=!1}))}};return(0,i.useBackButton)(10,(()=>{n.isFetching||r.goToProjectsList()})),{labels:b[e.language].labels,...r,state:n,chevronBackOutline:T.ZY4}}};var Io=(0,f.Z)(Ro,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-menu-button"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-buttons"),p=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-searchbar"),_=(0,a.up)("ion-spinner"),f=(0,a.up)("list-item-projects"),w=(0,a.up)("ion-list"),g=(0,a.up)("ion-card-title"),E=(0,a.up)("ion-card-header"),y=(0,a.up)("ion-card"),A=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(A,{title:""},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(l)])),subheader:(0,a.w5)((()=>[(0,a.Wm)(p,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:t[0]||(t[0]=t=>e.goToProjectsList())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.projects),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>[(0,a.Wm)(m,{animated:"",debounce:"500",placeholder:s.labels.search_for_project,onIonChange:e.fetchProjects},null,8,["placeholder","onIonChange"]),s.state.isFetching?((0,a.wg)(),(0,a.iD)("div",Ds,[(0,a.Wm)(_,{class:"spinner-fetch-projects",name:"crescent"})])):((0,a.wg)(),(0,a.iD)("div",Os,[(0,a.wy)((0,a._)("div",ks,[(0,a.Wm)(w,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{projects:s.state.projects,page:"add-project",onProjectSelected:e.onProjectSelected},null,8,["projects","onProjectSelected"])])),_:1})],512),[[r.F8,!s.state.isFetching&&s.state.projects.length>0]]),(0,a.wy)((0,a._)("div",null,[(0,a.Wm)(y,{class:"ion-text-center animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.no_projects_found),1)])),_:1})])),_:1})])),_:1})],512),[[r.F8,!s.state.isFetching&&0===s.state.projects.length&&""!==s.state.searchTerm]])]))])),_:1})}]]);const vo={class:"overflow-ellipsis toolbar-navigation-button"},Po={class:"overflow-ellipsis toolbar-navigation-button"},Do=(0,a.Uk)(" Add fakes "),Oo={key:1,class:"animate__animated animate__fadeIn"};const ko=(0,s.Q_)("BookmarkStore",{state:()=>({bookmarkId:null,bookmarks:[]}),getters:{},actions:{setBookmarks(e){this.bookmarks=[...e],this.bookmarks.sort(((e,t)=>(""+e.title.toLowerCase()).localeCompare(t.title.toLowerCase(),void 0,{numeric:!0})))},addBookmark(e){this.bookmarks.push(e),this.bookmarks.sort(((e,t)=>(""+e.title.toLowerCase()).localeCompare(t.title.toLowerCase(),void 0,{numeric:!0})))},deleteBookmark(e){this.bookmarks.forEach(((t,n)=>{t.id===e&&this.bookmarks.splice(n,1)}))}}}),Uo={previousProjectStructure:{},changeMade:!1,checkProjectVersion(){return new Promise((e=>{ne.hasInternetConnection()?de.getProjectVersion(B.getSlug()).then((function(t){t.data.data.attributes.structure_last_updated===B.getLastUpdated()?e(!0):e(!1)}),(function(t){e(!0)})):e(!0)}))},updateProject(){let e,t="",n="";const r=this;let s;const o=[],a=p().language;return new Promise(((i,l)=>{de.getProject(B.getSlug()).then((function(u){if(u.data){try{t=JSON.stringify(u.data.meta.project_extra),n=JSON.stringify(u.data.meta.project_mapping),e=u.data.meta.project_stats.structure_last_updated}catch(e){return void l()}r.previousProjectStructure=B.getProjectExtra(),B.loadExtraStructure(u.data.meta.project_extra),B.setLastUpdated(e),at.updateProject(B.getProjectRef(),t,n,e).then((function(){!function e(t){if(""!==t)r.selectAndUpdateEntries(t).then((function(){e(B.getNextFormRef(t))}),(function(){e(B.getNextFormRef(t))}));else{for(s in r.previousProjectStructure.forms)Object.prototype.hasOwnProperty.call(r.previousProjectStructure.forms,s)&&(B.getExtraForm(s)||o.push(s));ot.deleteFormEntries(B.getProjectRef(),o).then((function(){To.downloadProjectLogo(B.getSlug(),B.getProjectRef()).then((function(){i(r.changeMade),r.changeMade=!1}),(function(){i(r.changeMade),r.changeMade=!1}))}))}}(B.getFirstFormRef())}),(function(e){l(e)}))}else l({data:{errors:[{code:"ec5_116",source:"",title:b[a].status_codes.ec5_116}]}})}),(function(e){l(e)}))}))},selectAndUpdateEntries(e){const t=this,n=B.getExtraForm(e),r=n.group,s=t.getBranchInputs(n);let o,a;return new Promise(((i,u)=>{function c(n){const d=s[n],p=d.ref;I.selectBranchEntries(B.getProjectRef(),e,p).then((function(e){e.rows.length>0?(o=d.inputs,a=t.getInputRefs(o,r),t.updateEntries(l.BRANCH_ENTRIES_TABLE,e,a).then((function(){(n+=1)<s.length?c(n):i()}),(function(){u()}))):i()}),(function(){u()}))}I.selectEntries(B.getProjectRef(),e).then((function(e){e.rows.length>0?(o=n.inputs,a=t.getInputRefs(o,r),t.updateEntries(l.ENTRIES_TABLE,e,a).then((function(){s.length>0?c(0):i()}),(function(){u()}))):i()}),(function(){u()}))}))},updateEntries(e,t,n){let r,s;const o=this;let a;return new Promise((function(i,l){!function u(c){if(c===t.rows.length)i();else{const d=t.rows.item(c);try{r=d.id,s=JSON.parse(d.answers)}catch(e){l()}if(a=o.updateEntry(s,n),!a)return void i();o.changeMade=a;try{s=JSON.stringify(s)}catch(e){l()}at.updateEntryAnswers(e,r,s).then((function(){u(++c)}),(function(){u(++c)}))}}(0)}))},updateEntry(e,t){let n,r,s=!1;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(this.previousProjectStructure.inputs,t[n])||(r=B.getInput(t[n]),e[t[n]]=bt.createDefaultAnswer(r),s=!0));return s},getInputRefs(e,t){const n=[];let r,s,o;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){for(o in t)if(e[r]===o&&Object.prototype.hasOwnProperty.call(t,o))for(s in t[o])Object.prototype.hasOwnProperty.call(t[o],s)&&n.push(t[o][s]);n.push(e[r])}return n},getBranchInputs(e){const t=[],n=e.branch;let r,s;for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s={ref:r,inputs:n[r]},t.push(s));return t}};async function Wo(e){const t=R(),n=[],r=[],s=[];let o=!1,a=!1;const{formRef:i,parentEntryUuid:u,currentEntryOffset:c,filters:d,projectRef:p}=e,m=t.dbEntriesOrder,_=(await I.countEntriesUnsynced(p)).rows.item(0).total,f=(await I.countMediaUnsynced(p)).rows.item(0).total;o=_>0||f>0;const w=await I.selectEntries(p,i,u,m,l.ENTRIES_PER_PAGE,c,d,d.status);for(let e=0;e<w.rows.length;e++){const t=w.rows.item(e).title;n.push({title:t,entry_uuid:w.rows.item(e).entry_uuid,synced:w.rows.item(e).synced,can_edit:w.rows.item(e).can_edit,is_remote:w.rows.item(e).is_remote,created_at:w.rows.item(e).created_at,has_media_error:!1}),r.push(w.rows.item(e).entry_uuid)}const g=await I.selectBranches(r);for(let e=0;e<g.rows.length;e++)s.push({entry_uuid:g.rows.item(e).entry_uuid,owner_entry_uuid:g.rows.item(e).owner_entry_uuid}),r.push(g.rows.item(e).entry_uuid);const h=await I.selectEntryMediaErrors(r),E=await I.countEntries(p,i,u);if(n.length>0)for(let e=0;e<n.length;e++)for(let t=0;t<h.rows.length;t++){const r=h.rows.item(t).entry_uuid;n[e].entry_uuid===r&&(n[e].hasMediaError=!0);for(let t=0;t<s.length;t++)n[e].entry_uuid===s[t].owner_entry_uuid&&(n[e].hasMediaError=!0)}const y=B.getEntriesLimit(i);return a=null!==y&&E.rows.item(0).total>=window.parseInt(y,10),{entries:n,allMediaUuids:r,branchMediaUuids:s,hasUnsyncedEntries:o,entriesLimitReached:a}}const No={class:"entry-collected-on"};var Co={components:{ToolbarEntriesFilters:tt,IconEntry:rt},props:{countNoFilters:{type:Number,required:!0},countWithFilters:{type:Number,required:!0},projectRef:{type:String,required:!0},entries:{type:Array,required:!0},nextFormRef:{type:String,required:!0},formRef:{type:String,required:!0},parentEntryUuid:{type:String,required:!0},filters:{type:Object,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].labels,s=(0,D.tv)(),o=(0,m.qj)({entriesChunk:[],isInfiniteScrollDisabled:!1}),i=(0,a.f3)("entriesState"),{formRef:u,parentEntryUuid:c,entries:d,projectRef:_,filters:f}=(0,m.OT)(e),{nextFormRef:w}=(0,m.BK)(e),g={viewEntry(e){t.routeParams={entryUuid:e.entry_uuid,parentEntryUuid:c,formRef:u},s.replace({name:l.ROUTES.ENTRIES_VIEW})},goToChildEntriesPage(e,n){t.continueProjectVersionUpdate=!1;const r=[...t.hierarchyNavigation];r.push({parentEntryUuid:e,parentEntryName:n}),t.hierarchyNavigation=[...r];const o={...t.routeParams};o.formRef=w.value,t.routeParams=o,s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:"true",timestamp:Date.now()}})},utcToLocal(e){return(0,Ge.Z)(new Date(e),"dd MMM, yyyy @ h:mma")},loadEntriesChunk(e){setTimeout((async()=>{await async function(){return new Promise((e=>{const t=l.ENTRIES_PER_PAGE,n=o.entriesChunk.length+t;Wo({projectRef:_,formRef:u,parentEntryUuid:c,currentEntryOffset:n-t,filters:f,status:f.status}).then((t=>{t.entries.length>0?o.entriesChunk.push(...t.entries):o.isInfiniteScrollDisabled=!0,e()}))}))}(),e&&e.target.complete(),o.isInfiniteScrollDisabled&&(e.target.disabled=!0)}),l.DELAY_MEDIUM)},filtersClear(){i.filters={...l.FILTERS_DEFAULT},s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:"true",timestamp:Date.now()}})}},h={formName:(0,m.Fl)((()=>w.value?B.getFormName(w.value):""))};return(0,a.bv)((async()=>{o.entriesChunk=d.slice(0,l.ENTRIES_PER_PAGE),o.entriesChunk.length>=e.countNoFilters&&(o.isInfiniteScrollDisabled=!0)})),{labels:r,...g,...e,...h,state:o,PARAMETERS:l,chevronForward:T.XXs}}};var jo=(0,f.Z)(Co,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("toolbar-entries-filters"),u=(0,a.up)("icon-entry"),c=(0,a.up)("ion-label"),d=(0,a.up)("ion-col"),p=(0,a.up)("ion-icon"),m=(0,a.up)("ion-item"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("ion-list"),g=(0,a.up)("ion-infinite-scroll-content"),E=(0,a.up)("ion-infinite-scroll"),y=(0,a.up)("ion-card-title"),A=(0,a.up)("ion-card-header"),S=(0,a.up)("ion-card");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(w,{class:"list-entries ion-no-padding",lines:"full",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{countWithFilters:n.countWithFilters,countNoFilters:n.countNoFilters,onFiltersClear:t[0]||(t[0]=t=>e.filtersClear())},null,8,["countWithFilters","countNoFilters"]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.state.entriesChunk,(t=>(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{class:"list-entries-item",key:t.uuid},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{onClick:n=>e.viewEntry(t)},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{"size-xs":n.nextFormRef?8:12,"size-sm":n.nextFormRef?8:12,"size-md":n.nextFormRef?9:12,"size-lg":n.nextFormRef?9:12,"size-xl":n.nextFormRef?9:12},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"list-entries-item-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{entry:t},null,8,["entry"]),(0,a.Uk)(" "+(0,h.zw)(t.title),1)])),_:2},1024)])),_:2},1032,["size-xs","size-sm","size-md","size-lg","size-xl"]),n.nextFormRef?((0,a.wg)(),(0,a.j4)(d,{key:0,"size-xs":"4","size-sm":"4","size-md":"3","size-lg":"3","size-xl":"3",class:"list-entries-item-child"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{lines:"none",color:"secondary",button:"",class:"child-entries-item-button",onClick:(0,r.iM)((n=>e.goToChildEntriesPage(t.entry_uuid,t.title)),["stop"])},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.formName),1)])),_:1}),(0,a.Wm)(p,{icon:s.chevronForward,slot:"end"},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a._)("small",No,[(0,a._)("em",null,(0,h.zw)(s.labels.collected_on+e.utcToLocal(t.created_at)),1)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)),[[r.F8,n.countWithFilters>0]]))),128))])),_:1}),(0,a.wy)((0,a.Wm)(E,{disabled:n.countNoFilters<=s.PARAMETERS.ENTRIES_PER_PAGE,onIonInfinite:t[1]||(t[1]=t=>e.loadEntriesChunk(t)),threshold:"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{"loading-spinner":"crescent","loading-text":s.labels.loading},null,8,["loading-text"])])),_:1},8,["disabled"]),[[r.F8,n.countWithFilters>0]]),(0,a.wy)((0,a._)("div",null,[(0,a.Wm)(S,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.no_entries_found),1)])),_:1})])),_:1})])),_:1})],512),[[r.F8,0===n.countNoFilters||0===n.countWithFilters]])])}]]);const Lo={class:"center-item-content-wrapper half-padding"},Fo={class:"datetime-value"},qo=["min","max"],xo={class:"datetime-value"},Mo=["min","max"],zo=(0,a._)("div",{class:"line-divider"},null,-1);var Bo={props:{countNoFilters:{type:Number,required:!0},countWithFilters:{type:Number,required:!0},filters:{type:Object,required:!0},projectRef:{type:String,required:!0},formRef:{type:String,required:!0},parentEntryUuid:{type:String,required:!0}},setup(e){const t=p().language,n=b[t].labels,{projectRef:r,formRef:s,parentEntryUuid:o}=(0,m.OT)(e);let a;const u=(0,m.qj)({isFetching:!1,count:e.countWithFilters,filters:e.filters,searchbarInitialValue:e.filters.title});function c(e){const{projectRef:t,formRef:n,parentEntryUuid:r,filters:s}=e;return new Promise((e=>{let o={total:0,newest:(new Date).toISOString().split("T")[0],oldest:(new Date).toISOString().split("T")[0]};(async()=>{const a=await I.countEntries(t,n,r,s,s.status);a.rows.length>0&&a.rows.item(0).total>0&&(o={total:a.rows.item(0).total,oldest:a.rows.item(0).oldest.split("T")[0],newest:a.rows.item(0).newest.split("T")[0]}),e(o)})()}))}const d={countNoFilters:(0,m.Fl)((()=>e.countNoFilters)),countWithFilters:(0,m.Fl)((()=>u.count))},_={dismiss(){i.modalController.dismiss({filters:u.filters,count:u.count})},filterByTitle(e){const t=e.target.value;u.isFetching=!0,clearTimeout(a),a=window.setTimeout((async()=>{u.filters.title=t;const e=await c({projectRef:r,formRef:s,parentEntryUuid:o,filters:u.filters});u.count=e.total,u.filters.oldest=e.oldest,u.filters.newest=e.newest,u.isFetching=!1}),l.DELAY_LONG)},async filterByStatus(e){const t=e.target.value;u.isFetching=!0,u.filters.status=t,setTimeout((async()=>{const e=await c({projectRef:r,formRef:s,parentEntryUuid:o,filters:u.filters});u.count=e.total,u.filters.oldest=e.oldest,u.filters.newest=e.newest,u.isFetching=!1}),l.DELAY_LONG)},resetFilters(){u.isFetching=!0,u.searchbarInitialValue="",u.filters={...l.FILTERS_DEFAULT},setTimeout((async()=>{const e=await c({projectRef:r,formRef:s,parentEntryUuid:o,filters:u.filters,status:u.filters.status});u.count=e.total,u.filters.oldest=e.oldest,u.filters.newest=e.newest,u.filters.from=e.oldest,u.filters.to=e.newest,u.isFetching=!1}),l.DELAY_LONG)},filterByDate(){u.isFetching=!0,setTimeout((async()=>{const e=await c({projectRef:r,formRef:s,parentEntryUuid:o,filters:u.filters});u.count=e.total,u.filters.oldest=e.oldest,u.filters.newest=e.newest,u.isFetching=!1}),l.DELAY_LONG)}};return{labels:n,state:u,PARAMETERS:l,...d,..._,closeOutline:T.fID,filter:T.hXT,cloud:T.pzc,removeCircle:T.Dhl,cloudOutline:T.EIt,calendarClearOutline:T.l3U}}};var Go=(0,f.Z)(Bo,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-header"),m=(0,a.up)("ion-spinner"),_=(0,a.up)("ion-item"),f=(0,a.up)("ion-searchbar"),w=(0,a.up)("ion-label"),g=(0,a.up)("ion-chip"),E=(0,a.up)("ion-title"),y=(0,a.up)("ion-segment-button"),A=(0,a.up)("ion-segment"),S=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:s.state.isFetching,class:"button-close",onClick:t[0]||(t[0]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:s.closeOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.close),1)])),_:1},8,["disabled"])])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:s.state.isFetching,class:"button-close",onClick:t[1]||(t[1]=t=>e.resetFilters())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:s.filter},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.reset),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{lines:"none",class:"filter-by-title"},{default:(0,a.w5)((()=>[(0,a._)("div",Lo,[s.state.isFetching?((0,a.wg)(),(0,a.j4)(m,{key:0,name:"crescent",class:"spinner-filter"})):((0,a.wg)(),(0,a.j4)(u,{key:1,color:"secondary",size:"default",expand:"block",class:"animate__animated animate__fadeIn",onClick:t[2]||(t[2]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.show)+" "+(0,h.zw)(s.state.count)+" "+(0,h.zw)(s.labels.entries),1)])),_:1}))])])),_:1}),(0,a.Wm)(_,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{animated:"",debounce:"500",placeholder:s.labels.filter_by_title,onIonChange:e.filterByTitle,value:s.state.searchbarInitialValue},null,8,["placeholder","onIonChange","value"])])),_:1}),(0,a.Wm)(d,{class:"filter-by-date-from"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{class:"ion-text-end"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.from),1)])),_:1}),(0,a.Wm)(g,{class:"chip-datetimepicker entries-filters",outline:"",mode:"ios"},{default:(0,a.w5)((()=>[(0,a._)("div",Fo,[(0,a.Wm)(l,{class:"date-icon-left",size:"small",icon:s.calendarClearOutline},null,8,["icon"]),(0,a.wy)((0,a._)("input",{type:"date",min:s.state.filters.oldest,max:s.state.filters.newest,class:"question-input question-datetimepicker","onUpdate:modelValue":t[3]||(t[3]=e=>s.state.filters.from=e),onChange:t[4]||(t[4]=t=>e.filterByDate())},null,40,qo),[[r.nr,s.state.filters.from,void 0,{trim:!0}]])])])),_:1})])])),_:1})])),_:1}),(0,a.Wm)(d,{class:"filter-by-date-to"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{class:"ion-text-end"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",null,[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.to),1)])),_:1}),(0,a.Wm)(g,{class:"chip-datetimepicker entries-filters",outline:"",mode:"ios"},{default:(0,a.w5)((()=>[(0,a._)("div",xo,[(0,a.Wm)(l,{class:"date-icon-left",size:"small",icon:s.calendarClearOutline},null,8,["icon"]),(0,a.wy)((0,a._)("input",{type:"date",min:s.state.filters.oldest,max:s.state.filters.newest,class:"question-input question-datetimepicker","onUpdate:modelValue":t[5]||(t[5]=e=>s.state.filters.to=e),onChange:t[6]||(t[6]=t=>e.filterByDate())},null,40,Mo),[[r.nr,s.state.filters.to,void 0,{trim:!0}]])])])),_:1})])])])),_:1})])),_:1}),zo,(0,a.Wm)(_,{lines:"none",class:"filter-by-status"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{onIonChange:t[7]||(t[7]=t=>e.filterByStatus(t)),color:"tertiary",value:s.state.filters.status},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{value:s.PARAMETERS.STATUS.ALL,layout:"icon-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.cloudOutline},null,8,["icon"]),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.all),1)])),_:1})])),_:1},8,["value"]),(0,a.Wm)(y,{value:s.PARAMETERS.STATUS.INCOMPLETE,layout:"icon-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.removeCircle,class:"entry-incomplete"},null,8,["icon"]),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.incomplete),1)])),_:1})])),_:1},8,["value"]),(0,a.Wm)(y,{value:s.PARAMETERS.STATUS.ERROR,layout:"icon-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.cloud,class:"entry-sync-error"},null,8,["icon"]),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.error),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["value"])])),_:1})])),_:1})],64)}]]),Yo={emit:["filters-params"],props:{projectRef:{type:String,required:!0},isFetching:{type:Boolean,required:!0},parentEntryName:{type:String,required:!0},currentFormName:{type:String,required:!0},formRef:{type:String,required:!0},parentEntryUuid:{type:String,required:!0},countWithFilters:{type:Number,required:!0},countNoFilters:{type:Number,required:!0},filters:{type:Object,required:!0}},setup(e,t){const n={},r={async openModalEntriesFilter(){const{projectRef:r,formRef:s,parentEntryUuid:o,countNoFilters:a}=(0,m.OT)(e),l={...e.filters},u=e.countWithFilters;return n.ModalEntriesFilter=await i.modalController.create({cssClass:"modal-entries-filter",component:Go,showBackdrop:!0,backdropDismiss:!1,componentProps:{projectRef:r,formRef:s,parentEntryUuid:o,countWithFilters:u,countNoFilters:a,filters:l}}),n.ModalEntriesFilter.onWillDismiss().then((e=>{t.emit("filters-params",e.data)})),n.ModalEntriesFilter.present()}};return{...e,...r,star:T.h_b,filter:T.hXT}}};const Ho={getBookmarkId(e,t,n){const r=ko().bookmarks;let s=null;return r.forEach((r=>{r.projectRef===e&&r.formRef===t&&(0!==r.bookmark.length&&r.bookmark[r.bookmark.length-1].parentEntryUuid!==n||(s=r.id))})),s},async insertBookmark(e,t,n){const r=p(),s=ko();let o="";const a=r.hierarchyNavigation,i=a[a.length-1];return i&&(o=i.parentEntryUuid),new Promise(((r,i)=>{st.insertBookmark(e,t,n,JSON.stringify(a),o).then((function(o){s.addBookmark({id:o.insertId,projectRef:e,formRef:t,title:n,bookmark:a.slice()}),r(o.insertId)}),(function(e){i(e)}))}))},async deleteBookmark(e){const t=ko();return new Promise(((n,r)=>{ot.deleteBookmark(e).then((r=>{t.deleteBookmark(e),n()}),(e=>{r(e)}))}))},async getBookmarks(){const e=[];return new Promise(((t,n)=>{I.selectBookmarks().then((function(n){n.rows.length>0&&Object.values(n.rows).forEach((t=>{e.push({id:t.id,projectRef:t.project_ref,formRef:t.form_ref,title:t.title,bookmark:JSON.parse(t.bookmark)})})),t(e)}),(function(e){n(e)}))}))}};var Vo={components:{ListEntries:jo,ToolbarFormName:(0,f.Z)(Yo,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-title"),p=(0,a.up)("ion-toolbar");return n.isFetching?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(p,{key:0,color:"light",class:"form-name animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:s.star},null,8,["icon"])])),_:1})])),_:1},512),[[r.F8,!1]]),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:0===n.countNoFilters,onClick:t[0]||(t[0]=t=>e.openModalEntriesFilter())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"icon-only",icon:s.filter},null,8,["icon"])])),_:1},8,["disabled"])])),_:1}),(0,a.Wm)(d,{class:"form-name-label"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(n.parentEntryName)+" "+(0,h.zw)(n.currentFormName),1)])),_:1})])),_:1}))}]])},setup(){const e=p(),t=ko(),n=e.language,r=b[n].labels,s=(0,D.tv)(),o=(0,D.yj)(),u={},c=(0,m.qj)({isFetching:!0,entries:[],countNoFilters:0,countWithFilters:0,projectName:"",currentFormName:"",parentFormName:"",parentEntryName:"",formRef:"",nextFormRef:"",parentEntryUuid:"",hasUnsyncedEntries:!1,limit:1/0,status:l.STATUS.ALL,backLabel:b[n].labels.projects,allMediaUuids:[],branchMediaUuids:[],filters:{...l.FILTERS_DEFAULT},isDebug:l.DEBUG,isAddingFakeEntries:!1}),d=e.routeParams;u.projectRef=d.projectRef?d.projectRef:B.getProjectRef(),c.formRef=""!==d.formRef?d.formRef:z.formRef,u.getProjectAndEntries=async function(){function r(){c.entries=[],c.projectName=ne.getProjectNameMarkup(),function(){let n=B.getExtraForm(c.formRef);(""===c.formRef||0===Object.keys(n).length&&n.constructor===Object)&&(c.formRef=B.getFirstFormRef(),n=B.getExtraForm(c.formRef),e.hierarchyNavigation=[]),z.initialise(n);const r=e.hierarchyNavigation.length-1,s=e.hierarchyNavigation[r];c.parentEntryUuid=s?s.parentEntryUuid:"",c.parentEntryName=s?'"'+s.parentEntryName+'"':"",c.currentFormName=z.getName(),c.nextFormRef=B.getNextFormRef(c.formRef),c.parentFormRef=B.getParentFormRef(c.formRef),c.parentFormRef?(c.parentFormName=B.getFormName(c.parentFormRef),c.backLabel=c.parentFormName):c.backLabel=l.ROUTES.PROJECTS,t.getBookmarkId=Ho.getBookmarkId(u.projectRef,c.formRef,c.parentEntryUuid),c.limit=parseInt(B.getEntriesLimit(c.formRef),10)}(),function(){let e,t;return new Promise((n=>{(async()=>{const r=await I.countEntries(u.projectRef,c.formRef,c.parentEntryUuid,l.FILTERS_DEFAULT,l.STATUS.ALL);c.countNoFilters=r.rows.item(0).total;const s=await I.countEntries(u.projectRef,c.formRef,c.parentEntryUuid,c.filters,c.filters.status);s.rows.length>0&&(s.rows.item(0).total>0?(c.countWithFilters=s.rows.item(0).total,e=s.rows.item(0).oldest.split("T")[0],t=s.rows.item(0).newest.split("T")[0],null===c.filters.oldest&&null===c.filters.newest&&(c.filters.oldest=e,c.filters.newest=t,c.filters.from=e,c.filters.to=t)):c.countWithFilters=0),n(s.rows.item(0).total)})()}))}().then((function(e){setTimeout((function(){const{formRef:e,parentEntryUuid:t,filters:n,status:r}=c,{projectRef:s}=u;Wo({projectRef:s,formRef:e,parentEntryUuid:t,currentEntryOffset:0,filters:n,status:r}).then((e=>{c.entries=e.entries,c.branchMediaUuids=e.branchMediaUuids,c.hasUnsyncedEntries=e.hasUnsyncedEntries,c.allMediaUuids=e.allMediaUuids,c.isFetching=!1,setTimeout((function(){O.hideProgressDialog()}),l.DELAY_MEDIUM)}))}),0)}))}if(await O.showProgressDialog(b[n].labels.wait,b[n].labels.loading_entries),B.hasInitialised())r();else{const t=await I.selectProject(u.projectRef);e.continueProjectVersionUpdate=!0,B.initialise(t.rows.item(0)),r(),function(){const e=p(),t=e.language;return new Promise((n=>{function r(){const s=l.AUTH_ERROR_CODES;O.showProgressDialog(b[t].labels.wait,b[t].labels.updating_project),Uo.updateProject().then((function(e){e?O.showAlert(b[t].status_codes.ec5_137):O.showAlert(b[t].status_codes.ec5_136),O.hideProgressDialog(),O.showProgressDialog(b[t].labels.wait,b[t].labels.loading_entries),n(!0)}),(function(o){var a,i;O.hideProgressDialog(),s.indexOf(null==o||null===(a=o.data)||void 0===a||null===(i=a.errors[0])||void 0===i?void 0:i.code)>=0?(O.showToast(b[t].status_codes[o.data.errors[0].code]),e.afterUserIsLoggedIn={callback:r,params:null},So()):ve.handleWebError(o),n(!1)}))}Uo.checkProjectVersion().then((s=>{s?n(!1):!0===e.continueProjectVersionUpdate&&O.confirmSingle(b[t].labels.update_project,b[t].labels.project_outdated).then((e=>{e&&r()}),(e=>{n(!1)}))}))}))}().then((e=>{e&&(O.hideProgressDialog(),r())}))}},(0,a.bv)((async()=>{u.getProjectAndEntries()}));const _={openRightDrawer(){Us.m.open("right-drawer")},goBack(){if(e.continueProjectVersionUpdate=!1,""===c.parentFormRef)B.destroy(),z.destroy(),s.replace({name:l.ROUTES.PROJECTS,params:{projectName:c.projectName}});else{const t=[...e.hierarchyNavigation];t.pop(),e.hierarchyNavigation=[...t];const n={...e.routeParams};n.formRef=c.parentFormRef,0===e.hierarchyNavigation.length&&(n.formRef=""),e.routeParams=n,s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:"true",timestamp:Date.now()}})}},goToUploadPage(){e.continueProjectVersionUpdate=!1,e.nextRoute=l.ROUTES.ENTRIES,e.nextRoute=l.ROUTES.ENTRIES,e.routeParamsEntries=e.routeParams,s.replace({name:l.ROUTES.ENTRIES_UPLOAD})},utcToLocal(e){return(0,Ge.Z)(new Date(e),"dd MMM, yyyy @ h:mma")},viewEntry(t){e.continueProjectVersionUpdate=!1,e.routeParams={entryUuid:t.entry_uuid,parentEntryUuid:c.parentEntryUuid,formRef:c.formRef},s.replace({name:l.ROUTES.ENTRIES_VIEW})},async addEntry(){e.continueProjectVersionUpdate=!1,e.queueFilesToDelete=[],await O.showProgressDialog(b[n].labels.wait),Pt.setUpNew(c.formRef,c.parentEntryUuid,c.parentFormRef),e.routeParams={formRef:c.formRef,inputRef:null,inputIndex:0,isBranch:!1,error:{}},window.setTimeout((function(){O.hideProgressDialog()}),l.DELAY_LONG),s.replace({name:l.ROUTES.ENTRIES_ADD})},async addFakeEntries(){const{formRef:e,parentEntryUuid:t,parentFormRef:n}=c,r={formRef:e,parentEntryUuid:t,parentFormRef:n};c.isAddingFakeEntries=!0,await async function(e){return new Promise(((t,n)=>{const{formRef:r,parentEntryUuid:s,parentFormRef:o}=e,a=p().language,i=b[a].labels;(async()=>{await O.showProgressDialog(i.wait);const e=l.HOW_MANY_ENTRIES,n=l.HOW_MANY_BRANCH_ENTRIES;let a;const u=[];for(const[e,t]of Object.entries(z.formStructure.branch))u.push(e);!function i(c){a=0,Pt.setUpNew(r,s,o),It.addFakeAnswers(Pt.entry,Pt.form.inputs.slice(0),c).then((function(){!function r(s){if(u[a]){Ut.setUpNew(z.formRef,u[a],Pt.entry.entryUuid);const e=B.getBranches(z.formRef,u[a]);It.addFakeAnswers(Ut.entry,e.slice(0),s).then((function(){Ut.saveEntry(l.SYNCED_CODES.UNSYNCED),s<n?r(++s):(a++,r(1))}))}else Pt.saveEntry(l.SYNCED_CODES.UNSYNCED).then((function(){c<e?i(++c):(O.hideProgressDialog(),t())}))}(1)}))}(1)})()}))}(r),c.isAddingFakeEntries=!1,setTimeout((function(){s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:"true",timestamp:Date.now()}})}),l.DELAY_FAST)},applyFilters(e){ne.objectsMatch(c.filters,e.filters)||(c.isFetching=!0,c.filters=e.filters,c.countWithFilters=e.count,u.getProjectAndEntries())}},f={isEntriesLimitReached:(0,m.Fl)((()=>!!c.formRef&&(null!==c.limit&&c.countNoFilters>=c.limit))),warningEntriesLimitReached:(0,m.Fl)((()=>b[n].status_codes.ec5_250.split(".")[0]))};return(0,a.YP)((()=>[{refreshEntries:o.params.refreshEntries,refresh:o.params.refresh,timestamp:o.params.timestamp}]),(async t=>{e.continueProjectVersionUpdate=!1,"true"===t[0].refreshEntries&&(c.isFetching=!0,await O.showProgressDialog(b[n].labels.wait,b[n].labels.loading_entries),setTimeout((async()=>{c.formRef=e.routeParams.formRef,c.filters={...l.FILTERS_DEFAULT},u.getProjectAndEntries()}),l.DELAY_LONG))})),(0,a.JJ)("entriesState",c),(0,i.useBackButton)(10,(()=>{e.continueProjectVersionUpdate=!1,c.isAddingFakeEntries||c.isFetching||_.goBack()})),{labels:r,..._,...u,...f,state:c,cloudUpload:T.RH0,add:T.IHx,chevronBackOutline:T.ZY4,ellipsisVertical:T.LHl}}};var Qo=(0,f.Z)(Vo,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-menu-button"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-buttons"),p=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-label"),_=(0,a.up)("ion-item"),f=(0,a.up)("toolbar-form-name"),w=(0,a.up)("ion-spinner"),g=(0,a.up)("list-entries"),E=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(E,{key:0,title:s.state.projectName},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(l)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:t[0]||(t[0]=t=>e.goToUploadPage())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"icon-only",icon:s.cloudUpload},null,8,["icon"])])),_:1}),(0,a.Wm)(c,{onClick:t[1]||(t[1]=t=>e.openRightDrawer())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"icon-only",icon:s.ellipsisVertical},null,8,["icon"])])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(p,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:t[2]||(t[2]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.chevronBackOutline},null,8,["icon"]),(0,a._)("div",vo,(0,h.zw)(s.state.backLabel),1)])),_:1})])),_:1}),(0,a.Wm)(d,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:e.isEntriesLimitReached,onClick:t[3]||(t[3]=t=>e.addEntry())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.add},null,8,["icon"]),(0,a._)("div",Po,(0,h.zw)(s.labels.add_entry),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),s.state.isDebug&&!s.state.isFetching?((0,a.wg)(),(0,a.j4)(p,{key:0,color:"tertiary",mode:"ios",class:"animate__animated animate__fadeIn ion-no-margin ion-no-padding ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"ion-text-uppercase ion-no-margin ion-no-padding",fill:"clear",color:"dark",onClick:t[4]||(t[4]=t=>e.addFakeEntries())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.add},null,8,["icon"]),Do])),_:1})])),_:1})):(0,a.kq)("",!0),s.state.hasUnsyncedEntries&&!s.state.isFetching?((0,a.wg)(),(0,a.j4)(_,{key:1,class:"item-warning ion-text-center animate__animated animate__fadeIn",lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-uppercase ion-text-start"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.unsynced_entries),1)])),_:1}),(0,a.Wm)(c,{color:"warning",size:"default",onClick:t[5]||(t[5]=t=>e.goToUploadPage())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{icon:s.cloudUpload,slot:"start"},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.sync_now),1)])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(f,{isFetching:s.state.isFetching,projectRef:e.projectRef,parentEntryName:s.state.parentEntryName,currentFormName:s.state.currentFormName,formRef:s.state.formRef,parentEntryUuid:s.state.parentEntryUuid,countWithFilters:s.state.countWithFilters,countNoFilters:s.state.countNoFilters,filters:{...s.state.filters},onFiltersParams:e.applyFilters},null,8,["isFetching","projectRef","parentEntryName","currentFormName","formRef","parentEntryUuid","countWithFilters","countNoFilters","filters","onFiltersParams"])])),content:(0,a.w5)((()=>[s.state.isFetching?((0,a.wg)(),(0,a.j4)(w,{key:0,class:"loader",name:"crescent"})):((0,a.wg)(),(0,a.iD)("div",Oo,[e.isEntriesLimitReached?((0,a.wg)(),(0,a.j4)(_,{key:0,class:"ion-text-center ion-no-padding ion-no-margin",lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{color:"warning",class:"ion-no-padding ion-no-margin ion-text-wrap"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.warningEntriesLimitReached),1)])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.wy)((0,a.Wm)(g,{projectRef:e.projectRef,entries:s.state.entries,nextFormRef:s.state.nextFormRef,formRef:s.state.formRef,parentEntryUuid:s.state.parentEntryUuid,filters:s.state.filters,countWithFilters:s.state.countWithFilters,countNoFilters:s.state.countNoFilters},null,8,["projectRef","entries","nextFormRef","formRef","parentEntryUuid","filters","countWithFilters","countNoFilters"]),[[r.F8,!s.state.isFetching]])]))])),_:1},8,["title"])}]]);const Zo={key:1},Jo={key:1,class:"branch-entries-errors-item"},Xo={key:2};var Ko={components:{IconEntry:rt},setup(){const e=p(),t=e.language,n=b[t].labels,r=(0,D.tv)(),s=(0,D.yj)(),o=(0,m.qj)({isFetching:!0,projectName:"",entriesInvalid:{},forms:B.getForms(),refNames:{}});o.projectName=ne.getProjectNameMarkup(),(0,a.bv)((async()=>{!function(){let e;const t=B.getExtraInputs();let r;for(const s in o.forms)if(Object.prototype.hasOwnProperty.call(o.forms,s))for(e in o.refNames[s]=o.forms[s].details.name,r=B.getFormBranches(s),r)Object.prototype.hasOwnProperty.call(t,e)&&(o.refNames[e]=o.forms[s].details.name+" > "+n.branch+": "+t[e].data.question)}(),c()}));const u={openRightDrawer(){Us.m.open("right-drawer")},goToUploadPage(){e.nextRoute=r.currentRoute.value.name,r.replace({name:l.ROUTES.ENTRIES_UPLOAD})},viewEntry(t){e.nextRoute=l.ROUTES.ENTRIES_ERRORS,t.is_branch?I.selectEntry(t.owner_entry_uuid,null).then((function(n){const s=Oe;s.initialise(n.rows.item(0)),Pt.setUpExisting(s).then((function(){e.routeParams={formRef:t.form_ref,inputRef:t.owner_input_ref,inputIndex:B.getInputIndexFromRef(t.form_ref,t.owner_input_ref),error:{errors:[]}},r.replace({name:l.ROUTES.ENTRIES_ADD})}))})):(e.routeParams={entryUuid:t.entry_uuid,parentEntryUuid:t.parent_entry_uuid,formRef:t.form_ref},r.replace({name:l.ROUTES.ENTRIES_VIEW,params:{timestamp:Date.now()}}))}};async function c(){const e=B.getProjectRef();let t,r,s,a,i;await O.showProgressDialog(n.wait),o.isFetching=!0,o.entriesInvalid={};const u=await I.selectInvalidEntries(l.ENTRIES_TABLE,e);for(a=0;a<u.rows.length;a++)t=u.rows.item(a).title,r=u.rows.item(a).form_ref,i={title:t,entry_uuid:u.rows.item(a).entry_uuid,parent_entry_uuid:u.rows.item(a).parent_entry_uuid,form_ref:r,synced:u.rows.item(a).synced,can_edit:u.rows.item(a).can_edit,is_branch:!1},o.entriesInvalid[r]=o.entriesInvalid[r]||{},o.entriesInvalid[r].entries=o.entriesInvalid[r].entries||[],o.entriesInvalid[r].entries.push(i);const c=await I.selectInvalidEntries(l.BRANCH_ENTRIES_TABLE,e);for(a=0;a<c.rows.length;a++)t=c.rows.item(a).title,r=c.rows.item(a).form_ref,s=c.rows.item(a).owner_input_ref,i={title:t,entry_uuid:c.rows.item(a).entry_uuid,owner_input_ref:s,owner_entry_uuid:c.rows.item(a).owner_entry_uuid,form_ref:r,synced:c.rows.item(a).synced,can_edit:c.rows.item(a).can_edit,is_branch:!0},o.entriesInvalid[r]=o.entriesInvalid[r]||{},o.entriesInvalid[r].branch_entries=o.entriesInvalid[r].branch_entries||{},o.entriesInvalid[r].branch_entries[s]=o.entriesInvalid[r].branch_entries[s]||[],o.entriesInvalid[r].branch_entries[s].push(i);O.hideProgressDialog(),o.isFetching=!1}return(0,a.YP)((()=>[{refreshEntriesErrors:s.params.refreshEntriesErrors,timestamp:s.params.timestamp}]),(e=>{"true"===e[0].refreshEntriesErrors&&c()})),(0,i.useBackButton)(10,(()=>{o.isFetching||u.goToUploadPage()})),{labels:n,...u,state:o,bug:T.jIG,cloud:T.pzc,chevronBackOutline:T.ZY4,ellipsisVertical:T.LHl}}};var $o=(0,f.Z)(Ko,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-menu-button"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-spinner"),m=(0,a.up)("ion-title"),_=(0,a.up)("ion-label"),f=(0,a.up)("ion-item"),w=(0,a.up)("ion-list"),g=(0,a.up)("icon-entry"),E=(0,a.up)("ion-card-title"),y=(0,a.up)("ion-card-header"),A=(0,a.up)("ion-card"),S=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(S,{title:r.state.projectName},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(i)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[0]||(t[0]=t=>e.openRightDrawer())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"icon-only",icon:r.ellipsisVertical},null,8,["icon"])])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[1]||(t[1]=t=>e.goToUploadPage())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.sync_now),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>[r.state.isFetching?((0,a.wg)(),(0,a.j4)(p,{key:0,class:"loader",name:"crescent"})):(0,a.kq)("",!0),Object.keys(r.state.entriesInvalid).length>0?((0,a.wg)(),(0,a.iD)("div",Zo,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.entriesInvalid,((t,n,s)=>((0,a.wg)(),(0,a.iD)("div",{key:s},[(0,a.Wm)(d,{color:"light",class:"form-name",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"form-name-label-errors"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.refNames[n]),1)])),_:2},1024)])),_:2},1024),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t,((n,s,o)=>((0,a.wg)(),(0,a.iD)("div",{key:o,class:"entries-errors-item"},[void 0!==t.entries&&"entries"===s?((0,a.wg)(),(0,a.j4)(w,{key:0,lines:"full",class:"ion-no-padding"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n,((t,n,s)=>((0,a.wg)(),(0,a.j4)(f,{key:s},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"list-entries-item-title",onClick:n=>e.viewEntry(t)},{default:(0,a.w5)((()=>[-1===t.synced?((0,a.wg)(),(0,a.j4)(l,{key:0,icon:r.cloud,class:"entry-sync-error icon-error-entries"},null,8,["icon"])):(0,a.kq)("",!0),t.hasMediaError?((0,a.wg)(),(0,a.j4)(l,{key:1,icon:r.bug,class:"entry-sync-error icon-error-entries"},null,8,["icon"])):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,h.zw)(t.title),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:2},1024)):(0,a.kq)("",!0),void 0!==t.branch_entries&&"branch_entries"===s?((0,a.wg)(),(0,a.iD)("div",Jo,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n,((t,n,s)=>((0,a.wg)(),(0,a.j4)(w,{lines:"full",class:"ion-no-padding",key:s},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"medium",class:"form-name",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"form-name-label-errors"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.state.refNames[n]),1)])),_:2},1024)])),_:2},1024),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t,((t,n,r)=>((0,a.wg)(),(0,a.j4)(f,{key:r},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"list-entries-item-title",onClick:n=>e.viewEntry(t),"ng-class":"left_column"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{entry:t},null,8,["entry"]),(0,a.Uk)(" "+(0,h.zw)(t.title),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:2},1024)))),128))])):(0,a.kq)("",!0)])))),128))])))),128))])):((0,a.wg)(),(0,a.iD)("div",Xo,[(0,a.Wm)(A,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.no_errors_found),1)])),_:1})])),_:1})])),_:1})]))])),_:1},8,["title"])}]]);const ea={key:1},ta={key:0},na={key:1},ra={key:3};const sa={class:"answer-label-question"},oa={class:"answer-button-edit ion-activatable ripple-parent ion-text-center"};var aa={name:"ListAnswers",props:{items:{type:Object,required:!0},entry:{type:Object,required:!0},errors:{type:Object,required:!0},formRef:{type:String,required:!0},areGroupAnswers:{type:Boolean,required:!0},areBranchAnswers:{type:Boolean,required:!0}},setup(e){const t=p(),n=t.language,r=b[n].status_codes,s=b[n].labels,o=(0,D.tv)(),a=(0,m.qj)({itemsChunk:[]}),i={isInfiniteScrollDisabled:(0,m.Fl)((()=>{const{areGroupAnswers:t,items:n}=e;return t||Object.entries(n).length<=l.ANSWERS_PER_PAGE}))},u={async editAnswer(r,s){if(e.areBranchAnswers)return u.editAnswerBranch(r,s),!1;await O.showProgressDialog(b[n].labels.wait),Pt.setUpExisting(e.entry).then((function(){t.routeParams={formRef:e.formRef,inputRef:r,inputIndex:s,error:e.errors,isBranch:!1},o.replace({name:l.ROUTES.ENTRIES_ADD})}))},async editAnswerBranch(r,s){const{entry:a,errors:i}=(0,m.OT)(e);await O.showProgressDialog(b[n].labels.wait),await Ut.setUpExisting(a),t.routeParams={formRef:a.formRef,inputRef:r,inputIndex:s,error:i,isBranch:!0},o.replace({name:l.ROUTES.ENTRIES_BRANCH_ADD})},loadItemsChunk(t){(t=>{setTimeout((()=>{(()=>{const t=a.itemsChunk.length+l.ANSWERS_PER_PAGE;for(let n=t-l.ANSWERS_PER_PAGE;n<t;n++)Object.values(e.items)[n]&&a.itemsChunk.push(Object.values(e.items)[n])})(),t&&t.target.complete(),a.itemsChunk.length===Object.entries(e.items).length&&t&&(t.target.disabled=!0)}),l.DELAY_MEDIUM)})(t)}};return u.loadItemsChunk(),{labels:s,statusCodes:r,state:a,...e,...u,...i,eye:T.iyy,create:T.Ue8}}};var ia=(0,f.Z)(aa,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-col"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-ripple-effect"),d=(0,a.up)("ion-row"),p=(0,a.up)("ion-grid"),m=(0,a.up)("ion-card-title"),_=(0,a.up)("ion-card-header"),f=(0,a.up)("list-item-answer"),w=(0,a.up)("ion-card-content"),g=(0,a.up)("ion-card"),E=(0,a.up)("ion-infinite-scroll-content"),y=(0,a.up)("ion-infinite-scroll"),A=(0,a.up)("ion-list");return(0,a.wg)(),(0,a.j4)(A,{class:"answer-list"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.state.itemsChunk,((t,o)=>((0,a.wg)(),(0,a.j4)(g,{key:o,class:"answer-card animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a._)("div",null,["readme"!==t.type?((0,a.wg)(),(0,a.j4)(_,{key:0,class:(0,h.C_)(["answer-label force-no-padding",t.synced_error?"has-error":""])},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{"size-xs":"10","size-sm":"11","size-md":"11","size-lg":"11","size-xl":"11"},{default:(0,a.w5)((()=>[(0,a._)("div",sa,(0,h.zw)(t.question),1)])),_:2},1024),(0,a.Wm)(l,{"size-xs":"2","size-sm":"1","size-md":"1","size-lg":"1","size-xl":"1"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",oa,[!1===n.areGroupAnswers?((0,a.wg)(),(0,a.j4)(u,{key:0,icon:"branch"===t.type?s.eye:s.create,onClick:n=>e.editAnswer(t.input_ref,t.input_index)},null,8,["icon","onClick"])):(0,a.kq)("",!0),(0,a.Wm)(c,{class:"answer-label-button-ripple",type:"unbounded"})],512),[[r.F8,0!==t.can_edit||"branch"===t.type]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])):(0,a.kq)("",!0),"group"===t.type?((0,a.wg)(),(0,a.j4)(w,{key:1,class:"answer-card-group"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{formRef:n.formRef,entry:n.entry,errors:n.errors,item:t,areGroupAnswers:!1},null,8,["formRef","entry","errors","item"])])),_:2},1024)):((0,a.wg)(),(0,a.j4)(w,{key:2},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{formRef:n.formRef,entry:n.entry,errors:n.errors,item:t,areGroupAnswers:n.areGroupAnswers},null,8,["formRef","entry","errors","item","areGroupAnswers"])])),_:2},1024))])])),_:2},1024)))),128)),(0,a.Wm)(y,{class:"ion-margin-top",onIonInfinite:t[0]||(t[0]=t=>e.loadItemsChunk(t)),threshold:"100px",disabled:e.isInfiniteScrollDisabled},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{"loading-spinner":"crescent","loading-text":s.labels.loading},null,8,["loading-text"])])),_:1},8,["disabled"])])),_:1})}],["__scopeId","data-v-0e550f3d"]]),la={components:{ListAnswers:ia,ItemDividerError:bs},setup(){const e=p(),t=e.language,n=b[t].labels,r=b[t].status_codes,s=(0,D.tv)(),o=(0,D.yj)(),u=(0,m.qj)({isFetching:!0,projectName:"",formRef:"",entryUuid:"",parentEntryUuid:"",title:"",entry:{},errors:{},branches:{},branchesMediaErrors:{},items:{},inputsExtra:{},statusCodes:b[t].status_codes,synced:null}),c=e.routeParams;u.entry=Oe,u.entryUuid=c.entryUuid,u.parentEntryUuid=c.parentEntryUuid,u.formRef=c.formRef,u.inputs=B.getFormInputs(u.formRef),u.inputsExtra=B.getExtraInputs(),u.synced=u.entry.synced;const d={goBack(){if(e.nextRoute){const t=e.nextRoute,n=t===l.ROUTES.ENTRIES,r=t===l.ROUTES.ENTRIES_ERRORS;s.replace({name:e.nextRoute,params:{refreshEntries:n,refreshEntriesErrors:r,timestamp:Date.now()}}),e.nextRoute=null}else s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0}})},async deleteEntry(){const r=B.getProjectRef();let o=[];const a=[],i=[];async function c(t){if(await Promise.all(t.map((e=>ot.deleteEntry(e)))),await Ho.getBookmarks(),e.nextRoute){const t=e.nextRoute,n=t===l.ROUTES.ENTRIES,r=t===l.ROUTES.ENTRIES_ERRORS;s.replace({name:e.nextRoute,params:{refreshEntries:n,refreshEntriesErrors:r,timestamp:Date.now()}}),e.nextRoute=null}else e.routeParams={projectRef:B.getProjectRef(),formRef:u.formRef},s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0,timestamp:Date.now()}});O.showToast(n.entry_deleted)}await O.confirmSingle(b[t].status_codes.ec5_129)&&I.getHierarchyEntries(u.entryUuid).then((function(e){o=e.entries.concat(e.branchEntries).concat([u.entryUuid]),Promise.all(o.map((function(e){return I.selectEntryMedia(r,e)}))).then((function(e){e.forEach((e=>{e.forEach((e=>{a.push(e.entry_uuid),i.push({file_name:e.file_name,file_path:e.file_path,project_ref:r})}))})),i.length>0?le.removeFiles(i).then((function(){Promise.all(a.map((function(e){return ot.deleteEntryMedia(e)}))).then((function(){c(o)}))})):c(o)}))}))},goToUploadPage(){e.nextRoute=s.currentRoute.value.name,s.replace({name:l.ROUTES.ENTRIES_UPLOAD})}};async function _(){let e,t,r;await O.showProgressDialog(n.wait,n.loading_entry),Promise.all([I.selectEntry(u.entryUuid,u.parentEntryUuid),I.selectEntryMediaErrors([u.entryUuid])]).then((function(n){const s=n[0],o=n[1];let a,i=[];for(let e=0;e<o.rows.length;e++)a=JSON.parse(o.rows.item(e).synced_error),a.errors.forEach((t=>{t.inputRef=o.rows.item(e).input_ref,i=i.concat(t)}));try{s.rows.length>0&&(t=s.rows.item(0),u.entry.initialise(t),u.title=u.entry.title,u.synced=u.entry.synced),u.errors=JSON.parse(t.synced_error),u.errors.errors=u.errors.errors.concat(i)}catch(e){u.errors={},i.length>0&&(u.errors.errors=i)}I.selectBranches([u.entry.entryUuid]).then((function(t){for(u.branches={},e=0;e<t.rows.length;e++)u.branches[t.rows.item(e).owner_input_ref]?u.branches[t.rows.item(e).owner_input_ref]++:u.branches[t.rows.item(e).owner_input_ref]=1;u.inputs.forEach(((e,t)=>{r=u.inputsExtra[e].data,void 0!==u.entry.answers[r.ref]&&(u.entry.answers[r.ref].was_jumped||f(r,t)),1===u.entry.isRemote&&r.type===l.QUESTION_TYPES.GROUP&&f(r,t)})),u.isFetching=!1,setTimeout((()=>{O.hideProgressDialog(l.DELAY_LONG)}),l.DELAY_LONG)}))}))}function f(e,n){let r,s,o,a,i="",c="";switch(e.type){case l.QUESTION_TYPES.GROUP:for(c={},o=B.getFormGroups(u.entry.formRef),s=0;s<o[e.ref].length;s++){if(a=u.inputsExtra[o[e.ref][s]].data,i="",u.errors.errors)for(r in u.errors.errors)Object.prototype.hasOwnProperty.call(u.errors.errors,r)&&(u.errors.errors[r].source===a.ref&&(i=b[t].status_codes[u.errors.errors[r].code]||u.errors.errors[r].title),"ec5_231"===u.errors.errors[r].code&&u.errors.errors[r].inputRef&&u.errors.errors[r].inputRef===a.ref&&(i=b[t].status_codes[u.errors.errors[r].code]||u.errors.errors[r].title));a.type===l.QUESTION_TYPES.README&&1===u.entry.isRemote||(c[a.ref]={type:a.type,question:a.type===l.QUESTION_TYPES.README?ne.htmlDecode(a.question):a.question,answer:d(a,u.entry.answers[a.ref].answer),synced_error:i})}p(),m();break;case l.QUESTION_TYPES.BRANCH:c=d(e,u.branches),I.countCurrentBranchMediaErrors(e.ref).then((function(n){const r={errors:[{code:"ec5_231",title:b[t].entries_errors,source:e.ref}]};u.branchesMediaErrors[e.ref]=n.rows.item(0).total>0,u.branchesMediaErrors[e.ref]&&(0===Object.keys(u.errors).length?u.errors=r:u.errors.errors=u.errors.errors.concat(r)),p(),m()}));break;default:c=d(e,u.entry.answers[e.ref].answer),p(),m()}function d(e,t){return bt.parseAnswerForViewing(e,t)}function p(){if(u.errors.errors)for(r in u.errors.errors)Object.prototype.hasOwnProperty.call(u.errors.errors,r)&&(u.errors.errors[r].source===e.ref&&(i=b[t].status_codes[u.errors.errors[r].code]||u.errors.errors[r].title),u.errors.errors[r].inputRef&&u.errors.errors[r].inputRef===e.ref&&(i=b[t].status_codes[u.errors.errors[r].code]||u.errors.errors[r].title))}function m(){u.items[e.ref]={question:e.type===l.QUESTION_TYPES.README?ne.htmlDecode(e.question):e.question,answer:c,possible_answers:e.possible_answers.length>0?e.possible_answers:null,input_ref:e.ref,input_index:n,type:e.type,synced_error:i,can_edit:u.entry.canEdit}}u.projectName=ne.getProjectNameMarkup()}return _(),(0,a.YP)((()=>[{refreshEntriesView:o.params.refreshEntriesView,timestamp:o.params.timestamp}]),(async e=>{"true"===e[0].refreshEntriesView&&(u.isFetching=!0,await O.showProgressDialog(n.wait,n.loading_entry),setTimeout((async()=>{_()}),l.DELAY_LONG))})),(0,i.useBackButton)(10,(()=>{u.isFetching||d.goBack()})),{state:u,labels:n,statusCodes:r,...d,desktopOutline:T.xWY,cloudUpload:T.RH0,trash:T._Ij,removeCircle:T.Dhl,chevronBackOutline:T.ZY4}}};var ua=(0,f.Z)(la,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-menu-button"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-spinner"),m=(0,a.up)("item-divider-error"),_=(0,a.up)("ion-label"),f=(0,a.up)("ion-item"),w=(0,a.up)("list-answers"),g=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(g,{title:r.state.projectName},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(i)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"icon-only"})])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[0]||(t[0]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.back),1)])),_:1})])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[1]||(t[1]=t=>e.deleteEntry())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.trash},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.delete),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>{var n,s;return[r.state.isFetching?((0,a.wg)(),(0,a.j4)(p,{key:0,class:"loader",name:"crescent"})):((0,a.wg)(),(0,a.iD)("div",ea,[(null===(n=r.state.errors)||void 0===n||null===(s=n.errors)||void 0===s?void 0:s.length)>0?((0,a.wg)(),(0,a.iD)("div",ta,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.errors.errors,((e,t)=>((0,a.wg)(),(0,a.j4)(m,{key:t,message:r.statusCodes[e.code]||e.title},null,8,["message"])))),128))])):(0,a.kq)("",!0),2===r.state.synced?((0,a.wg)(),(0,a.iD)("div",na,[(0,a.Wm)(f,{class:"item-warning animate__animated animate__fadeIn",lines:"full",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"end",icon:r.removeCircle},null,8,["icon"]),(0,a.Wm)(_,{class:"ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.incomplete_entry),1)])),_:1})])),_:1})])):(0,a.kq)("",!0),0===r.state.synced?((0,a.wg)(),(0,a.j4)(f,{key:2,class:"item-warning ion-text-center animate__animated animate__fadeIn",lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"ion-text-uppercase ion-text-start"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.unsynced_entry),1)])),_:1}),(0,a.Wm)(u,{color:"warning",size:"default",onClick:t[2]||(t[2]=t=>e.goToUploadPage())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{icon:r.cloudUpload,slot:"start"},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.sync_now),1)])),_:1})])),_:1})):(0,a.kq)("",!0),1===r.state.entry.isRemote?((0,a.wg)(),(0,a.iD)("div",ra,[(0,a.Wm)(f,{class:"item-warning animate__animated animate__fadeIn",lines:"full",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"end",icon:r.desktopOutline},null,8,["icon"]),(0,a.Wm)(_,{class:"ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.remote_entry),1)])),_:1})])),_:1})])):(0,a.kq)("",!0),(0,a.Wm)(w,{formRef:r.state.formRef,items:r.state.items,entry:r.state.entry,errors:r.state.errors,areGroupAnswers:!1,areBranchAnswers:!1},null,8,["formRef","items","entry","errors"])]))]})),_:1},8,["title"])}]]);const ca={key:1},da={key:0},pa={key:1};var ma={components:{ListAnswers:ia,ItemDividerError:bs},setup(){const e=p(),t=e.language,n=b[t].labels,r=b[t].status_codes,s=(0,D.tv)(),o=(0,D.yj)(),u=(0,m.qj)({isFetching:!0,projectName:"",formRef:"",entryUuid:"",parentEntryUuid:"",ownerEntryUuid:"",ownerInputRef:"",title:"",entry:{},errors:{},branches:{},branchesMediaErrors:{},items:{},inputsExtra:{},branchInputs:[],statusCodes:b[t].status_codes,synced:null}),c=e.routeParams;u.entry=kt,u.entryUuid=c.entryUuid,u.ownerEntryUuid=c.ownerEntryUuid,u.ownerInputRef=c.ownerInputRef,u.formRef=c.formRef,u.projectName=ne.getProjectNameMarkup(),u.branchInputs=B.getBranches(u.formRef,u.ownerInputRef),u.inputsExtra=B.getExtraInputs(),u.synced=u.entry.synced;const d={goBack(){e.routeParams={formRef:u.entry.formRef,inputRef:u.entry.ownerInputRef,inputIndex:B.getInputIndexFromRef(u.entry.formRef,u.entry.ownerInputRef),error:u.errors},s.replace({name:l.ROUTES.ENTRIES_ADD,params:{refreshBranchEntries:"true",timestamp:Date.now()}})},async deleteEntryBranch(){if(await O.confirmSingle(b[t].status_codes.ec5_129,n.delete_branch_entry+"?")){await ot.deleteBranchEntry(u.entryUuid);const e=await I.selectProjectMedia({project_ref:B.getProjectRef(),synced:null,entry_uuid:[u.entryUuid]}),t=e.audios.concat(e.videos).concat(e.photos);if(0===t.length)return O.showToast(n.entry_deleted),d.goBack(),!1;try{await le.removeFiles(t),await ot.deleteEntryMedia(u.entryUuid),O.showToast(n.entry_deleted),d.goBack()}catch(e){}}},async editEntry(t,n){await Ut.setUpExisting(u.entry),e.routeParams={formRef:u.entry.formRef,inputRef:t,inputIndex:n,error:u.errors,isBranch:!0},s.replace({name:l.ROUTES.ENTRIES_ADD})}};async function _(){let r,s;await O.showProgressDialog(n.wait,n.loading_entry),Promise.all([I.selectBranchEntry(u.entryUuid),I.selectEntryMediaErrors([u.entryUuid])]).then((n=>{const o=n[0],a=n[1];let i,c=[];for(let e=0;e<a.rows.length;e++)i=JSON.parse(a.rows.item(e).synced_error),i.errors.forEach((t=>{t.inputRef=a.rows.item(e).input_ref,c=c.concat(t)}));try{o.rows.length>0&&(r=o.rows.item(o.rows.length-1),u.entry.initialise(r),u.title=u.entry.title,u.synced=u.entry.synced),u.errors=JSON.parse(r.synced_error),u.errors.errors=u.errors.errors.concat(c)}catch(e){u.errors={},c.length>0&&(u.errors.errors=c)}Object.values(u.branchInputs).forEach(((n,r)=>{s=u.inputsExtra[n].data,void 0!==u.entry.answers[s.ref]&&(u.entry.answers[s.ref].was_jumped||function(n,r){let s,o,a,i,c="",d="";switch(n.type){case l.QUESTION_TYPES.GROUP:for(d={},a=B.getFormGroups(u.entry.formRef),o=0;o<a[n.ref].length;o++){if(i=u.inputsExtra[a[n.ref][o]].data,c="",u.errors.errors)for(s in u.errors.errors)Object.prototype.hasOwnProperty.call(u.errors.errors,s)&&(u.errors.errors[s].source===i.ref&&(c=b[t].status_codes[u.errors.errors[s].code]||u.errors.errors[s].title),"ec5_231"===u.errors.errors[s].code&&u.errors.errors[s].inputRef&&u.errors.errors[s].inputRef===i.ref&&(c=b[t].status_codes[u.errors.errors[s].code]||u.errors.errors[s].title));i.type===l.QUESTION_TYPES.README&&1===u.entry.isRemote||(d[i.ref]={type:i.type,question:i.type===l.QUESTION_TYPES.README?ne.htmlDecode(i.question):i.question,answer:p(i,u.entry.answers[i.ref].answer),synced_error:c})}m(),_();break;case l.QUESTION_TYPES.BRANCH:d=p(n,u.branches),I.countCurrentBranchMediaErrors(n.ref).then((function(e){const r={errors:[{code:"ec5_231",title:b[t].entries_errors,source:n.ref}]};u.branchesMediaErrors[n.ref]=e.rows.item(0).total>0,u.branchesMediaErrors[n.ref]&&(0===Object.keys(u.errors).length?u.errors=r:u.errors.errors=u.errors.errors.concat(r)),m(),_()}));break;default:d=p(n,u.entry.answers[n.ref].answer),m(),_()}function p(e,t){return bt.parseAnswerForViewing(e,t)}function m(){if(u.errors.errors)for(s in u.errors.errors)Object.prototype.hasOwnProperty.call(u.errors.errors,s)&&(u.errors.errors[s].source===n.ref&&(c=b[t].status_codes[u.errors.errors[s].code]||u.errors.errors[s].title),u.errors.errors[s].inputRef&&u.errors.errors[s].inputRef===n.ref&&(c=b[t].status_codes[u.errors.errors[s].code]||u.errors.errors[s].title))}function _(){u.items[n.ref]={question:n.type===l.QUESTION_TYPES.README?ne.htmlDecode(n.question):n.question,answer:d,possible_answers:n.possible_answers.length>0?n.possible_answers:null,input_ref:n.ref,input_index:r,type:n.type,synced_error:c,can_edit:u.entry.canEdit}}u.projectName=ne.getProjectNameMarkup();e.routeParams}(s,r))})),O.hideProgressDialog(),u.isFetching=!1}))}return _(),(0,a.YP)((()=>[{refreshEntriesViewBranch:o.params.refreshEntriesViewBranch,timestamp:o.params.timestamp}]),(e=>{"true"===e[0].refreshEntriesViewBranch&&(u.isFetching=!0,setTimeout((async()=>{_()}),l.DELAY_LONG))})),(0,i.useBackButton)(10,(()=>{u.isFetching||d.goBack()})),{state:u,labels:n,statusCodes:r,...d,chevronBackOutline:T.ZY4,trash:T._Ij}}};var _a=(0,f.Z)(ma,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-menu-button"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-spinner"),m=(0,a.up)("item-divider-error"),_=(0,a.up)("ion-label"),f=(0,a.up)("ion-item-divider"),w=(0,a.up)("list-answers"),g=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(g,{title:r.state.projectName,id:"entries-view-branch"},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(i)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"icon-only"})])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[0]||(t[0]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.back),1)])),_:1})])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[1]||(t[1]=t=>e.deleteEntryBranch())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.trash},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.delete),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>{var e,t;return[r.state.isFetching?((0,a.wg)(),(0,a.j4)(p,{key:0,class:"loader",name:"crescent"})):((0,a.wg)(),(0,a.iD)("div",ca,[(null===(e=r.state.errors)||void 0===e||null===(t=e.errors)||void 0===t?void 0:t.length)>0?((0,a.wg)(),(0,a.iD)("div",da,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.errors.errors,((e,t)=>((0,a.wg)(),(0,a.j4)(m,{key:t,message:r.statusCodes[e.code]||e.title},null,8,["message"])))),128))])):(0,a.kq)("",!0),2===r.state.synced?((0,a.wg)(),(0,a.iD)("div",pa,[(0,a.Wm)(f,{color:"warning",class:"entry-incomplete",sticky:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"entry-title-label ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.incomplete_entry),1)])),_:1})])),_:1})])):(0,a.kq)("",!0),(0,a.Wm)(w,{formRef:r.state.formRef,items:r.state.items,entry:r.state.entry,errors:r.state.errors,areGroupAnswers:!1,areBranchAnswers:!0},null,8,["formRef","items","entry","errors"])]))]})),_:1},8,["title"])}]]);const fa={class:"ion-text-center"},wa={class:"ion-text-center"};const ga={key:0,class:"progress-transfer animate__animated animate__fadeIn"};var ha={props:{header:{type:String,required:!0}},setup(e){const t=p(),n=t.language;return{labels:b[n].labels,...{progress:(0,m.Fl)((()=>{const e=t.progressTransfer;return e.done/e.total})),total:(0,m.Fl)((()=>t.progressTransfer.total)),done:(0,m.Fl)((()=>t.progressTransfer.done)),header:e.header}}}};var Ea=(0,f.Z)(ha,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-title"),l=(0,a.up)("ion-toolbar"),u=(0,a.up)("ion-header"),c=(0,a.up)("ion-spinner"),d=(0,a.up)("ion-progress-bar"),p=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"ion-text-center",color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(n.header),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(p,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"spinner-transfer",name:"crescent"}),e.total>0?((0,a.wg)(),(0,a.iD)("div",ga,[(0,a.Wm)(d,{color:"primary",value:e.progress},null,8,["value"]),(0,a._)("strong",null,[(0,a._)("p",null,(0,h.zw)(e.done)+"/"+(0,h.zw)(e.total),1)])])):(0,a.kq)("",!0)])),_:1})],64)}]]);async function ya(){const e=p(),t=e.language,n=b[t].labels,r=l.AUTH_ERROR_CODES;await O.showProgressDialog(n.wait,n.updating_project),Uo.updateProject().then((function(n){O.hideProgressDialog(0),n?(e.nextRoute=l.ROUTES.ENTRIES,O.showAlert(b[t].status_codes.ec5_137)):O.showAlert(b[t].status_codes.ec5_136)}),(function(n){var s,o;O.hideProgressDialog(),r.indexOf(null==n||null===(s=n.data)||void 0===s||null===(o=s.errors[0])||void 0===o?void 0:o.code)>=0?(O.showAlert(b[t].status_codes[n.data.errors[0].code]),e.afterUserIsLoggedIn={callback:ya,params:null},So()):ve.handleWebError(n)}))}const Aa={execute(e,t,n){const r=p(),s=r.language;let o;function a(e){e?n+=e:n++,O.setProgress({total:t,done:n})}return new Promise((function(i,u){I.getUser().then((function(u){u.rows.length>0&&(o=u.rows.item(0).jwt);B.getProjectRef();const c=B.getSlug(),d=new window.FileTransfer,p=new window.FileUploadOptions,m=B.getServerUrl()+l.API.ROUTES.ROOT+l.API.ROUTES.UPLOAD+c;let _,f=!1,w={errors:[{code:"ec5_116",source:"",title:b[s].status_codes.ec5_116}]};function g(t,n,u){let c;switch(t.file_type){case l.QUESTION_TYPES.AUDIO:c=l.AUDIO_DIR;break;case l.QUESTION_TYPES.PHOTO:c=l.PHOTO_DIR;break;case l.QUESTION_TYPES.VIDEO:c=l.VIDEO_DIR}function h(r,s){at.updateFileEntrySynced(t.id,r,s).then((function(t){u++,O.setProgress({total:n,done:u}),0===e.length?(f&&ve.handleWebError({data:w}),i(f)):window.setTimeout((async function(){await ne.hasInternetConnection()?g(e.pop(),n,u):(ve.handleWebError({data:w}),i(f))}),l.DELAY_FAST)}),(function(e){i(e)}))}p.mimeType=ne.getMIMEType(t.file_type),p.fileKey="name",p.fileName=t.file_name,p.params={data:JSON.stringify(Ie.makeJsonFileEntry(t))},o&&(p.headers={Authorization:"Bearer "+o}),_=r.persistentDir+c+t.project_ref+"/"+t.file_name,r.device.platform===l.IOS&&(_="file://"+_,p.chunkedMode=!1),d.upload(_,m,(function(e){200===e.responseCode?(a(),h(1)):(O.hideProgressDialog(),O.showToast(b[s].status_codes.ec5_125))}),(function(e){if(O.hideProgressDialog(),f=!0,e.body){try{w=JSON.parse(e.body)}catch(e){}h(0,w)}else ne.hasInternetConnection().then((e=>{e||(w={errors:[{code:"ec5_330",source:"",title:b[s].status_codes.ec5_330}]}),h(0,w)}))}),p)}e.length>0&&window.setTimeout((function(){g(e.pop(),t,n)}),l.DELAY_FAST)}))}))}},Sa={execute(e){return new Promise((function(t,n){const r=p().language;let s,o=0;const a=[],i=B.getProjectRef(),u=B.getFirstFormRef(),c=B.getSlug();let d,m,_=!1;const f=l.UPLOAD_STOPPING_ERROR_CODES;let w={errors:[{code:"ec5_116",source:"",title:b[r].status_codes.ec5_116}]};function g(e){d=null,0===a.length&&null===e?window.setTimeout((function(){g(u)}),l.DELAY_FAST):(a.length>0&&(d=a[a.length-1]),I.selectOneEntry(i,e,d,[l.SYNCED_CODES.UNSYNCED,l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES],null).then((function(r){r.rows.length>0?0===r.rows.item(0).can_edit||r.rows.item(0).synced===l.SYNCED_CODES.HAS_UNSYNCED_CHILD_ENTRIES?(E(),a.push(r.rows.item(0).entry_uuid),window.setTimeout((function(){h()}),l.DELAY_FAST)):(s=Ie.makeJsonEntry(l.ENTRY,r.rows.item(0)),de.uploadEntry(c,s).then((function(){E(),a.push(r.rows.item(0).entry_uuid),window.setTimeout((function(){h()}),l.DELAY_FAST)}),(async function(e){const o=s.entry.entry_uuid,a=await I.countUnsyncedBranchEntries(i,o);a.rows.item(0).count>0&&E(a.rows.item(0).count),void 0===e&&n();try{y(l.ENTRY,e.data,r.rows.item(0).entry_uuid).then((function(){E(),window.setTimeout((function(){g(null)}),l.DELAY_FAST)}),(function(e){_?t(_):n(e)}))}catch(e){n()}}))):e&&0===r.rows.length?t(_):(a.length>0&&(d=a[a.length-1]),at.updateSynced(l.ENTRY,d,l.SYNCED_CODES.SYNCED).then((function(){a.pop(),window.setTimeout((function(){g(null)}),l.DELAY_FAST)})))})))}function h(){m=null,a.length>0&&(m=a[a.length-1]),I.selectOneBranchEntry(i,m,l.SYNCED_CODES.UNSYNCED).then((function(e){e.rows.length>0?1===e.rows.item(0).can_edit?(s=Ie.makeJsonEntry(l.BRANCH_ENTRY,e.rows.item(0)),de.uploadEntry(c,s).then((function(){at.updateSynced(l.BRANCH_ENTRY,e.rows.item(0).entry_uuid,l.SYNCED_CODES.SYNCED).then((function(){E(),window.setTimeout((function(){h()}),l.DELAY_FAST)}))}),(function(r){y(l.BRANCH_ENTRY,r.data,e.rows.item(0).entry_uuid).then((function(){E(),window.setTimeout((function(){h()}),l.DELAY_FAST)}),(function(e){_?t(_):n(e)}))}))):(E(),window.setTimeout((function(){h()}),l.DELAY_FAST)):window.setTimeout((function(){g(null)}),l.DELAY_FAST)}))}function E(t){t?o+=t:o++,O.setProgress({total:e,done:o})}function y(e,t,n){return _=!0,new Promise((function(r,s){t&&(w=t),w.errors&&f.indexOf(w.errors[0].code)>=0?(_=!1,s({data:t})):at.updateSynced(e,n,l.SYNCED_CODES.SYNCED_WITH_ERROR,w).then((function(){r()}),(function(e){s()}))}))}g(u)}))}};var Ta={setup(){const e=p(),t=e.language,n=b[t].labels,r=(0,D.tv)(),s=(0,m.qj)({totalEntriesIncomplete:0,totalEntriesUnsynced:0,totalEntriesWithErrors:0,totalEntries:0,photos:[],videos:[],audios:[],errors:!1,canUploadData:!1,isUploading:!1});function o(){const e=B.getProjectRef();return new Promise((t=>{!async function(){const n=await I.countUnsyncedEntries(e);s.totalEntries=n.rows.item(0).total_number_of_entries,s.totalEntriesUnsynced=n.rows.item(0).total_number_of_entries_unsynced,s.totalEntriesWithErrors=n.rows.item(0).total_number_of_entries_with_errors,s.totalEntriesIncomplete=n.rows.item(0).total_number_of_incomplete_entries,s.totalEntriesUnsynced>0&&0===s.totalEntriesWithErrors?(s.canUploadData=!0,s.totalEntriesWithErrors>0&&(s.errors=!0),t()):(s.canUploadData=!1,s.totalEntriesWithErrors>0?(s.errors=!0,t()):(await new Promise(((e,t)=>{!async function(){const t=await Ot.getProjectStoredMedia({project_ref:B.getProjectRef(),synced:0,entry_uuid:null});t.photos.length>0&&(s.photos=t.photos),t.videos.length>0&&(s.videos=t.videos),t.audios.length>0&&(s.audios=t.audios),e()}()})),t()))}()}))}async function u(t,n){e.progressTransfer={total:n,done:0};return(await i.modalController.create({cssClass:"modal-progress-transfer",component:Ea,showBackdrop:!0,backdropDismiss:!1,componentProps:{header:t}})).present()}const c={async uploadData(){const r=l.PROJECT_OUTDATED_ERROR_CODES,a=l.AUTH_ERROR_CODES;return await ne.hasInternetConnection()?0===s.totalEntriesUnsynced?(O.showToast(b[t].status_codes.ec5_119),!1):void(s.totalEntriesUnsynced>0&&(e.attemptedUploadOrErrorFix=!0,s.isUploading=!0,await u(n.uploading_entries,s.totalEntriesUnsynced),Sa.execute(s.totalEntriesUnsynced).then((async function(e){await o(),i.modalController.dismiss(),s.isUploading=!1,s.errors=e,s.errors||s.totalEntriesWithErrors>0?O.showAlert(b[t].status_codes.ec5_125):s.totalEntriesIncomplete>0?O.showAlert(b[t].status_codes.ec5_139):O.showToast(b[t].status_codes.ec5_120)}),(async function(n){var l,u,c,d;if(await o(),i.modalController.dismiss(),s.isUploading=!1,r.indexOf(null==n||null===(l=n.data)||void 0===l||null===(u=l.errors[0])||void 0===u?void 0:u.code)>=0){await O.confirmSingle(b[t].labels.update_project,b[t].labels.project_outdated)?ya():ve.handleWebError(n)}else if(a.indexOf(null==n||null===(c=n.data)||void 0===c||null===(d=c.errors[0])||void 0===d?void 0:d.code)>=0)if("ec5_78"!==n.data.errors[0].code){await O.confirmSingle(b[e.language].status_codes[n.data.errors[0].code])&&So()}else ve.handleWebError(n);else ve.handleWebError(n)})))):(O.showAlert(b[t].labels.connect_to_internet_to_upload),!1)},async uploadMedia(e){const r=s[e+"s"].length;let a=n.uploading_entries;if(!await ne.hasInternetConnection())return O.showAlert(b[t].labels.connect_to_internet_to_upload),!1;if(0===r)return O.showToast(b[t].status_codes.ec5_119),!1;switch(e){case l.QUESTION_TYPES.AUDIO:a=n.uploading_audios;break;case l.QUESTION_TYPES.VIDEO:a=n.uploading_videos;break;default:a=n.uploading_photos}await u(a,r),s.isUploading=!0,Aa.execute(s[e+"s"],r,0).then((async function(e){await o(),i.modalController.dismiss(),s.isUploading=!1,s.errors=e,s.errors?O.showAlert(b[t].status_codes.ec5_125):O.showToast(b[t].status_codes.ec5_120)}))},goBack(){e.attemptedUploadOrErrorFix?(e.attemptedUploadOrErrorFix=!1,e.routeParams=e.routeParamsEntries,r.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0,timestamp:Date.now()}})):r.replace({name:e.nextRoute,params:{...e.routeParams}})},goToEntriesErrors(){e.attemptedUploadOrErrorFix=!0,r.replace({name:l.ROUTES.ENTRIES_ERRORS,params:{refreshEntriesErrors:!0,timestamp:Date.now()}})}},d={projectName:ne.getProjectNameMarkup(),areAllEntrieUploaded:(0,a.Fl)((()=>0===s.totalEntriesIncomplete&&s.totalEntries>0&&!s.canUploadData&&!s.errors&&0===s.photos.length&&0===s.videos.length&&0===s.audios.length&&!s.isUploading))};return o(),(0,i.useBackButton)(10,(()=>{s.isUploading||c.goBack()})),{labels:n,PARAMETERS:l,...c,...d,state:s,videocam:T.HIy,chevronBackOutline:T.ZY4,checkmark:T.d29,images:T.WcA,musicalNotes:T.BE_,alertCircle:T.no6,documentText:T.BvF}}};var ba=(0,f.Z)(Ta,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-menu-button"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-buttons"),p=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-col"),_=(0,a.up)("ion-row"),f=(0,a.up)("ion-grid"),w=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(w,{title:e.projectName},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(l)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:"true"},{default:(0,a.w5)((()=>[(0,a.Wm)(u)])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(p,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:t[0]||(t[0]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.back),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(_,{class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"subheader-success"},{default:(0,a.w5)((()=>[(0,a._)("div",fa,[(0,a._)("p",null,[(0,a.Wm)(u,{icon:s.checkmark},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.all_entries_uploaded),1)])])])),_:1})])),_:1},512),[[r.F8,e.areAllEntrieUploaded]]),0===s.state.totalEntries?((0,a.wg)(),(0,a.j4)(_,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center subheader-default"},{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,h.zw)(s.labels.no_entries_found),1)])),_:1})])),_:1})):(0,a.kq)("",!0),s.state.totalEntriesIncomplete>0?((0,a.wg)(),(0,a.j4)(_,{key:1,class:"subheader-error"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a._)("div",wa,[(0,a._)("p",null,[(0,a.Wm)(u,{icon:s.alertCircle},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.incomplete_entries),1)])])])),_:1})])),_:1})):(0,a.kq)("",!0),s.state.totalEntries>0&&s.state.errors?((0,a.wg)(),(0,a.j4)(_,{key:2,class:"ion-margin-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"danger",expand:"block",onClick:t[1]||(t[1]=t=>e.goToEntriesErrors())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.check_entries),1)])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(_,{class:"ion-margin-bottom ion-margin-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:!s.state.canUploadData,color:"secondary",expand:"block",onClick:t[2]||(t[2]=t=>e.uploadData())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.documentText},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.upload_data),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:0===s.state.photos.length,color:"secondary",expand:"block",onClick:t[3]||(t[3]=t=>e.uploadMedia(s.PARAMETERS.QUESTION_TYPES.PHOTO))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.images},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.upload_photos),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:0===s.state.audios.length,color:"secondary",expand:"block",onClick:t[4]||(t[4]=t=>e.uploadMedia(s.PARAMETERS.QUESTION_TYPES.AUDIO))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.musicalNotes},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.upload_audios),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),(0,a.Wm)(_,{class:"ion-margin-bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"size-xs":"8","offset-xs":"2","size-sm":"6","offset-sm":"3","size-md":"4","offset-md":"4","size-lg":"4","offset-lg":"4",class:"ion-align-self-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{disabled:0===s.state.videos.length,color:"secondary",expand:"block",onClick:t[5]||(t[5]=t=>e.uploadMedia(s.PARAMETERS.QUESTION_TYPES.VIDEO))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.videocam},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.upload_videos),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1},8,["title"])}]]);const Ra={class:"center-item-content-wrapper"};var Ia={components:{},setup(){const e=p(),t=e.language,n=b[t].labels,r=(0,D.tv)(),s=(0,m.qj)({filtersToggle:e.filtersToggle,serverUrl:e.serverUrl,selectedTextSize:e.selectedTextSize,isSaving:!1}),o={appVersion:(0,m.Fl)((()=>e.app.name+" v "+e.app.version)),isDebug:(0,m.Fl)((()=>l.DEBUG))},u={goBack(){r.replace({name:e.nextRoute,params:{...e.routeParams}})},async saveSettings(){let r=!1;await O.showProgressDialog(),s.isSaving=!0;for(let e=0;e<=5;e++)document.body.classList.remove("zoom-"+e);document.body.classList.add("zoom-"+s.selectedTextSize),Object.values(l.SETTINGS_KEYS).forEach((async t=>{switch(t){case l.SETTINGS_KEYS.SERVER_URL:try{await st.insertSetting(t,s.serverUrl),e.serverUrl=s.serverUrl}catch(e){r=!0}break;case l.SETTINGS_KEYS.SELECTED_TEXT_SIZE:try{await st.insertSetting(t,s.selectedTextSize),e.selectedTextSize=s.selectedTextSize}catch(e){r=!0}break;case l.SETTINGS_KEYS.FILTERS_TOGGLE:try{await st.insertSetting(t,s.filtersToggle),e.filtersToggle=s.filtersToggle}catch(e){r=!0}}})),O.hideProgressDialog(),s.isSaving=!1,r?O.showAlert(n.unknown_error,n.error):O.showToast(b[t].status_codes.ec5_123)},updateSelectedTextSize(t){s.selectedTextSize=t.detail.value,e.selectedTextSize=s.selectedTextSize},onFiltersToggleChange(){s.filtersToggle=!s.filtersToggle}};return(0,a.bv)((()=>{})),(0,i.useBackButton)(10,(()=>{s.isSaving||u.goBack()})),{labels:n,...u,...o,state:s,chevronBackOutline:T.ZY4,add:T.IHx,remove:T.OdJ,checkmark:T.d29}}};var va=(0,f.Z)(Ia,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("ion-menu-button"),u=(0,a.up)("ion-icon"),c=(0,a.up)("ion-button"),d=(0,a.up)("ion-buttons"),p=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-label"),_=(0,a.up)("ion-card-title"),f=(0,a.up)("ion-card-header"),w=(0,a.up)("ion-item"),g=(0,a.up)("ion-range"),E=(0,a.up)("ion-card-content"),y=(0,a.up)("ion-card"),A=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(A,{title:""},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(l)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(c,{fill:"clear",onClick:t[0]||(t[0]=t=>e.saveSettings())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.checkmark},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.save),1)])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(p,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:t[1]||(t[1]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.back),1)])),_:1})])),_:1}),(0,a.Wm)(d,{class:"toolbar-spacer",slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"end",icon:s.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.back),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>[(0,a.Wm)(p,{color:"light",mode:"ios",class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a._)("div",Ra,[(0,a.Wm)(m,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.settings),1)])),_:1})])])),_:1}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.accessibility),1)])),_:1})])),_:1}),(0,a.Wm)(E,{class:"ion-text-left ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{lines:"full",class:"ion-text-left"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.text_size),1)])),_:1})])),_:1}),(0,a.Wm)(w,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{min:"0",max:"5",step:"1",debounce:"500",snaps:"true",ticks:"true",value:s.state.selectedTextSize,onIonChange:t[2]||(t[2]=t=>e.updateSelectedTextSize(t))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start",icon:s.remove},null,8,["icon"]),(0,a.Wm)(u,{slot:"end",icon:s.add},null,8,["icon"])])),_:1},8,["value"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.version),1)])),_:1})])),_:1}),(0,a.Wm)(E,{class:"ion-text-left ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{lines:"none",class:"ion-text-left"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(e.appVersion),1)])),_:1})])),_:1})])),_:1})])),_:1}),e.isDebug?((0,a.wg)(),(0,a.j4)(y,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.advanced_settings),1)])),_:1})])),_:1}),(0,a.Wm)(E,{class:"ion-text-center ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{color:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.server_url),1)])),_:1})])),_:1}),(0,a.Wm)(w,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("input",{class:"full-width",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>s.state.serverUrl=e)},null,512),[[r.nr,s.state.serverUrl]])])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})}]]);const Pa={class:"center-item-content-wrapper"};const Da={downloadFormEntries(e){const t=p().language,n={errors:[{code:"ec5_116",source:"",title:b[t].status_codes.ec5_116}]};return new Promise(((t,r)=>{const s=B.getSlug();let o=0,a=0;!function i(u){de.downloadEntries(s,e,u).then((function(e){if(e.data.data){const n=e.data.data.entries,r=e.data.links.next;o=e.data.meta.total;let s=!1;n.length>0?(s=!0,n.forEach((e=>{const t=Ie.flattenJsonEntry(e,l.EDIT_CODES.CANT,l.REMOTE_CODES.IS);t.projectRef=B.getProjectRef(),st.insertEntry(t,l.SYNCED_CODES.SYNCED).then((function(){}),(function(e){})),a++})),function(e){O.setProgress({total:o,done:e})}(a),r?i(r):t(s)):t(s)}else r(n)}),(function(e){r(e)}))}()}))}};var Oa={setup(){const e=p(),t=e.language,n=b[t].labels,r=(0,D.tv)(),s=(0,m.qj)({projectName:"",forms:[],errors:!1,completed:!1,noEntriesFound:!1,enabledButtons:[],entriesDownloaded:[],showWarning:!0,wasAttemptedDownload:!1,isFetching:!1});s.projectName=ne.getProjectNameMarkup();const o={goBack(){const t=r.currentRoute.value.name;s.wasAttemptedDownload||null===e.nextRoute||e.nextRoute===t?r.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0,timestamp:Date.now()}}):r.replace({name:e.nextRoute,params:{...e.routeParams}})},downloadEntries(r){function o(){!async function(){e.progressTransfer={total:0,done:0};const t=await i.modalController.create({cssClass:"modal-progress-transfer",component:Ea,showBackdrop:!0,backdropDismiss:!1,componentProps:{header:n.downloading_entries}});t.onDidDismiss().then((e=>{s.isFetching=!1})),s.isFetching=!0,t.present()}(),Da.downloadFormEntries(r).then((function(e){let n="ec5_143";i.modalController.dismiss(),e?(s.enabledButtons[B.getNextFormRef(r)]=!0,s.entriesDownloaded[r]=!0,B.getLastFormRef()===r&&(s.completed=!0)):(n="ec5_144",B.getFirstFormRef()===r?s.noEntriesFound=!0:s.completed=!0),O.showToast(b[t].status_codes[n])}),(async function(t){var n,r;const s=l.AUTH_ERROR_CODES;if(i.modalController.dismiss(),s.indexOf(null==t||null===(n=t.data)||void 0===n||null===(r=n.errors[0])||void 0===r?void 0:r.code)>=0){if("ec5_78"!==t.data.errors[0].code){await O.confirmSingle(b[e.language].status_codes[t.data.errors[0].code])&&So()}}else ve.handleWebError(t)}))}s.showWarning?O.confirmSingle(n.download_warning,n.download_remote_entries).then((function(e){e&&(s.showWarning=!1,s.wasAttemptedDownload=!0,o())})):o()}};return function(){const e=B.getExtraForms();let t=0;for(const[n,r]of Object.entries(e))0===t&&(s.enabledButtons[n]=!0),t++,s.forms.push({name:r.details.name,formRef:n})}(),(0,i.useBackButton)(10,(()=>{s.isFetching||o.goBack()})),{labels:n,...o,state:s,chevronBackOutline:T.ZY4,documentText:T.BvF}}};var ka=(0,f.Z)(Oa,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-menu-button"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-item"),m=(0,a.up)("ion-list"),_=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(_,{title:r.state.projectName},{"actions-start":(0,a.w5)((()=>[(0,a.Wm)(i)])),"actions-end":(0,a.w5)((()=>[(0,a.Wm)(u,{disabled:"true"},{default:(0,a.w5)((()=>[(0,a.Wm)(l)])),_:1})])),subheader:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"dark",mode:"md"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[0]||(t[0]=t=>e.goBack())},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.chevronBackOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.back),1)])),_:1})])),_:1})])),_:1})])),content:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.forms,(t=>((0,a.wg)(),(0,a.j4)(p,{key:t.ref,lines:"none"},{default:(0,a.w5)((()=>[(0,a._)("div",Pa,[(0,a.Wm)(u,{onClick:n=>e.downloadEntries(t.formRef),disabled:!r.state.enabledButtons[t.formRef]||r.state.entriesDownloaded[t.formRef]||r.state.noEntriesFound||r.state.completed,size:"default",color:"secondary",expand:"block"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{slot:"start",icon:r.documentText},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(t.name),1)])),_:2},1032,["onClick","disabled"])])])),_:2},1024)))),128))])),_:1})])),_:1},8,["title"])}]]);let Ua=[];if("PWA".toLowerCase()===l.PWA.toLowerCase()){const e=ne.getBasepath();Ua=[{path:e+"/",component:L,name:l.ROUTES.NOT_FOUND},{path:e+"/project/:project_slug/add-entry",component:Ps,name:l.ROUTES.ENTRIES_ADD},{path:e+"/project/:project_slug/edit-entry",component:Ps,name:l.ROUTES.ENTRIES_EDIT},{path:e+"/project/:project_slug/add-entry/branch",component:Ps,name:l.ROUTES.ENTRIES_BRANCH_ADD},{path:e+"/:pathMatch(.*)*",redirect:{name:l.ROUTES.NOT_FOUND}}]}else Ua=[{path:"/",redirect:{name:l.ROUTES.PROJECTS}},{path:"/projects",component:W,name:l.ROUTES.PROJECTS},{path:"/projects/add",component:Io,name:l.ROUTES.PROJECTS_ADD},{path:"/projects/entries",component:Qo,name:l.ROUTES.ENTRIES},{path:"/projects/entries/add",component:Ps,name:l.ROUTES.ENTRIES_ADD},{path:"/projects/entries/errors",component:$o,name:l.ROUTES.ENTRIES_ERRORS},{path:"/projects/entries/add/branch",component:Ps,name:l.ROUTES.ENTRIES_BRANCH_ADD},{path:"/projects/entries/view",component:ua,name:l.ROUTES.ENTRIES_VIEW},{path:"/projects/entries/view/branch",component:_a,name:l.ROUTES.ENTRIES_VIEW_BRANCH},{path:"/projects/entries/upload",component:ba,name:l.ROUTES.ENTRIES_UPLOAD},{path:"/settings",component:va,name:l.ROUTES.SETTINGS},{path:"/projects/entries/download",component:ka,name:l.ROUTES.ENTRIES_DOWNLOAD}];var Wa=(0,g.p7)({history:(0,g.PO)(),scrollBehavior(){return{x:0,y:0}},routes:Ua}),Na=n(125),Ca=(n(8851),n(2406)),ja=n(5137);const La={async execute(e){const t=R().db;let n=e;return new Promise(((r,s)=>{function o(e,t){s(t)}t.transaction((t=>{switch(parseInt(e,10)+1){case 2:n=2,t.executeSql("ALTER TABLE unique_answers ADD COLUMN form_ref text",[],(function(e){}),o),t.executeSql("ALTER TABLE temp_unique_answers ADD COLUMN form_ref text",[],(function(e){}),o);case 3:n=3,t.executeSql("ALTER TABLE users ADD COLUMN name text",[],(function(e){}),o);case 4:n=4,t.executeSql("ALTER TABLE users ADD COLUMN email text",[],(function(e){}),o);case 5:n=5,t.executeSql("ALTER TABLE projects ADD COLUMN mapping text",[],(function(e){}),o)}}),o,(e=>{t.transaction((e=>{e.executeSql("INSERT OR REPLACE INTO settings (field, value) VALUES (?,?)",[u.dbVersionName,n],(()=>{r(n)}),o)}))}))}))}},Fa={async getDeviceInfo(){const e=await Ca.A.getInfo(),t=await Ca.A.getId();return e.platform===l.WEB&&"PWA".toLowerCase()===l.PWA.toLowerCase()&&(e.platform=l.PWA),{...e,...t}},async getAppInfo(){const e=p();return[l.WEB,l.PWA].includes(e.device.platform)?{name:"Epicollect5 Beta",version:"n/a"}:await ja.g.getInfo()},async openDB(e){return new Promise((t=>{let n={};e===l.WEB?(n=window.openDatabase("epicollect5.db","1.0","epicollect5",5e6),t(n)):document.addEventListener("deviceready",(()=>{e===l.ANDROID&&(n=window.sqlitePlugin.openDatabase({name:"epicollect5.db",location:"default",androidDatabaseProvider:"system",androidLockWorkaround:1}),t(n)),e===l.IOS&&(n=window.sqlitePlugin.openDatabase({name:"epicollect5.db",iosDatabaseLocation:"Documents"}),t(n))}))}))},async getDBVersion(){let e;return new Promise(((t,n)=>{I.selectSetting("db_version").then((n=>{n.rows.length>0&&(e=n.rows.item(0).value),t(e)}),(e=>{n(e)}))}))},async migrateDB(){let e=R().dbVersion;return e||(e=1),new Promise(((t,n)=>{La.execute(e).then((e=>{t(e)}),(e=>{n(e)}))}))},async getLanguage(){let e=p().language;return new Promise(((t,n)=>{function r(e){ce()("./assets/ec5-status-codes/"+e+".json").then((n=>{b[e].status_codes=n.data,t(e)}),(()=>{ce()("./assets/ec5-status-codes/en.json").then((n=>{b.en.status_codes=n.data,t(e)}))}))}navigator.globalization?navigator.globalization.getPreferredLanguage((function(t){t.value.toLowerCase().startsWith("it")&&(e="it"),t.value.toLowerCase().startsWith("es")&&(e="es"),t.value.toLowerCase().startsWith("fr")&&(e="fr"),t.value.toLowerCase().startsWith("pl")&&(e="pl"),r(e)}),(()=>{})):r(e)}))},async getLanguagePWA(){const e=p(),t=e.language,n=e.serverUrl;let r="/";return new Promise(((e,s)=>{{const e=l.PWA_LANGUAGE_FILES_ENDPOINT;r=n+e+t+".json"}ce()(r).then((n=>{b[t].status_codes=n.data,e(t)})).catch((e=>{}))}))},async getServerUrl(){return new Promise(((e,t)=>{I.selectSetting("server_url").then((function(t){t.rows.length>0&&""!==t.rows.item(0).value?e(t.rows.item(0).value):e(l.DEFAULT_SERVER_URL),e()}),(function(e){t(e)}))}))},async tidyTempTables(){return new Promise(((e,t)=>{ot.deleteTempBranchEntries().then((()=>{ot.deleteTempUniqueAnswers().then((()=>{e()}),(e=>{t(e)}))}),(e=>{t(e)}))}))},async getEntriesOrder(){return new Promise(((e,t)=>{I.selectSetting("order_by").then((function(t){t.rows.length>0?e(JSON.parse(t.rows.item(0).value)):e(null)}),(function(e){t(e)}))}))},async insertDemoProject(){return new Promise(((e,t)=>{var n;window.localStorage.is_app_already_installed?e():(n=c.PROJECT_FILENAME,new Promise((e=>{ce()(n).then((t=>{e(JSON.stringify(t))}))}))).then((n=>{const r=JSON.parse(n).data.meta;c.PROJECT_EXTRA=JSON.stringify(r.project_extra),c.MAPPING=JSON.stringify(r.project_mapping),st.insertProject(c.PROJECT_SLUG,c.PROJECT_NAME,c.PROJECT_REF,c.PROJECT_EXTRA,l.DEFAULT_SERVER_URL,c.LAST_UPDATED,c.MAPPING).then((t=>{e()}),(e=>{t(e)}))}))}))},async getSelectedTextSize(){let e=l.DEFAULT_TEXT_SIZE;return new Promise(((t,n)=>{I.selectSetting("selected_text_size").then((function(n){n.rows.length>0&&"0"!==n.rows.item(0).value&&(e=n.rows.item(0).value),t(e)}),(function(e){n(e)}))}))},async getFiltersToggleStatus(){return new Promise((function(e,t){I.selectSetting("filters_toggle").then((function(t){e(t.rows.length>0&&"true"===t.rows.item(0).value)}),(function(e){t(e)}))}))},async retrieveJwtToken(){const e=p();return new Promise((function(t,n){I.getUser().then((async function(n){const r={},s=e.language;r.jwt="",r.name="",r.email="",n.rows.length>0?(r.action=b[s].labels.logout,r.jwt=n.rows.item(0).jwt,r.name=n.rows.item(0).name,r.email=n.rows.item(0).email):r.action=b[s].labels.login,t(r)}))}))}};var qa=n(4406);const xa={createDirsLegacy(){const e=p().device,t=[l.PHOTO_DIR,l.AUDIO_DIR,l.VIDEO_DIR,l.LOGOS_DIR];return e.platform===l.WEB||new Promise(((e,n)=>{let r;function s(){o()}function o(){let n;t.length>0?(n=t.shift(),r.getDirectory(n,{create:!0,exclusive:!1},s,a)):e()}function a(e){n()}window.localStorage.is_app_already_installed?e():window.resolveLocalFileSystemURL(cordova.file.dataDirectory,(function(e){r=e,o()}),a)}))},async removeExternalMediaDirs(e){const t=this,n=p().language,r=b[n].language,s=ne.getPlatformDownloadFolder(),o=s+e+"/"+l.PHOTO_DIR,a=s+e+"/"+l.AUDIO_DIR,i=s+e+"/"+l.VIDEO_DIR,u=cordova.file.externalRootDirectory,c=await t.dirExists(u+o),d=await t.dirExists(u+a),m=await t.dirExists(u+i);return new Promise(((e,t)=>{!async function(){null!==c&&null!==d&&null!==m||t(r.unknown_error);try{c&&await qa.fy.rmdir({path:o,directory:qa.tP.ExternalStorage,recursive:!0}),d&&await qa.fy.rmdir({path:a,directory:qa.tP.ExternalStorage,recursive:!0}),m&&await qa.fy.rmdir({path:i,directory:qa.tP.ExternalStorage,recursive:!0}),e()}catch(t){e()}}()}))},async dirExists(e){return new Promise((t=>{window.resolveLocalFileSystemURL(e,(e=>{t(!0)}),(e=>{1===e.code?t(!1):t(null)}))}))}};n(1292),n(1633),n(1045),n(6187),n(2299),n(3423),n(4687),n(9147),n(6250);const Ma=(0,a.Uk)("Beta"),za=(0,a.Uk)(" Report a bug  "),Ba=(0,a.Uk)("Beta"),Ga=(0,a.Uk)(" Report a bug  ");var Ya={props:{title:{type:String,required:!0},id:{type:String}},emits:["exit-app"],setup(e,t){const n=p(),r=(0,D.yj)(),s=n.language,o=b[s].labels,a={async reportBug(){await ne.hasInternetConnection()||O.showAlert(b[s].status_codes.ec5_135+"!",o.error),window.open(l.COMMUNITY_SUPPORT_URL,"_system","location=yes")},exitApp(e){const s=[l.ROUTES.NOT_FOUND,l.ROUTES.ENTRIES_ADD,l.ROUTES.ENTRIES_EDIT,l.ROUTES.ENTRIES_BRANCH_ADD];n.isPWA&&"project-logo"===e.target.className&&"img"===e.target.localName&&s.includes(r.name)&&t.emit("exit-app")}},i={showBetaToolbarAndroid:(0,m.Fl)((()=>{if(n.device.platform===l.ANDROID)return n.app.id.includes("beta")})),showBetaToolbariOS:(0,m.Fl)((()=>{if(n.device.platform===l.IOS)return n.app.id.includes("beta")})),isPWA:(0,m.Fl)((()=>n.isPWA))};return{chatbubbleEllipses:T.zRZ,...a,...i}}};var Ha=(0,f.Z)(Ya,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-title"),l=(0,a.up)("ion-icon"),u=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-header"),m=(0,a.up)("ion-content"),_=(0,a.up)("ion-page");return(0,a.wg)(),(0,a.j4)(_,{id:n.id},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[e.showBetaToolbarAndroid?((0,a.wg)(),(0,a.j4)(d,{key:0,color:"warning",class:"beta-toolbar"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start"},{default:(0,a.w5)((()=>[Ma])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{size:"small",onClick:t[0]||(t[0]=t=>e.reportBug())},{default:(0,a.w5)((()=>[za,(0,a.Wm)(l,{icon:r.chatbubbleEllipses},null,8,["icon"])])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.WI)(e.$slots,"actions-start")])),_:3}),(0,a.Wm)(i,{class:(0,h.C_)(["project-header",e.isPWA?"pwa":"ion-text-center"]),innerHTML:n.title,onClick:t[1]||(t[1]=t=>e.exitApp(t))},null,8,["class","innerHTML"]),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.WI)(e.$slots,"actions-end")])),_:3})])),_:3}),e.showBetaToolbariOS?((0,a.wg)(),(0,a.j4)(d,{key:1,color:"warning",class:"beta-toolbar"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start"},{default:(0,a.w5)((()=>[Ba])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{size:"small",onClick:t[2]||(t[2]=t=>e.reportBug())},{default:(0,a.w5)((()=>[Ga,(0,a.Wm)(l,{icon:r.chatbubbleEllipses},null,8,["icon"])])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.WI)(e.$slots,"subheader")])),_:3}),(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.WI)(e.$slots,"content")])),_:3})])),_:3},8,["id"])}]]);const Va={key:0,class:"user-label",lines:"none"},Qa=(0,a.Uk)("   ");var Za={setup(){const e=p(),t=ko(),n=e.language,r=b[n].labels,s=(0,D.tv)(),o=(0,m.qj)({bookmarks:t.bookmarks}),a={performAuthAction(){e.user.action===b[n].labels.login&&a.openModalLogin(),e.user.action===b[n].labels.logout&&a.logout(!0)},goToProjects(){s.replace({name:l.ROUTES.PROJECTS,params:{}}),Us.m.close()},goToSettings(){e.nextRoute=s.currentRoute.value.name,s.replace({name:l.ROUTES.SETTINGS,params:{}}),Us.m.close()},async goToCommunityPage(){await ne.hasInternetConnection()||O.showAlert(b[n].status_codes.ec5_135+"!",r.error),window.open(l.COMMUNITY_SUPPORT_URL,"_system","location=yes")},async goToUserGuide(){await ne.hasInternetConnection()?window.open(l.USER_GUIDE_URL,"_system","location=yes"):O.showAlert(b[n].status_codes.ec5_135+"!",r.error)},goToBookmark(t){B.destroy(),e.hierarchyNavigation=[...t.bookmark.slice()],e.routeParams={projectRef:t.projectRef,formRef:t.formRef},s.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:"true",timestamp:Date.now()}}),Us.m.close()},async openModalLogin(){await ne.hasInternetConnection()?(await O.showProgressDialog(),a.logout(!1).then((()=>{So()}),(async function(){O.hideProgressDialog(),O.showToast(b[n].status_codes.ec5_267)}))):O.showAlert(b[n].status_codes.ec5_118)},logout(t){function r(){e.user={action:b[n].labels.login,name:"",email:""},t&&O.showToast(b[n].status_codes.ec5_141),Us.m.close()}return new Promise((t=>{ot.deleteToken().then((function(){e.device.platform!==l.WEB?window.plugins.googleplus.logout((async function(e){r(),t()}),(function(e){r(),t()})):(r(),t())}))}))}},i={authAction:(0,m.Fl)((()=>e.user.action)),isLoggedIn:(0,m.Fl)((()=>e.user.email.length>0)),user:(0,m.Fl)((()=>e.user))};return{labels:r,state:o,...a,...i,document:T.tjo,bookmark:T.vjt,personCircle:T.Y1u,book:T.s9D,people:T.MI,settings:T.Xdb}}};var Ja=(0,f.Z)(Za,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-toolbar"),l=(0,a.up)("ion-header"),u=(0,a.up)("ion-label"),c=(0,a.up)("ion-item-group"),d=(0,a.up)("ion-icon"),p=(0,a.up)("ion-item"),m=(0,a.up)("ion-item-divider"),_=(0,a.up)("ion-list"),f=(0,a.up)("ion-content"),w=(0,a.up)("ion-menu");return(0,a.wg)(),(0,a.j4)(w,{side:"start","menu-id":"left-drawer","content-id":"main","swipe-gesture":"false"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{color:"primary",class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.menu),1)])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[e.isLoggedIn?((0,a.wg)(),(0,a.iD)("div",Va,[(0,a.Wm)(u,{color:"tertiary"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,h.zw)(r.labels.hi)+", "+(0,h.zw)(e.user.name),1)])),_:1}),(0,a.Wm)(u,{color:"dark"},{default:(0,a.w5)((()=>[(0,a._)("small",null,(0,h.zw)(e.user.email),1)])),_:1})])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(p,{onClick:t[0]||(t[0]=t=>e.goToProjects()),lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:r.document},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.projects),1)])),_:1}),(0,a.Wm)(p,{onClick:t[1]||(t[1]=t=>e.goToSettings()),lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:r.settings},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.settings),1)])),_:1}),(0,a.Wm)(p,{onClick:t[2]||(t[2]=t=>e.goToCommunityPage()),lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:r.people},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.help),1)])),_:1}),(0,a.Wm)(p,{onClick:t[3]||(t[3]=t=>e.goToUserGuide()),lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:r.book},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(r.labels.user_guide),1)])),_:1}),(0,a.Wm)(p,{lines:"full",onClick:t[4]||(t[4]=t=>e.performAuthAction())},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:r.personCircle},null,8,["icon"]),(0,a.Uk)("   "+(0,h.zw)(e.authAction),1)])),_:1}),(0,a.Wm)(m,{color:"primary",class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"item-divider-label-centered ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.my_bookmarks),1)])),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.state.bookmarks,((t,n)=>((0,a.wg)(),(0,a.j4)(p,{key:n,lines:"full",onClick:n=>e.goToBookmark(t)},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:r.bookmark},null,8,["icon"]),Qa,(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(t.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===r.state.bookmarks.length?((0,a.wg)(),(0,a.j4)(p,{key:0,lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"ion-text-center"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.no_bookmarks_found),1)])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1})}]]);const Xa=(0,a.Uk)("  A-Z "),Ka=(0,a.Uk)("  Z-A ");const $a={class:"ion-padding-top"},ei={class:"ion-padding-top"},ti={class:"ion-padding-top"};var ni={setup(e){const t=p().language,n=b[t].labels,r=(0,m.qj)({isFetching:!1,noHits:!1,hits:[],picks:[]}),s={dismiss(){i.modalController.dismiss()},getProjectNameMarkup(){return ne.getProjectNameMarkup(!0)},async goToProjectHomePage(){const e=B.getSlug(),s=l.DEFAULT_SERVER_URL+l.API.ROUTES.PROJECT+e;if(!await ne.hasInternetConnection())return O.showAlert(b[t].status_codes.ec5_135+"!",n.error),void(r.isFetching=!1);window.open(s,"_system","location=yes")}},o={projectName:B.getProjectName(),projectSmallDescription:B.getSmallDescription(),projectDescription:B.getDescription()};return{labels:n,state:r,...o,...s,open:T._H,closeOutline:T.fID}}};var ri=(0,f.Z)(ni,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-icon"),l=(0,a.up)("ion-button"),u=(0,a.up)("ion-buttons"),c=(0,a.up)("ion-title"),d=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-header"),m=(0,a.up)("ion-card-title"),_=(0,a.up)("ion-card-header"),f=(0,a.up)("ion-card-content"),w=(0,a.up)("ion-card"),g=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"button-close",onClick:t[0]||(t[0]=t=>e.dismiss())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"start",icon:r.closeOutline},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(r.labels.close),1)])),_:1})])),_:1}),(0,a.Wm)(c,{class:"project-header ion-text-center",innerHTML:e.getProjectNameMarkup()},null,8,["innerHTML"]),(0,a.Wm)(u,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{class:"button-open",onClick:t[1]||(t[1]=t=>e.goToProjectHomePage())},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{slot:"end",icon:r.open},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(g,{class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.project_info),1)])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("h2",$a,(0,h.zw)(e.projectName),1)])),_:1})])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.small_description),1)])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("h2",ei,(0,h.zw)(e.projectSmallDescription),1)])),_:1})])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.description),1)])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("h2",ti,(0,h.zw)(e.projectDescription),1)])),_:1})])),_:1})])),_:1})],64)}]]);const si={class:"ion-margin-top"},oi=["placeholder"];var ai={components:{HeaderModal:Qt},props:{bookmarkTitle:{type:String,required:!0},projectRef:{type:String,required:!0},formRef:{type:String,required:!0}},setup(e){const t=p(),n=ko(),r=t.language,s=b[r].labels,o=(0,m.qj)({bookmarkTitle:e.bookmarkTitle}),{projectRef:a,formRef:u}=(0,m.OT)(e),c=new RegExp(l.REGEX_BOOKMARK_TITLE),d={dismiss(){i.modalController.dismiss()},async addBookmark(){try{const e=await Ho.insertBookmark(a,u,o.bookmarkTitle);n.bookmarkId=e,O.showToast(b[r].status_codes.ec5_126)}catch(e){O.showAlert(b[r].status_codes.ec5_104)}i.modalController.dismiss()}},_={projectName:B.getProjectName(),projectSmallDescription:B.getSmallDescription(),projectDescription:B.getDescription(),isValidTitle:(0,m.Fl)((()=>c.test(o.bookmarkTitle))),bookmarkClass:(0,m.Fl)((()=>({"bookmark-title-error":!c.test(o.bookmarkTitle),"bookmark-title-success":c.test(o.bookmarkTitle)})))};return{labels:s,state:o,..._,...d,add:T.IHx}}};var ii=(0,f.Z)(ai,[["render",function(e,t,n,s,o,i){const l=(0,a.up)("header-modal"),u=(0,a.up)("ion-title"),c=(0,a.up)("ion-toolbar"),d=(0,a.up)("ion-card-title"),p=(0,a.up)("ion-card-header"),m=(0,a.up)("ion-icon"),_=(0,a.up)("ion-button"),f=(0,a.up)("ion-card-content"),w=(0,a.up)("ion-card"),g=(0,a.up)("ion-col"),E=(0,a.up)("ion-row"),y=(0,a.up)("ion-grid"),A=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(l,{onOnDismiss:t[0]||(t[0]=t=>e.dismiss())}),(0,a.Wm)(A,{class:"animate__animated animate__fadeIn"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"dark",mode:"md",class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.bookmark),1)])),_:1})])),_:1}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{"size-xs":"12","offset-xs":"0","size-sm":"8","offset-sm":"2","size-md":"8","offset-md":"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"settings-label"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(s.labels.bookmark_title),1)])),_:1})])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("div",si,[(0,a.wy)((0,a._)("input",{type:"text",class:"question-input",placeholder:s.labels.type_hint,"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.bookmarkTitle=e),maxlength:"50"},null,8,oi),[[r.nr,s.state.bookmarkTitle]])]),(0,a._)("div",{class:(0,h.C_)(e.bookmarkClass)},(0,h.zw)(s.labels.invalid_value),3),(0,a.Wm)(_,{expand:"block",color:"secondary",disabled:0===s.state.bookmarkTitle.length||!e.isValidTitle,onClick:t[2]||(t[2]=t=>e.addBookmark())},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{slot:"start",icon:s.add},null,8,["icon"]),(0,a.Uk)(" "+(0,h.zw)(s.labels.add_bookmark),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})],64)}]]);const li={async execute(e,t){const n=p(),r=n.language,s=b[r].labels,o=ne.getPlatformDownloadFolder(),a=n.persistentDir,i=a+l.PHOTO_DIR+e,u=a+l.AUDIO_DIR+e,c=a+l.VIDEO_DIR+e,d=o+t+"/"+l.PHOTO_DIR,m=o+t+"/"+l.AUDIO_DIR,_=o+t+"/"+l.VIDEO_DIR;return new Promise(((e,t)=>{!async function(){const n=await xa.dirExists(i),r=await xa.dirExists(u),o=await xa.dirExists(c);null!==n&&null!==r&&null!==o||t(s.unknown_error);try{n&&await qa.fy.copy({from:i,to:d,toDirectory:qa.tP.ExternalStorage}),r&&await qa.fy.copy({from:u,to:m,toDirectory:qa.tP.ExternalStorage}),o&&await qa.fy.copy({from:c,to:_,toDirectory:qa.tP.ExternalStorage}),e()}catch(e){t(e)}}()}))}},ui={async appendCSVRow(e,t,n,r,s){const o=this;return new Promise(((a,i)=>{!async function(){const l=o.getFilePath(n,s);if(0===r)try{await qa.fy.writeFile({path:l,data:e.join(","),directory:qa.tP.ExternalStorage,encoding:qa.ez.UTF8,recursive:!0})}catch(e){i(e)}if(t.length>0)try{await qa.fy.appendFile({path:l,data:"\r\n"+t,directory:qa.tP.ExternalStorage,encoding:qa.ez.UTF8}),a()}catch(e){i(e)}}()}))},getFilePath(e,t){const n=ne.getPlatformDownloadFolder(),r=B.getSlug(),s=B.getProjectMappings(),o=B.getProjectExtra(),a=B.getFormIndex(e),i=B.getFormName(e);let l="",u="";if(null!==t){const n=s.filter((e=>{if(e.is_default)return e.forms}));let r=0;const a=o.inputs[t].data.question;for(const[s,o]of Object.entries(n[0].forms[e])){if(s===t){l=ne.generateFilenameForExport("branch-"+(r+1),a);break}r++}}else l=ne.generateFilenameForExport("form-"+(a+1),i);return u=n+r+"/"+l+".csv",u}},ci={async exportHierarchyEntries(e,t){const n=p().language,r=Object.values(B.getForms()),s=B.getProjectMappings();let o,a=0;return 0===Object.entries(s).length?Promise.reject(b[n].status_codes.ec5_322):new Promise(((t,n)=>{!function i(l){const u=l.details.ref,c=Ie.getFormCSVHeaders(l,s,!1,a,!1);o=0,async function s(o){const d=await I.selectOneEntry(e,u,null,null,o);if(0===d.rows.length)r.length>0?(a++,o=0,i(r.shift())):t();else{const e=d.rows.item(0),t=l.details.ref,r=(await Ie.getFormCSVRow(e,l,JSON.parse(e.answers),!1)).join(",");try{await ui.appendCSVRow(c,r,t,o,null)}catch(e){n(e)}s(++o)}}(0)}(r.shift())}))},async exportBranchEntries(e){const t=[];let n;return new Promise(((r,s)=>{!async function(){const o=await I.selectDistinctBranchRefs(e);if(o.rows.length>0){for(let e=0;e<o.rows.length;e++){const n=o.rows.item(e);t.push({branchRef:n.owner_input_ref,formRef:n.form_ref})}!async function o(a){const i=B.getProjectMappings(),l=a.branchRef,u=Ie.getBranchCSVHeaders(a,i);async function c(n){const i=await I.selectOneBranchEntryForExport(e,l,n);if(0===i.rows.length)t.length>0?(n=0,o(t.shift())):r();else{const e=i.rows.item(0),t=await Ie.getBranchCSVRow(e,a,JSON.parse(e.answers),!1);try{await ui.appendCSVRow(u,t,a.formRef,n,a.branchRef)}catch(e){s(e)}c(++n)}}n=0,c(0)}(t.shift())}else r()}()}))},async exportMedia(e,t){return new Promise(((n,r)=>{!async function(){try{await xa.removeExternalMediaDirs(t);try{await li.execute(e,t),n()}catch(e){r(e)}}catch(e){r(e)}}()}))}};var di={setup(){const e=p(),t=R(),n=ko(),r=(0,D.tv)(),s=e.language,o=b[s].labels,a=(0,m.qj)({order:t.dbEntriesOrder}),u=(0,m.iH)(null),c={},d={isBookmarked:(0,m.Fl)((()=>null!==n.bookmarkId))},_={onMenuWillClose(){u.value.$el.scrollToTop(l.DELAY_FAST)},async exportAllEntries(){const t=B.getProjectRef(),n=B.getSlug();await O.showProgressDialog(o.wait);try{await ci.exportHierarchyEntries(t,n)}catch(e){O.hideProgressDialog(),O.showAlert(e)}try{await ci.exportBranchEntries(t,n)}catch(e){O.hideProgressDialog(),O.showAlert(e)}if(e.device.platform!==l.WEB)try{await ci.exportMedia(t,n),O.hideProgressDialog(),O.showAlert(o.all_entries_downloaded),Us.m.close()}catch(e){O.hideProgressDialog(),O.showAlert(e)}else O.hideProgressDialog(),O.showAlert(o.all_entries_downloaded),Us.m.close()},deleteProject(){!async function(e){const t=p().language,n=b[t].labels;if(!await O.confirmSingle(b[t].status_codes.ec5_113,b[t].labels.delete_project))return!1;await O.showProgressDialog(b[t].labels.deleting_project);const r=await I.selectProjectMedia({project_ref:B.getProjectRef(),synced:null,entry_uuid:null}),s=r.audios.concat(r.videos).concat(r.photos);if(s.length>0)try{await le.removeFiles(s),await ot.deleteProject(B.getProjectRef()),o()}catch(e){O.hideProgressDialog(),O.showAlert(n.unknown_error,n.error)}else try{await ot.deleteProject(B.getProjectRef()),o()}catch(e){O.hideProgressDialog(),O.showAlert(n.unknown_error,n.error)}async function o(){await Ho.getBookmarks(),B.destroy(),O.hideProgressDialog(),O.showToast(b[t].status_codes.ec5_114),Us.m.close(),e.replace({name:l.ROUTES.PROJECTS,params:{refresh:!0}})}}(r)},deleteEntries(){!async function(e){const t=p(),n=t.language,r=b[n].labels;if(!await O.confirmSingle(b[n].status_codes.ec5_121,b[n].labels.delete_all_entries))return!1;await O.showProgressDialog(r.deleting_entries);const s=await I.selectProjectMedia({project_ref:B.getProjectRef(),synced:null,entry_uuid:null}),o=s.audios.concat(s.videos).concat(s.photos);if(o.length>0)try{await le.removeFiles(o),await ot.deleteEntries(B.getProjectRef()),a()}catch(e){O.hideProgressDialog(),O.showAlert(r.unknown_error,r.error)}else try{await ot.deleteEntries(B.getProjectRef()),a()}catch(e){O.hideProgressDialog(),O.showAlert(r.unknown_error,r.error)}async function a(){await Ho.getBookmarks(),O.hideProgressDialog(),O.showToast(b[n].status_codes.ec5_122),t.hierarchyNavigation=[],Us.m.close(),e.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0}})}}(r)},async unsyncAllEntries(){const e=B.getProjectRef();await O.showProgressDialog(o.wait),await at.unsyncAllEntries(e),await at.unsyncAllBranchEntries(e),await at.unsyncAllFileEntries(e),O.hideProgressDialog(),O.showToast(o.unsynced),r.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0}}),Us.m.close()},async showProjectInfo(){return c.ModalProjectInfo=await i.modalController.create({cssClass:"modal-project-info",component:ri,showBackdrop:!0,backdropDismiss:!1,componentProps:{}}),c.ModalProjectInfo.present()},async sortBy(e,t){const n=R(),s=l.ALLOWED_ORDERING_COLUMNS.indexOf(e)>-1?e:l.DEFAULT_ORDERING_COLUMN,o=l.ALLOWED_ORDERING.indexOf(t)>-1?t:l.DEFAULT_ORDERING;n.dbEntriesOrder={field:s,sortType:o},a.order=n.dbEntriesOrder,await st.insertSetting("order_by",JSON.stringify(n.dbEntriesOrder)),r.replace({name:l.ROUTES.ENTRIES,params:{refreshEntries:!0,timestamp:Date.now()}})},async openModalBookmarkAdd(){let t="";const n=e.hierarchyNavigation;return t=n.length>0?n[n.length-1].parentEntryName:B.getProjectName(),c.ModalBookmarkAdd=await i.modalController.create({cssClass:"modal-bookmark-add",component:ii,showBackdrop:!0,backdropDismiss:!1,componentProps:{bookmarkTitle:t,formRef:z.formRef,projectRef:B.getProjectRef()}}),c.ModalBookmarkAdd.onDidDismiss().then((e=>{Us.m.close()})),c.ModalBookmarkAdd.present()},async removeBookmark(){const e=n.bookmarkId;try{await Ho.deleteBookmark(e),n.bookmarkId=null,O.showToast(b[s].status_codes.ec5_127)}catch(e){O.showAlert(b[s].status_codes.ec5_104)}Us.m.close()},goToDownloadPage(){e.nextRoute=r.currentRoute.value.name,r.replace({name:l.ROUTES.ENTRIES_DOWNLOAD}),Us.m.close()},goToUploadPage(){e.nextRoute=r.currentRoute.value.name,r.replace({name:l.ROUTES.ENTRIES_UPLOAD}),Us.m.close()}};return{labels:o,state:a,...d,..._,drawerContent:u,cloudUpload:T.RH0,cloudDownload:T.uQl,unlink:T.qBr,bookmark:T.vjt,informationCircle:T.n3I,trash:T._Ij,checkmark:T.d29,arrowUpCircle:T.bYZ,arrowDownCircle:T.qdp,timeOutline:T.bdY}}};var pi=(0,f.Z)(di,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-toolbar"),u=(0,a.up)("ion-header"),c=(0,a.up)("ion-icon"),d=(0,a.up)("ion-item"),p=(0,a.up)("ion-item-divider"),m=(0,a.up)("ion-list"),_=(0,a.up)("ion-content"),f=(0,a.up)("ion-menu");return(0,a.wg)(),(0,a.j4)(f,{side:"end","menu-id":"right-drawer","content-id":"main",onIonWillClose:t[12]||(t[12]=t=>e.onMenuWillClose()),"swipe-gesture":"false"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{color:"primary",class:"ion-text-center ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.project_options),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{ref:"drawerContent"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{onClick:t[0]||(t[0]=t=>e.goToUploadPage())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.cloudUpload},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.upload_entries),1)])),_:1}),(0,a.Wm)(d,{onClick:t[1]||(t[1]=t=>e.goToDownloadPage())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.cloudDownload},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.download_entries),1)])),_:1}),(0,a.Wm)(d,{onClick:t[2]||(t[2]=t=>e.unsyncAllEntries())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.unlink},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.unsync_all_entries),1)])),_:1}),e.isBookmarked?((0,a.wg)(),(0,a.j4)(d,{key:1,onClick:t[4]||(t[4]=t=>e.removeBookmark())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.bookmark},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.remove_bookmark),1)])),_:1})):((0,a.wg)(),(0,a.j4)(d,{key:0,onClick:t[3]||(t[3]=t=>e.openModalBookmarkAdd())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.bookmark},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.bookmark_page),1)])),_:1})),(0,a.Wm)(d,{onClick:t[5]||(t[5]=t=>e.showProjectInfo())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.informationCircle},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.project_info),1)])),_:1}),(0,a.Wm)(p,{color:"primary",class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"item-divider-label-centered ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.sort),1)])),_:1})])),_:1}),(0,a.Wm)(d,{onClick:t[6]||(t[6]=t=>e.sortBy("title","ASC"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.arrowUpCircle},null,8,["icon"]),Xa,"title"===r.state.order.field&&"ASC"===r.state.order.sortType?((0,a.wg)(),(0,a.j4)(c,{key:0,icon:r.checkmark,slot:"end"},null,8,["icon"])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(d,{onClick:t[7]||(t[7]=t=>e.sortBy("title","DESC"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.arrowDownCircle},null,8,["icon"]),Ka,"title"===r.state.order.field&&"DESC"===r.state.order.sortType?((0,a.wg)(),(0,a.j4)(c,{key:0,icon:r.checkmark,slot:"end"},null,8,["icon"])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(d,{onClick:t[8]||(t[8]=t=>e.sortBy("created_at","DESC"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.timeOutline},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.newest)+" ",1),"created_at"===r.state.order.field&&"DESC"===r.state.order.sortType?((0,a.wg)(),(0,a.j4)(c,{key:0,icon:r.checkmark,slot:"end"},null,8,["icon"])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(d,{onClick:t[9]||(t[9]=t=>e.sortBy("created_at","ASC"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{icon:r.timeOutline},null,8,["icon"]),(0,a.Uk)("  "+(0,h.zw)(r.labels.oldest)+" ",1),"created_at"===r.state.order.field&&"ASC"===r.state.order.sortType?((0,a.wg)(),(0,a.j4)(c,{key:0,icon:r.checkmark,slot:"end"},null,8,["icon"])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(p,{color:"danger",class:"ion-no-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"item-divider-label-centered ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,h.zw)(r.labels.delete),1)])),_:1})])),_:1}),(0,a.Wm)(d,{onClick:t[10]||(t[10]=t=>e.deleteEntries())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"icon-danger",icon:r.trash},null,8,["icon"]),(0,a.Wm)(i,{color:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)("  "+(0,h.zw)(r.labels.delete_all_entries),1)])),_:1})])),_:1}),(0,a.Wm)(d,{onClick:t[11]||(t[11]=t=>e.deleteProject())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"icon-danger",icon:r.trash},null,8,["icon"]),(0,a.Wm)(i,{color:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)("  "+(0,h.zw)(r.labels.delete_project),1)])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}]]);const mi={key:0},_i=["innerHTML"],fi={key:1},wi={key:2},gi={key:3},hi={key:4,class:"answer-item-text"},Ei={key:5,class:"answer-error"};const yi={key:0},Ai={key:1},Si={key:0},Ti={key:1},bi={key:0},Ri={key:1};var Ii={props:{item:{type:Object,required:!0}},setup(e){const t=p().language,n=b[t].labels,r={latitude:(0,m.Fl)((()=>parseFloat(e.item.answer.latitude).toFixed(6))),longitude:(0,m.Fl)((()=>parseFloat(e.item.answer.longitude).toFixed(6)))};return{labels:n,...e,...r}}};var vi={props:{item:{type:Object,required:!0},formRef:{type:String,required:!0},entry:{type:Object,required:!0},errors:{type:Object,required:!0}},setup(e){const t=p().language;return{labels:b[t].labels,...e}}};var Pi={name:"ListItemAnswer",components:{AnswerLocation:(0,f.Z)(Ii,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("ion-label"),l=(0,a.up)("ion-col"),u=(0,a.up)("ion-row"),c=(0,a.up)("ion-grid");return(0,a.wg)(),(0,a.j4)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,h.zw)(r.labels.latitude),1)])),_:1})])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[""===n.item.answer.latitude?((0,a.wg)(),(0,a.iD)("span",yi,(0,h.zw)(r.labels.not_located_yet),1)):((0,a.wg)(),(0,a.iD)("span",Ai,(0,h.zw)(e.latitude),1))])),_:1})])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,h.zw)(r.labels.longitude),1)])),_:1})])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[""===n.item.answer.longitude?((0,a.wg)(),(0,a.iD)("span",Si,(0,h.zw)(r.labels.not_located_yet),1)):((0,a.wg)(),(0,a.iD)("span",Ti,(0,h.zw)(e.longitude),1))])),_:1})])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"ion-text-uppercase"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,h.zw)(r.labels.accuracy),1)])),_:1})])),_:1}),(0,a.Wm)(l,null,{default:(0,a.w5)((()=>[""===n.item.answer.accuracy?((0,a.wg)(),(0,a.iD)("span",bi,(0,h.zw)(r.labels.not_located_yet),1)):((0,a.wg)(),(0,a.iD)("span",Ri,(0,h.zw)(n.item.answer.accuracy),1))])),_:1})])),_:1})])),_:1})}]]),AnswerGroup:(0,f.Z)(vi,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("list-answers");return(0,a.wg)(),(0,a.j4)(i,{class:"answer-group",items:n.item.answer,formRef:n.formRef,entry:n.entry,errors:n.errors,areGroupAnswers:!0,areBranchAnswers:!1},null,8,["items","formRef","entry","errors"])}]])},props:{item:{type:Object,required:!0},formRef:{type:String,required:!0},entry:{type:Object,required:!0},errors:{type:Object,required:!0},areGroupAnswers:{type:Boolean,required:!0}},setup(e){return{...e,...{editEntry(){}}}}};var Di=(0,f.Z)(Pi,[["render",function(e,t,n,r,s,o){const i=(0,a.up)("answer-location"),l=(0,a.up)("answer-group");return(0,a.wg)(),(0,a.iD)(a.HY,null,["readme"===n.item.type?((0,a.wg)(),(0,a.iD)("div",mi,[(0,a._)("div",{innerHTML:n.item.question},null,8,_i)])):"location"===n.item.type?((0,a.wg)(),(0,a.iD)("div",fi,[(0,a.Wm)(i,{item:n.item},null,8,["item"])])):"branch"===n.item.type?((0,a.wg)(),(0,a.iD)("div",wi,(0,h.zw)(n.item.answer),1)):"group"===n.item.type?((0,a.wg)(),(0,a.iD)("div",gi,[(0,a.Wm)(l,{formRef:n.formRef,entry:n.entry,errors:n.errors,item:n.item},null,8,["formRef","entry","errors","item"])])):((0,a.wg)(),(0,a.iD)("div",hi,[(0,a._)("span",null,(0,h.zw)(n.item.answer),1)])),n.item.synced_error&&"group"!==n.item.type?((0,a.wg)(),(0,a.iD)("div",Ei,[(0,a._)("span",null,(0,h.zw)(n.item.synced_error),1)])):(0,a.kq)("",!0)],64)}]]);const Oi={execute(){const e=p().device;let t="";return new Promise(((n,r)=>{e.platform===l.WEB&&n(t),e.platform===l.IOS&&window.resolveLocalFileSystemURL(cordova.file.tempDirectory,(function(e){t=e.nativeURL,t=t.slice(7),n(t)}),(function(e){r()})),e.platform===l.ANDROID&&window.resolveLocalFileSystemURL(cordova.file.cacheDirectory,(function(e){t=e.nativeURL,n(t)}),(function(e){r()}))}))}},ki={async execute(){const e=p().device;let t="";return new Promise(((n,r)=>{e.platform===l.WEB&&n(t),e.platform===l.IOS&&window.resolveLocalFileSystemURL(cordova.file.dataDirectory,(e=>{t=e.nativeURL,n(t)}),(e=>{r()})),e.platform===l.ANDROID&&window.resolveLocalFileSystemURL(cordova.file.dataDirectory,(e=>{t=e.nativeURL,n(t)}),(e=>{r()}))}))}},Ui={execute(e){return new Promise(((t,n)=>{const r=e=>{n(e)};e.transaction((e=>{e.executeSql("CREATE TABLE IF NOT EXISTS projects (id integer primary key, name text, slug text, logo_thumb text, project_ref text, json_extra text, server_url text, last_updated text,UNIQUE (project_ref, server_url))",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS users (id integer primary key, jwt text )",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS entries (id integer primary key, entry_uuid text UNIQUE, parent_entry_uuid text, project_ref text, form_ref text, parent_form_ref text, answers text, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, title text, synced int, synced_error text,can_edit int, is_remote int)",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS branch_entries (id integer primary key, entry_uuid text UNIQUE, owner_entry_uuid text, owner_input_ref text, project_ref text, form_ref text, answers text, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, title text, synced int, synced_error text,can_edit int, is_remote int)",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS temp_branch_entries (id integer primary key, entry_uuid text UNIQUE, owner_entry_uuid text, owner_input_ref text, project_ref text, form_ref text, answers text, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, title text, synced int, synced_error text,can_edit int, is_remote int)",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS media (id integer primary key, entry_uuid text, branch_entry_uuid text, input_ref text, project_ref text, form_ref text, file_name text, file_path text, file_type text, synced int, synced_error text,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS unique_answers (id integer primary key, project_ref text, entry_uuid text, input_ref text, parent_entry_uuid text, owner_entry_uuid text, answer text, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,UNIQUE (entry_uuid, input_ref))",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS temp_unique_answers (id integer primary key, project_ref text, entry_uuid text, input_ref text, parent_entry_uuid text, owner_entry_uuid text, answer text, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,UNIQUE (entry_uuid, input_ref))",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS bookmarks (id integer primary key, project_ref text, form_ref text, parent_entry_uuid text, title text, bookmark text, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",[],(e=>{}),r),e.executeSql("CREATE TABLE IF NOT EXISTS settings (id integer primary key, field text, value text,UNIQUE (field))",[],(e=>{}),r);const t=[u.dbVersionName];e.executeSql("SELECT * FROM settings WHERE field=?",t,(function(e,t){0===t.rows.length?e.executeSql("INSERT INTO settings (field, value) VALUES (?,?)",[u.dbVersionName,u.dbVersion],(e=>{}),r):window.localStorage.is_app_already_installed=1}),r)}),r,(()=>{t()}))}))}},Wi=(0,s.WB)();Wi.use((0,o.U2)({expanded:!0,disabled:!0}));const Ni=(0,r.ri)(w).use(i.IonicVue,{hardwareBackButton:!0,mode:"md"}).use(Wa).use(Wi);!async function(){const e=p();Object.keys(i).forEach((e=>{/^Ion[A-Z]\w+$/.test(e)&&Ni.component(e,i[e])})),Ni.component("base-layout",Ha),Ni.component("left-drawer",Ja),Ni.component("right-drawer",pi),Ni.component("list-answers",ia),Ni.component("list-item-answer",Di);const t=await Fa.getDeviceInfo();if(e.device=t,e.isPWA=e.device.platform===l.PWA,e.isPWA){const t=new URLSearchParams(window.location.search);e.searchParams=t;const n=window.location.pathname.split("/"),r=[l.PWA_ADD_ENTRY,l.PWA_EDIT_ENTRY],s=n.pop();r.includes(s)||(e.notFound=!0),e.searchParams=t;for(const[e,n]of t.entries());{const t=new URL(window.location.href);e.serverUrl=t.origin+ne.getBasepath()}if(e.language=l.DEFAULT_LANGUAGE,await Fa.getLanguagePWA(),!e.notFound){const t=window.location.pathname.split("/").splice(-2,1)[0];try{const n=await de.getProjectPWA(t);B.initialisePWA(n);let r="",o=!1;if(e.searchParams.get("branch_ref")&&e.searchParams.get("branch_owner_uuid")&&(o=!0),s===l.PWA_ADD_ENTRY)try{r=await Ss(l.PWA_ADD_ENTRY,o),e.providedSegment=l.PWA_ADD_ENTRY}catch(e){return!1}else{e.searchParams.has("uuid")||(e.notFound=!0);const t=e.searchParams.get("uuid");lt.isValidUuid(t)||(e.notFound=!0);try{r=await Ss(l.PWA_EDIT_ENTRY,o),e.providedSegment=l.PWA_EDIT_ENTRY}catch(t){e.notFound=!0}}e.routeParams=o?{formRef:r,inputRef:null,inputIndex:0,isBranch:!0,error:{}}:{formRef:r,inputRef:null,inputIndex:0,isBranch:!1,error:{}}}catch(t){t?O.showAlert(t.statusText,t.status):O.showAlert(b[e.language].labels.unknown_error),e.notFound=!0}}}else{const n=R(),r=ko(),s=await Fa.getAppInfo();e.app=s;const o=await Fa.getLanguage();e.language=o;const a=await Fa.openDB(t.platform);await Ui.execute(a),n.db=a,n.dbVersion=await Fa.getDBVersion();const i=await Fa.migrateDB();if(n.dbVersion=i,v.dV.isNativePlatform()){await xa.createDirsLegacy();const t=await Oi.execute();e.tempDir=t;const n=await ki.execute();e.persistentDir=n}const u=await Fa.getServerUrl();e.serverUrl=u;const c=await Ho.getBookmarks();r.setBookmarks(c),await Fa.tidyTempTables();const d=await Fa.getEntriesOrder();null!==d&&(n.dbEntriesOrder=d),await Fa.insertDemoProject();const p=await Fa.getSelectedTextSize();e.selectedTextSize=p;const m=await Fa.getFiltersToggleStatus();e.filtersToggle=m;const _=await Fa.retrieveJwtToken();e.user=_,e.device.platform===l.ANDROID&&(e.hasGoogleServices=await ne.hasGoogleServices())}String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return"[object regexp]"===Object.prototype.toString.call(e).toLowerCase()?this.replace(e,t):this.replace(new RegExp(e,"g"),t)}),Wa.isReady().then((()=>{Ni.mount("#app"),e.isPWA||setTimeout((async()=>{await Na.c.hide()}),l.DELAY_EXTRA_LONG)}))}()}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=function(t,n,s,o){if(!n){var a=1/0;for(c=0;c<e.length;c++){n=e[c][0],s=e[c][1],o=e[c][2];for(var i=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(r.O).every((function(e){return r.O[e](n[l])}))?n.splice(l--,1):(i=!1,o<a&&(a=o));if(i){e.splice(c--,1);var u=s();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,s,o]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.e=function(){return Promise.resolve()},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,o,a=n[0],i=n[1],l=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(l)var c=l(r)}for(t&&t(n);u<a.length;u++)o=a[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},n=self.webpackChunkuk_ac_imperial_epicollect_five_beta=self.webpackChunkuk_ac_imperial_epicollect_five_beta||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var s=r.O(void 0,[64,382,516,262],(function(){return r(471)}));s=r.O(s)}();
//# sourceMappingURL=app.js.map